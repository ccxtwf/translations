var AS=Object.defineProperty;var RS=(n,e,t)=>e in n?AS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var xS=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var we=(n,e,t)=>(RS(n,typeof e!="symbol"?e+"":e,t),t);var KU=xS((pi,mi)=>{function iT(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ss(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function _S(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var aT={exports:{}},$d={},sT={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pu=Symbol.for("react.element"),PS=Symbol.for("react.portal"),MS=Symbol.for("react.fragment"),OS=Symbol.for("react.strict_mode"),IS=Symbol.for("react.profiler"),DS=Symbol.for("react.provider"),$S=Symbol.for("react.context"),LS=Symbol.for("react.forward_ref"),qS=Symbol.for("react.suspense"),BS=Symbol.for("react.memo"),FS=Symbol.for("react.lazy"),Ug=Symbol.iterator;function kS(n){return n===null||typeof n!="object"?null:(n=Ug&&n[Ug]||n["@@iterator"],typeof n=="function"?n:null)}var oT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lT=Object.assign,uT={};function vo(n,e,t){this.props=n,this.context=e,this.refs=uT,this.updater=t||oT}vo.prototype.isReactComponent={};vo.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};vo.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function cT(){}cT.prototype=vo.prototype;function im(n,e,t){this.props=n,this.context=e,this.refs=uT,this.updater=t||oT}var am=im.prototype=new cT;am.constructor=im;lT(am,vo.prototype);am.isPureReactComponent=!0;var jg=Array.isArray,dT=Object.prototype.hasOwnProperty,sm={current:null},hT={key:!0,ref:!0,__self:!0,__source:!0};function fT(n,e,t){var r,i={},a=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)dT.call(e,r)&&!hT.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:pu,type:n,key:a,ref:s,props:i,_owner:sm.current}}function US(n,e){return{$$typeof:pu,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function om(n){return typeof n=="object"&&n!==null&&n.$$typeof===pu}function jS(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Qg=/\/+/g;function kh(n,e){return typeof n=="object"&&n!==null&&n.key!=null?jS(""+n.key):e.toString(36)}function Rc(n,e,t,r,i){var a=typeof n;(a==="undefined"||a==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case pu:case PS:s=!0}}if(s)return s=n,i=i(s),n=r===""?"."+kh(s,0):r,jg(i)?(t="",n!=null&&(t=n.replace(Qg,"$&/")+"/"),Rc(i,e,t,"",function(u){return u})):i!=null&&(om(i)&&(i=US(i,t+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Qg,"$&/")+"/")+n)),e.push(i)),1;if(s=0,r=r===""?".":r+":",jg(n))for(var o=0;o<n.length;o++){a=n[o];var l=r+kh(a,o);s+=Rc(a,e,t,l,i)}else if(l=kS(n),typeof l=="function")for(n=l.call(n),o=0;!(a=n.next()).done;)a=a.value,l=r+kh(a,o++),s+=Rc(a,e,t,l,i);else if(a==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Xu(n,e,t){if(n==null)return n;var r=[],i=0;return Rc(n,r,"","",function(a){return e.call(t,a,i++)}),r}function QS(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var gn={current:null},xc={transition:null},VS={ReactCurrentDispatcher:gn,ReactCurrentBatchConfig:xc,ReactCurrentOwner:sm};Ge.Children={map:Xu,forEach:function(n,e,t){Xu(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Xu(n,function(){e++}),e},toArray:function(n){return Xu(n,function(e){return e})||[]},only:function(n){if(!om(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ge.Component=vo;Ge.Fragment=MS;Ge.Profiler=IS;Ge.PureComponent=im;Ge.StrictMode=OS;Ge.Suspense=qS;Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VS;Ge.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=lT({},n.props),i=n.key,a=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=sm.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)dT.call(e,l)&&!hT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:pu,type:n.type,key:i,ref:a,props:r,_owner:s}};Ge.createContext=function(n){return n={$$typeof:$S,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:DS,_context:n},n.Consumer=n};Ge.createElement=fT;Ge.createFactory=function(n){var e=fT.bind(null,n);return e.type=n,e};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(n){return{$$typeof:LS,render:n}};Ge.isValidElement=om;Ge.lazy=function(n){return{$$typeof:FS,_payload:{_status:-1,_result:n},_init:QS}};Ge.memo=function(n,e){return{$$typeof:BS,type:n,compare:e===void 0?null:e}};Ge.startTransition=function(n){var e=xc.transition;xc.transition={};try{n()}finally{xc.transition=e}};Ge.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ge.useCallback=function(n,e){return gn.current.useCallback(n,e)};Ge.useContext=function(n){return gn.current.useContext(n)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(n){return gn.current.useDeferredValue(n)};Ge.useEffect=function(n,e){return gn.current.useEffect(n,e)};Ge.useId=function(){return gn.current.useId()};Ge.useImperativeHandle=function(n,e,t){return gn.current.useImperativeHandle(n,e,t)};Ge.useInsertionEffect=function(n,e){return gn.current.useInsertionEffect(n,e)};Ge.useLayoutEffect=function(n,e){return gn.current.useLayoutEffect(n,e)};Ge.useMemo=function(n,e){return gn.current.useMemo(n,e)};Ge.useReducer=function(n,e,t){return gn.current.useReducer(n,e,t)};Ge.useRef=function(n){return gn.current.useRef(n)};Ge.useState=function(n){return gn.current.useState(n)};Ge.useSyncExternalStore=function(n,e,t){return gn.current.useSyncExternalStore(n,e,t)};Ge.useTransition=function(){return gn.current.useTransition()};Ge.version="18.2.0";sT.exports=Ge;var Te=sT.exports;const Y=ss(Te),Vg=iT({__proto__:null,default:Y},[Te]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zS=Te,WS=Symbol.for("react.element"),HS=Symbol.for("react.fragment"),GS=Object.prototype.hasOwnProperty,KS=zS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JS={key:!0,ref:!0,__self:!0,__source:!0};function pT(n,e,t){var r,i={},a=null,s=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)GS.call(e,r)&&!JS.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:WS,type:n,key:a,ref:s,props:i,_owner:KS.current}}$d.Fragment=HS;$d.jsx=pT;$d.jsxs=pT;aT.exports=$d;var V=aT.exports,qf={},mT={exports:{}},Vn={},yT={exports:{}},gT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ee,de){var Ee=ee.length;ee.push(de);e:for(;0<Ee;){var ye=Ee-1>>>1,re=ee[ye];if(0<i(re,de))ee[ye]=de,ee[Ee]=re,Ee=ye;else break e}}function t(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var de=ee[0],Ee=ee.pop();if(Ee!==de){ee[0]=Ee;e:for(var ye=0,re=ee.length,Ze=re>>>1;ye<Ze;){var Pe=2*(ye+1)-1,Le=ee[Pe],Ve=Pe+1,et=ee[Ve];if(0>i(Le,Ee))Ve<re&&0>i(et,Le)?(ee[ye]=et,ee[Ve]=Ee,ye=Ve):(ee[ye]=Le,ee[Pe]=Ee,ye=Pe);else if(Ve<re&&0>i(et,Ee))ee[ye]=et,ee[Ve]=Ee,ye=Ve;else break e}}return de}function i(ee,de){var Ee=ee.sortIndex-de.sortIndex;return Ee!==0?Ee:ee.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();n.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,d=null,h=3,p=!1,g=!1,E=!1,A=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(ee){for(var de=t(u);de!==null;){if(de.callback===null)r(u);else if(de.startTime<=ee)r(u),de.sortIndex=de.expirationTime,e(l,de);else break;de=t(u)}}function P(ee){if(E=!1,C(ee),!g)if(t(l)!==null)g=!0,he(D);else{var de=t(u);de!==null&&pe(P,de.startTime-ee)}}function D(ee,de){g=!1,E&&(E=!1,b(W),W=-1),p=!0;var Ee=h;try{for(C(de),d=t(l);d!==null&&(!(d.expirationTime>de)||ee&&!M());){var ye=d.callback;if(typeof ye=="function"){d.callback=null,h=d.priorityLevel;var re=ye(d.expirationTime<=de);de=n.unstable_now(),typeof re=="function"?d.callback=re:d===t(l)&&r(l),C(de)}else r(l);d=t(l)}if(d!==null)var Ze=!0;else{var Pe=t(u);Pe!==null&&pe(P,Pe.startTime-de),Ze=!1}return Ze}finally{d=null,h=Ee,p=!1}}var F=!1,Q=null,W=-1,B=5,K=-1;function M(){return!(n.unstable_now()-K<B)}function Z(){if(Q!==null){var ee=n.unstable_now();K=ee;var de=!0;try{de=Q(!0,ee)}finally{de?q():(F=!1,Q=null)}}else F=!1}var q;if(typeof T=="function")q=function(){T(Z)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,oe=G.port2;G.port1.onmessage=Z,q=function(){oe.postMessage(null)}}else q=function(){A(Z,0)};function he(ee){Q=ee,F||(F=!0,q())}function pe(ee,de){W=A(function(){ee(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_continueExecution=function(){g||p||(g=!0,he(D))},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<ee?Math.floor(1e3/ee):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var de=3;break;default:de=h}var Ee=h;h=de;try{return ee()}finally{h=Ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ee,de){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Ee=h;h=ee;try{return de()}finally{h=Ee}},n.unstable_scheduleCallback=function(ee,de,Ee){var ye=n.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?ye+Ee:ye):Ee=ye,ee){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Ee+re,ee={id:c++,callback:de,priorityLevel:ee,startTime:Ee,expirationTime:re,sortIndex:-1},Ee>ye?(ee.sortIndex=Ee,e(u,ee),t(l)===null&&ee===t(u)&&(E?(b(W),W=-1):E=!0,pe(P,Ee-ye))):(ee.sortIndex=re,e(l,ee),g||p||(g=!0,he(D))),ee},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(ee){var de=h;return function(){var Ee=h;h=de;try{return ee.apply(this,arguments)}finally{h=Ee}}}})(gT);yT.exports=gT;var YS=yT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vT=Te,Bn=YS;function ue(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ET=new Set,Sl={};function os(n,e){Gs(n,e),Gs(n+"Capture",e)}function Gs(n,e){for(Sl[n]=e,n=0;n<e.length;n++)ET.add(e[n])}var wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bf=Object.prototype.hasOwnProperty,XS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zg={},Wg={};function ZS(n){return Bf.call(Wg,n)?!0:Bf.call(zg,n)?!1:XS.test(n)?Wg[n]=!0:(zg[n]=!0,!1)}function eA(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function tA(n,e,t,r){if(e===null||typeof e>"u"||eA(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vn(n,e,t,r,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){tn[n]=new vn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];tn[e]=new vn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){tn[n]=new vn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){tn[n]=new vn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){tn[n]=new vn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){tn[n]=new vn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){tn[n]=new vn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){tn[n]=new vn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){tn[n]=new vn(n,5,!1,n.toLowerCase(),null,!1,!1)});var lm=/[\-:]([a-z])/g;function um(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(lm,um);tn[e]=new vn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(lm,um);tn[e]=new vn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(lm,um);tn[e]=new vn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){tn[n]=new vn(n,1,!1,n.toLowerCase(),null,!1,!1)});tn.xlinkHref=new vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){tn[n]=new vn(n,1,!1,n.toLowerCase(),null,!0,!0)});function cm(n,e,t,r){var i=tn.hasOwnProperty(e)?tn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tA(e,t,i,r)&&(t=null),r||i===null?ZS(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Di=vT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zu=Symbol.for("react.element"),Rs=Symbol.for("react.portal"),xs=Symbol.for("react.fragment"),dm=Symbol.for("react.strict_mode"),Ff=Symbol.for("react.profiler"),wT=Symbol.for("react.provider"),TT=Symbol.for("react.context"),hm=Symbol.for("react.forward_ref"),kf=Symbol.for("react.suspense"),Uf=Symbol.for("react.suspense_list"),fm=Symbol.for("react.memo"),Qi=Symbol.for("react.lazy"),bT=Symbol.for("react.offscreen"),Hg=Symbol.iterator;function Qo(n){return n===null||typeof n!="object"?null:(n=Hg&&n[Hg]||n["@@iterator"],typeof n=="function"?n:null)}var Nt=Object.assign,Uh;function al(n){if(Uh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Uh=e&&e[1]||""}return`
`+Uh+n}var jh=!1;function Qh(n,e){if(!n||jh)return"";jh=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=s&&0<=o);break}}}finally{jh=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?al(n):""}function nA(n){switch(n.tag){case 5:return al(n.type);case 16:return al("Lazy");case 13:return al("Suspense");case 19:return al("SuspenseList");case 0:case 2:case 15:return n=Qh(n.type,!1),n;case 11:return n=Qh(n.type.render,!1),n;case 1:return n=Qh(n.type,!0),n;default:return""}}function jf(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case xs:return"Fragment";case Rs:return"Portal";case Ff:return"Profiler";case dm:return"StrictMode";case kf:return"Suspense";case Uf:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case TT:return(n.displayName||"Context")+".Consumer";case wT:return(n._context.displayName||"Context")+".Provider";case hm:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case fm:return e=n.displayName||null,e!==null?e:jf(n.type)||"Memo";case Qi:e=n._payload,n=n._init;try{return jf(n(e))}catch{}}return null}function rA(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jf(e);case 8:return e===dm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ia(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function NT(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function iA(n){var e=NT(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,a=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,a.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ec(n){n._valueTracker||(n._valueTracker=iA(n))}function CT(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=NT(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Wc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Qf(n,e){var t=e.checked;return Nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Gg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=ia(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ST(n,e){e=e.checked,e!=null&&cm(n,"checked",e,!1)}function Vf(n,e){ST(n,e);var t=ia(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?zf(n,e.type,t):e.hasOwnProperty("defaultValue")&&zf(n,e.type,ia(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Kg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function zf(n,e,t){(e!=="number"||Wc(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var sl=Array.isArray;function ks(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+ia(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Wf(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ue(91));return Nt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Jg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ue(92));if(sl(t)){if(1<t.length)throw Error(ue(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ia(t)}}function AT(n,e){var t=ia(e.value),r=ia(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Yg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function RT(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hf(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?RT(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var tc,xT=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(tc=tc||document.createElement("div"),tc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Al(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var dl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aA=["Webkit","ms","Moz","O"];Object.keys(dl).forEach(function(n){aA.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),dl[e]=dl[n]})});function _T(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||dl.hasOwnProperty(n)&&dl[n]?(""+e).trim():e+"px"}function PT(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=_T(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var sA=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gf(n,e){if(e){if(sA[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ue(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ue(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ue(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ue(62))}}function Kf(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jf=null;function pm(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Yf=null,Us=null,js=null;function Xg(n){if(n=gu(n)){if(typeof Yf!="function")throw Error(ue(280));var e=n.stateNode;e&&(e=kd(e),Yf(n.stateNode,n.type,e))}}function MT(n){Us?js?js.push(n):js=[n]:Us=n}function OT(){if(Us){var n=Us,e=js;if(js=Us=null,Xg(n),e)for(n=0;n<e.length;n++)Xg(e[n])}}function IT(n,e){return n(e)}function DT(){}var Vh=!1;function $T(n,e,t){if(Vh)return n(e,t);Vh=!0;try{return IT(n,e,t)}finally{Vh=!1,(Us!==null||js!==null)&&(DT(),OT())}}function Rl(n,e){var t=n.stateNode;if(t===null)return null;var r=kd(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ue(231,e,typeof t));return t}var Xf=!1;if(wi)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){Xf=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{Xf=!1}function oA(n,e,t,r,i,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var hl=!1,Hc=null,Gc=!1,Zf=null,lA={onError:function(n){hl=!0,Hc=n}};function uA(n,e,t,r,i,a,s,o,l){hl=!1,Hc=null,oA.apply(lA,arguments)}function cA(n,e,t,r,i,a,s,o,l){if(uA.apply(this,arguments),hl){if(hl){var u=Hc;hl=!1,Hc=null}else throw Error(ue(198));Gc||(Gc=!0,Zf=u)}}function ls(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function LT(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Zg(n){if(ls(n)!==n)throw Error(ue(188))}function dA(n){var e=n.alternate;if(!e){if(e=ls(n),e===null)throw Error(ue(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===t)return Zg(i),n;if(a===r)return Zg(i),e;a=a.sibling}throw Error(ue(188))}if(t.return!==r.return)t=i,r=a;else{for(var s=!1,o=i.child;o;){if(o===t){s=!0,t=i,r=a;break}if(o===r){s=!0,r=i,t=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===t){s=!0,t=a,r=i;break}if(o===r){s=!0,r=a,t=i;break}o=o.sibling}if(!s)throw Error(ue(189))}}if(t.alternate!==r)throw Error(ue(190))}if(t.tag!==3)throw Error(ue(188));return t.stateNode.current===t?n:e}function qT(n){return n=dA(n),n!==null?BT(n):null}function BT(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=BT(n);if(e!==null)return e;n=n.sibling}return null}var FT=Bn.unstable_scheduleCallback,ev=Bn.unstable_cancelCallback,hA=Bn.unstable_shouldYield,fA=Bn.unstable_requestPaint,_t=Bn.unstable_now,pA=Bn.unstable_getCurrentPriorityLevel,mm=Bn.unstable_ImmediatePriority,kT=Bn.unstable_UserBlockingPriority,Kc=Bn.unstable_NormalPriority,mA=Bn.unstable_LowPriority,UT=Bn.unstable_IdlePriority,Ld=null,Wr=null;function yA(n){if(Wr&&typeof Wr.onCommitFiberRoot=="function")try{Wr.onCommitFiberRoot(Ld,n,void 0,(n.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:EA,gA=Math.log,vA=Math.LN2;function EA(n){return n>>>=0,n===0?32:31-(gA(n)/vA|0)|0}var nc=64,rc=4194304;function ol(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Jc(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,a=n.pingedLanes,s=t&268435455;if(s!==0){var o=s&~i;o!==0?r=ol(o):(a&=s,a!==0&&(r=ol(a)))}else s=t&~i,s!==0?r=ol(s):a!==0&&(r=ol(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-_r(e),i=1<<t,r|=n[t],e&=~i;return r}function wA(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TA(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,a=n.pendingLanes;0<a;){var s=31-_r(a),o=1<<s,l=i[s];l===-1?(!(o&t)||o&r)&&(i[s]=wA(o,e)):l<=e&&(n.expiredLanes|=o),a&=~o}}function ep(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function jT(){var n=nc;return nc<<=1,!(nc&4194240)&&(nc=64),n}function zh(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function mu(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-_r(e),n[e]=t}function bA(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-_r(t),a=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~a}}function ym(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-_r(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var nt=0;function QT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var VT,gm,zT,WT,HT,tp=!1,ic=[],Ji=null,Yi=null,Xi=null,xl=new Map,_l=new Map,zi=[],NA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tv(n,e){switch(n){case"focusin":case"focusout":Ji=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":xl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_l.delete(e.pointerId)}}function zo(n,e,t,r,i,a){return n===null||n.nativeEvent!==a?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=gu(e),e!==null&&gm(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function CA(n,e,t,r,i){switch(e){case"focusin":return Ji=zo(Ji,n,e,t,r,i),!0;case"dragenter":return Yi=zo(Yi,n,e,t,r,i),!0;case"mouseover":return Xi=zo(Xi,n,e,t,r,i),!0;case"pointerover":var a=i.pointerId;return xl.set(a,zo(xl.get(a)||null,n,e,t,r,i)),!0;case"gotpointercapture":return a=i.pointerId,_l.set(a,zo(_l.get(a)||null,n,e,t,r,i)),!0}return!1}function GT(n){var e=qa(n.target);if(e!==null){var t=ls(e);if(t!==null){if(e=t.tag,e===13){if(e=LT(t),e!==null){n.blockedOn=e,HT(n.priority,function(){zT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function _c(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=np(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Jf=r,t.target.dispatchEvent(r),Jf=null}else return e=gu(t),e!==null&&gm(e),n.blockedOn=t,!1;e.shift()}return!0}function nv(n,e,t){_c(n)&&t.delete(e)}function SA(){tp=!1,Ji!==null&&_c(Ji)&&(Ji=null),Yi!==null&&_c(Yi)&&(Yi=null),Xi!==null&&_c(Xi)&&(Xi=null),xl.forEach(nv),_l.forEach(nv)}function Wo(n,e){n.blockedOn===e&&(n.blockedOn=null,tp||(tp=!0,Bn.unstable_scheduleCallback(Bn.unstable_NormalPriority,SA)))}function Pl(n){function e(i){return Wo(i,n)}if(0<ic.length){Wo(ic[0],n);for(var t=1;t<ic.length;t++){var r=ic[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Ji!==null&&Wo(Ji,n),Yi!==null&&Wo(Yi,n),Xi!==null&&Wo(Xi,n),xl.forEach(e),_l.forEach(e),t=0;t<zi.length;t++)r=zi[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<zi.length&&(t=zi[0],t.blockedOn===null);)GT(t),t.blockedOn===null&&zi.shift()}var Qs=Di.ReactCurrentBatchConfig,Yc=!0;function AA(n,e,t,r){var i=nt,a=Qs.transition;Qs.transition=null;try{nt=1,vm(n,e,t,r)}finally{nt=i,Qs.transition=a}}function RA(n,e,t,r){var i=nt,a=Qs.transition;Qs.transition=null;try{nt=4,vm(n,e,t,r)}finally{nt=i,Qs.transition=a}}function vm(n,e,t,r){if(Yc){var i=np(n,e,t,r);if(i===null)tf(n,e,r,Xc,t),tv(n,r);else if(CA(i,n,e,t,r))r.stopPropagation();else if(tv(n,r),e&4&&-1<NA.indexOf(n)){for(;i!==null;){var a=gu(i);if(a!==null&&VT(a),a=np(n,e,t,r),a===null&&tf(n,e,r,Xc,t),a===i)break;i=a}i!==null&&r.stopPropagation()}else tf(n,e,r,null,t)}}var Xc=null;function np(n,e,t,r){if(Xc=null,n=pm(r),n=qa(n),n!==null)if(e=ls(n),e===null)n=null;else if(t=e.tag,t===13){if(n=LT(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Xc=n,null}function KT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pA()){case mm:return 1;case kT:return 4;case Kc:case mA:return 16;case UT:return 536870912;default:return 16}default:return 16}}var Hi=null,Em=null,Pc=null;function JT(){if(Pc)return Pc;var n,e=Em,t=e.length,r,i="value"in Hi?Hi.value:Hi.textContent,a=i.length;for(n=0;n<t&&e[n]===i[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===i[a-r];r++);return Pc=i.slice(n,1<r?1-r:void 0)}function Mc(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function ac(){return!0}function rv(){return!1}function zn(n){function e(t,r,i,a,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ac:rv,this.isPropagationStopped=rv,this}return Nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ac)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ac)},persist:function(){},isPersistent:ac}),e}var Eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wm=zn(Eo),yu=Nt({},Eo,{view:0,detail:0}),xA=zn(yu),Wh,Hh,Ho,qd=Nt({},yu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tm,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ho&&(Ho&&n.type==="mousemove"?(Wh=n.screenX-Ho.screenX,Hh=n.screenY-Ho.screenY):Hh=Wh=0,Ho=n),Wh)},movementY:function(n){return"movementY"in n?n.movementY:Hh}}),iv=zn(qd),_A=Nt({},qd,{dataTransfer:0}),PA=zn(_A),MA=Nt({},yu,{relatedTarget:0}),Gh=zn(MA),OA=Nt({},Eo,{animationName:0,elapsedTime:0,pseudoElement:0}),IA=zn(OA),DA=Nt({},Eo,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),$A=zn(DA),LA=Nt({},Eo,{data:0}),av=zn(LA),qA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kA(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=FA[n])?!!e[n]:!1}function Tm(){return kA}var UA=Nt({},yu,{key:function(n){if(n.key){var e=qA[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Mc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?BA[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tm,charCode:function(n){return n.type==="keypress"?Mc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Mc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),jA=zn(UA),QA=Nt({},qd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sv=zn(QA),VA=Nt({},yu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tm}),zA=zn(VA),WA=Nt({},Eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),HA=zn(WA),GA=Nt({},qd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),KA=zn(GA),JA=[9,13,27,32],bm=wi&&"CompositionEvent"in window,fl=null;wi&&"documentMode"in document&&(fl=document.documentMode);var YA=wi&&"TextEvent"in window&&!fl,YT=wi&&(!bm||fl&&8<fl&&11>=fl),ov=" ",lv=!1;function XT(n,e){switch(n){case"keyup":return JA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var _s=!1;function XA(n,e){switch(n){case"compositionend":return ZT(e);case"keypress":return e.which!==32?null:(lv=!0,ov);case"textInput":return n=e.data,n===ov&&lv?null:n;default:return null}}function ZA(n,e){if(_s)return n==="compositionend"||!bm&&XT(n,e)?(n=JT(),Pc=Em=Hi=null,_s=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return YT&&e.locale!=="ko"?null:e.data;default:return null}}var eR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!eR[n.type]:e==="textarea"}function e0(n,e,t,r){MT(r),e=Zc(e,"onChange"),0<e.length&&(t=new wm("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var pl=null,Ml=null;function tR(n){d0(n,0)}function Bd(n){var e=Os(n);if(CT(e))return n}function nR(n,e){if(n==="change")return e}var t0=!1;if(wi){var Kh;if(wi){var Jh="oninput"in document;if(!Jh){var cv=document.createElement("div");cv.setAttribute("oninput","return;"),Jh=typeof cv.oninput=="function"}Kh=Jh}else Kh=!1;t0=Kh&&(!document.documentMode||9<document.documentMode)}function dv(){pl&&(pl.detachEvent("onpropertychange",n0),Ml=pl=null)}function n0(n){if(n.propertyName==="value"&&Bd(Ml)){var e=[];e0(e,Ml,n,pm(n)),$T(tR,e)}}function rR(n,e,t){n==="focusin"?(dv(),pl=e,Ml=t,pl.attachEvent("onpropertychange",n0)):n==="focusout"&&dv()}function iR(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Bd(Ml)}function aR(n,e){if(n==="click")return Bd(e)}function sR(n,e){if(n==="input"||n==="change")return Bd(e)}function oR(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Dr=typeof Object.is=="function"?Object.is:oR;function Ol(n,e){if(Dr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Bf.call(e,i)||!Dr(n[i],e[i]))return!1}return!0}function hv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function fv(n,e){var t=hv(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=hv(t)}}function r0(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?r0(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function i0(){for(var n=window,e=Wc();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Wc(n.document)}return e}function Nm(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function lR(n){var e=i0(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&r0(t.ownerDocument.documentElement,t)){if(r!==null&&Nm(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!n.extend&&a>r&&(i=r,r=a,a=i),i=fv(t,a);var s=fv(t,r);i&&s&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),a>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var uR=wi&&"documentMode"in document&&11>=document.documentMode,Ps=null,rp=null,ml=null,ip=!1;function pv(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;ip||Ps==null||Ps!==Wc(r)||(r=Ps,"selectionStart"in r&&Nm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ml&&Ol(ml,r)||(ml=r,r=Zc(rp,"onSelect"),0<r.length&&(e=new wm("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ps)))}function sc(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ms={animationend:sc("Animation","AnimationEnd"),animationiteration:sc("Animation","AnimationIteration"),animationstart:sc("Animation","AnimationStart"),transitionend:sc("Transition","TransitionEnd")},Yh={},a0={};wi&&(a0=document.createElement("div").style,"AnimationEvent"in window||(delete Ms.animationend.animation,delete Ms.animationiteration.animation,delete Ms.animationstart.animation),"TransitionEvent"in window||delete Ms.transitionend.transition);function Fd(n){if(Yh[n])return Yh[n];if(!Ms[n])return n;var e=Ms[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in a0)return Yh[n]=e[t];return n}var s0=Fd("animationend"),o0=Fd("animationiteration"),l0=Fd("animationstart"),u0=Fd("transitionend"),c0=new Map,mv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function va(n,e){c0.set(n,e),os(e,[n])}for(var Xh=0;Xh<mv.length;Xh++){var Zh=mv[Xh],cR=Zh.toLowerCase(),dR=Zh[0].toUpperCase()+Zh.slice(1);va(cR,"on"+dR)}va(s0,"onAnimationEnd");va(o0,"onAnimationIteration");va(l0,"onAnimationStart");va("dblclick","onDoubleClick");va("focusin","onFocus");va("focusout","onBlur");va(u0,"onTransitionEnd");Gs("onMouseEnter",["mouseout","mouseover"]);Gs("onMouseLeave",["mouseout","mouseover"]);Gs("onPointerEnter",["pointerout","pointerover"]);Gs("onPointerLeave",["pointerout","pointerover"]);os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));os("onBeforeInput",["compositionend","keypress","textInput","paste"]);os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hR=new Set("cancel close invalid load scroll toggle".split(" ").concat(ll));function yv(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,cA(r,e,void 0,n),n.currentTarget=null}function d0(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;yv(i,o,u),a=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;yv(i,o,u),a=l}}}if(Gc)throw n=Zf,Gc=!1,Zf=null,n}function dt(n,e){var t=e[up];t===void 0&&(t=e[up]=new Set);var r=n+"__bubble";t.has(r)||(h0(e,n,2,!1),t.add(r))}function ef(n,e,t){var r=0;e&&(r|=4),h0(t,n,r,e)}var oc="_reactListening"+Math.random().toString(36).slice(2);function Il(n){if(!n[oc]){n[oc]=!0,ET.forEach(function(t){t!=="selectionchange"&&(hR.has(t)||ef(t,!1,n),ef(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[oc]||(e[oc]=!0,ef("selectionchange",!1,e))}}function h0(n,e,t,r){switch(KT(e)){case 1:var i=AA;break;case 4:i=RA;break;default:i=vm}t=i.bind(null,e,t,n),i=void 0,!Xf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function tf(n,e,t,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=qa(o),s===null)return;if(l=s.tag,l===5||l===6){r=a=s;continue e}o=o.parentNode}}r=r.return}$T(function(){var u=a,c=pm(t),d=[];e:{var h=c0.get(n);if(h!==void 0){var p=wm,g=n;switch(n){case"keypress":if(Mc(t)===0)break e;case"keydown":case"keyup":p=jA;break;case"focusin":g="focus",p=Gh;break;case"focusout":g="blur",p=Gh;break;case"beforeblur":case"afterblur":p=Gh;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=iv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=PA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=zA;break;case s0:case o0:case l0:p=IA;break;case u0:p=HA;break;case"scroll":p=xA;break;case"wheel":p=KA;break;case"copy":case"cut":case"paste":p=$A;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=sv}var E=(e&4)!==0,A=!E&&n==="scroll",b=E?h!==null?h+"Capture":null:h;E=[];for(var T=u,C;T!==null;){C=T;var P=C.stateNode;if(C.tag===5&&P!==null&&(C=P,b!==null&&(P=Rl(T,b),P!=null&&E.push(Dl(T,P,C)))),A)break;T=T.return}0<E.length&&(h=new p(h,g,null,t,c),d.push({event:h,listeners:E}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",h&&t!==Jf&&(g=t.relatedTarget||t.fromElement)&&(qa(g)||g[Ti]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=t.relatedTarget||t.toElement,p=u,g=g?qa(g):null,g!==null&&(A=ls(g),g!==A||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(E=iv,P="onMouseLeave",b="onMouseEnter",T="mouse",(n==="pointerout"||n==="pointerover")&&(E=sv,P="onPointerLeave",b="onPointerEnter",T="pointer"),A=p==null?h:Os(p),C=g==null?h:Os(g),h=new E(P,T+"leave",p,t,c),h.target=A,h.relatedTarget=C,P=null,qa(c)===u&&(E=new E(b,T+"enter",g,t,c),E.target=C,E.relatedTarget=A,P=E),A=P,p&&g)t:{for(E=p,b=g,T=0,C=E;C;C=bs(C))T++;for(C=0,P=b;P;P=bs(P))C++;for(;0<T-C;)E=bs(E),T--;for(;0<C-T;)b=bs(b),C--;for(;T--;){if(E===b||b!==null&&E===b.alternate)break t;E=bs(E),b=bs(b)}E=null}else E=null;p!==null&&gv(d,h,p,E,!1),g!==null&&A!==null&&gv(d,A,g,E,!0)}}e:{if(h=u?Os(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var D=nR;else if(uv(h))if(t0)D=sR;else{D=iR;var F=rR}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(D=aR);if(D&&(D=D(n,u))){e0(d,D,t,c);break e}F&&F(n,h,u),n==="focusout"&&(F=h._wrapperState)&&F.controlled&&h.type==="number"&&zf(h,"number",h.value)}switch(F=u?Os(u):window,n){case"focusin":(uv(F)||F.contentEditable==="true")&&(Ps=F,rp=u,ml=null);break;case"focusout":ml=rp=Ps=null;break;case"mousedown":ip=!0;break;case"contextmenu":case"mouseup":case"dragend":ip=!1,pv(d,t,c);break;case"selectionchange":if(uR)break;case"keydown":case"keyup":pv(d,t,c)}var Q;if(bm)e:{switch(n){case"compositionstart":var W="onCompositionStart";break e;case"compositionend":W="onCompositionEnd";break e;case"compositionupdate":W="onCompositionUpdate";break e}W=void 0}else _s?XT(n,t)&&(W="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(W="onCompositionStart");W&&(YT&&t.locale!=="ko"&&(_s||W!=="onCompositionStart"?W==="onCompositionEnd"&&_s&&(Q=JT()):(Hi=c,Em="value"in Hi?Hi.value:Hi.textContent,_s=!0)),F=Zc(u,W),0<F.length&&(W=new av(W,n,null,t,c),d.push({event:W,listeners:F}),Q?W.data=Q:(Q=ZT(t),Q!==null&&(W.data=Q)))),(Q=YA?XA(n,t):ZA(n,t))&&(u=Zc(u,"onBeforeInput"),0<u.length&&(c=new av("onBeforeInput","beforeinput",null,t,c),d.push({event:c,listeners:u}),c.data=Q))}d0(d,e)})}function Dl(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Zc(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Rl(n,t),a!=null&&r.unshift(Dl(n,a,i)),a=Rl(n,e),a!=null&&r.push(Dl(n,a,i))),n=n.return}return r}function bs(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function gv(n,e,t,r,i){for(var a=e._reactName,s=[];t!==null&&t!==r;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=Rl(t,a),l!=null&&s.unshift(Dl(t,l,o))):i||(l=Rl(t,a),l!=null&&s.push(Dl(t,l,o)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var fR=/\r\n?/g,pR=/\u0000|\uFFFD/g;function vv(n){return(typeof n=="string"?n:""+n).replace(fR,`
`).replace(pR,"")}function lc(n,e,t){if(e=vv(e),vv(n)!==e&&t)throw Error(ue(425))}function ed(){}var ap=null,sp=null;function op(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lp=typeof setTimeout=="function"?setTimeout:void 0,mR=typeof clearTimeout=="function"?clearTimeout:void 0,Ev=typeof Promise=="function"?Promise:void 0,yR=typeof queueMicrotask=="function"?queueMicrotask:typeof Ev<"u"?function(n){return Ev.resolve(null).then(n).catch(gR)}:lp;function gR(n){setTimeout(function(){throw n})}function nf(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Pl(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Pl(e)}function Zi(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function wv(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var wo=Math.random().toString(36).slice(2),Ur="__reactFiber$"+wo,$l="__reactProps$"+wo,Ti="__reactContainer$"+wo,up="__reactEvents$"+wo,vR="__reactListeners$"+wo,ER="__reactHandles$"+wo;function qa(n){var e=n[Ur];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ti]||t[Ur]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=wv(n);n!==null;){if(t=n[Ur])return t;n=wv(n)}return e}n=t,t=n.parentNode}return null}function gu(n){return n=n[Ur]||n[Ti],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Os(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ue(33))}function kd(n){return n[$l]||null}var cp=[],Is=-1;function Ea(n){return{current:n}}function pt(n){0>Is||(n.current=cp[Is],cp[Is]=null,Is--)}function lt(n,e){Is++,cp[Is]=n.current,n.current=e}var aa={},dn=Ea(aa),Nn=Ea(!1),za=aa;function Ks(n,e){var t=n.type.contextTypes;if(!t)return aa;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in t)i[a]=e[a];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Cn(n){return n=n.childContextTypes,n!=null}function td(){pt(Nn),pt(dn)}function Tv(n,e,t){if(dn.current!==aa)throw Error(ue(168));lt(dn,e),lt(Nn,t)}function f0(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ue(108,rA(n)||"Unknown",i));return Nt({},t,r)}function nd(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||aa,za=dn.current,lt(dn,n),lt(Nn,Nn.current),!0}function bv(n,e,t){var r=n.stateNode;if(!r)throw Error(ue(169));t?(n=f0(n,e,za),r.__reactInternalMemoizedMergedChildContext=n,pt(Nn),pt(dn),lt(dn,n)):pt(Nn),lt(Nn,t)}var ui=null,Ud=!1,rf=!1;function p0(n){ui===null?ui=[n]:ui.push(n)}function wR(n){Ud=!0,p0(n)}function wa(){if(!rf&&ui!==null){rf=!0;var n=0,e=nt;try{var t=ui;for(nt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}ui=null,Ud=!1}catch(i){throw ui!==null&&(ui=ui.slice(n+1)),FT(mm,wa),i}finally{nt=e,rf=!1}}return null}var Ds=[],$s=0,rd=null,id=0,Yn=[],Xn=0,Wa=null,di=1,hi="";function Ia(n,e){Ds[$s++]=id,Ds[$s++]=rd,rd=n,id=e}function m0(n,e,t){Yn[Xn++]=di,Yn[Xn++]=hi,Yn[Xn++]=Wa,Wa=n;var r=di;n=hi;var i=32-_r(r)-1;r&=~(1<<i),t+=1;var a=32-_r(e)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,di=1<<32-_r(e)+i|t<<i|r,hi=a+n}else di=1<<a|t<<i|r,hi=n}function Cm(n){n.return!==null&&(Ia(n,1),m0(n,1,0))}function Sm(n){for(;n===rd;)rd=Ds[--$s],Ds[$s]=null,id=Ds[--$s],Ds[$s]=null;for(;n===Wa;)Wa=Yn[--Xn],Yn[Xn]=null,hi=Yn[--Xn],Yn[Xn]=null,di=Yn[--Xn],Yn[Xn]=null}var Ln=null,Dn=null,gt=!1,Ar=null;function y0(n,e){var t=tr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Nv(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ln=n,Dn=Zi(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ln=n,Dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Wa!==null?{id:di,overflow:hi}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=tr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ln=n,Dn=null,!0):!1;default:return!1}}function dp(n){return(n.mode&1)!==0&&(n.flags&128)===0}function hp(n){if(gt){var e=Dn;if(e){var t=e;if(!Nv(n,e)){if(dp(n))throw Error(ue(418));e=Zi(t.nextSibling);var r=Ln;e&&Nv(n,e)?y0(r,t):(n.flags=n.flags&-4097|2,gt=!1,Ln=n)}}else{if(dp(n))throw Error(ue(418));n.flags=n.flags&-4097|2,gt=!1,Ln=n}}}function Cv(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ln=n}function uc(n){if(n!==Ln)return!1;if(!gt)return Cv(n),gt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!op(n.type,n.memoizedProps)),e&&(e=Dn)){if(dp(n))throw g0(),Error(ue(418));for(;e;)y0(n,e),e=Zi(e.nextSibling)}if(Cv(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ue(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Dn=Zi(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Dn=null}}else Dn=Ln?Zi(n.stateNode.nextSibling):null;return!0}function g0(){for(var n=Dn;n;)n=Zi(n.nextSibling)}function Js(){Dn=Ln=null,gt=!1}function Am(n){Ar===null?Ar=[n]:Ar.push(n)}var TR=Di.ReactCurrentBatchConfig;function br(n,e){if(n&&n.defaultProps){e=Nt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var ad=Ea(null),sd=null,Ls=null,Rm=null;function xm(){Rm=Ls=sd=null}function _m(n){var e=ad.current;pt(ad),n._currentValue=e}function fp(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Vs(n,e){sd=n,Rm=Ls=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(bn=!0),n.firstContext=null)}function sr(n){var e=n._currentValue;if(Rm!==n)if(n={context:n,memoizedValue:e,next:null},Ls===null){if(sd===null)throw Error(ue(308));Ls=n,sd.dependencies={lanes:0,firstContext:n}}else Ls=Ls.next=n;return e}var Ba=null;function Pm(n){Ba===null?Ba=[n]:Ba.push(n)}function v0(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Pm(e)):(t.next=i.next,i.next=t),e.interleaved=t,bi(n,r)}function bi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Vi=!1;function Mm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function E0(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function yi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ea(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,bi(n,t)}return i=r.interleaved,i===null?(e.next=e,Pm(r)):(e.next=i.next,i.next=e),r.interleaved=e,bi(n,t)}function Oc(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,ym(n,t)}}function Sv(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,a=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};a===null?i=a=s:a=a.next=s,t=t.next}while(t!==null);a===null?i=a=e:a=a.next=e}else i=a=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function od(n,e,t,r){var i=n.updateQueue;Vi=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?a=u:s.next=u,s=l;var c=n.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(a!==null){var d=i.baseState;s=0,c=u=l=null,o=a;do{var h=o.lane,p=o.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=n,E=o;switch(h=e,p=t,E.tag){case 1:if(g=E.payload,typeof g=="function"){d=g.call(p,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=E.payload,h=typeof g=="function"?g.call(p,d,h):g,h==null)break e;d=Nt({},d,h);break e;case 2:Vi=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=p,l=d):c=c.next=p,s|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Ga|=s,n.lanes=s,n.memoizedState=d}}function Av(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(ue(191,i));i.call(r)}}}var w0=new vT.Component().refs;function pp(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Nt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var jd={isMounted:function(n){return(n=n._reactInternals)?ls(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=mn(),i=na(n),a=yi(r,i);a.payload=e,t!=null&&(a.callback=t),e=ea(n,a,i),e!==null&&(Pr(e,n,i,r),Oc(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=mn(),i=na(n),a=yi(r,i);a.tag=1,a.payload=e,t!=null&&(a.callback=t),e=ea(n,a,i),e!==null&&(Pr(e,n,i,r),Oc(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=mn(),r=na(n),i=yi(t,r);i.tag=2,e!=null&&(i.callback=e),e=ea(n,i,r),e!==null&&(Pr(e,n,r,t),Oc(e,n,r))}};function Rv(n,e,t,r,i,a,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,a,s):e.prototype&&e.prototype.isPureReactComponent?!Ol(t,r)||!Ol(i,a):!0}function T0(n,e,t){var r=!1,i=aa,a=e.contextType;return typeof a=="object"&&a!==null?a=sr(a):(i=Cn(e)?za:dn.current,r=e.contextTypes,a=(r=r!=null)?Ks(n,i):aa),e=new e(t,a),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jd,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=a),e}function xv(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&jd.enqueueReplaceState(e,e.state,null)}function mp(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=w0,Mm(n);var a=e.contextType;typeof a=="object"&&a!==null?i.context=sr(a):(a=Cn(e)?za:dn.current,i.context=Ks(n,a)),i.state=n.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(pp(n,e,a,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&jd.enqueueReplaceState(i,i.state,null),od(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Go(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ue(309));var r=t.stateNode}if(!r)throw Error(ue(147,n));var i=r,a=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;o===w0&&(o=i.refs={}),s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof n!="string")throw Error(ue(284));if(!t._owner)throw Error(ue(290,n))}return n}function cc(n,e){throw n=Object.prototype.toString.call(e),Error(ue(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function _v(n){var e=n._init;return e(n._payload)}function b0(n){function e(b,T){if(n){var C=b.deletions;C===null?(b.deletions=[T],b.flags|=16):C.push(T)}}function t(b,T){if(!n)return null;for(;T!==null;)e(b,T),T=T.sibling;return null}function r(b,T){for(b=new Map;T!==null;)T.key!==null?b.set(T.key,T):b.set(T.index,T),T=T.sibling;return b}function i(b,T){return b=ra(b,T),b.index=0,b.sibling=null,b}function a(b,T,C){return b.index=C,n?(C=b.alternate,C!==null?(C=C.index,C<T?(b.flags|=2,T):C):(b.flags|=2,T)):(b.flags|=1048576,T)}function s(b){return n&&b.alternate===null&&(b.flags|=2),b}function o(b,T,C,P){return T===null||T.tag!==6?(T=df(C,b.mode,P),T.return=b,T):(T=i(T,C),T.return=b,T)}function l(b,T,C,P){var D=C.type;return D===xs?c(b,T,C.props.children,P,C.key):T!==null&&(T.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Qi&&_v(D)===T.type)?(P=i(T,C.props),P.ref=Go(b,T,C),P.return=b,P):(P=Bc(C.type,C.key,C.props,null,b.mode,P),P.ref=Go(b,T,C),P.return=b,P)}function u(b,T,C,P){return T===null||T.tag!==4||T.stateNode.containerInfo!==C.containerInfo||T.stateNode.implementation!==C.implementation?(T=hf(C,b.mode,P),T.return=b,T):(T=i(T,C.children||[]),T.return=b,T)}function c(b,T,C,P,D){return T===null||T.tag!==7?(T=ja(C,b.mode,P,D),T.return=b,T):(T=i(T,C),T.return=b,T)}function d(b,T,C){if(typeof T=="string"&&T!==""||typeof T=="number")return T=df(""+T,b.mode,C),T.return=b,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Zu:return C=Bc(T.type,T.key,T.props,null,b.mode,C),C.ref=Go(b,null,T),C.return=b,C;case Rs:return T=hf(T,b.mode,C),T.return=b,T;case Qi:var P=T._init;return d(b,P(T._payload),C)}if(sl(T)||Qo(T))return T=ja(T,b.mode,C,null),T.return=b,T;cc(b,T)}return null}function h(b,T,C,P){var D=T!==null?T.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return D!==null?null:o(b,T,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Zu:return C.key===D?l(b,T,C,P):null;case Rs:return C.key===D?u(b,T,C,P):null;case Qi:return D=C._init,h(b,T,D(C._payload),P)}if(sl(C)||Qo(C))return D!==null?null:c(b,T,C,P,null);cc(b,C)}return null}function p(b,T,C,P,D){if(typeof P=="string"&&P!==""||typeof P=="number")return b=b.get(C)||null,o(T,b,""+P,D);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Zu:return b=b.get(P.key===null?C:P.key)||null,l(T,b,P,D);case Rs:return b=b.get(P.key===null?C:P.key)||null,u(T,b,P,D);case Qi:var F=P._init;return p(b,T,C,F(P._payload),D)}if(sl(P)||Qo(P))return b=b.get(C)||null,c(T,b,P,D,null);cc(T,P)}return null}function g(b,T,C,P){for(var D=null,F=null,Q=T,W=T=0,B=null;Q!==null&&W<C.length;W++){Q.index>W?(B=Q,Q=null):B=Q.sibling;var K=h(b,Q,C[W],P);if(K===null){Q===null&&(Q=B);break}n&&Q&&K.alternate===null&&e(b,Q),T=a(K,T,W),F===null?D=K:F.sibling=K,F=K,Q=B}if(W===C.length)return t(b,Q),gt&&Ia(b,W),D;if(Q===null){for(;W<C.length;W++)Q=d(b,C[W],P),Q!==null&&(T=a(Q,T,W),F===null?D=Q:F.sibling=Q,F=Q);return gt&&Ia(b,W),D}for(Q=r(b,Q);W<C.length;W++)B=p(Q,b,W,C[W],P),B!==null&&(n&&B.alternate!==null&&Q.delete(B.key===null?W:B.key),T=a(B,T,W),F===null?D=B:F.sibling=B,F=B);return n&&Q.forEach(function(M){return e(b,M)}),gt&&Ia(b,W),D}function E(b,T,C,P){var D=Qo(C);if(typeof D!="function")throw Error(ue(150));if(C=D.call(C),C==null)throw Error(ue(151));for(var F=D=null,Q=T,W=T=0,B=null,K=C.next();Q!==null&&!K.done;W++,K=C.next()){Q.index>W?(B=Q,Q=null):B=Q.sibling;var M=h(b,Q,K.value,P);if(M===null){Q===null&&(Q=B);break}n&&Q&&M.alternate===null&&e(b,Q),T=a(M,T,W),F===null?D=M:F.sibling=M,F=M,Q=B}if(K.done)return t(b,Q),gt&&Ia(b,W),D;if(Q===null){for(;!K.done;W++,K=C.next())K=d(b,K.value,P),K!==null&&(T=a(K,T,W),F===null?D=K:F.sibling=K,F=K);return gt&&Ia(b,W),D}for(Q=r(b,Q);!K.done;W++,K=C.next())K=p(Q,b,W,K.value,P),K!==null&&(n&&K.alternate!==null&&Q.delete(K.key===null?W:K.key),T=a(K,T,W),F===null?D=K:F.sibling=K,F=K);return n&&Q.forEach(function(Z){return e(b,Z)}),gt&&Ia(b,W),D}function A(b,T,C,P){if(typeof C=="object"&&C!==null&&C.type===xs&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Zu:e:{for(var D=C.key,F=T;F!==null;){if(F.key===D){if(D=C.type,D===xs){if(F.tag===7){t(b,F.sibling),T=i(F,C.props.children),T.return=b,b=T;break e}}else if(F.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Qi&&_v(D)===F.type){t(b,F.sibling),T=i(F,C.props),T.ref=Go(b,F,C),T.return=b,b=T;break e}t(b,F);break}else e(b,F);F=F.sibling}C.type===xs?(T=ja(C.props.children,b.mode,P,C.key),T.return=b,b=T):(P=Bc(C.type,C.key,C.props,null,b.mode,P),P.ref=Go(b,T,C),P.return=b,b=P)}return s(b);case Rs:e:{for(F=C.key;T!==null;){if(T.key===F)if(T.tag===4&&T.stateNode.containerInfo===C.containerInfo&&T.stateNode.implementation===C.implementation){t(b,T.sibling),T=i(T,C.children||[]),T.return=b,b=T;break e}else{t(b,T);break}else e(b,T);T=T.sibling}T=hf(C,b.mode,P),T.return=b,b=T}return s(b);case Qi:return F=C._init,A(b,T,F(C._payload),P)}if(sl(C))return g(b,T,C,P);if(Qo(C))return E(b,T,C,P);cc(b,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,T!==null&&T.tag===6?(t(b,T.sibling),T=i(T,C),T.return=b,b=T):(t(b,T),T=df(C,b.mode,P),T.return=b,b=T),s(b)):t(b,T)}return A}var Ys=b0(!0),N0=b0(!1),vu={},Hr=Ea(vu),Ll=Ea(vu),ql=Ea(vu);function Fa(n){if(n===vu)throw Error(ue(174));return n}function Om(n,e){switch(lt(ql,e),lt(Ll,n),lt(Hr,vu),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hf(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Hf(e,n)}pt(Hr),lt(Hr,e)}function Xs(){pt(Hr),pt(Ll),pt(ql)}function C0(n){Fa(ql.current);var e=Fa(Hr.current),t=Hf(e,n.type);e!==t&&(lt(Ll,n),lt(Hr,t))}function Im(n){Ll.current===n&&(pt(Hr),pt(Ll))}var Tt=Ea(0);function ld(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var af=[];function Dm(){for(var n=0;n<af.length;n++)af[n]._workInProgressVersionPrimary=null;af.length=0}var Ic=Di.ReactCurrentDispatcher,sf=Di.ReactCurrentBatchConfig,Ha=0,bt=null,qt=null,zt=null,ud=!1,yl=!1,Bl=0,bR=0;function an(){throw Error(ue(321))}function $m(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Dr(n[t],e[t]))return!1;return!0}function Lm(n,e,t,r,i,a){if(Ha=a,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ic.current=n===null||n.memoizedState===null?AR:RR,n=t(r,i),yl){a=0;do{if(yl=!1,Bl=0,25<=a)throw Error(ue(301));a+=1,zt=qt=null,e.updateQueue=null,Ic.current=xR,n=t(r,i)}while(yl)}if(Ic.current=cd,e=qt!==null&&qt.next!==null,Ha=0,zt=qt=bt=null,ud=!1,e)throw Error(ue(300));return n}function qm(){var n=Bl!==0;return Bl=0,n}function kr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?bt.memoizedState=zt=n:zt=zt.next=n,zt}function or(){if(qt===null){var n=bt.alternate;n=n!==null?n.memoizedState:null}else n=qt.next;var e=zt===null?bt.memoizedState:zt.next;if(e!==null)zt=e,qt=n;else{if(n===null)throw Error(ue(310));qt=n,n={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},zt===null?bt.memoizedState=zt=n:zt=zt.next=n}return zt}function Fl(n,e){return typeof e=="function"?e(n):e}function of(n){var e=or(),t=e.queue;if(t===null)throw Error(ue(311));t.lastRenderedReducer=n;var r=qt,i=r.baseQueue,a=t.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,t.pending=null}if(i!==null){a=i.next,r=r.baseState;var o=s=null,l=null,u=a;do{var c=u.lane;if((Ha&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,s=r):l=l.next=d,bt.lanes|=c,Ga|=c}u=u.next}while(u!==null&&u!==a);l===null?s=r:l.next=o,Dr(r,e.memoizedState)||(bn=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do a=i.lane,bt.lanes|=a,Ga|=a,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function lf(n){var e=or(),t=e.queue;if(t===null)throw Error(ue(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,a=e.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do a=n(a,s.action),s=s.next;while(s!==i);Dr(a,e.memoizedState)||(bn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),t.lastRenderedState=a}return[a,r]}function S0(){}function A0(n,e){var t=bt,r=or(),i=e(),a=!Dr(r.memoizedState,i);if(a&&(r.memoizedState=i,bn=!0),r=r.queue,Bm(_0.bind(null,t,r,n),[n]),r.getSnapshot!==e||a||zt!==null&&zt.memoizedState.tag&1){if(t.flags|=2048,kl(9,x0.bind(null,t,r,i,e),void 0,null),Ht===null)throw Error(ue(349));Ha&30||R0(t,e,i)}return i}function R0(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function x0(n,e,t,r){e.value=t,e.getSnapshot=r,P0(e)&&M0(n)}function _0(n,e,t){return t(function(){P0(e)&&M0(n)})}function P0(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Dr(n,t)}catch{return!0}}function M0(n){var e=bi(n,1);e!==null&&Pr(e,n,1,-1)}function Pv(n){var e=kr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fl,lastRenderedState:n},e.queue=n,n=n.dispatch=SR.bind(null,bt,n),[e.memoizedState,n]}function kl(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function O0(){return or().memoizedState}function Dc(n,e,t,r){var i=kr();bt.flags|=n,i.memoizedState=kl(1|e,t,void 0,r===void 0?null:r)}function Qd(n,e,t,r){var i=or();r=r===void 0?null:r;var a=void 0;if(qt!==null){var s=qt.memoizedState;if(a=s.destroy,r!==null&&$m(r,s.deps)){i.memoizedState=kl(e,t,a,r);return}}bt.flags|=n,i.memoizedState=kl(1|e,t,a,r)}function Mv(n,e){return Dc(8390656,8,n,e)}function Bm(n,e){return Qd(2048,8,n,e)}function I0(n,e){return Qd(4,2,n,e)}function D0(n,e){return Qd(4,4,n,e)}function $0(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function L0(n,e,t){return t=t!=null?t.concat([n]):null,Qd(4,4,$0.bind(null,e,n),t)}function Fm(){}function q0(n,e){var t=or();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&$m(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function B0(n,e){var t=or();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&$m(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function F0(n,e,t){return Ha&21?(Dr(t,e)||(t=jT(),bt.lanes|=t,Ga|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,bn=!0),n.memoizedState=t)}function NR(n,e){var t=nt;nt=t!==0&&4>t?t:4,n(!0);var r=sf.transition;sf.transition={};try{n(!1),e()}finally{nt=t,sf.transition=r}}function k0(){return or().memoizedState}function CR(n,e,t){var r=na(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},U0(n))j0(e,t);else if(t=v0(n,e,t,r),t!==null){var i=mn();Pr(t,n,r,i),Q0(t,e,r)}}function SR(n,e,t){var r=na(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(U0(n))j0(e,i);else{var a=n.alternate;if(n.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,t);if(i.hasEagerState=!0,i.eagerState=o,Dr(o,s)){var l=e.interleaved;l===null?(i.next=i,Pm(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=v0(n,e,i,r),t!==null&&(i=mn(),Pr(t,n,r,i),Q0(t,e,r))}}function U0(n){var e=n.alternate;return n===bt||e!==null&&e===bt}function j0(n,e){yl=ud=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Q0(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,ym(n,t)}}var cd={readContext:sr,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},AR={readContext:sr,useCallback:function(n,e){return kr().memoizedState=[n,e===void 0?null:e],n},useContext:sr,useEffect:Mv,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Dc(4194308,4,$0.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Dc(4194308,4,n,e)},useInsertionEffect:function(n,e){return Dc(4,2,n,e)},useMemo:function(n,e){var t=kr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=kr();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=CR.bind(null,bt,n),[r.memoizedState,n]},useRef:function(n){var e=kr();return n={current:n},e.memoizedState=n},useState:Pv,useDebugValue:Fm,useDeferredValue:function(n){return kr().memoizedState=n},useTransition:function(){var n=Pv(!1),e=n[0];return n=NR.bind(null,n[1]),kr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=bt,i=kr();if(gt){if(t===void 0)throw Error(ue(407));t=t()}else{if(t=e(),Ht===null)throw Error(ue(349));Ha&30||R0(r,e,t)}i.memoizedState=t;var a={value:t,getSnapshot:e};return i.queue=a,Mv(_0.bind(null,r,a,n),[n]),r.flags|=2048,kl(9,x0.bind(null,r,a,t,e),void 0,null),t},useId:function(){var n=kr(),e=Ht.identifierPrefix;if(gt){var t=hi,r=di;t=(r&~(1<<32-_r(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Bl++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=bR++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},RR={readContext:sr,useCallback:q0,useContext:sr,useEffect:Bm,useImperativeHandle:L0,useInsertionEffect:I0,useLayoutEffect:D0,useMemo:B0,useReducer:of,useRef:O0,useState:function(){return of(Fl)},useDebugValue:Fm,useDeferredValue:function(n){var e=or();return F0(e,qt.memoizedState,n)},useTransition:function(){var n=of(Fl)[0],e=or().memoizedState;return[n,e]},useMutableSource:S0,useSyncExternalStore:A0,useId:k0,unstable_isNewReconciler:!1},xR={readContext:sr,useCallback:q0,useContext:sr,useEffect:Bm,useImperativeHandle:L0,useInsertionEffect:I0,useLayoutEffect:D0,useMemo:B0,useReducer:lf,useRef:O0,useState:function(){return lf(Fl)},useDebugValue:Fm,useDeferredValue:function(n){var e=or();return qt===null?e.memoizedState=n:F0(e,qt.memoizedState,n)},useTransition:function(){var n=lf(Fl)[0],e=or().memoizedState;return[n,e]},useMutableSource:S0,useSyncExternalStore:A0,useId:k0,unstable_isNewReconciler:!1};function Zs(n,e){try{var t="",r=e;do t+=nA(r),r=r.return;while(r);var i=t}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:n,source:e,stack:i,digest:null}}function uf(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function yp(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var _R=typeof WeakMap=="function"?WeakMap:Map;function V0(n,e,t){t=yi(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){hd||(hd=!0,Ap=r),yp(n,e)},t}function z0(n,e,t){t=yi(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){yp(n,e)}}var a=n.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){yp(n,e),typeof r!="function"&&(ta===null?ta=new Set([this]):ta.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function Ov(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new _R;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=QR.bind(null,n,e,t),e.then(n,n))}function Iv(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Dv(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=yi(-1,1),e.tag=2,ea(t,e,1))),t.lanes|=1),n)}var PR=Di.ReactCurrentOwner,bn=!1;function fn(n,e,t,r){e.child=n===null?N0(e,null,t,r):Ys(e,n.child,t,r)}function $v(n,e,t,r,i){t=t.render;var a=e.ref;return Vs(e,i),r=Lm(n,e,t,r,a,i),t=qm(),n!==null&&!bn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ni(n,e,i)):(gt&&t&&Cm(e),e.flags|=1,fn(n,e,r,i),e.child)}function Lv(n,e,t,r,i){if(n===null){var a=t.type;return typeof a=="function"&&!Hm(a)&&a.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=a,W0(n,e,a,r,i)):(n=Bc(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(a=n.child,!(n.lanes&i)){var s=a.memoizedProps;if(t=t.compare,t=t!==null?t:Ol,t(s,r)&&n.ref===e.ref)return Ni(n,e,i)}return e.flags|=1,n=ra(a,r),n.ref=e.ref,n.return=e,e.child=n}function W0(n,e,t,r,i){if(n!==null){var a=n.memoizedProps;if(Ol(a,r)&&n.ref===e.ref)if(bn=!1,e.pendingProps=r=a,(n.lanes&i)!==0)n.flags&131072&&(bn=!0);else return e.lanes=n.lanes,Ni(n,e,i)}return gp(n,e,t,r,i)}function H0(n,e,t){var r=e.pendingProps,i=r.children,a=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(Bs,On),On|=t;else{if(!(t&1073741824))return n=a!==null?a.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,lt(Bs,On),On|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:t,lt(Bs,On),On|=r}else a!==null?(r=a.baseLanes|t,e.memoizedState=null):r=t,lt(Bs,On),On|=r;return fn(n,e,i,t),e.child}function G0(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function gp(n,e,t,r,i){var a=Cn(t)?za:dn.current;return a=Ks(e,a),Vs(e,i),t=Lm(n,e,t,r,a,i),r=qm(),n!==null&&!bn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ni(n,e,i)):(gt&&r&&Cm(e),e.flags|=1,fn(n,e,t,i),e.child)}function qv(n,e,t,r,i){if(Cn(t)){var a=!0;nd(e)}else a=!1;if(Vs(e,i),e.stateNode===null)$c(n,e),T0(e,t,r),mp(e,t,r,i),r=!0;else if(n===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,u=t.contextType;typeof u=="object"&&u!==null?u=sr(u):(u=Cn(t)?za:dn.current,u=Ks(e,u));var c=t.getDerivedStateFromProps,d=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==r||l!==u)&&xv(e,s,r,u),Vi=!1;var h=e.memoizedState;s.state=h,od(e,r,s,i),l=e.memoizedState,o!==r||h!==l||Nn.current||Vi?(typeof c=="function"&&(pp(e,t,c,r),l=e.memoizedState),(o=Vi||Rv(e,t,o,r,h,l,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,E0(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:br(e.type,o),s.props=u,d=e.pendingProps,h=s.context,l=t.contextType,typeof l=="object"&&l!==null?l=sr(l):(l=Cn(t)?za:dn.current,l=Ks(e,l));var p=t.getDerivedStateFromProps;(c=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||h!==l)&&xv(e,s,r,l),Vi=!1,h=e.memoizedState,s.state=h,od(e,r,s,i);var g=e.memoizedState;o!==d||h!==g||Nn.current||Vi?(typeof p=="function"&&(pp(e,t,p,r),g=e.memoizedState),(u=Vi||Rv(e,t,u,r,h,g,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,g,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),s.props=r,s.state=g,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),r=!1)}return vp(n,e,t,r,a,i)}function vp(n,e,t,r,i,a){G0(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&bv(e,t,!1),Ni(n,e,a);r=e.stateNode,PR.current=e;var o=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=Ys(e,n.child,null,a),e.child=Ys(e,null,o,a)):fn(n,e,o,a),e.memoizedState=r.state,i&&bv(e,t,!0),e.child}function K0(n){var e=n.stateNode;e.pendingContext?Tv(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Tv(n,e.context,!1),Om(n,e.containerInfo)}function Bv(n,e,t,r,i){return Js(),Am(i),e.flags|=256,fn(n,e,t,r),e.child}var Ep={dehydrated:null,treeContext:null,retryLane:0};function wp(n){return{baseLanes:n,cachePool:null,transitions:null}}function J0(n,e,t){var r=e.pendingProps,i=Tt.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),lt(Tt,i&1),n===null)return hp(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,a?(r=e.mode,a=e.child,s={mode:"hidden",children:s},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=Wd(s,r,0,null),n=ja(n,r,t,null),a.return=e,n.return=e,a.sibling=n,e.child=a,e.child.memoizedState=wp(t),e.memoizedState=Ep,n):km(e,s));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return MR(n,e,s,r,o,i,t);if(a){a=r.fallback,s=e.mode,i=n.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ra(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=ra(o,a):(a=ja(a,s,t,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,s=n.child.memoizedState,s=s===null?wp(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=n.childLanes&~t,e.memoizedState=Ep,r}return a=n.child,n=a.sibling,r=ra(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function km(n,e){return e=Wd({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function dc(n,e,t,r){return r!==null&&Am(r),Ys(e,n.child,null,t),n=km(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function MR(n,e,t,r,i,a,s){if(t)return e.flags&256?(e.flags&=-257,r=uf(Error(ue(422))),dc(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=Wd({mode:"visible",children:r.children},i,0,null),a=ja(a,i,s,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&Ys(e,n.child,null,s),e.child.memoizedState=wp(s),e.memoizedState=Ep,a);if(!(e.mode&1))return dc(n,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(ue(419)),r=uf(a,r,void 0),dc(n,e,s,r)}if(o=(s&n.childLanes)!==0,bn||o){if(r=Ht,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,bi(n,i),Pr(r,n,i,-1))}return Wm(),r=uf(Error(ue(421))),dc(n,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=VR.bind(null,n),i._reactRetry=e,null):(n=a.treeContext,Dn=Zi(i.nextSibling),Ln=e,gt=!0,Ar=null,n!==null&&(Yn[Xn++]=di,Yn[Xn++]=hi,Yn[Xn++]=Wa,di=n.id,hi=n.overflow,Wa=e),e=km(e,r.children),e.flags|=4096,e)}function Fv(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),fp(n.return,e,t)}function cf(n,e,t,r,i){var a=n.memoizedState;a===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=t,a.tailMode=i)}function Y0(n,e,t){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(fn(n,e,r.children,t),r=Tt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Fv(n,t,e);else if(n.tag===19)Fv(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(lt(Tt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&ld(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),cf(e,!1,i,t,a);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&ld(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}cf(e,!0,t,null,a);break;case"together":cf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $c(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ni(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ga|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ue(153));if(e.child!==null){for(n=e.child,t=ra(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ra(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function OR(n,e,t){switch(e.tag){case 3:K0(e),Js();break;case 5:C0(e);break;case 1:Cn(e.type)&&nd(e);break;case 4:Om(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;lt(ad,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(lt(Tt,Tt.current&1),e.flags|=128,null):t&e.child.childLanes?J0(n,e,t):(lt(Tt,Tt.current&1),n=Ni(n,e,t),n!==null?n.sibling:null);lt(Tt,Tt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Y0(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),lt(Tt,Tt.current),r)break;return null;case 22:case 23:return e.lanes=0,H0(n,e,t)}return Ni(n,e,t)}var X0,Tp,Z0,eb;X0=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Tp=function(){};Z0=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Fa(Hr.current);var a=null;switch(t){case"input":i=Qf(n,i),r=Qf(n,r),a=[];break;case"select":i=Nt({},i,{value:void 0}),r=Nt({},r,{value:void 0}),a=[];break;case"textarea":i=Wf(n,i),r=Wf(n,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=ed)}Gf(t,r);var s;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(s in o)o.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Sl.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(a||(a=[]),a.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Sl.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&dt("scroll",n),a||o===l||(a=[])):(a=a||[]).push(u,l))}t&&(a=a||[]).push("style",t);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};eb=function(n,e,t,r){t!==r&&(e.flags|=4)};function Ko(n,e){if(!gt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function sn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function IR(n,e,t){var r=e.pendingProps;switch(Sm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(e),null;case 1:return Cn(e.type)&&td(),sn(e),null;case 3:return r=e.stateNode,Xs(),pt(Nn),pt(dn),Dm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(uc(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ar!==null&&(_p(Ar),Ar=null))),Tp(n,e),sn(e),null;case 5:Im(e);var i=Fa(ql.current);if(t=e.type,n!==null&&e.stateNode!=null)Z0(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ue(166));return sn(e),null}if(n=Fa(Hr.current),uc(e)){r=e.stateNode,t=e.type;var a=e.memoizedProps;switch(r[Ur]=e,r[$l]=a,n=(e.mode&1)!==0,t){case"dialog":dt("cancel",r),dt("close",r);break;case"iframe":case"object":case"embed":dt("load",r);break;case"video":case"audio":for(i=0;i<ll.length;i++)dt(ll[i],r);break;case"source":dt("error",r);break;case"img":case"image":case"link":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"input":Gg(r,a),dt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},dt("invalid",r);break;case"textarea":Jg(r,a),dt("invalid",r)}Gf(t,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&lc(r.textContent,o,n),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&lc(r.textContent,o,n),i=["children",""+o]):Sl.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&dt("scroll",r)}switch(t){case"input":ec(r),Kg(r,a,!0);break;case"textarea":ec(r),Yg(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=ed)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=RT(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[Ur]=e,n[$l]=r,X0(n,e,!1,!1),e.stateNode=n;e:{switch(s=Kf(t,r),t){case"dialog":dt("cancel",n),dt("close",n),i=r;break;case"iframe":case"object":case"embed":dt("load",n),i=r;break;case"video":case"audio":for(i=0;i<ll.length;i++)dt(ll[i],n);i=r;break;case"source":dt("error",n),i=r;break;case"img":case"image":case"link":dt("error",n),dt("load",n),i=r;break;case"details":dt("toggle",n),i=r;break;case"input":Gg(n,r),i=Qf(n,r),dt("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Nt({},r,{value:void 0}),dt("invalid",n);break;case"textarea":Jg(n,r),i=Wf(n,r),dt("invalid",n);break;default:i=r}Gf(t,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?PT(n,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xT(n,l)):a==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Al(n,l):typeof l=="number"&&Al(n,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Sl.hasOwnProperty(a)?l!=null&&a==="onScroll"&&dt("scroll",n):l!=null&&cm(n,a,l,s))}switch(t){case"input":ec(n),Kg(n,r,!1);break;case"textarea":ec(n),Yg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+ia(r.value));break;case"select":n.multiple=!!r.multiple,a=r.value,a!=null?ks(n,!!r.multiple,a,!1):r.defaultValue!=null&&ks(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=ed)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return sn(e),null;case 6:if(n&&e.stateNode!=null)eb(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ue(166));if(t=Fa(ql.current),Fa(Hr.current),uc(e)){if(r=e.stateNode,t=e.memoizedProps,r[Ur]=e,(a=r.nodeValue!==t)&&(n=Ln,n!==null))switch(n.tag){case 3:lc(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&lc(r.nodeValue,t,(n.mode&1)!==0)}a&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return sn(e),null;case 13:if(pt(Tt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(gt&&Dn!==null&&e.mode&1&&!(e.flags&128))g0(),Js(),e.flags|=98560,a=!1;else if(a=uc(e),r!==null&&r.dehydrated!==null){if(n===null){if(!a)throw Error(ue(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ue(317));a[Ur]=e}else Js(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;sn(e),a=!1}else Ar!==null&&(_p(Ar),Ar=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Tt.current&1?Bt===0&&(Bt=3):Wm())),e.updateQueue!==null&&(e.flags|=4),sn(e),null);case 4:return Xs(),Tp(n,e),n===null&&Il(e.stateNode.containerInfo),sn(e),null;case 10:return _m(e.type._context),sn(e),null;case 17:return Cn(e.type)&&td(),sn(e),null;case 19:if(pt(Tt),a=e.memoizedState,a===null)return sn(e),null;if(r=(e.flags&128)!==0,s=a.rendering,s===null)if(r)Ko(a,!1);else{if(Bt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=ld(n),s!==null){for(e.flags|=128,Ko(a,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)a=t,n=r,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=n,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,n=s.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return lt(Tt,Tt.current&1|2),e.child}n=n.sibling}a.tail!==null&&_t()>eo&&(e.flags|=128,r=!0,Ko(a,!1),e.lanes=4194304)}else{if(!r)if(n=ld(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ko(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!gt)return sn(e),null}else 2*_t()-a.renderingStartTime>eo&&t!==1073741824&&(e.flags|=128,r=!0,Ko(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(t=a.last,t!==null?t.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=_t(),e.sibling=null,t=Tt.current,lt(Tt,r?t&1|2:t&1),e):(sn(e),null);case 22:case 23:return zm(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?On&1073741824&&(sn(e),e.subtreeFlags&6&&(e.flags|=8192)):sn(e),null;case 24:return null;case 25:return null}throw Error(ue(156,e.tag))}function DR(n,e){switch(Sm(e),e.tag){case 1:return Cn(e.type)&&td(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Xs(),pt(Nn),pt(dn),Dm(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Im(e),null;case 13:if(pt(Tt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ue(340));Js()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return pt(Tt),null;case 4:return Xs(),null;case 10:return _m(e.type._context),null;case 22:case 23:return zm(),null;case 24:return null;default:return null}}var hc=!1,on=!1,$R=typeof WeakSet=="function"?WeakSet:Set,Se=null;function qs(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){St(n,e,r)}else t.current=null}function bp(n,e,t){try{t()}catch(r){St(n,e,r)}}var kv=!1;function LR(n,e){if(ap=Yc,n=i0(),Nm(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{t.nodeType,a.nodeType}catch{t=null;break e}var s=0,o=-1,l=-1,u=0,c=0,d=n,h=null;t:for(;;){for(var p;d!==t||i!==0&&d.nodeType!==3||(o=s+i),d!==a||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===n)break t;if(h===t&&++u===i&&(o=s),h===a&&++c===r&&(l=s),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(sp={focusedElem:n,selectionRange:t},Yc=!1,Se=e;Se!==null;)if(e=Se,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Se=n;else for(;Se!==null;){e=Se;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var E=g.memoizedProps,A=g.memoizedState,b=e.stateNode,T=b.getSnapshotBeforeUpdate(e.elementType===e.type?E:br(e.type,E),A);b.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(P){St(e,e.return,P)}if(n=e.sibling,n!==null){n.return=e.return,Se=n;break}Se=e.return}return g=kv,kv=!1,g}function gl(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var a=i.destroy;i.destroy=void 0,a!==void 0&&bp(e,t,a)}i=i.next}while(i!==r)}}function Vd(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Np(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function tb(n){var e=n.alternate;e!==null&&(n.alternate=null,tb(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ur],delete e[$l],delete e[up],delete e[vR],delete e[ER])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function nb(n){return n.tag===5||n.tag===3||n.tag===4}function Uv(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||nb(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Cp(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=ed));else if(r!==4&&(n=n.child,n!==null))for(Cp(n,e,t),n=n.sibling;n!==null;)Cp(n,e,t),n=n.sibling}function Sp(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Sp(n,e,t),n=n.sibling;n!==null;)Sp(n,e,t),n=n.sibling}var Xt=null,Nr=!1;function Ui(n,e,t){for(t=t.child;t!==null;)rb(n,e,t),t=t.sibling}function rb(n,e,t){if(Wr&&typeof Wr.onCommitFiberUnmount=="function")try{Wr.onCommitFiberUnmount(Ld,t)}catch{}switch(t.tag){case 5:on||qs(t,e);case 6:var r=Xt,i=Nr;Xt=null,Ui(n,e,t),Xt=r,Nr=i,Xt!==null&&(Nr?(n=Xt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Xt.removeChild(t.stateNode));break;case 18:Xt!==null&&(Nr?(n=Xt,t=t.stateNode,n.nodeType===8?nf(n.parentNode,t):n.nodeType===1&&nf(n,t),Pl(n)):nf(Xt,t.stateNode));break;case 4:r=Xt,i=Nr,Xt=t.stateNode.containerInfo,Nr=!0,Ui(n,e,t),Xt=r,Nr=i;break;case 0:case 11:case 14:case 15:if(!on&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&bp(t,e,s),i=i.next}while(i!==r)}Ui(n,e,t);break;case 1:if(!on&&(qs(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){St(t,e,o)}Ui(n,e,t);break;case 21:Ui(n,e,t);break;case 22:t.mode&1?(on=(r=on)||t.memoizedState!==null,Ui(n,e,t),on=r):Ui(n,e,t);break;default:Ui(n,e,t)}}function jv(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new $R),e.forEach(function(r){var i=zR.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function wr(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var a=n,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:Xt=o.stateNode,Nr=!1;break e;case 3:Xt=o.stateNode.containerInfo,Nr=!0;break e;case 4:Xt=o.stateNode.containerInfo,Nr=!0;break e}o=o.return}if(Xt===null)throw Error(ue(160));rb(a,s,i),Xt=null,Nr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){St(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ib(e,n),e=e.sibling}function ib(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(wr(e,n),Fr(n),r&4){try{gl(3,n,n.return),Vd(3,n)}catch(E){St(n,n.return,E)}try{gl(5,n,n.return)}catch(E){St(n,n.return,E)}}break;case 1:wr(e,n),Fr(n),r&512&&t!==null&&qs(t,t.return);break;case 5:if(wr(e,n),Fr(n),r&512&&t!==null&&qs(t,t.return),n.flags&32){var i=n.stateNode;try{Al(i,"")}catch(E){St(n,n.return,E)}}if(r&4&&(i=n.stateNode,i!=null)){var a=n.memoizedProps,s=t!==null?t.memoizedProps:a,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&ST(i,a),Kf(o,s);var u=Kf(o,a);for(s=0;s<l.length;s+=2){var c=l[s],d=l[s+1];c==="style"?PT(i,d):c==="dangerouslySetInnerHTML"?xT(i,d):c==="children"?Al(i,d):cm(i,c,d,u)}switch(o){case"input":Vf(i,a);break;case"textarea":AT(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?ks(i,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?ks(i,!!a.multiple,a.defaultValue,!0):ks(i,!!a.multiple,a.multiple?[]:"",!1))}i[$l]=a}catch(E){St(n,n.return,E)}}break;case 6:if(wr(e,n),Fr(n),r&4){if(n.stateNode===null)throw Error(ue(162));i=n.stateNode,a=n.memoizedProps;try{i.nodeValue=a}catch(E){St(n,n.return,E)}}break;case 3:if(wr(e,n),Fr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Pl(e.containerInfo)}catch(E){St(n,n.return,E)}break;case 4:wr(e,n),Fr(n);break;case 13:wr(e,n),Fr(n),i=n.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Qm=_t())),r&4&&jv(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(on=(u=on)||c,wr(e,n),on=u):wr(e,n),Fr(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(Se=n,c=n.child;c!==null;){for(d=Se=c;Se!==null;){switch(h=Se,p=h.child,h.tag){case 0:case 11:case 14:case 15:gl(4,h,h.return);break;case 1:qs(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){r=h,t=h.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(E){St(r,t,E)}}break;case 5:qs(h,h.return);break;case 22:if(h.memoizedState!==null){Vv(d);continue}}p!==null?(p.return=h,Se=p):Vv(d)}c=c.sibling}e:for(c=null,d=n;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=_T("display",s))}catch(E){St(n,n.return,E)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(E){St(n,n.return,E)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:wr(e,n),Fr(n),r&4&&jv(n);break;case 21:break;default:wr(e,n),Fr(n)}}function Fr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(nb(t)){var r=t;break e}t=t.return}throw Error(ue(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Al(i,""),r.flags&=-33);var a=Uv(n);Sp(n,a,i);break;case 3:case 4:var s=r.stateNode.containerInfo,o=Uv(n);Cp(n,o,s);break;default:throw Error(ue(161))}}catch(l){St(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function qR(n,e,t){Se=n,ab(n)}function ab(n,e,t){for(var r=(n.mode&1)!==0;Se!==null;){var i=Se,a=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||hc;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||on;o=hc;var u=on;if(hc=s,(on=l)&&!u)for(Se=i;Se!==null;)s=Se,l=s.child,s.tag===22&&s.memoizedState!==null?zv(i):l!==null?(l.return=s,Se=l):zv(i);for(;a!==null;)Se=a,ab(a),a=a.sibling;Se=i,hc=o,on=u}Qv(n)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Se=a):Qv(n)}}function Qv(n){for(;Se!==null;){var e=Se;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:on||Vd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!on)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:br(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Av(e,a,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Av(e,s,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Pl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}on||e.flags&512&&Np(e)}catch(h){St(e,e.return,h)}}if(e===n){Se=null;break}if(t=e.sibling,t!==null){t.return=e.return,Se=t;break}Se=e.return}}function Vv(n){for(;Se!==null;){var e=Se;if(e===n){Se=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Se=t;break}Se=e.return}}function zv(n){for(;Se!==null;){var e=Se;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Vd(4,e)}catch(l){St(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){St(e,i,l)}}var a=e.return;try{Np(e)}catch(l){St(e,a,l)}break;case 5:var s=e.return;try{Np(e)}catch(l){St(e,s,l)}}}catch(l){St(e,e.return,l)}if(e===n){Se=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Se=o;break}Se=e.return}}var BR=Math.ceil,dd=Di.ReactCurrentDispatcher,Um=Di.ReactCurrentOwner,rr=Di.ReactCurrentBatchConfig,Xe=0,Ht=null,It=null,en=0,On=0,Bs=Ea(0),Bt=0,Ul=null,Ga=0,zd=0,jm=0,vl=null,wn=null,Qm=0,eo=1/0,li=null,hd=!1,Ap=null,ta=null,fc=!1,Gi=null,fd=0,El=0,Rp=null,Lc=-1,qc=0;function mn(){return Xe&6?_t():Lc!==-1?Lc:Lc=_t()}function na(n){return n.mode&1?Xe&2&&en!==0?en&-en:TR.transition!==null?(qc===0&&(qc=jT()),qc):(n=nt,n!==0||(n=window.event,n=n===void 0?16:KT(n.type)),n):1}function Pr(n,e,t,r){if(50<El)throw El=0,Rp=null,Error(ue(185));mu(n,t,r),(!(Xe&2)||n!==Ht)&&(n===Ht&&(!(Xe&2)&&(zd|=t),Bt===4&&Wi(n,en)),Sn(n,r),t===1&&Xe===0&&!(e.mode&1)&&(eo=_t()+500,Ud&&wa()))}function Sn(n,e){var t=n.callbackNode;TA(n,e);var r=Jc(n,n===Ht?en:0);if(r===0)t!==null&&ev(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&ev(t),e===1)n.tag===0?wR(Wv.bind(null,n)):p0(Wv.bind(null,n)),yR(function(){!(Xe&6)&&wa()}),t=null;else{switch(QT(r)){case 1:t=mm;break;case 4:t=kT;break;case 16:t=Kc;break;case 536870912:t=UT;break;default:t=Kc}t=fb(t,sb.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function sb(n,e){if(Lc=-1,qc=0,Xe&6)throw Error(ue(327));var t=n.callbackNode;if(zs()&&n.callbackNode!==t)return null;var r=Jc(n,n===Ht?en:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=pd(n,r);else{e=r;var i=Xe;Xe|=2;var a=lb();(Ht!==n||en!==e)&&(li=null,eo=_t()+500,Ua(n,e));do try{UR();break}catch(o){ob(n,o)}while(!0);xm(),dd.current=a,Xe=i,It!==null?e=0:(Ht=null,en=0,e=Bt)}if(e!==0){if(e===2&&(i=ep(n),i!==0&&(r=i,e=xp(n,i))),e===1)throw t=Ul,Ua(n,0),Wi(n,r),Sn(n,_t()),t;if(e===6)Wi(n,r);else{if(i=n.current.alternate,!(r&30)&&!FR(i)&&(e=pd(n,r),e===2&&(a=ep(n),a!==0&&(r=a,e=xp(n,a))),e===1))throw t=Ul,Ua(n,0),Wi(n,r),Sn(n,_t()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(ue(345));case 2:Da(n,wn,li);break;case 3:if(Wi(n,r),(r&130023424)===r&&(e=Qm+500-_t(),10<e)){if(Jc(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){mn(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=lp(Da.bind(null,n,wn,li),e);break}Da(n,wn,li);break;case 4:if(Wi(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var s=31-_r(r);a=1<<s,s=e[s],s>i&&(i=s),r&=~a}if(r=i,r=_t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*BR(r/1960))-r,10<r){n.timeoutHandle=lp(Da.bind(null,n,wn,li),r);break}Da(n,wn,li);break;case 5:Da(n,wn,li);break;default:throw Error(ue(329))}}}return Sn(n,_t()),n.callbackNode===t?sb.bind(null,n):null}function xp(n,e){var t=vl;return n.current.memoizedState.isDehydrated&&(Ua(n,e).flags|=256),n=pd(n,e),n!==2&&(e=wn,wn=t,e!==null&&_p(e)),n}function _p(n){wn===null?wn=n:wn.push.apply(wn,n)}function FR(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],a=i.getSnapshot;i=i.value;try{if(!Dr(a(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Wi(n,e){for(e&=~jm,e&=~zd,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-_r(e),r=1<<t;n[t]=-1,e&=~r}}function Wv(n){if(Xe&6)throw Error(ue(327));zs();var e=Jc(n,0);if(!(e&1))return Sn(n,_t()),null;var t=pd(n,e);if(n.tag!==0&&t===2){var r=ep(n);r!==0&&(e=r,t=xp(n,r))}if(t===1)throw t=Ul,Ua(n,0),Wi(n,e),Sn(n,_t()),t;if(t===6)throw Error(ue(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Da(n,wn,li),Sn(n,_t()),null}function Vm(n,e){var t=Xe;Xe|=1;try{return n(e)}finally{Xe=t,Xe===0&&(eo=_t()+500,Ud&&wa())}}function Ka(n){Gi!==null&&Gi.tag===0&&!(Xe&6)&&zs();var e=Xe;Xe|=1;var t=rr.transition,r=nt;try{if(rr.transition=null,nt=1,n)return n()}finally{nt=r,rr.transition=t,Xe=e,!(Xe&6)&&wa()}}function zm(){On=Bs.current,pt(Bs)}function Ua(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,mR(t)),It!==null)for(t=It.return;t!==null;){var r=t;switch(Sm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&td();break;case 3:Xs(),pt(Nn),pt(dn),Dm();break;case 5:Im(r);break;case 4:Xs();break;case 13:pt(Tt);break;case 19:pt(Tt);break;case 10:_m(r.type._context);break;case 22:case 23:zm()}t=t.return}if(Ht=n,It=n=ra(n.current,null),en=On=e,Bt=0,Ul=null,jm=zd=Ga=0,wn=vl=null,Ba!==null){for(e=0;e<Ba.length;e++)if(t=Ba[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,a=t.pending;if(a!==null){var s=a.next;a.next=i,r.next=s}t.pending=r}Ba=null}return n}function ob(n,e){do{var t=It;try{if(xm(),Ic.current=cd,ud){for(var r=bt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ud=!1}if(Ha=0,zt=qt=bt=null,yl=!1,Bl=0,Um.current=null,t===null||t.return===null){Bt=1,Ul=e,It=null;break}e:{var a=n,s=t.return,o=t,l=e;if(e=en,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=Iv(s);if(p!==null){p.flags&=-257,Dv(p,s,o,a,e),p.mode&1&&Ov(a,u,e),e=p,l=u;var g=e.updateQueue;if(g===null){var E=new Set;E.add(l),e.updateQueue=E}else g.add(l);break e}else{if(!(e&1)){Ov(a,u,e),Wm();break e}l=Error(ue(426))}}else if(gt&&o.mode&1){var A=Iv(s);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Dv(A,s,o,a,e),Am(Zs(l,o));break e}}a=l=Zs(l,o),Bt!==4&&(Bt=2),vl===null?vl=[a]:vl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var b=V0(a,l,e);Sv(a,b);break e;case 1:o=l;var T=a.type,C=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(ta===null||!ta.has(C)))){a.flags|=65536,e&=-e,a.lanes|=e;var P=z0(a,o,e);Sv(a,P);break e}}a=a.return}while(a!==null)}cb(t)}catch(D){e=D,It===t&&t!==null&&(It=t=t.return);continue}break}while(!0)}function lb(){var n=dd.current;return dd.current=cd,n===null?cd:n}function Wm(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),Ht===null||!(Ga&268435455)&&!(zd&268435455)||Wi(Ht,en)}function pd(n,e){var t=Xe;Xe|=2;var r=lb();(Ht!==n||en!==e)&&(li=null,Ua(n,e));do try{kR();break}catch(i){ob(n,i)}while(!0);if(xm(),Xe=t,dd.current=r,It!==null)throw Error(ue(261));return Ht=null,en=0,Bt}function kR(){for(;It!==null;)ub(It)}function UR(){for(;It!==null&&!hA();)ub(It)}function ub(n){var e=hb(n.alternate,n,On);n.memoizedProps=n.pendingProps,e===null?cb(n):It=e,Um.current=null}function cb(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=DR(t,e),t!==null){t.flags&=32767,It=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Bt=6,It=null;return}}else if(t=IR(t,e,On),t!==null){It=t;return}if(e=e.sibling,e!==null){It=e;return}It=e=n}while(e!==null);Bt===0&&(Bt=5)}function Da(n,e,t){var r=nt,i=rr.transition;try{rr.transition=null,nt=1,jR(n,e,t,r)}finally{rr.transition=i,nt=r}return null}function jR(n,e,t,r){do zs();while(Gi!==null);if(Xe&6)throw Error(ue(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ue(177));n.callbackNode=null,n.callbackPriority=0;var a=t.lanes|t.childLanes;if(bA(n,a),n===Ht&&(It=Ht=null,en=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||fc||(fc=!0,fb(Kc,function(){return zs(),null})),a=(t.flags&15990)!==0,t.subtreeFlags&15990||a){a=rr.transition,rr.transition=null;var s=nt;nt=1;var o=Xe;Xe|=4,Um.current=null,LR(n,t),ib(t,n),lR(sp),Yc=!!ap,sp=ap=null,n.current=t,qR(t),fA(),Xe=o,nt=s,rr.transition=a}else n.current=t;if(fc&&(fc=!1,Gi=n,fd=i),a=n.pendingLanes,a===0&&(ta=null),yA(t.stateNode),Sn(n,_t()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(hd)throw hd=!1,n=Ap,Ap=null,n;return fd&1&&n.tag!==0&&zs(),a=n.pendingLanes,a&1?n===Rp?El++:(El=0,Rp=n):El=0,wa(),null}function zs(){if(Gi!==null){var n=QT(fd),e=rr.transition,t=nt;try{if(rr.transition=null,nt=16>n?16:n,Gi===null)var r=!1;else{if(n=Gi,Gi=null,fd=0,Xe&6)throw Error(ue(331));var i=Xe;for(Xe|=4,Se=n.current;Se!==null;){var a=Se,s=a.child;if(Se.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Se=u;Se!==null;){var c=Se;switch(c.tag){case 0:case 11:case 15:gl(8,c,a)}var d=c.child;if(d!==null)d.return=c,Se=d;else for(;Se!==null;){c=Se;var h=c.sibling,p=c.return;if(tb(c),c===u){Se=null;break}if(h!==null){h.return=p,Se=h;break}Se=p}}}var g=a.alternate;if(g!==null){var E=g.child;if(E!==null){g.child=null;do{var A=E.sibling;E.sibling=null,E=A}while(E!==null)}}Se=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,Se=s;else e:for(;Se!==null;){if(a=Se,a.flags&2048)switch(a.tag){case 0:case 11:case 15:gl(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Se=b;break e}Se=a.return}}var T=n.current;for(Se=T;Se!==null;){s=Se;var C=s.child;if(s.subtreeFlags&2064&&C!==null)C.return=s,Se=C;else e:for(s=T;Se!==null;){if(o=Se,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Vd(9,o)}}catch(D){St(o,o.return,D)}if(o===s){Se=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,Se=P;break e}Se=o.return}}if(Xe=i,wa(),Wr&&typeof Wr.onPostCommitFiberRoot=="function")try{Wr.onPostCommitFiberRoot(Ld,n)}catch{}r=!0}return r}finally{nt=t,rr.transition=e}}return!1}function Hv(n,e,t){e=Zs(t,e),e=V0(n,e,1),n=ea(n,e,1),e=mn(),n!==null&&(mu(n,1,e),Sn(n,e))}function St(n,e,t){if(n.tag===3)Hv(n,n,t);else for(;e!==null;){if(e.tag===3){Hv(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ta===null||!ta.has(r))){n=Zs(t,n),n=z0(e,n,1),e=ea(e,n,1),n=mn(),e!==null&&(mu(e,1,n),Sn(e,n));break}}e=e.return}}function QR(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=mn(),n.pingedLanes|=n.suspendedLanes&t,Ht===n&&(en&t)===t&&(Bt===4||Bt===3&&(en&130023424)===en&&500>_t()-Qm?Ua(n,0):jm|=t),Sn(n,e)}function db(n,e){e===0&&(n.mode&1?(e=rc,rc<<=1,!(rc&130023424)&&(rc=4194304)):e=1);var t=mn();n=bi(n,e),n!==null&&(mu(n,e,t),Sn(n,t))}function VR(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),db(n,t)}function zR(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ue(314))}r!==null&&r.delete(e),db(n,t)}var hb;hb=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Nn.current)bn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return bn=!1,OR(n,e,t);bn=!!(n.flags&131072)}else bn=!1,gt&&e.flags&1048576&&m0(e,id,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$c(n,e),n=e.pendingProps;var i=Ks(e,dn.current);Vs(e,t),i=Lm(null,e,r,n,i,t);var a=qm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cn(r)?(a=!0,nd(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Mm(e),i.updater=jd,e.stateNode=i,i._reactInternals=e,mp(e,r,n,t),e=vp(null,e,r,!0,a,t)):(e.tag=0,gt&&a&&Cm(e),fn(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch($c(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=HR(r),n=br(r,n),i){case 0:e=gp(null,e,r,n,t);break e;case 1:e=qv(null,e,r,n,t);break e;case 11:e=$v(null,e,r,n,t);break e;case 14:e=Lv(null,e,r,br(r.type,n),t);break e}throw Error(ue(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),gp(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),qv(n,e,r,i,t);case 3:e:{if(K0(e),n===null)throw Error(ue(387));r=e.pendingProps,a=e.memoizedState,i=a.element,E0(n,e),od(e,r,null,t);var s=e.memoizedState;if(r=s.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Zs(Error(ue(423)),e),e=Bv(n,e,r,t,i);break e}else if(r!==i){i=Zs(Error(ue(424)),e),e=Bv(n,e,r,t,i);break e}else for(Dn=Zi(e.stateNode.containerInfo.firstChild),Ln=e,gt=!0,Ar=null,t=N0(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Js(),r===i){e=Ni(n,e,t);break e}fn(n,e,r,t)}e=e.child}return e;case 5:return C0(e),n===null&&hp(e),r=e.type,i=e.pendingProps,a=n!==null?n.memoizedProps:null,s=i.children,op(r,i)?s=null:a!==null&&op(r,a)&&(e.flags|=32),G0(n,e),fn(n,e,s,t),e.child;case 6:return n===null&&hp(e),null;case 13:return J0(n,e,t);case 4:return Om(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Ys(e,null,r,t):fn(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),$v(n,e,r,i,t);case 7:return fn(n,e,e.pendingProps,t),e.child;case 8:return fn(n,e,e.pendingProps.children,t),e.child;case 12:return fn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,lt(ad,r._currentValue),r._currentValue=s,a!==null)if(Dr(a.value,s)){if(a.children===i.children&&!Nn.current){e=Ni(n,e,t);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=yi(-1,t&-t),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=t,l=a.alternate,l!==null&&(l.lanes|=t),fp(a.return,t,e),o.lanes|=t;break}l=l.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(ue(341));s.lanes|=t,o=s.alternate,o!==null&&(o.lanes|=t),fp(s,t,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}fn(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Vs(e,t),i=sr(i),r=r(i),e.flags|=1,fn(n,e,r,t),e.child;case 14:return r=e.type,i=br(r,e.pendingProps),i=br(r.type,i),Lv(n,e,r,i,t);case 15:return W0(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),$c(n,e),e.tag=1,Cn(r)?(n=!0,nd(e)):n=!1,Vs(e,t),T0(e,r,i),mp(e,r,i,t),vp(null,e,r,!0,n,t);case 19:return Y0(n,e,t);case 22:return H0(n,e,t)}throw Error(ue(156,e.tag))};function fb(n,e){return FT(n,e)}function WR(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tr(n,e,t,r){return new WR(n,e,t,r)}function Hm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function HR(n){if(typeof n=="function")return Hm(n)?1:0;if(n!=null){if(n=n.$$typeof,n===hm)return 11;if(n===fm)return 14}return 2}function ra(n,e){var t=n.alternate;return t===null?(t=tr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Bc(n,e,t,r,i,a){var s=2;if(r=n,typeof n=="function")Hm(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case xs:return ja(t.children,i,a,e);case dm:s=8,i|=8;break;case Ff:return n=tr(12,t,e,i|2),n.elementType=Ff,n.lanes=a,n;case kf:return n=tr(13,t,e,i),n.elementType=kf,n.lanes=a,n;case Uf:return n=tr(19,t,e,i),n.elementType=Uf,n.lanes=a,n;case bT:return Wd(t,i,a,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case wT:s=10;break e;case TT:s=9;break e;case hm:s=11;break e;case fm:s=14;break e;case Qi:s=16,r=null;break e}throw Error(ue(130,n==null?n:typeof n,""))}return e=tr(s,t,e,i),e.elementType=n,e.type=r,e.lanes=a,e}function ja(n,e,t,r){return n=tr(7,n,r,e),n.lanes=t,n}function Wd(n,e,t,r){return n=tr(22,n,r,e),n.elementType=bT,n.lanes=t,n.stateNode={isHidden:!1},n}function df(n,e,t){return n=tr(6,n,null,e),n.lanes=t,n}function hf(n,e,t){return e=tr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function GR(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zh(0),this.expirationTimes=zh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gm(n,e,t,r,i,a,s,o,l){return n=new GR(n,e,t,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=tr(3,null,null,e),n.current=a,a.stateNode=n,a.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mm(a),n}function KR(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rs,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function pb(n){if(!n)return aa;n=n._reactInternals;e:{if(ls(n)!==n||n.tag!==1)throw Error(ue(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ue(171))}if(n.tag===1){var t=n.type;if(Cn(t))return f0(n,t,e)}return e}function mb(n,e,t,r,i,a,s,o,l){return n=Gm(t,r,!0,n,i,a,s,o,l),n.context=pb(null),t=n.current,r=mn(),i=na(t),a=yi(r,i),a.callback=e??null,ea(t,a,i),n.current.lanes=i,mu(n,i,r),Sn(n,r),n}function Hd(n,e,t,r){var i=e.current,a=mn(),s=na(i);return t=pb(t),e.context===null?e.context=t:e.pendingContext=t,e=yi(a,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=ea(i,e,s),n!==null&&(Pr(n,i,s,a),Oc(n,i,s)),s}function md(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Gv(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Km(n,e){Gv(n,e),(n=n.alternate)&&Gv(n,e)}function JR(){return null}var yb=typeof reportError=="function"?reportError:function(n){console.error(n)};function Jm(n){this._internalRoot=n}Gd.prototype.render=Jm.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ue(409));Hd(n,e,null,null)};Gd.prototype.unmount=Jm.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ka(function(){Hd(null,n,null,null)}),e[Ti]=null}};function Gd(n){this._internalRoot=n}Gd.prototype.unstable_scheduleHydration=function(n){if(n){var e=WT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<zi.length&&e!==0&&e<zi[t].priority;t++);zi.splice(t,0,n),t===0&&GT(n)}};function Ym(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Kd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Kv(){}function YR(n,e,t,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=md(s);a.call(u)}}var s=mb(e,r,n,0,null,!1,!1,"",Kv);return n._reactRootContainer=s,n[Ti]=s.current,Il(n.nodeType===8?n.parentNode:n),Ka(),s}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=md(l);o.call(u)}}var l=Gm(n,0,!1,null,null,!1,!1,"",Kv);return n._reactRootContainer=l,n[Ti]=l.current,Il(n.nodeType===8?n.parentNode:n),Ka(function(){Hd(e,l,t,r)}),l}function Jd(n,e,t,r,i){var a=t._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=md(s);o.call(l)}}Hd(e,s,n,i)}else s=YR(t,e,n,i,r);return md(s)}VT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=ol(e.pendingLanes);t!==0&&(ym(e,t|1),Sn(e,_t()),!(Xe&6)&&(eo=_t()+500,wa()))}break;case 13:Ka(function(){var r=bi(n,1);if(r!==null){var i=mn();Pr(r,n,1,i)}}),Km(n,1)}};gm=function(n){if(n.tag===13){var e=bi(n,134217728);if(e!==null){var t=mn();Pr(e,n,134217728,t)}Km(n,134217728)}};zT=function(n){if(n.tag===13){var e=na(n),t=bi(n,e);if(t!==null){var r=mn();Pr(t,n,e,r)}Km(n,e)}};WT=function(){return nt};HT=function(n,e){var t=nt;try{return nt=n,e()}finally{nt=t}};Yf=function(n,e,t){switch(e){case"input":if(Vf(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=kd(r);if(!i)throw Error(ue(90));CT(r),Vf(r,i)}}}break;case"textarea":AT(n,t);break;case"select":e=t.value,e!=null&&ks(n,!!t.multiple,e,!1)}};IT=Vm;DT=Ka;var XR={usingClientEntryPoint:!1,Events:[gu,Os,kd,MT,OT,Vm]},Jo={findFiberByHostInstance:qa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ZR={bundleType:Jo.bundleType,version:Jo.version,rendererPackageName:Jo.rendererPackageName,rendererConfig:Jo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Di.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=qT(n),n===null?null:n.stateNode},findFiberByHostInstance:Jo.findFiberByHostInstance||JR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pc.isDisabled&&pc.supportsFiber)try{Ld=pc.inject(ZR),Wr=pc}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XR;Vn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ym(e))throw Error(ue(200));return KR(n,e,null,t)};Vn.createRoot=function(n,e){if(!Ym(n))throw Error(ue(299));var t=!1,r="",i=yb;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Gm(n,1,!1,null,null,t,!1,r,i),n[Ti]=e.current,Il(n.nodeType===8?n.parentNode:n),new Jm(e)};Vn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ue(188)):(n=Object.keys(n).join(","),Error(ue(268,n)));return n=qT(e),n=n===null?null:n.stateNode,n};Vn.flushSync=function(n){return Ka(n)};Vn.hydrate=function(n,e,t){if(!Kd(e))throw Error(ue(200));return Jd(null,n,e,!0,t)};Vn.hydrateRoot=function(n,e,t){if(!Ym(n))throw Error(ue(405));var r=t!=null&&t.hydratedSources||null,i=!1,a="",s=yb;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=mb(e,null,n,1,t??null,i,!1,a,s),n[Ti]=e.current,Il(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Gd(e)};Vn.render=function(n,e,t){if(!Kd(e))throw Error(ue(200));return Jd(null,n,e,!1,t)};Vn.unmountComponentAtNode=function(n){if(!Kd(n))throw Error(ue(40));return n._reactRootContainer?(Ka(function(){Jd(null,null,n,!1,function(){n._reactRootContainer=null,n[Ti]=null})}),!0):!1};Vn.unstable_batchedUpdates=Vm;Vn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Kd(t))throw Error(ue(200));if(n==null||n._reactInternals===void 0)throw Error(ue(38));return Jd(n,e,t,!1,r)};Vn.version="18.2.0-next-9e3b772b8-20220608";function gb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gb)}catch(n){console.error(n)}}gb(),mT.exports=Vn;var jl=mT.exports,Jv=jl;qf.createRoot=Jv.createRoot,qf.hydrateRoot=Jv.hydrateRoot;/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Yv;(function(n){(function(e){var t=typeof globalThis=="object"?globalThis:typeof zc=="object"?zc:typeof self=="object"?self:typeof this=="object"?this:o(),r=i(n);typeof t.Reflect<"u"&&(r=i(t.Reflect,r)),e(r,t),typeof t.Reflect>"u"&&(t.Reflect=n);function i(l,u){return function(c,d){Object.defineProperty(l,c,{configurable:!0,writable:!0,value:d}),u&&u(c,d)}}function a(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function o(){return a()||s()}})(function(e,t){var r=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",a=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!o&&!l,c={create:o?function(){return x(Object.create(null))}:l?function(){return x({__proto__:null})}:function(){return x({})},has:u?function(S,R){return r.call(S,R)}:function(S,R){return R in S},get:u?function(S,R){return r.call(S,R)?S[R]:void 0}:function(S,R){return S[R]}},d=Object.getPrototypeOf(Function),h=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:N(),p=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:m(),g=typeof WeakMap=="function"?WeakMap:v(),E=i?Symbol.for("@reflect-metadata:registry"):void 0,A=En(),b=j(A);function T(S,R,O,H){if(re(O)){if(!Ut(S))throw new TypeError;if(!Re(R))throw new TypeError;return Z(S,R)}else{if(!Ut(S))throw new TypeError;if(!Le(R))throw new TypeError;if(!Le(H)&&!re(H)&&!Ze(H))throw new TypeError;return Ze(H)&&(H=void 0),O=Mt(O),q(S,R,O,H)}}e("decorate",T);function C(S,R){function O(H,ce){if(!Le(H))throw new TypeError;if(!re(ce)&&!He(ce))throw new TypeError;ee(S,R,H,ce)}return O}e("metadata",C);function P(S,R,O,H){if(!Le(O))throw new TypeError;return re(H)||(H=Mt(H)),ee(S,R,O,H)}e("defineMetadata",P);function D(S,R,O){if(!Le(R))throw new TypeError;return re(O)||(O=Mt(O)),G(S,R,O)}e("hasMetadata",D);function F(S,R,O){if(!Le(R))throw new TypeError;return re(O)||(O=Mt(O)),oe(S,R,O)}e("hasOwnMetadata",F);function Q(S,R,O){if(!Le(R))throw new TypeError;return re(O)||(O=Mt(O)),he(S,R,O)}e("getMetadata",Q);function W(S,R,O){if(!Le(R))throw new TypeError;return re(O)||(O=Mt(O)),pe(S,R,O)}e("getOwnMetadata",W);function B(S,R){if(!Le(S))throw new TypeError;return re(R)||(R=Mt(R)),de(S,R)}e("getMetadataKeys",B);function K(S,R){if(!Le(S))throw new TypeError;return re(R)||(R=Mt(R)),Ee(S,R)}e("getOwnMetadataKeys",K);function M(S,R,O){if(!Le(R))throw new TypeError;if(re(O)||(O=Mt(O)),!Le(R))throw new TypeError;re(O)||(O=Mt(O));var H=ie(R,O,!1);return re(H)?!1:H.OrdinaryDeleteMetadata(S,R,O)}e("deleteMetadata",M);function Z(S,R){for(var O=S.length-1;O>=0;--O){var H=S[O],ce=H(R);if(!re(ce)&&!Ze(ce)){if(!Re(ce))throw new TypeError;R=ce}}return R}function q(S,R,O,H){for(var ce=S.length-1;ce>=0;--ce){var $e=S[ce],Fe=$e(R,O,H);if(!re(Fe)&&!Ze(Fe)){if(!Le(Fe))throw new TypeError;H=Fe}}return H}function G(S,R,O){var H=oe(S,R,O);if(H)return!0;var ce=jt(R);return Ze(ce)?!1:G(S,ce,O)}function oe(S,R,O){var H=ie(R,O,!1);return re(H)?!1:ut(H.OrdinaryHasOwnMetadata(S,R,O))}function he(S,R,O){var H=oe(S,R,O);if(H)return pe(S,R,O);var ce=jt(R);if(!Ze(ce))return he(S,ce,O)}function pe(S,R,O){var H=ie(R,O,!1);if(!re(H))return H.OrdinaryGetOwnMetadata(S,R,O)}function ee(S,R,O,H){var ce=ie(O,H,!0);ce.OrdinaryDefineOwnMetadata(S,R,O,H)}function de(S,R){var O=Ee(S,R),H=jt(S);if(H===null)return O;var ce=de(H,R);if(ce.length<=0)return O;if(O.length<=0)return ce;for(var $e=new p,Fe=[],ae=0,ge=O;ae<ge.length;ae++){var Ae=ge[ae],Ne=$e.has(Ae);Ne||($e.add(Ae),Fe.push(Ae))}for(var Ce=0,ze=ce;Ce<ze.length;Ce++){var Ae=ze[Ce],Ne=$e.has(Ae);Ne||($e.add(Ae),Fe.push(Ae))}return Fe}function Ee(S,R){var O=ie(S,R,!1);return O?O.OrdinaryOwnMetadataKeys(S,R):[]}function ye(S){if(S===null)return 1;switch(typeof S){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return S===null?1:6;default:return 6}}function re(S){return S===void 0}function Ze(S){return S===null}function Pe(S){return typeof S=="symbol"}function Le(S){return typeof S=="object"?S!==null:typeof S=="function"}function Ve(S,R){switch(ye(S)){case 0:return S;case 1:return S;case 2:return S;case 3:return S;case 4:return S;case 5:return S}var O=R===3?"string":R===5?"number":"default",H=Dt(S,a);if(H!==void 0){var ce=H.call(S,O);if(Le(ce))throw new TypeError;return ce}return et(S,O==="default"?"number":O)}function et(S,R){if(R==="string"){var O=S.toString;if(nn(O)){var H=O.call(S);if(!Le(H))return H}var ce=S.valueOf;if(nn(ce)){var H=ce.call(S);if(!Le(H))return H}}else{var ce=S.valueOf;if(nn(ce)){var H=ce.call(S);if(!Le(H))return H}var $e=S.toString;if(nn($e)){var H=$e.call(S);if(!Le(H))return H}}throw new TypeError}function ut(S){return!!S}function mt(S){return""+S}function Mt(S){var R=Ve(S,3);return Pe(R)?R:mt(R)}function Ut(S){return Array.isArray?Array.isArray(S):S instanceof Object?S instanceof Array:Object.prototype.toString.call(S)==="[object Array]"}function nn(S){return typeof S=="function"}function Re(S){return typeof S=="function"}function He(S){switch(ye(S)){case 3:return!0;case 4:return!0;default:return!1}}function Pn(S,R){return S===R||S!==S&&R!==R}function Dt(S,R){var O=S[R];if(O!=null){if(!nn(O))throw new TypeError;return O}}function Kt(S){var R=Dt(S,s);if(!nn(R))throw new TypeError;var O=R.call(S);if(!Le(O))throw new TypeError;return O}function gr(S){return S.value}function tt(S){var R=S.next();return R.done?!1:R}function $t(S){var R=S.return;R&&R.call(S)}function jt(S){var R=Object.getPrototypeOf(S);if(typeof S!="function"||S===d||R!==d)return R;var O=S.prototype,H=O&&Object.getPrototypeOf(O);if(H==null||H===Object.prototype)return R;var ce=H.constructor;return typeof ce!="function"||ce===S?R:ce}function it(){var S;!re(E)&&typeof t.Reflect<"u"&&!(E in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(S=X(t.Reflect));var R,O,H,ce=new g,$e={registerProvider:Fe,getProvider:ge,setProvider:Ne};return $e;function Fe(Ce){if(!Object.isExtensible($e))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case S===Ce:break;case re(R):R=Ce;break;case R===Ce:break;case re(O):O=Ce;break;case O===Ce:break;default:H===void 0&&(H=new p),H.add(Ce);break}}function ae(Ce,ze){if(!re(R)){if(R.isProviderFor(Ce,ze))return R;if(!re(O)){if(O.isProviderFor(Ce,ze))return R;if(!re(H))for(var Ke=Kt(H);;){var yt=tt(Ke);if(!yt)return;var le=gr(yt);if(le.isProviderFor(Ce,ze))return $t(Ke),le}}}if(!re(S)&&S.isProviderFor(Ce,ze))return S}function ge(Ce,ze){var Ke=ce.get(Ce),yt;return re(Ke)||(yt=Ke.get(ze)),re(yt)&&(yt=ae(Ce,ze),re(yt)||(re(Ke)&&(Ke=new h,ce.set(Ce,Ke)),Ke.set(ze,yt))),yt}function Ae(Ce){if(re(Ce))throw new TypeError;return R===Ce||O===Ce||!re(H)&&H.has(Ce)}function Ne(Ce,ze,Ke){if(!Ae(Ke))throw new Error("Metadata provider not registered.");var yt=ge(Ce,ze);if(yt!==Ke){if(!re(yt))return!1;var le=ce.get(Ce);re(le)&&(le=new h,ce.set(Ce,le)),le.set(ze,Ke)}return!0}}function En(){var S;return!re(E)&&Le(t.Reflect)&&Object.isExtensible(t.Reflect)&&(S=t.Reflect[E]),re(S)&&(S=it()),!re(E)&&Le(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,E,{enumerable:!1,configurable:!1,writable:!1,value:S}),S}function j(S){var R=new g,O={isProviderFor:function(Ae,Ne){var Ce=R.get(Ae);return re(Ce)?!1:Ce.has(Ne)},OrdinaryDefineOwnMetadata:Fe,OrdinaryHasOwnMetadata:ce,OrdinaryGetOwnMetadata:$e,OrdinaryOwnMetadataKeys:ae,OrdinaryDeleteMetadata:ge};return A.registerProvider(O),O;function H(Ae,Ne,Ce){var ze=R.get(Ae),Ke=!1;if(re(ze)){if(!Ce)return;ze=new h,R.set(Ae,ze),Ke=!0}var yt=ze.get(Ne);if(re(yt)){if(!Ce)return;if(yt=new h,ze.set(Ne,yt),!S.setProvider(Ae,Ne,O))throw ze.delete(Ne),Ke&&R.delete(Ae),new Error("Wrong provider for target.")}return yt}function ce(Ae,Ne,Ce){var ze=H(Ne,Ce,!1);return re(ze)?!1:ut(ze.has(Ae))}function $e(Ae,Ne,Ce){var ze=H(Ne,Ce,!1);if(!re(ze))return ze.get(Ae)}function Fe(Ae,Ne,Ce,ze){var Ke=H(Ce,ze,!0);Ke.set(Ae,Ne)}function ae(Ae,Ne){var Ce=[],ze=H(Ae,Ne,!1);if(re(ze))return Ce;for(var Ke=ze.keys(),yt=Kt(Ke),le=0;;){var vs=tt(yt);if(!vs)return Ce.length=le,Ce;var rn=gr(vs);try{Ce[le]=rn}catch(xa){try{$t(yt)}finally{throw xa}}le++}}function ge(Ae,Ne,Ce){var ze=H(Ne,Ce,!1);if(re(ze)||!ze.delete(Ae))return!1;if(ze.size===0){var Ke=R.get(Ne);re(Ke)||(Ke.delete(Ce),Ke.size===0&&R.delete(Ke))}return!0}}function X(S){var R=S.defineMetadata,O=S.hasOwnMetadata,H=S.getOwnMetadata,ce=S.getOwnMetadataKeys,$e=S.deleteMetadata,Fe=new g,ae={isProviderFor:function(ge,Ae){var Ne=Fe.get(ge);return re(Ne)?ce(ge,Ae).length?(re(Ne)&&(Ne=new p,Fe.set(ge,Ne)),Ne.add(Ae),!0):!1:Ne.has(Ae)},OrdinaryDefineOwnMetadata:R,OrdinaryHasOwnMetadata:O,OrdinaryGetOwnMetadata:H,OrdinaryOwnMetadataKeys:ce,OrdinaryDeleteMetadata:$e};return ae}function ie(S,R,O){var H=A.getProvider(S,R);if(!re(H))return H;if(O){if(A.setProvider(S,R,b))return b;throw new Error("Illegal state.")}}function N(){var S={},R=[],O=function(){function ae(ge,Ae,Ne){this._index=0,this._keys=ge,this._values=Ae,this._selector=Ne}return ae.prototype["@@iterator"]=function(){return this},ae.prototype[s]=function(){return this},ae.prototype.next=function(){var ge=this._index;if(ge>=0&&ge<this._keys.length){var Ae=this._selector(this._keys[ge],this._values[ge]);return ge+1>=this._keys.length?(this._index=-1,this._keys=R,this._values=R):this._index++,{value:Ae,done:!1}}return{value:void 0,done:!0}},ae.prototype.throw=function(ge){throw this._index>=0&&(this._index=-1,this._keys=R,this._values=R),ge},ae.prototype.return=function(ge){return this._index>=0&&(this._index=-1,this._keys=R,this._values=R),{value:ge,done:!0}},ae}(),H=function(){function ae(){this._keys=[],this._values=[],this._cacheKey=S,this._cacheIndex=-2}return Object.defineProperty(ae.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),ae.prototype.has=function(ge){return this._find(ge,!1)>=0},ae.prototype.get=function(ge){var Ae=this._find(ge,!1);return Ae>=0?this._values[Ae]:void 0},ae.prototype.set=function(ge,Ae){var Ne=this._find(ge,!0);return this._values[Ne]=Ae,this},ae.prototype.delete=function(ge){var Ae=this._find(ge,!1);if(Ae>=0){for(var Ne=this._keys.length,Ce=Ae+1;Ce<Ne;Ce++)this._keys[Ce-1]=this._keys[Ce],this._values[Ce-1]=this._values[Ce];return this._keys.length--,this._values.length--,Pn(ge,this._cacheKey)&&(this._cacheKey=S,this._cacheIndex=-2),!0}return!1},ae.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=S,this._cacheIndex=-2},ae.prototype.keys=function(){return new O(this._keys,this._values,ce)},ae.prototype.values=function(){return new O(this._keys,this._values,$e)},ae.prototype.entries=function(){return new O(this._keys,this._values,Fe)},ae.prototype["@@iterator"]=function(){return this.entries()},ae.prototype[s]=function(){return this.entries()},ae.prototype._find=function(ge,Ae){if(!Pn(this._cacheKey,ge)){this._cacheIndex=-1;for(var Ne=0;Ne<this._keys.length;Ne++)if(Pn(this._keys[Ne],ge)){this._cacheIndex=Ne;break}}return this._cacheIndex<0&&Ae&&(this._cacheIndex=this._keys.length,this._keys.push(ge),this._values.push(void 0)),this._cacheIndex},ae}();return H;function ce(ae,ge){return ae}function $e(ae,ge){return ge}function Fe(ae,ge){return[ae,ge]}}function m(){var S=function(){function R(){this._map=new h}return Object.defineProperty(R.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),R.prototype.has=function(O){return this._map.has(O)},R.prototype.add=function(O){return this._map.set(O,O),this},R.prototype.delete=function(O){return this._map.delete(O)},R.prototype.clear=function(){this._map.clear()},R.prototype.keys=function(){return this._map.keys()},R.prototype.values=function(){return this._map.keys()},R.prototype.entries=function(){return this._map.entries()},R.prototype["@@iterator"]=function(){return this.keys()},R.prototype[s]=function(){return this.keys()},R}();return S}function v(){var S=16,R=c.create(),O=H();return function(){function ge(){this._key=H()}return ge.prototype.has=function(Ae){var Ne=ce(Ae,!1);return Ne!==void 0?c.has(Ne,this._key):!1},ge.prototype.get=function(Ae){var Ne=ce(Ae,!1);return Ne!==void 0?c.get(Ne,this._key):void 0},ge.prototype.set=function(Ae,Ne){var Ce=ce(Ae,!0);return Ce[this._key]=Ne,this},ge.prototype.delete=function(Ae){var Ne=ce(Ae,!1);return Ne!==void 0?delete Ne[this._key]:!1},ge.prototype.clear=function(){this._key=H()},ge}();function H(){var ge;do ge="@@WeakMap@@"+ae();while(c.has(R,ge));return R[ge]=!0,ge}function ce(ge,Ae){if(!r.call(ge,O)){if(!Ae)return;Object.defineProperty(ge,O,{value:c.create()})}return ge[O]}function $e(ge,Ae){for(var Ne=0;Ne<Ae;++Ne)ge[Ne]=Math.random()*255|0;return ge}function Fe(ge){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(ge)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(ge)):$e(new Uint8Array(ge),ge):$e(new Array(ge),ge)}function ae(){var ge=Fe(S);ge[6]=ge[6]&79|64,ge[8]=ge[8]&191|128;for(var Ae="",Ne=0;Ne<S;++Ne){var Ce=ge[Ne];(Ne===4||Ne===6||Ne===8)&&(Ae+="-"),Ce<16&&(Ae+="0"),Ae+=Ce.toString(16).toLowerCase()}return Ae}}function x(S){return S.__=void 0,delete S.__,S}})})(Yv||(Yv={}));var vb={exports:{}},Eb={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eu=Te;function ex(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var tx=typeof Object.is=="function"?Object.is:ex,nx=Eu.useSyncExternalStore,rx=Eu.useRef,ix=Eu.useEffect,ax=Eu.useMemo,sx=Eu.useDebugValue;Eb.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var a=rx(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=ax(function(){function l(p){if(!u){if(u=!0,c=p,p=r(p),i!==void 0&&s.hasValue){var g=s.value;if(i(g,p))return d=g}return d=p}if(g=d,tx(c,p))return g;var E=r(p);return i!==void 0&&i(g,E)?g:(c=p,d=E)}var u=!1,c,d,h=t===void 0?null:t;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,t,r,i]);var o=nx(n,a[0],a[1]);return ix(function(){s.hasValue=!0,s.value=o},[o]),sx(o),o};vb.exports=Eb;var ox=vb.exports,$n="default"in Vg?Y:Vg,Xv=Symbol.for("react-redux-context"),Zv=typeof globalThis<"u"?globalThis:{};function lx(){if(!$n.createContext)return{};const n=Zv[Xv]??(Zv[Xv]=new Map);let e=n.get($n.createContext);return e||(e=$n.createContext(null),n.set($n.createContext,e)),e}var sa=lx(),ux=()=>{throw new Error("uSES not initialized!")};function Xm(n=sa){return function(){return $n.useContext(n)}}var wb=Xm(),Tb=ux,cx=n=>{Tb=n},dx=(n,e)=>n===e;function hx(n=sa){const e=n===sa?wb:Xm(n);return function(r,i={}){const{equalityFn:a=dx,devModeChecks:s={}}=typeof i=="function"?{equalityFn:i}:i,{store:o,subscription:l,getServerState:u,stabilityCheck:c,identityFunctionCheck:d}=e();$n.useRef(!0);const h=$n.useCallback({[r.name](g){return r(g)}}[r.name],[r,c,s.stabilityCheck]),p=Tb(l.addNestedSub,o.getState,u||o.getState,h,a);return $n.useDebugValue(p),p}}var Ss=hx();function fx(n){n()}function px(){let n=null,e=null;return{clear(){n=null,e=null},notify(){fx(()=>{let t=n;for(;t;)t.callback(),t=t.next})},get(){let t=[],r=n;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0,i=e={callback:t,next:null,prev:e};return i.prev?i.prev.next=i:n=i,function(){!r||n===null||(r=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:n=i.next)}}}}var eE={notify(){},get:()=>[]};function mx(n,e){let t,r=eE,i=0,a=!1;function s(E){c();const A=r.subscribe(E);let b=!1;return()=>{b||(b=!0,A(),d())}}function o(){r.notify()}function l(){g.onStateChange&&g.onStateChange()}function u(){return a}function c(){i++,t||(t=e?e.addNestedSub(l):n.subscribe(l),r=px())}function d(){i--,t&&i===0&&(t(),t=void 0,r.clear(),r=eE)}function h(){a||(a=!0,c())}function p(){a&&(a=!1,d())}const g={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:u,trySubscribe:h,tryUnsubscribe:p,getListeners:()=>r};return g}var yx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gx=yx?$n.useLayoutEffect:$n.useEffect;function vx({store:n,context:e,children:t,serverState:r,stabilityCheck:i="once",identityFunctionCheck:a="once"}){const s=$n.useMemo(()=>{const u=mx(n);return{store:n,subscription:u,getServerState:r?()=>r:void 0,stabilityCheck:i,identityFunctionCheck:a}},[n,r,i,a]),o=$n.useMemo(()=>n.getState(),[n]);gx(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==n.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,o]);const l=e||sa;return $n.createElement(l.Provider,{value:s},t)}var Ex=vx;function bb(n=sa){const e=n===sa?wb:Xm(n);return function(){const{store:r}=e();return r}}var wx=bb();function Tx(n=sa){const e=n===sa?wx:bb(n);return function(){return e().dispatch}}var bx=Tx();cx(ox.useSyncExternalStoreWithSelector);const Nx="/assets/sql-wasm-Ko6OkY9T.wasm",Cx="/assets/tl-XM5KXebP.db";/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var tE;(function(n){(function(e){var t=typeof zc=="object"?zc:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),r=i(n);typeof t.Reflect>"u"?t.Reflect=n:r=i(t.Reflect,r),e(r);function i(a,s){return function(o,l){typeof a[o]!="function"&&Object.defineProperty(a,o,{configurable:!0,writable:!0,value:l}),s&&s(o,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,r=typeof Symbol=="function",i=r&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=r&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",o={__proto__:[]}instanceof Array,l=!s&&!o,u={create:s?function(){return En(Object.create(null))}:o?function(){return En({__proto__:null})}:function(){return En({})},has:l?function(j,X){return t.call(j,X)}:function(j,X){return X in j},get:l?function(j,X){return t.call(j,X)?j[X]:void 0}:function(j,X){return j[X]}},c=Object.getPrototypeOf(Function),d=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",h=!d&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:$t(),p=!d&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:jt(),g=!d&&typeof WeakMap=="function"?WeakMap:it(),E=new g;function A(j,X,ie,N){if(ye(ie)){if(!Mt(j))throw new TypeError;if(!nn(X))throw new TypeError;return K(j,X)}else{if(!Mt(j))throw new TypeError;if(!Pe(X))throw new TypeError;if(!Pe(N)&&!ye(N)&&!re(N))throw new TypeError;return re(N)&&(N=void 0),ie=mt(ie),M(j,X,ie,N)}}e("decorate",A);function b(j,X){function ie(N,m){if(!Pe(N))throw new TypeError;if(!ye(m)&&!Re(m))throw new TypeError;pe(j,X,N,m)}return ie}e("metadata",b);function T(j,X,ie,N){if(!Pe(ie))throw new TypeError;return ye(N)||(N=mt(N)),pe(j,X,ie,N)}e("defineMetadata",T);function C(j,X,ie){if(!Pe(X))throw new TypeError;return ye(ie)||(ie=mt(ie)),q(j,X,ie)}e("hasMetadata",C);function P(j,X,ie){if(!Pe(X))throw new TypeError;return ye(ie)||(ie=mt(ie)),G(j,X,ie)}e("hasOwnMetadata",P);function D(j,X,ie){if(!Pe(X))throw new TypeError;return ye(ie)||(ie=mt(ie)),oe(j,X,ie)}e("getMetadata",D);function F(j,X,ie){if(!Pe(X))throw new TypeError;return ye(ie)||(ie=mt(ie)),he(j,X,ie)}e("getOwnMetadata",F);function Q(j,X){if(!Pe(j))throw new TypeError;return ye(X)||(X=mt(X)),ee(j,X)}e("getMetadataKeys",Q);function W(j,X){if(!Pe(j))throw new TypeError;return ye(X)||(X=mt(X)),de(j,X)}e("getOwnMetadataKeys",W);function B(j,X,ie){if(!Pe(X))throw new TypeError;ye(ie)||(ie=mt(ie));var N=Z(X,ie,!1);if(ye(N)||!N.delete(j))return!1;if(N.size>0)return!0;var m=E.get(X);return m.delete(ie),m.size>0||E.delete(X),!0}e("deleteMetadata",B);function K(j,X){for(var ie=j.length-1;ie>=0;--ie){var N=j[ie],m=N(X);if(!ye(m)&&!re(m)){if(!nn(m))throw new TypeError;X=m}}return X}function M(j,X,ie,N){for(var m=j.length-1;m>=0;--m){var v=j[m],x=v(X,ie,N);if(!ye(x)&&!re(x)){if(!Pe(x))throw new TypeError;N=x}}return N}function Z(j,X,ie){var N=E.get(j);if(ye(N)){if(!ie)return;N=new h,E.set(j,N)}var m=N.get(X);if(ye(m)){if(!ie)return;m=new h,N.set(X,m)}return m}function q(j,X,ie){var N=G(j,X,ie);if(N)return!0;var m=tt(X);return re(m)?!1:q(j,m,ie)}function G(j,X,ie){var N=Z(X,ie,!1);return ye(N)?!1:et(N.has(j))}function oe(j,X,ie){var N=G(j,X,ie);if(N)return he(j,X,ie);var m=tt(X);if(!re(m))return oe(j,m,ie)}function he(j,X,ie){var N=Z(X,ie,!1);if(!ye(N))return N.get(j)}function pe(j,X,ie,N){var m=Z(ie,N,!0);m.set(j,X)}function ee(j,X){var ie=de(j,X),N=tt(j);if(N===null)return ie;var m=ee(N,X);if(m.length<=0)return ie;if(ie.length<=0)return m;for(var v=new p,x=[],S=0,R=ie;S<R.length;S++){var O=R[S],H=v.has(O);H||(v.add(O),x.push(O))}for(var ce=0,$e=m;ce<$e.length;ce++){var O=$e[ce],H=v.has(O);H||(v.add(O),x.push(O))}return x}function de(j,X){var ie=[],N=Z(j,X,!1);if(ye(N))return ie;for(var m=N.keys(),v=Pn(m),x=0;;){var S=Kt(v);if(!S)return ie.length=x,ie;var R=Dt(S);try{ie[x]=R}catch(O){try{gr(v)}finally{throw O}}x++}}function Ee(j){if(j===null)return 1;switch(typeof j){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return j===null?1:6;default:return 6}}function ye(j){return j===void 0}function re(j){return j===null}function Ze(j){return typeof j=="symbol"}function Pe(j){return typeof j=="object"?j!==null:typeof j=="function"}function Le(j,X){switch(Ee(j)){case 0:return j;case 1:return j;case 2:return j;case 3:return j;case 4:return j;case 5:return j}var ie=X===3?"string":X===5?"number":"default",N=He(j,i);if(N!==void 0){var m=N.call(j,ie);if(Pe(m))throw new TypeError;return m}return Ve(j,ie==="default"?"number":ie)}function Ve(j,X){if(X==="string"){var ie=j.toString;if(Ut(ie)){var N=ie.call(j);if(!Pe(N))return N}var m=j.valueOf;if(Ut(m)){var N=m.call(j);if(!Pe(N))return N}}else{var m=j.valueOf;if(Ut(m)){var N=m.call(j);if(!Pe(N))return N}var v=j.toString;if(Ut(v)){var N=v.call(j);if(!Pe(N))return N}}throw new TypeError}function et(j){return!!j}function ut(j){return""+j}function mt(j){var X=Le(j,3);return Ze(X)?X:ut(X)}function Mt(j){return Array.isArray?Array.isArray(j):j instanceof Object?j instanceof Array:Object.prototype.toString.call(j)==="[object Array]"}function Ut(j){return typeof j=="function"}function nn(j){return typeof j=="function"}function Re(j){switch(Ee(j)){case 3:return!0;case 4:return!0;default:return!1}}function He(j,X){var ie=j[X];if(ie!=null){if(!Ut(ie))throw new TypeError;return ie}}function Pn(j){var X=He(j,a);if(!Ut(X))throw new TypeError;var ie=X.call(j);if(!Pe(ie))throw new TypeError;return ie}function Dt(j){return j.value}function Kt(j){var X=j.next();return X.done?!1:X}function gr(j){var X=j.return;X&&X.call(j)}function tt(j){var X=Object.getPrototypeOf(j);if(typeof j!="function"||j===c||X!==c)return X;var ie=j.prototype,N=ie&&Object.getPrototypeOf(ie);if(N==null||N===Object.prototype)return X;var m=N.constructor;return typeof m!="function"||m===j?X:m}function $t(){var j={},X=[],ie=function(){function x(S,R,O){this._index=0,this._keys=S,this._values=R,this._selector=O}return x.prototype["@@iterator"]=function(){return this},x.prototype[a]=function(){return this},x.prototype.next=function(){var S=this._index;if(S>=0&&S<this._keys.length){var R=this._selector(this._keys[S],this._values[S]);return S+1>=this._keys.length?(this._index=-1,this._keys=X,this._values=X):this._index++,{value:R,done:!1}}return{value:void 0,done:!0}},x.prototype.throw=function(S){throw this._index>=0&&(this._index=-1,this._keys=X,this._values=X),S},x.prototype.return=function(S){return this._index>=0&&(this._index=-1,this._keys=X,this._values=X),{value:S,done:!0}},x}();return function(){function x(){this._keys=[],this._values=[],this._cacheKey=j,this._cacheIndex=-2}return Object.defineProperty(x.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),x.prototype.has=function(S){return this._find(S,!1)>=0},x.prototype.get=function(S){var R=this._find(S,!1);return R>=0?this._values[R]:void 0},x.prototype.set=function(S,R){var O=this._find(S,!0);return this._values[O]=R,this},x.prototype.delete=function(S){var R=this._find(S,!1);if(R>=0){for(var O=this._keys.length,H=R+1;H<O;H++)this._keys[H-1]=this._keys[H],this._values[H-1]=this._values[H];return this._keys.length--,this._values.length--,S===this._cacheKey&&(this._cacheKey=j,this._cacheIndex=-2),!0}return!1},x.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=j,this._cacheIndex=-2},x.prototype.keys=function(){return new ie(this._keys,this._values,N)},x.prototype.values=function(){return new ie(this._keys,this._values,m)},x.prototype.entries=function(){return new ie(this._keys,this._values,v)},x.prototype["@@iterator"]=function(){return this.entries()},x.prototype[a]=function(){return this.entries()},x.prototype._find=function(S,R){return this._cacheKey!==S&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=S)),this._cacheIndex<0&&R&&(this._cacheIndex=this._keys.length,this._keys.push(S),this._values.push(void 0)),this._cacheIndex},x}();function N(x,S){return x}function m(x,S){return S}function v(x,S){return[x,S]}}function jt(){return function(){function j(){this._map=new h}return Object.defineProperty(j.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),j.prototype.has=function(X){return this._map.has(X)},j.prototype.add=function(X){return this._map.set(X,X),this},j.prototype.delete=function(X){return this._map.delete(X)},j.prototype.clear=function(){this._map.clear()},j.prototype.keys=function(){return this._map.keys()},j.prototype.values=function(){return this._map.values()},j.prototype.entries=function(){return this._map.entries()},j.prototype["@@iterator"]=function(){return this.keys()},j.prototype[a]=function(){return this.keys()},j}()}function it(){var j=16,X=u.create(),ie=N();return function(){function R(){this._key=N()}return R.prototype.has=function(O){var H=m(O,!1);return H!==void 0?u.has(H,this._key):!1},R.prototype.get=function(O){var H=m(O,!1);return H!==void 0?u.get(H,this._key):void 0},R.prototype.set=function(O,H){var ce=m(O,!0);return ce[this._key]=H,this},R.prototype.delete=function(O){var H=m(O,!1);return H!==void 0?delete H[this._key]:!1},R.prototype.clear=function(){this._key=N()},R}();function N(){var R;do R="@@WeakMap@@"+S();while(u.has(X,R));return X[R]=!0,R}function m(R,O){if(!t.call(R,ie)){if(!O)return;Object.defineProperty(R,ie,{value:u.create()})}return R[ie]}function v(R,O){for(var H=0;H<O;++H)R[H]=Math.random()*255|0;return R}function x(R){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(R)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(R)):v(new Uint8Array(R),R):v(new Array(R),R)}function S(){var R=x(j);R[6]=R[6]&79|64,R[8]=R[8]&191|128;for(var O="",H=0;H<j;++H){var ce=R[H];(H===4||H===6||H===8)&&(O+="-"),ce<16&&(O+="0"),O+=ce.toString(16).toLowerCase()}return O}}function En(j){return j.__=void 0,delete j.__,j}})})(tE||(tE={}));class Fc{static getInheritanceTree(e){const t=[e],r=i=>{const a=Object.getPrototypeOf(i);a&&a.name&&(t.push(a),r(a))};return r(e),t}static isInherited(e,t){return e.prototype instanceof t}static filterByTarget(e,t){return t?e.filter(r=>r.target&&t.indexOf(r.target)!==-1):e}}class Nb{constructor(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}filterTables(e){return this.filterByTarget(this.tables,e)}filterColumns(e){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,e)}findGenerated(e,t){return this.generations.find(r=>(Array.isArray(e)?e.indexOf(r.target)!==-1:r.target===e)&&r.propertyName===t)}findTree(e){return this.trees.find(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterRelations(e){return this.filterByTargetAndWithoutDuplicateRelationProperties(this.relations,e)}filterRelationIds(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,e)}filterRelationCounts(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,e)}filterIndices(e){return this.indices.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterUniques(e){return this.uniques.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterChecks(e){return this.checks.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterExclusions(e){return this.exclusions.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterListeners(e){return this.filterByTarget(this.entityListeners,e)}filterEmbeddeds(e){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,e)}findJoinTable(e,t){return this.joinTables.find(r=>r.target===e&&r.propertyName===t)}filterJoinColumns(e,t){return this.joinColumns.filter(r=>r.target===e&&r.propertyName===t)}filterSubscribers(e){return this.filterByTarget(this.entitySubscribers,e)}filterNamingStrategies(e){return this.filterByTarget(this.namingStrategies,e)}filterTransactionEntityManagers(e,t){return this.transactionEntityManagers.filter(r=>(Array.isArray(e)?e.indexOf(r.target)!==-1:r.target===e)&&r.methodName===t)}filterTransactionRepository(e,t){return this.transactionRepositories.filter(r=>(Array.isArray(e)?e.indexOf(r.target)!==-1:r.target===e)&&r.methodName===t)}filterSingleTableChildren(e){return this.tables.filter(t=>typeof t.target=="function"&&typeof e=="function"&&Fc.isInherited(t.target,e)&&t.type==="entity-child")}findInheritanceType(e){return this.inheritances.find(t=>t.target===e)}findDiscriminatorValue(e){return this.discriminatorValues.find(t=>t.target===e)}filterByTarget(e,t){return e.filter(r=>Array.isArray(t)?t.indexOf(r.target)!==-1:r.target===t)}filterByTargetAndWithoutDuplicateProperties(e,t){const r=[];return e.forEach(i=>{(Array.isArray(t)?t.indexOf(i.target)!==-1:i.target===t)&&(r.find(s=>s.propertyName===i.propertyName)||r.push(i))}),r}filterByTargetAndWithoutDuplicateRelationProperties(e,t){const r=[];return e.forEach(i=>{if(Array.isArray(t)?t.indexOf(i.target)!==-1:i.target===t){const s=r.findIndex(o=>o.propertyName===i.propertyName);if(Array.isArray(t)&&s!==-1&&t.indexOf(i.target)<t.indexOf(r[s].target)){const o=Object.create(r[s]);o.type=i.type,r[s]=o}else s===-1&&r.push(i)}}),r}filterByTargetAndWithoutDuplicateEmbeddedProperties(e,t){const r=[];return e.forEach(i=>{(Array.isArray(t)?t.indexOf(i.target)!==-1:i.target===t)&&(r.find(o=>o.prefix===i.prefix&&o.propertyName===i.propertyName)||r.push(i))}),r}}class ft{static getGlobalVariable(){return typeof window<"u"?window:global}static load(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: require("${e}").`);return""}static pathNormalize(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.normalize("${e}").`);return""}static pathExtname(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.extname("${e}").`);return""}static pathResolve(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.resolve("${e}").`);return""}static fileExist(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.existsSync("${e}").`);return!1}static dotenv(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: dotenv.config({ path: "${e}" }).`)}static getEnvVariable(e){}static readFileSync(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("${e}").`);return null}static appendFileSync(e,t){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("${e}").`)}static writeFile(e,t){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.writeFile("${e}").`);return Promise.reject(null)}static highlightSql(e){return e}static highlightJson(e){return e}static logInfo(e,t){console.info(e+" ",t)}static logError(e,t){console.error(e+" ",t)}static logWarn(e,t){console.warn(e+" ",t)}static log(e){console.log(e)}static warn(e){return e}}ft.type="browser";typeof window<"u"&&typeof require<"u"&&(window.Buffer=require("buffer/").Buffer);typeof global<"u"&&typeof require<"u"&&(global.Buffer=require("buffer/").Buffer);class ji{static sha1(e){let t=function(D,F){return D<<F|D>>>32-F},r=function(D){let F="",Q,W;for(Q=7;Q>=0;Q--)W=D>>>Q*4&15,F+=W.toString(16);return F},i,a,s,o=new Array(80),l=1732584193,u=4023233417,c=2562383102,d=271733878,h=3285377520,p,g,E,A,b,T;e=encodeURIComponent(e);let C=e.length,P=[];for(a=0;a<C-3;a+=4)s=e.charCodeAt(a)<<24|e.charCodeAt(a+1)<<16|e.charCodeAt(a+2)<<8|e.charCodeAt(a+3),P.push(s);switch(C%4){case 0:a=2147483648;break;case 1:a=e.charCodeAt(C-1)<<24|8388608;break;case 2:a=e.charCodeAt(C-2)<<24|e.charCodeAt(C-1)<<16|32768;break;case 3:a=e.charCodeAt(C-3)<<24|e.charCodeAt(C-2)<<16|e.charCodeAt(C-1)<<8|128;break}for(P.push(a);P.length%16!==14;)P.push(0);for(P.push(C>>>29),P.push(C<<3&4294967295),i=0;i<P.length;i+=16){for(a=0;a<16;a++)o[a]=P[i+a];for(a=16;a<=79;a++)o[a]=t(o[a-3]^o[a-8]^o[a-14]^o[a-16],1);for(p=l,g=u,E=c,A=d,b=h,a=0;a<=19;a++)T=t(p,5)+(g&E|~g&A)+b+o[a]+1518500249&4294967295,b=A,A=E,E=t(g,30),g=p,p=T;for(a=20;a<=39;a++)T=t(p,5)+(g^E^A)+b+o[a]+1859775393&4294967295,b=A,A=E,E=t(g,30),g=p,p=T;for(a=40;a<=59;a++)T=t(p,5)+(g&E|g&A|E&A)+b+o[a]+2400959708&4294967295,b=A,A=E,E=t(g,30),g=p,p=T;for(a=60;a<=79;a++)T=t(p,5)+(g^E^A)+b+o[a]+3395469782&4294967295,b=A,A=E,E=t(g,30),g=p,p=T;l=l+p&4294967295,u=u+g&4294967295,c=c+E&4294967295,d=d+A&4294967295,h=h+b&4294967295}return T=r(l)+r(u)+r(c)+r(d)+r(h),T.toLowerCase()}}var Cb={exports:{}},Pp={exports:{}};typeof Object.create=="function"?Pp.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Pp.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}};var To=Pp.exports,Mp={exports:{}},Sb={},Yd={};Yd.byteLength=Rx;Yd.toByteArray=_x;Yd.fromByteArray=Ox;var jr=[],Jn=[],Sx=typeof Uint8Array<"u"?Uint8Array:Array,ff="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ns=0,Ax=ff.length;Ns<Ax;++Ns)jr[Ns]=ff[Ns],Jn[ff.charCodeAt(Ns)]=Ns;Jn[45]=62;Jn[95]=63;function Ab(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function Rx(n){var e=Ab(n),t=e[0],r=e[1];return(t+r)*3/4-r}function xx(n,e,t){return(e+t)*3/4-t}function _x(n){var e,t=Ab(n),r=t[0],i=t[1],a=new Sx(xx(n,r,i)),s=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)e=Jn[n.charCodeAt(l)]<<18|Jn[n.charCodeAt(l+1)]<<12|Jn[n.charCodeAt(l+2)]<<6|Jn[n.charCodeAt(l+3)],a[s++]=e>>16&255,a[s++]=e>>8&255,a[s++]=e&255;return i===2&&(e=Jn[n.charCodeAt(l)]<<2|Jn[n.charCodeAt(l+1)]>>4,a[s++]=e&255),i===1&&(e=Jn[n.charCodeAt(l)]<<10|Jn[n.charCodeAt(l+1)]<<4|Jn[n.charCodeAt(l+2)]>>2,a[s++]=e>>8&255,a[s++]=e&255),a}function Px(n){return jr[n>>18&63]+jr[n>>12&63]+jr[n>>6&63]+jr[n&63]}function Mx(n,e,t){for(var r,i=[],a=e;a<t;a+=3)r=(n[a]<<16&16711680)+(n[a+1]<<8&65280)+(n[a+2]&255),i.push(Px(r));return i.join("")}function Ox(n){for(var e,t=n.length,r=t%3,i=[],a=16383,s=0,o=t-r;s<o;s+=a)i.push(Mx(n,s,s+a>o?o:s+a));return r===1?(e=n[t-1],i.push(jr[e>>2]+jr[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(jr[e>>10]+jr[e>>4&63]+jr[e<<2&63]+"=")),i.join("")}var Zm={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Zm.read=function(n,e,t,r,i){var a,s,o=i*8-r-1,l=(1<<o)-1,u=l>>1,c=-7,d=t?i-1:0,h=t?-1:1,p=n[e+d];for(d+=h,a=p&(1<<-c)-1,p>>=-c,c+=o;c>0;a=a*256+n[e+d],d+=h,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=r;c>0;s=s*256+n[e+d],d+=h,c-=8);if(a===0)a=1-u;else{if(a===l)return s?NaN:(p?-1:1)*(1/0);s=s+Math.pow(2,r),a=a-u}return(p?-1:1)*s*Math.pow(2,a-r)};Zm.write=function(n,e,t,r,i,a){var s,o,l,u=a*8-i-1,c=(1<<u)-1,d=c>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,g=r?1:-1,E=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?e+=h/l:e+=h*Math.pow(2,1-d),e*l>=2&&(s++,l/=2),s+d>=c?(o=0,s=c):s+d>=1?(o=(e*l-1)*Math.pow(2,i),s=s+d):(o=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;n[t+p]=o&255,p+=g,o/=256,i-=8);for(s=s<<i|o,u+=i;u>0;n[t+p]=s&255,p+=g,s/=256,u-=8);n[t+p-g]|=E*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=Yd,t=Zm,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=o,n.SlowBuffer=T,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=a(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const N=new Uint8Array(1),m={foo:function(){return 42}};return Object.setPrototypeOf(m,Uint8Array.prototype),Object.setPrototypeOf(N,m),N.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function s(N){if(N>i)throw new RangeError('The value "'+N+'" is invalid for option "size"');const m=new Uint8Array(N);return Object.setPrototypeOf(m,o.prototype),m}function o(N,m,v){if(typeof N=="number"){if(typeof m=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(N)}return l(N,m,v)}o.poolSize=8192;function l(N,m,v){if(typeof N=="string")return h(N,m);if(ArrayBuffer.isView(N))return g(N);if(N==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(it(N,ArrayBuffer)||N&&it(N.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(it(N,SharedArrayBuffer)||N&&it(N.buffer,SharedArrayBuffer)))return E(N,m,v);if(typeof N=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const x=N.valueOf&&N.valueOf();if(x!=null&&x!==N)return o.from(x,m,v);const S=A(N);if(S)return S;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof N[Symbol.toPrimitive]=="function")return o.from(N[Symbol.toPrimitive]("string"),m,v);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}o.from=function(N,m,v){return l(N,m,v)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function u(N){if(typeof N!="number")throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function c(N,m,v){return u(N),N<=0?s(N):m!==void 0?typeof v=="string"?s(N).fill(m,v):s(N).fill(m):s(N)}o.alloc=function(N,m,v){return c(N,m,v)};function d(N){return u(N),s(N<0?0:b(N)|0)}o.allocUnsafe=function(N){return d(N)},o.allocUnsafeSlow=function(N){return d(N)};function h(N,m){if((typeof m!="string"||m==="")&&(m="utf8"),!o.isEncoding(m))throw new TypeError("Unknown encoding: "+m);const v=C(N,m)|0;let x=s(v);const S=x.write(N,m);return S!==v&&(x=x.slice(0,S)),x}function p(N){const m=N.length<0?0:b(N.length)|0,v=s(m);for(let x=0;x<m;x+=1)v[x]=N[x]&255;return v}function g(N){if(it(N,Uint8Array)){const m=new Uint8Array(N);return E(m.buffer,m.byteOffset,m.byteLength)}return p(N)}function E(N,m,v){if(m<0||N.byteLength<m)throw new RangeError('"offset" is outside of buffer bounds');if(N.byteLength<m+(v||0))throw new RangeError('"length" is outside of buffer bounds');let x;return m===void 0&&v===void 0?x=new Uint8Array(N):v===void 0?x=new Uint8Array(N,m):x=new Uint8Array(N,m,v),Object.setPrototypeOf(x,o.prototype),x}function A(N){if(o.isBuffer(N)){const m=b(N.length)|0,v=s(m);return v.length===0||N.copy(v,0,0,m),v}if(N.length!==void 0)return typeof N.length!="number"||En(N.length)?s(0):p(N);if(N.type==="Buffer"&&Array.isArray(N.data))return p(N.data)}function b(N){if(N>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return N|0}function T(N){return+N!=N&&(N=0),o.alloc(+N)}o.isBuffer=function(m){return m!=null&&m._isBuffer===!0&&m!==o.prototype},o.compare=function(m,v){if(it(m,Uint8Array)&&(m=o.from(m,m.offset,m.byteLength)),it(v,Uint8Array)&&(v=o.from(v,v.offset,v.byteLength)),!o.isBuffer(m)||!o.isBuffer(v))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===v)return 0;let x=m.length,S=v.length;for(let R=0,O=Math.min(x,S);R<O;++R)if(m[R]!==v[R]){x=m[R],S=v[R];break}return x<S?-1:S<x?1:0},o.isEncoding=function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(m,v){if(!Array.isArray(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return o.alloc(0);let x;if(v===void 0)for(v=0,x=0;x<m.length;++x)v+=m[x].length;const S=o.allocUnsafe(v);let R=0;for(x=0;x<m.length;++x){let O=m[x];if(it(O,Uint8Array))R+O.length>S.length?(o.isBuffer(O)||(O=o.from(O)),O.copy(S,R)):Uint8Array.prototype.set.call(S,O,R);else if(o.isBuffer(O))O.copy(S,R);else throw new TypeError('"list" argument must be an Array of Buffers');R+=O.length}return S};function C(N,m){if(o.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||it(N,ArrayBuffer))return N.byteLength;if(typeof N!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);const v=N.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&v===0)return 0;let S=!1;for(;;)switch(m){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":return Kt(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v*2;case"hex":return v>>>1;case"base64":return $t(N).length;default:if(S)return x?-1:Kt(N).length;m=(""+m).toLowerCase(),S=!0}}o.byteLength=C;function P(N,m,v){let x=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0,m>>>=0,v<=m))return"";for(N||(N="utf8");;)switch(N){case"hex":return de(this,m,v);case"utf8":case"utf-8":return G(this,m,v);case"ascii":return pe(this,m,v);case"latin1":case"binary":return ee(this,m,v);case"base64":return q(this,m,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,m,v);default:if(x)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),x=!0}}o.prototype._isBuffer=!0;function D(N,m,v){const x=N[m];N[m]=N[v],N[v]=x}o.prototype.swap16=function(){const m=this.length;if(m%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let v=0;v<m;v+=2)D(this,v,v+1);return this},o.prototype.swap32=function(){const m=this.length;if(m%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let v=0;v<m;v+=4)D(this,v,v+3),D(this,v+1,v+2);return this},o.prototype.swap64=function(){const m=this.length;if(m%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let v=0;v<m;v+=8)D(this,v,v+7),D(this,v+1,v+6),D(this,v+2,v+5),D(this,v+3,v+4);return this},o.prototype.toString=function(){const m=this.length;return m===0?"":arguments.length===0?G(this,0,m):P.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(m){if(!o.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m?!0:o.compare(this,m)===0},o.prototype.inspect=function(){let m="";const v=n.INSPECT_MAX_BYTES;return m=this.toString("hex",0,v).replace(/(.{2})/g,"$1 ").trim(),this.length>v&&(m+=" ... "),"<Buffer "+m+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(m,v,x,S,R){if(it(m,Uint8Array)&&(m=o.from(m,m.offset,m.byteLength)),!o.isBuffer(m))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(v===void 0&&(v=0),x===void 0&&(x=m?m.length:0),S===void 0&&(S=0),R===void 0&&(R=this.length),v<0||x>m.length||S<0||R>this.length)throw new RangeError("out of range index");if(S>=R&&v>=x)return 0;if(S>=R)return-1;if(v>=x)return 1;if(v>>>=0,x>>>=0,S>>>=0,R>>>=0,this===m)return 0;let O=R-S,H=x-v;const ce=Math.min(O,H),$e=this.slice(S,R),Fe=m.slice(v,x);for(let ae=0;ae<ce;++ae)if($e[ae]!==Fe[ae]){O=$e[ae],H=Fe[ae];break}return O<H?-1:H<O?1:0};function F(N,m,v,x,S){if(N.length===0)return-1;if(typeof v=="string"?(x=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,En(v)&&(v=S?0:N.length-1),v<0&&(v=N.length+v),v>=N.length){if(S)return-1;v=N.length-1}else if(v<0)if(S)v=0;else return-1;if(typeof m=="string"&&(m=o.from(m,x)),o.isBuffer(m))return m.length===0?-1:Q(N,m,v,x,S);if(typeof m=="number")return m=m&255,typeof Uint8Array.prototype.indexOf=="function"?S?Uint8Array.prototype.indexOf.call(N,m,v):Uint8Array.prototype.lastIndexOf.call(N,m,v):Q(N,[m],v,x,S);throw new TypeError("val must be string, number or Buffer")}function Q(N,m,v,x,S){let R=1,O=N.length,H=m.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(N.length<2||m.length<2)return-1;R=2,O/=2,H/=2,v/=2}function ce(Fe,ae){return R===1?Fe[ae]:Fe.readUInt16BE(ae*R)}let $e;if(S){let Fe=-1;for($e=v;$e<O;$e++)if(ce(N,$e)===ce(m,Fe===-1?0:$e-Fe)){if(Fe===-1&&(Fe=$e),$e-Fe+1===H)return Fe*R}else Fe!==-1&&($e-=$e-Fe),Fe=-1}else for(v+H>O&&(v=O-H),$e=v;$e>=0;$e--){let Fe=!0;for(let ae=0;ae<H;ae++)if(ce(N,$e+ae)!==ce(m,ae)){Fe=!1;break}if(Fe)return $e}return-1}o.prototype.includes=function(m,v,x){return this.indexOf(m,v,x)!==-1},o.prototype.indexOf=function(m,v,x){return F(this,m,v,x,!0)},o.prototype.lastIndexOf=function(m,v,x){return F(this,m,v,x,!1)};function W(N,m,v,x){v=Number(v)||0;const S=N.length-v;x?(x=Number(x),x>S&&(x=S)):x=S;const R=m.length;x>R/2&&(x=R/2);let O;for(O=0;O<x;++O){const H=parseInt(m.substr(O*2,2),16);if(En(H))return O;N[v+O]=H}return O}function B(N,m,v,x){return jt(Kt(m,N.length-v),N,v,x)}function K(N,m,v,x){return jt(gr(m),N,v,x)}function M(N,m,v,x){return jt($t(m),N,v,x)}function Z(N,m,v,x){return jt(tt(m,N.length-v),N,v,x)}o.prototype.write=function(m,v,x,S){if(v===void 0)S="utf8",x=this.length,v=0;else if(x===void 0&&typeof v=="string")S=v,x=this.length,v=0;else if(isFinite(v))v=v>>>0,isFinite(x)?(x=x>>>0,S===void 0&&(S="utf8")):(S=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const R=this.length-v;if((x===void 0||x>R)&&(x=R),m.length>0&&(x<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");let O=!1;for(;;)switch(S){case"hex":return W(this,m,v,x);case"utf8":case"utf-8":return B(this,m,v,x);case"ascii":case"latin1":case"binary":return K(this,m,v,x);case"base64":return M(this,m,v,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,m,v,x);default:if(O)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),O=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(N,m,v){return m===0&&v===N.length?e.fromByteArray(N):e.fromByteArray(N.slice(m,v))}function G(N,m,v){v=Math.min(N.length,v);const x=[];let S=m;for(;S<v;){const R=N[S];let O=null,H=R>239?4:R>223?3:R>191?2:1;if(S+H<=v){let ce,$e,Fe,ae;switch(H){case 1:R<128&&(O=R);break;case 2:ce=N[S+1],(ce&192)===128&&(ae=(R&31)<<6|ce&63,ae>127&&(O=ae));break;case 3:ce=N[S+1],$e=N[S+2],(ce&192)===128&&($e&192)===128&&(ae=(R&15)<<12|(ce&63)<<6|$e&63,ae>2047&&(ae<55296||ae>57343)&&(O=ae));break;case 4:ce=N[S+1],$e=N[S+2],Fe=N[S+3],(ce&192)===128&&($e&192)===128&&(Fe&192)===128&&(ae=(R&15)<<18|(ce&63)<<12|($e&63)<<6|Fe&63,ae>65535&&ae<1114112&&(O=ae))}}O===null?(O=65533,H=1):O>65535&&(O-=65536,x.push(O>>>10&1023|55296),O=56320|O&1023),x.push(O),S+=H}return he(x)}const oe=4096;function he(N){const m=N.length;if(m<=oe)return String.fromCharCode.apply(String,N);let v="",x=0;for(;x<m;)v+=String.fromCharCode.apply(String,N.slice(x,x+=oe));return v}function pe(N,m,v){let x="";v=Math.min(N.length,v);for(let S=m;S<v;++S)x+=String.fromCharCode(N[S]&127);return x}function ee(N,m,v){let x="";v=Math.min(N.length,v);for(let S=m;S<v;++S)x+=String.fromCharCode(N[S]);return x}function de(N,m,v){const x=N.length;(!m||m<0)&&(m=0),(!v||v<0||v>x)&&(v=x);let S="";for(let R=m;R<v;++R)S+=j[N[R]];return S}function Ee(N,m,v){const x=N.slice(m,v);let S="";for(let R=0;R<x.length-1;R+=2)S+=String.fromCharCode(x[R]+x[R+1]*256);return S}o.prototype.slice=function(m,v){const x=this.length;m=~~m,v=v===void 0?x:~~v,m<0?(m+=x,m<0&&(m=0)):m>x&&(m=x),v<0?(v+=x,v<0&&(v=0)):v>x&&(v=x),v<m&&(v=m);const S=this.subarray(m,v);return Object.setPrototypeOf(S,o.prototype),S};function ye(N,m,v){if(N%1!==0||N<0)throw new RangeError("offset is not uint");if(N+m>v)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(m,v,x){m=m>>>0,v=v>>>0,x||ye(m,v,this.length);let S=this[m],R=1,O=0;for(;++O<v&&(R*=256);)S+=this[m+O]*R;return S},o.prototype.readUintBE=o.prototype.readUIntBE=function(m,v,x){m=m>>>0,v=v>>>0,x||ye(m,v,this.length);let S=this[m+--v],R=1;for(;v>0&&(R*=256);)S+=this[m+--v]*R;return S},o.prototype.readUint8=o.prototype.readUInt8=function(m,v){return m=m>>>0,v||ye(m,1,this.length),this[m]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(m,v){return m=m>>>0,v||ye(m,2,this.length),this[m]|this[m+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(m,v){return m=m>>>0,v||ye(m,2,this.length),this[m]<<8|this[m+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(m,v){return m=m>>>0,v||ye(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+this[m+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(m,v){return m=m>>>0,v||ye(m,4,this.length),this[m]*16777216+(this[m+1]<<16|this[m+2]<<8|this[m+3])},o.prototype.readBigUInt64LE=X(function(m){m=m>>>0,Re(m,"offset");const v=this[m],x=this[m+7];(v===void 0||x===void 0)&&He(m,this.length-8);const S=v+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24,R=this[++m]+this[++m]*2**8+this[++m]*2**16+x*2**24;return BigInt(S)+(BigInt(R)<<BigInt(32))}),o.prototype.readBigUInt64BE=X(function(m){m=m>>>0,Re(m,"offset");const v=this[m],x=this[m+7];(v===void 0||x===void 0)&&He(m,this.length-8);const S=v*2**24+this[++m]*2**16+this[++m]*2**8+this[++m],R=this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+x;return(BigInt(S)<<BigInt(32))+BigInt(R)}),o.prototype.readIntLE=function(m,v,x){m=m>>>0,v=v>>>0,x||ye(m,v,this.length);let S=this[m],R=1,O=0;for(;++O<v&&(R*=256);)S+=this[m+O]*R;return R*=128,S>=R&&(S-=Math.pow(2,8*v)),S},o.prototype.readIntBE=function(m,v,x){m=m>>>0,v=v>>>0,x||ye(m,v,this.length);let S=v,R=1,O=this[m+--S];for(;S>0&&(R*=256);)O+=this[m+--S]*R;return R*=128,O>=R&&(O-=Math.pow(2,8*v)),O},o.prototype.readInt8=function(m,v){return m=m>>>0,v||ye(m,1,this.length),this[m]&128?(255-this[m]+1)*-1:this[m]},o.prototype.readInt16LE=function(m,v){m=m>>>0,v||ye(m,2,this.length);const x=this[m]|this[m+1]<<8;return x&32768?x|4294901760:x},o.prototype.readInt16BE=function(m,v){m=m>>>0,v||ye(m,2,this.length);const x=this[m+1]|this[m]<<8;return x&32768?x|4294901760:x},o.prototype.readInt32LE=function(m,v){return m=m>>>0,v||ye(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},o.prototype.readInt32BE=function(m,v){return m=m>>>0,v||ye(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},o.prototype.readBigInt64LE=X(function(m){m=m>>>0,Re(m,"offset");const v=this[m],x=this[m+7];(v===void 0||x===void 0)&&He(m,this.length-8);const S=this[m+4]+this[m+5]*2**8+this[m+6]*2**16+(x<<24);return(BigInt(S)<<BigInt(32))+BigInt(v+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24)}),o.prototype.readBigInt64BE=X(function(m){m=m>>>0,Re(m,"offset");const v=this[m],x=this[m+7];(v===void 0||x===void 0)&&He(m,this.length-8);const S=(v<<24)+this[++m]*2**16+this[++m]*2**8+this[++m];return(BigInt(S)<<BigInt(32))+BigInt(this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+x)}),o.prototype.readFloatLE=function(m,v){return m=m>>>0,v||ye(m,4,this.length),t.read(this,m,!0,23,4)},o.prototype.readFloatBE=function(m,v){return m=m>>>0,v||ye(m,4,this.length),t.read(this,m,!1,23,4)},o.prototype.readDoubleLE=function(m,v){return m=m>>>0,v||ye(m,8,this.length),t.read(this,m,!0,52,8)},o.prototype.readDoubleBE=function(m,v){return m=m>>>0,v||ye(m,8,this.length),t.read(this,m,!1,52,8)};function re(N,m,v,x,S,R){if(!o.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>S||m<R)throw new RangeError('"value" argument is out of bounds');if(v+x>N.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(m,v,x,S){if(m=+m,v=v>>>0,x=x>>>0,!S){const H=Math.pow(2,8*x)-1;re(this,m,v,x,H,0)}let R=1,O=0;for(this[v]=m&255;++O<x&&(R*=256);)this[v+O]=m/R&255;return v+x},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(m,v,x,S){if(m=+m,v=v>>>0,x=x>>>0,!S){const H=Math.pow(2,8*x)-1;re(this,m,v,x,H,0)}let R=x-1,O=1;for(this[v+R]=m&255;--R>=0&&(O*=256);)this[v+R]=m/O&255;return v+x},o.prototype.writeUint8=o.prototype.writeUInt8=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,1,255,0),this[v]=m&255,v+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,2,65535,0),this[v]=m&255,this[v+1]=m>>>8,v+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,2,65535,0),this[v]=m>>>8,this[v+1]=m&255,v+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,4,4294967295,0),this[v+3]=m>>>24,this[v+2]=m>>>16,this[v+1]=m>>>8,this[v]=m&255,v+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,4,4294967295,0),this[v]=m>>>24,this[v+1]=m>>>16,this[v+2]=m>>>8,this[v+3]=m&255,v+4};function Ze(N,m,v,x,S){nn(m,x,S,N,v,7);let R=Number(m&BigInt(4294967295));N[v++]=R,R=R>>8,N[v++]=R,R=R>>8,N[v++]=R,R=R>>8,N[v++]=R;let O=Number(m>>BigInt(32)&BigInt(4294967295));return N[v++]=O,O=O>>8,N[v++]=O,O=O>>8,N[v++]=O,O=O>>8,N[v++]=O,v}function Pe(N,m,v,x,S){nn(m,x,S,N,v,7);let R=Number(m&BigInt(4294967295));N[v+7]=R,R=R>>8,N[v+6]=R,R=R>>8,N[v+5]=R,R=R>>8,N[v+4]=R;let O=Number(m>>BigInt(32)&BigInt(4294967295));return N[v+3]=O,O=O>>8,N[v+2]=O,O=O>>8,N[v+1]=O,O=O>>8,N[v]=O,v+8}o.prototype.writeBigUInt64LE=X(function(m,v=0){return Ze(this,m,v,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=X(function(m,v=0){return Pe(this,m,v,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(m,v,x,S){if(m=+m,v=v>>>0,!S){const ce=Math.pow(2,8*x-1);re(this,m,v,x,ce-1,-ce)}let R=0,O=1,H=0;for(this[v]=m&255;++R<x&&(O*=256);)m<0&&H===0&&this[v+R-1]!==0&&(H=1),this[v+R]=(m/O>>0)-H&255;return v+x},o.prototype.writeIntBE=function(m,v,x,S){if(m=+m,v=v>>>0,!S){const ce=Math.pow(2,8*x-1);re(this,m,v,x,ce-1,-ce)}let R=x-1,O=1,H=0;for(this[v+R]=m&255;--R>=0&&(O*=256);)m<0&&H===0&&this[v+R+1]!==0&&(H=1),this[v+R]=(m/O>>0)-H&255;return v+x},o.prototype.writeInt8=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,1,127,-128),m<0&&(m=255+m+1),this[v]=m&255,v+1},o.prototype.writeInt16LE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,2,32767,-32768),this[v]=m&255,this[v+1]=m>>>8,v+2},o.prototype.writeInt16BE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,2,32767,-32768),this[v]=m>>>8,this[v+1]=m&255,v+2},o.prototype.writeInt32LE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,4,2147483647,-2147483648),this[v]=m&255,this[v+1]=m>>>8,this[v+2]=m>>>16,this[v+3]=m>>>24,v+4},o.prototype.writeInt32BE=function(m,v,x){return m=+m,v=v>>>0,x||re(this,m,v,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[v]=m>>>24,this[v+1]=m>>>16,this[v+2]=m>>>8,this[v+3]=m&255,v+4},o.prototype.writeBigInt64LE=X(function(m,v=0){return Ze(this,m,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=X(function(m,v=0){return Pe(this,m,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Le(N,m,v,x,S,R){if(v+x>N.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function Ve(N,m,v,x,S){return m=+m,v=v>>>0,S||Le(N,m,v,4),t.write(N,m,v,x,23,4),v+4}o.prototype.writeFloatLE=function(m,v,x){return Ve(this,m,v,!0,x)},o.prototype.writeFloatBE=function(m,v,x){return Ve(this,m,v,!1,x)};function et(N,m,v,x,S){return m=+m,v=v>>>0,S||Le(N,m,v,8),t.write(N,m,v,x,52,8),v+8}o.prototype.writeDoubleLE=function(m,v,x){return et(this,m,v,!0,x)},o.prototype.writeDoubleBE=function(m,v,x){return et(this,m,v,!1,x)},o.prototype.copy=function(m,v,x,S){if(!o.isBuffer(m))throw new TypeError("argument should be a Buffer");if(x||(x=0),!S&&S!==0&&(S=this.length),v>=m.length&&(v=m.length),v||(v=0),S>0&&S<x&&(S=x),S===x||m.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),m.length-v<S-x&&(S=m.length-v+x);const R=S-x;return this===m&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(v,x,S):Uint8Array.prototype.set.call(m,this.subarray(x,S),v),R},o.prototype.fill=function(m,v,x,S){if(typeof m=="string"){if(typeof v=="string"?(S=v,v=0,x=this.length):typeof x=="string"&&(S=x,x=this.length),S!==void 0&&typeof S!="string")throw new TypeError("encoding must be a string");if(typeof S=="string"&&!o.isEncoding(S))throw new TypeError("Unknown encoding: "+S);if(m.length===1){const O=m.charCodeAt(0);(S==="utf8"&&O<128||S==="latin1")&&(m=O)}}else typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=Number(m));if(v<0||this.length<v||this.length<x)throw new RangeError("Out of range index");if(x<=v)return this;v=v>>>0,x=x===void 0?this.length:x>>>0,m||(m=0);let R;if(typeof m=="number")for(R=v;R<x;++R)this[R]=m;else{const O=o.isBuffer(m)?m:o.from(m,S),H=O.length;if(H===0)throw new TypeError('The value "'+m+'" is invalid for argument "value"');for(R=0;R<x-v;++R)this[R+v]=O[R%H]}return this};const ut={};function mt(N,m,v){ut[N]=class extends v{constructor(){super(),Object.defineProperty(this,"message",{value:m.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${N}]`,this.stack,delete this.name}get code(){return N}set code(S){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:S,writable:!0})}toString(){return`${this.name} [${N}]: ${this.message}`}}}mt("ERR_BUFFER_OUT_OF_BOUNDS",function(N){return N?`${N} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),mt("ERR_INVALID_ARG_TYPE",function(N,m){return`The "${N}" argument must be of type number. Received type ${typeof m}`},TypeError),mt("ERR_OUT_OF_RANGE",function(N,m,v){let x=`The value of "${N}" is out of range.`,S=v;return Number.isInteger(v)&&Math.abs(v)>2**32?S=Mt(String(v)):typeof v=="bigint"&&(S=String(v),(v>BigInt(2)**BigInt(32)||v<-(BigInt(2)**BigInt(32)))&&(S=Mt(S)),S+="n"),x+=` It must be ${m}. Received ${S}`,x},RangeError);function Mt(N){let m="",v=N.length;const x=N[0]==="-"?1:0;for(;v>=x+4;v-=3)m=`_${N.slice(v-3,v)}${m}`;return`${N.slice(0,v)}${m}`}function Ut(N,m,v){Re(m,"offset"),(N[m]===void 0||N[m+v]===void 0)&&He(m,N.length-(v+1))}function nn(N,m,v,x,S,R){if(N>v||N<m){const O=typeof m=="bigint"?"n":"";let H;throw R>3?m===0||m===BigInt(0)?H=`>= 0${O} and < 2${O} ** ${(R+1)*8}${O}`:H=`>= -(2${O} ** ${(R+1)*8-1}${O}) and < 2 ** ${(R+1)*8-1}${O}`:H=`>= ${m}${O} and <= ${v}${O}`,new ut.ERR_OUT_OF_RANGE("value",H,N)}Ut(x,S,R)}function Re(N,m){if(typeof N!="number")throw new ut.ERR_INVALID_ARG_TYPE(m,"number",N)}function He(N,m,v){throw Math.floor(N)!==N?(Re(N,v),new ut.ERR_OUT_OF_RANGE(v||"offset","an integer",N)):m<0?new ut.ERR_BUFFER_OUT_OF_BOUNDS:new ut.ERR_OUT_OF_RANGE(v||"offset",`>= ${v?1:0} and <= ${m}`,N)}const Pn=/[^+/0-9A-Za-z-_]/g;function Dt(N){if(N=N.split("=")[0],N=N.trim().replace(Pn,""),N.length<2)return"";for(;N.length%4!==0;)N=N+"=";return N}function Kt(N,m){m=m||1/0;let v;const x=N.length;let S=null;const R=[];for(let O=0;O<x;++O){if(v=N.charCodeAt(O),v>55295&&v<57344){if(!S){if(v>56319){(m-=3)>-1&&R.push(239,191,189);continue}else if(O+1===x){(m-=3)>-1&&R.push(239,191,189);continue}S=v;continue}if(v<56320){(m-=3)>-1&&R.push(239,191,189),S=v;continue}v=(S-55296<<10|v-56320)+65536}else S&&(m-=3)>-1&&R.push(239,191,189);if(S=null,v<128){if((m-=1)<0)break;R.push(v)}else if(v<2048){if((m-=2)<0)break;R.push(v>>6|192,v&63|128)}else if(v<65536){if((m-=3)<0)break;R.push(v>>12|224,v>>6&63|128,v&63|128)}else if(v<1114112){if((m-=4)<0)break;R.push(v>>18|240,v>>12&63|128,v>>6&63|128,v&63|128)}else throw new Error("Invalid code point")}return R}function gr(N){const m=[];for(let v=0;v<N.length;++v)m.push(N.charCodeAt(v)&255);return m}function tt(N,m){let v,x,S;const R=[];for(let O=0;O<N.length&&!((m-=2)<0);++O)v=N.charCodeAt(O),x=v>>8,S=v%256,R.push(S),R.push(x);return R}function $t(N){return e.toByteArray(Dt(N))}function jt(N,m,v,x){let S;for(S=0;S<x&&!(S+v>=m.length||S>=N.length);++S)m[S+v]=N[S];return S}function it(N,m){return N instanceof m||N!=null&&N.constructor!=null&&N.constructor.name!=null&&N.constructor.name===m.name}function En(N){return N!==N}const j=function(){const N="0123456789abcdef",m=new Array(256);for(let v=0;v<16;++v){const x=v*16;for(let S=0;S<16;++S)m[x+S]=N[v]+N[S]}return m}();function X(N){return typeof BigInt>"u"?ie:N}function ie(){throw new Error("BigInt not supported")}})(Sb);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=Sb,r=t.Buffer;function i(s,o){for(var l in s)o[l]=s[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=t:(i(t,e),e.Buffer=a);function a(s,o,l){return r(s,o,l)}a.prototype=Object.create(r.prototype),i(r,a),a.from=function(s,o,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return r(s,o,l)},a.alloc=function(s,o,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var u=r(s);return o!==void 0?typeof l=="string"?u.fill(o,l):u.fill(o):u.fill(0),u},a.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r(s)},a.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(s)}})(Mp,Mp.exports);var us=Mp.exports,Rb=us.Buffer;function Xd(n,e){this._block=Rb.alloc(n),this._finalSize=e,this._blockSize=n,this._len=0}Xd.prototype.update=function(n,e){typeof n=="string"&&(e=e||"utf8",n=Rb.from(n,e));for(var t=this._block,r=this._blockSize,i=n.length,a=this._len,s=0;s<i;){for(var o=a%r,l=Math.min(i-s,r-o),u=0;u<l;u++)t[o+u]=n[s+u];a+=l,s+=l,a%r===0&&this._update(t)}return this._len+=i,this};Xd.prototype.digest=function(n){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var t=this._len*8;if(t<=4294967295)this._block.writeUInt32BE(t,this._blockSize-4);else{var r=(t&4294967295)>>>0,i=(t-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var a=this._hash();return n?a.toString(n):a};Xd.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var bo=Xd,Ix=To,xb=bo,Dx=us.Buffer,$x=[1518500249,1859775393,-1894007588,-899497514],Lx=new Array(80);function wu(){this.init(),this._w=Lx,xb.call(this,64,56)}Ix(wu,xb);wu.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function qx(n){return n<<5|n>>>27}function Bx(n){return n<<30|n>>>2}function Fx(n,e,t,r){return n===0?e&t|~e&r:n===2?e&t|e&r|t&r:e^t^r}wu.prototype._update=function(n){for(var e=this._w,t=this._a|0,r=this._b|0,i=this._c|0,a=this._d|0,s=this._e|0,o=0;o<16;++o)e[o]=n.readInt32BE(o*4);for(;o<80;++o)e[o]=e[o-3]^e[o-8]^e[o-14]^e[o-16];for(var l=0;l<80;++l){var u=~~(l/20),c=qx(t)+Fx(u,r,i,a)+s+e[l]+$x[u]|0;s=a,a=i,i=Bx(r),r=t,t=c}this._a=t+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=a+this._d|0,this._e=s+this._e|0};wu.prototype._hash=function(){var n=Dx.allocUnsafe(20);return n.writeInt32BE(this._a|0,0),n.writeInt32BE(this._b|0,4),n.writeInt32BE(this._c|0,8),n.writeInt32BE(this._d|0,12),n.writeInt32BE(this._e|0,16),n};var kx=wu,Ux=To,_b=bo,jx=us.Buffer,Qx=[1518500249,1859775393,-1894007588,-899497514],Vx=new Array(80);function Tu(){this.init(),this._w=Vx,_b.call(this,64,56)}Ux(Tu,_b);Tu.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function zx(n){return n<<1|n>>>31}function Wx(n){return n<<5|n>>>27}function Hx(n){return n<<30|n>>>2}function Gx(n,e,t,r){return n===0?e&t|~e&r:n===2?e&t|e&r|t&r:e^t^r}Tu.prototype._update=function(n){for(var e=this._w,t=this._a|0,r=this._b|0,i=this._c|0,a=this._d|0,s=this._e|0,o=0;o<16;++o)e[o]=n.readInt32BE(o*4);for(;o<80;++o)e[o]=zx(e[o-3]^e[o-8]^e[o-14]^e[o-16]);for(var l=0;l<80;++l){var u=~~(l/20),c=Wx(t)+Gx(u,r,i,a)+s+e[l]+Qx[u]|0;s=a,a=i,i=Hx(r),r=t,t=c}this._a=t+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=a+this._d|0,this._e=s+this._e|0};Tu.prototype._hash=function(){var n=jx.allocUnsafe(20);return n.writeInt32BE(this._a|0,0),n.writeInt32BE(this._b|0,4),n.writeInt32BE(this._c|0,8),n.writeInt32BE(this._d|0,12),n.writeInt32BE(this._e|0,16),n};var Kx=Tu,Jx=To,Pb=bo,Yx=us.Buffer,Xx=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Zx=new Array(64);function bu(){this.init(),this._w=Zx,Pb.call(this,64,56)}Jx(bu,Pb);bu.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function e_(n,e,t){return t^n&(e^t)}function t_(n,e,t){return n&e|t&(n|e)}function n_(n){return(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10)}function r_(n){return(n>>>6|n<<26)^(n>>>11|n<<21)^(n>>>25|n<<7)}function i_(n){return(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3}function a_(n){return(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10}bu.prototype._update=function(n){for(var e=this._w,t=this._a|0,r=this._b|0,i=this._c|0,a=this._d|0,s=this._e|0,o=this._f|0,l=this._g|0,u=this._h|0,c=0;c<16;++c)e[c]=n.readInt32BE(c*4);for(;c<64;++c)e[c]=a_(e[c-2])+e[c-7]+i_(e[c-15])+e[c-16]|0;for(var d=0;d<64;++d){var h=u+r_(s)+e_(s,o,l)+Xx[d]+e[d]|0,p=n_(t)+t_(t,r,i)|0;u=l,l=o,o=s,s=a+h|0,a=i,i=r,r=t,t=h+p|0}this._a=t+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=a+this._d|0,this._e=s+this._e|0,this._f=o+this._f|0,this._g=l+this._g|0,this._h=u+this._h|0};bu.prototype._hash=function(){var n=Yx.allocUnsafe(32);return n.writeInt32BE(this._a,0),n.writeInt32BE(this._b,4),n.writeInt32BE(this._c,8),n.writeInt32BE(this._d,12),n.writeInt32BE(this._e,16),n.writeInt32BE(this._f,20),n.writeInt32BE(this._g,24),n.writeInt32BE(this._h,28),n};var Mb=bu,s_=To,o_=Mb,l_=bo,u_=us.Buffer,c_=new Array(64);function Zd(){this.init(),this._w=c_,l_.call(this,64,56)}s_(Zd,o_);Zd.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this};Zd.prototype._hash=function(){var n=u_.allocUnsafe(28);return n.writeInt32BE(this._a,0),n.writeInt32BE(this._b,4),n.writeInt32BE(this._c,8),n.writeInt32BE(this._d,12),n.writeInt32BE(this._e,16),n.writeInt32BE(this._f,20),n.writeInt32BE(this._g,24),n};var d_=Zd,h_=To,Ob=bo,f_=us.Buffer,nE=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],p_=new Array(160);function Nu(){this.init(),this._w=p_,Ob.call(this,128,112)}h_(Nu,Ob);Nu.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function rE(n,e,t){return t^n&(e^t)}function iE(n,e,t){return n&e|t&(n|e)}function aE(n,e){return(n>>>28|e<<4)^(e>>>2|n<<30)^(e>>>7|n<<25)}function sE(n,e){return(n>>>14|e<<18)^(n>>>18|e<<14)^(e>>>9|n<<23)}function m_(n,e){return(n>>>1|e<<31)^(n>>>8|e<<24)^n>>>7}function y_(n,e){return(n>>>1|e<<31)^(n>>>8|e<<24)^(n>>>7|e<<25)}function g_(n,e){return(n>>>19|e<<13)^(e>>>29|n<<3)^n>>>6}function v_(n,e){return(n>>>19|e<<13)^(e>>>29|n<<3)^(n>>>6|e<<26)}function Vt(n,e){return n>>>0<e>>>0?1:0}Nu.prototype._update=function(n){for(var e=this._w,t=this._ah|0,r=this._bh|0,i=this._ch|0,a=this._dh|0,s=this._eh|0,o=this._fh|0,l=this._gh|0,u=this._hh|0,c=this._al|0,d=this._bl|0,h=this._cl|0,p=this._dl|0,g=this._el|0,E=this._fl|0,A=this._gl|0,b=this._hl|0,T=0;T<32;T+=2)e[T]=n.readInt32BE(T*4),e[T+1]=n.readInt32BE(T*4+4);for(;T<160;T+=2){var C=e[T-30],P=e[T-15*2+1],D=m_(C,P),F=y_(P,C);C=e[T-2*2],P=e[T-2*2+1];var Q=g_(C,P),W=v_(P,C),B=e[T-7*2],K=e[T-7*2+1],M=e[T-16*2],Z=e[T-16*2+1],q=F+K|0,G=D+B+Vt(q,F)|0;q=q+W|0,G=G+Q+Vt(q,W)|0,q=q+Z|0,G=G+M+Vt(q,Z)|0,e[T]=G,e[T+1]=q}for(var oe=0;oe<160;oe+=2){G=e[oe],q=e[oe+1];var he=iE(t,r,i),pe=iE(c,d,h),ee=aE(t,c),de=aE(c,t),Ee=sE(s,g),ye=sE(g,s),re=nE[oe],Ze=nE[oe+1],Pe=rE(s,o,l),Le=rE(g,E,A),Ve=b+ye|0,et=u+Ee+Vt(Ve,b)|0;Ve=Ve+Le|0,et=et+Pe+Vt(Ve,Le)|0,Ve=Ve+Ze|0,et=et+re+Vt(Ve,Ze)|0,Ve=Ve+q|0,et=et+G+Vt(Ve,q)|0;var ut=de+pe|0,mt=ee+he+Vt(ut,de)|0;u=l,b=A,l=o,A=E,o=s,E=g,g=p+Ve|0,s=a+et+Vt(g,p)|0,a=i,p=h,i=r,h=d,r=t,d=c,c=Ve+ut|0,t=et+mt+Vt(c,Ve)|0}this._al=this._al+c|0,this._bl=this._bl+d|0,this._cl=this._cl+h|0,this._dl=this._dl+p|0,this._el=this._el+g|0,this._fl=this._fl+E|0,this._gl=this._gl+A|0,this._hl=this._hl+b|0,this._ah=this._ah+t+Vt(this._al,c)|0,this._bh=this._bh+r+Vt(this._bl,d)|0,this._ch=this._ch+i+Vt(this._cl,h)|0,this._dh=this._dh+a+Vt(this._dl,p)|0,this._eh=this._eh+s+Vt(this._el,g)|0,this._fh=this._fh+o+Vt(this._fl,E)|0,this._gh=this._gh+l+Vt(this._gl,A)|0,this._hh=this._hh+u+Vt(this._hl,b)|0};Nu.prototype._hash=function(){var n=f_.allocUnsafe(64);function e(t,r,i){n.writeInt32BE(t,i),n.writeInt32BE(r,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),n};var Ib=Nu,E_=To,w_=Ib,T_=bo,b_=us.Buffer,N_=new Array(160);function eh(){this.init(),this._w=N_,T_.call(this,128,112)}E_(eh,w_);eh.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this};eh.prototype._hash=function(){var n=b_.allocUnsafe(48);function e(t,r,i){n.writeInt32BE(t,i),n.writeInt32BE(r,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),n};var C_=eh,cs=Cb.exports=function(e){e=e.toLowerCase();var t=cs[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};cs.sha=kx;cs.sha1=Kx;cs.sha224=d_;cs.sha256=Mb;cs.sha384=C_;cs.sha512=Ib;var S_=Cb.exports;const A_=ss(S_);function pf(n,e=!1){return e&&(n=" "+n),n.replace(/^([A-Z])|[\s-_](\w)/g,function(t,r,i){return i?i.toUpperCase():r.toLowerCase()})}function oE(n){return n.replace(/([A-Z])([A-Z])([a-z])/g,"$1_$2$3").replace(/([a-z0-9])([A-Z])/g,"$1_$2").toLowerCase()}function R_(n){return n.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())}function Db(n,e={}){const{segmentLength:t=4,separator:r="__",termLength:i=2}=e;return n.split(r).reduce((o,l)=>{const u=l.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=u.length>1?i:t,d=u.map(h=>h.substr(0,c)).join("");return o.push(d),o},[]).join(r)}function x_(n,e={}){const t=A_("sha1");t.update(n,"utf8");const r=t.digest("hex");return e.length?r.slice(0,e.length):r}class __{constructor(){this.nestedSetColumnNames={left:"nsleft",right:"nsright"},this.materializedPathColumnName="mpath"}getTableName(e){return typeof e!="string"&&(e=e.name),e.split(".").pop()}tableName(e,t){return t||oE(e)}closureJunctionTableName(e){return e+"_closure"}columnName(e,t,r){const i=t||e;return r.length?pf(r.join("_"))+R_(i):i}relationName(e){return e}primaryKeyName(e,t){const r=[...t];r.sort();const s=`${this.getTableName(e).replace(".","_")}_${r.join("_")}`;return"PK_"+ji.sha1(s).substr(0,27)}uniqueConstraintName(e,t){const r=[...t];r.sort();const s=`${this.getTableName(e).replace(".","_")}_${r.join("_")}`;return"UQ_"+ji.sha1(s).substr(0,27)}relationConstraintName(e,t,r){const i=[...t];i.sort();let o=`${this.getTableName(e).replace(".","_")}_${i.join("_")}`;return r&&(o+=`_${r}`),"REL_"+ji.sha1(o).substr(0,26)}defaultConstraintName(e,t){const a=`${this.getTableName(e).replace(".","_")}_${t}`;return"DF_"+ji.sha1(a).substr(0,27)}foreignKeyName(e,t,r,i){const a=[...t];a.sort();const l=`${this.getTableName(e).replace(".","_")}_${a.join("_")}`;return"FK_"+ji.sha1(l).substr(0,27)}indexName(e,t,r){const i=[...t];i.sort();let o=`${this.getTableName(e).replace(".","_")}_${i.join("_")}`;return r&&(o+=`_${r}`),"IDX_"+ji.sha1(o).substr(0,26)}checkConstraintName(e,t,r){const s=`${this.getTableName(e).replace(".","_")}_${t}`,o="CHK_"+ji.sha1(s).substr(0,26);return r?`${o}_ENUM`:o}exclusionConstraintName(e,t){const a=`${this.getTableName(e).replace(".","_")}_${t}`;return"XCL_"+ji.sha1(a).substr(0,26)}joinColumnName(e,t){return pf(e+"_"+t)}joinTableName(e,t,r,i){return oE(e+"_"+r.replace(/\./gi,"_")+"_"+t)}joinTableColumnDuplicationPrefix(e,t){return e+"_"+t}joinTableColumnName(e,t,r){return pf(e+"_"+(r||t))}joinTableInverseColumnName(e,t,r){return this.joinTableColumnName(e,t,r)}prefixTableName(e,t){return e+t}eagerJoinRelationAlias(e,t){return e+"_"+t.replace(".","_")}}class L extends Error{get name(){return this.constructor.name}constructor(e){super(e),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class mc extends L{constructor(e){super(`Internal error. Subject ${e.metadata.targetName} must have an identifier to perform operation.`)}}class P_ extends L{constructor(e){super(`Cannot create a "${e}" connection because connection to the database already established.`)}}class Cs extends L{constructor(){super("Locking not supported on given driver.")}}class M_ extends L{constructor(e,t){super();const r=e.primaryColumns.reduce((i,a,s)=>(a.setEntityValue(i,s+1),i),{});this.message=`Cannot use given entity id "${t}" because "${e.targetName}" contains multiple primary columns, you must provide object in following form: ${JSON.stringify(r)} as an id.`}}class O_ extends L{constructor(e){super(`Cannot ${e}, given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.`)}}class I_ extends L{constructor(e){super(`Tree repositories are not supported in ${e.options.type} driver.`)}}class $b extends L{constructor(e){super(`Custom repository ${typeof e=="function"?e.name:e.constructor.name} was not found. Did you forgot to put @EntityRepository decorator on it?`)}}class lr extends L{constructor(){super("Transaction is not started yet, start transaction before committing or rolling it back.")}}class D_ extends L{constructor(){super("Transaction already started for the given connection, commit current transaction before starting a new one.")}}class Ue{static isObject(e){return e!==null&&typeof e=="object"}static isObjectWithName(e){return e!==null&&typeof e=="object"&&e.name!==void 0}static assign(e,...t){for(const r of t)for(const i of Object.getOwnPropertyNames(r))e[i]=r[i]}static mixedListToArray(e){return e!==null&&typeof e=="object"?Object.keys(e).map(t=>e[t]):e}}class U{static isMssqlParameter(e){return this.check(e,"MssqlParameter")}static isEntityMetadata(e){return this.check(e,"EntityMetadata")}static isColumnMetadata(e){return this.check(e,"ColumnMetadata")}static isSelectQueryBuilder(e){return this.check(e,"SelectQueryBuilder")}static isInsertQueryBuilder(e){return this.check(e,"InsertQueryBuilder")}static isDeleteQueryBuilder(e){return this.check(e,"DeleteQueryBuilder")}static isUpdateQueryBuilder(e){return this.check(e,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(e){return this.check(e,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(e){return this.check(e,"RelationQueryBuilder")}static isBrackets(e){return this.check(e,"Brackets")||this.check(e,"NotBrackets")}static isNotBrackets(e){return this.check(e,"NotBrackets")}static isSubject(e){return this.check(e,"Subject")}static isRdbmsSchemaBuilder(e){return this.check(e,"RdbmsSchemaBuilder")}static isMongoEntityManager(e){return this.check(e,"MongoEntityManager")}static isSqljsEntityManager(e){return this.check(e,"SqljsEntityManager")}static isEntitySchema(e){return this.check(e,"EntitySchema")}static isBaseEntityConstructor(e){return typeof e=="function"&&typeof e.hasId=="function"&&typeof e.save=="function"&&typeof e.useDataSource=="function"}static isFindOperator(e){return this.check(e,"FindOperator")||this.check(e,"EqualOperator")}static isEqualOperator(e){return this.check(e,"EqualOperator")}static isQuery(e){return this.check(e,"Query")}static isTable(e){return this.check(e,"Table")}static isTableCheck(e){return this.check(e,"TableCheck")}static isTableColumn(e){return this.check(e,"TableColumn")}static isTableExclusion(e){return this.check(e,"TableExclusion")}static isTableForeignKey(e){return this.check(e,"TableForeignKey")}static isTableIndex(e){return this.check(e,"TableIndex")}static isTableUnique(e){return this.check(e,"TableUnique")}static isView(e){return this.check(e,"View")}static isDataSource(e){return this.check(e,"DataSource")}static check(e,t){return typeof e=="object"&&e!==null&&e["@instanceof"]===Symbol.for(t)}}class Op extends L{constructor(e,t){super(),this.message=`Could not find any entity of type "${this.stringifyTarget(e)}" matching: ${this.stringifyCriteria(t)}`}stringifyTarget(e){return U.isEntitySchema(e)?e.options.name:typeof e=="function"||Ue.isObject(e)&&"name"in e?e.name:e}stringifyCriteria(e){try{return JSON.stringify(e,null,4)}catch{}return""+e}}class $_ extends L{constructor(e){super(),this.message=`No metadata for "${this.stringifyTarget(e)}" was found.`}stringifyTarget(e){return U.isEntitySchema(e)?e.options.name:typeof e=="function"||Ue.isObject(e)&&"name"in e?e.name:e}}class L_ extends L{constructor(e,t){super(`Cannot ${e}, given value must be an entity, instead "${t}" is given.`)}}class lE extends L{constructor(e,t,r){super(`The optimistic lock on entity ${e} failed, version ${t} was expected, but is actually ${r}.`)}}class q_ extends L{constructor(e){super(`Custom entity repository ${typeof e=="function"?e.name:e.constructor.name}  cannot inherit Repository class without entity being set in the @EntityRepository decorator.`)}}class Lb extends L{constructor(){super("Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.")}}class uE extends L{constructor(e){super(`Cannot attach entity "${e}" to its parent. Please make sure parent is saved in the database before saving children nodes.`)}}class mf extends L{constructor(e){super(`Custom repository ${typeof e=="function"?e.name:e.constructor.name} does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? `)}}class B_ extends L{constructor(e){super(`Circular relations detected: ${e}. To resolve this issue you need to set nullable: true somewhere in this dependency structure.`)}}class F_ extends L{constructor(e){super(`Entity "${e.name}" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.`)}}class Qr extends L{constructor(e,t){super(e),Object.setPrototypeOf(this,Qr.prototype),this.message=`Property "${e}" was not found in "${t.targetName}". Make sure your query is correct.`}}class k_ extends L{constructor(e,t=[]){super(`Wrong driver: "${e}" given. Supported drivers are: ${t.map(r=>`"${r}"`).join(", ")}.`)}}class No extends L{constructor(e,t){super(`${e} package has not been found installed. Try to install it: npm install ${t} --save`)}}class U_ extends L{constructor(e){super(`Entity ${e} does not have version or update date columns.`)}}class Yo extends L{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class j_ extends L{constructor(e){super(`Driver option (${e}) is not set. Please set it to perform connection to the database.`)}}class Q_ extends L{constructor(e){super(),e.length===1?this.message=`Relation "${e[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${e.map(t=>`"${t}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class V_ extends L{constructor(){super("An open transaction is required for pessimistic lock.")}}class z_ extends L{constructor(e,t,r){super();const i=typeof t=="string"?t:t.name;this.message=`Data type "${i}" in "${e.entityMetadata.targetName}.${e.propertyName}" is not supported by "${r}" database.`}}class W_ extends L{constructor(e){super(`Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "${e.entityMetadata.targetName}#${e.propertyPath}". This is ORM requirement to make relations to work properly. Refer docs for more information.`)}}class Gr extends L{constructor(e,t,r){if(super(r.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,"")),this.query=e,this.parameters=t,this.driverError=r,r){const{name:i,...a}=r;Ue.assign(this,{...a})}}}class H_ extends L{constructor(){super("Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.")}}class G_ extends L{constructor(e){super(`Removed entity "${e.metadata.name}" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).`)}}class qb extends L{constructor(e,t){super(`Column type for ${e.constructor.name}#${t} is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.`)}}class yn extends L{constructor(){super("Query runner already released. Cannot run queries anymore.")}}class K_ extends L{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class Xo extends L{constructor(e){super(`Cannot execute operation on "${e}" connection because connection is not yet established.`)}}class J_ extends L{constructor(e){super(`Option "${e}" is not set in your connection options, please define "${e}" option in your connection options or ormconfig.json`)}}class Y_ extends L{constructor(e){const t=e.map(r=>`"${r.name}"`);super(`Migrations ${t.join(", ")} override the transaction mode, but the global transaction mode is "all"`)}}class Tn{constructor(e){this["@instanceof"]=Symbol.for("TableColumn"),this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,e&&(this.name=e.name,this.type=e.type||"",this.length=e.length||"",this.width=e.width,this.charset=e.charset,this.collation=e.collation,this.precision=e.precision,this.scale=e.scale,this.zerofill=e.zerofill||!1,this.unsigned=this.zerofill?!0:e.unsigned||!1,this.default=e.default,this.onUpdate=e.onUpdate,this.isNullable=e.isNullable||!1,this.isGenerated=e.isGenerated||!1,this.generationStrategy=e.generationStrategy,this.generatedIdentity=e.generatedIdentity,this.isPrimary=e.isPrimary||!1,this.isUnique=e.isUnique||!1,this.isArray=e.isArray||!1,this.comment=e.comment,this.enum=e.enum,this.enumName=e.enumName,this.primaryKeyConstraintName=e.primaryKeyConstraintName,this.asExpression=e.asExpression,this.generatedType=e.generatedType,this.spatialFeatureType=e.spatialFeatureType,this.srid=e.srid)}clone(){return new Tn({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,enumName:this.enumName,primaryKeyConstraintName:this.primaryKeyConstraintName,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,generatedIdentity:this.generatedIdentity,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})}}class At{constructor(e){this["@instanceof"]=Symbol.for("TableIndex"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isFulltext=!!e.isFulltext,this.isNullFiltered=!!e.isNullFiltered,this.parser=e.parser,this.where=e.where?e.where:""}clone(){return new At({name:this.name,columnNames:[...this.columnNames],isUnique:this.isUnique,isSpatial:this.isSpatial,isFulltext:this.isFulltext,isNullFiltered:this.isNullFiltered,parser:this.parser,where:this.where})}static create(e){return new At({name:e.name,columnNames:e.columns.map(t=>t.databaseName),isUnique:e.isUnique,isSpatial:e.isSpatial,isFulltext:e.isFulltext,isNullFiltered:e.isNullFiltered,parser:e.parser,where:e.where})}}class ir{constructor(e){this["@instanceof"]=Symbol.for("TableForeignKey"),this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedDatabase=e.referencedDatabase,this.referencedSchema=e.referencedSchema,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}clone(){return new ir({name:this.name,columnNames:[...this.columnNames],referencedColumnNames:[...this.referencedColumnNames],referencedDatabase:this.referencedDatabase,referencedSchema:this.referencedSchema,referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})}static create(e,t){return new ir({name:e.name,columnNames:e.columnNames,referencedColumnNames:e.referencedColumnNames,referencedDatabase:e.referencedEntityMetadata.database,referencedSchema:e.referencedEntityMetadata.schema,referencedTableName:e.referencedTablePath,onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable})}}class kc{static createTableColumnOptions(e,t){return{name:e.databaseName,length:t.getColumnLength(e),width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:t.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,generatedIdentity:e.generatedIdentity,isNullable:e.isNullable,type:t.normalizeType(e),isPrimary:e.isPrimary,isUnique:t.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map(r=>r+""):e.enum,enumName:e.enumName,primaryKeyConstraintName:e.primaryKeyConstraintName,spatialFeatureType:e.spatialFeatureType,srid:e.srid}}}class un{constructor(e){this["@instanceof"]=Symbol.for("TableUnique"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.deferrable=e.deferrable}clone(){return new un({name:this.name,columnNames:[...this.columnNames],deferrable:this.deferrable})}static create(e){return new un({name:e.name,columnNames:e.columns.map(t=>t.databaseName),deferrable:e.deferrable})}}class Mr{constructor(e){this["@instanceof"]=Symbol.for("TableCheck"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}clone(){return new Mr({name:this.name,columnNames:this.columnNames?[...this.columnNames]:[],expression:this.expression})}static create(e){return new Mr({name:e.name,expression:e.expression})}}class Ja{constructor(e){this["@instanceof"]=Symbol.for("TableExclusion"),this.name=e.name,this.expression=e.expression}clone(){return new Ja({name:this.name,expression:this.expression})}static create(e){return new Ja({name:e.name,expression:e.expression})}}let xt=class Ip{constructor(e){this["@instanceof"]=Symbol.for("Table"),this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,this.withoutRowid=!1,e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,e.columns&&(this.columns=e.columns.map(t=>new Tn(t))),e.indices&&(this.indices=e.indices.map(t=>new At(t))),e.foreignKeys&&(this.foreignKeys=e.foreignKeys.map(t=>new ir({...t,referencedDatabase:(t==null?void 0:t.referencedDatabase)||e.database,referencedSchema:(t==null?void 0:t.referencedSchema)||e.schema}))),e.uniques&&(this.uniques=e.uniques.map(t=>new un(t))),e.checks&&(this.checks=e.checks.map(t=>new Mr(t))),e.exclusions&&(this.exclusions=e.exclusions.map(t=>new Ja(t))),e.justCreated!==void 0&&(this.justCreated=e.justCreated),e.withoutRowid&&(this.withoutRowid=e.withoutRowid),this.engine=e.engine)}get primaryColumns(){return this.columns.filter(e=>e.isPrimary)}clone(){return new Ip({schema:this.schema,database:this.database,name:this.name,columns:this.columns.map(e=>e.clone()),indices:this.indices.map(e=>e.clone()),foreignKeys:this.foreignKeys.map(e=>e.clone()),uniques:this.uniques.map(e=>e.clone()),checks:this.checks.map(e=>e.clone()),exclusions:this.exclusions.map(e=>e.clone()),justCreated:this.justCreated,withoutRowid:this.withoutRowid,engine:this.engine})}addColumn(e){this.columns.push(e)}removeColumn(e){const t=this.columns.find(r=>r.name===e.name);t&&this.columns.splice(this.columns.indexOf(t),1)}addUniqueConstraint(e){if(this.uniques.push(e),e.columnNames.length===1){const t=this.columns.find(r=>r.name===e.columnNames[0]);t&&(t.isUnique=!0)}}removeUniqueConstraint(e){const t=this.uniques.find(r=>r.name===e.name);if(t&&(this.uniques.splice(this.uniques.indexOf(t),1),t.columnNames.length===1)){const r=this.columns.find(i=>i.name===t.columnNames[0]);r&&(r.isUnique=!1)}}addCheckConstraint(e){this.checks.push(e)}removeCheckConstraint(e){const t=this.checks.find(r=>r.name===e.name);t&&this.checks.splice(this.checks.indexOf(t),1)}addExclusionConstraint(e){this.exclusions.push(e)}removeExclusionConstraint(e){const t=this.exclusions.find(r=>r.name===e.name);t&&this.exclusions.splice(this.exclusions.indexOf(t),1)}addForeignKey(e){this.foreignKeys.push(e)}removeForeignKey(e){const t=this.foreignKeys.find(r=>r.name===e.name);t&&this.foreignKeys.splice(this.foreignKeys.indexOf(t),1)}addIndex(e,t=!1){if(this.indices.push(e),e.columnNames.length===1&&e.isUnique&&t){const r=this.columns.find(i=>i.name===e.columnNames[0]);r&&(r.isUnique=!0)}}removeIndex(e,t=!1){const r=this.indices.find(i=>i.name===e.name);if(r&&(this.indices.splice(this.indices.indexOf(r),1),r.columnNames.length===1&&r.isUnique&&t)){const i=this.columns.find(a=>a.name===r.columnNames[0]);i&&(i.isUnique=this.indices.some(a=>a.columnNames.length===1&&a.columnNames[0]===i.name&&!!r.isUnique))}}findColumnByName(e){return this.columns.find(t=>t.name===e)}findColumnIndices(e){return this.indices.filter(t=>!!t.columnNames.find(r=>r===e.name))}findColumnForeignKeys(e){return this.foreignKeys.filter(t=>!!t.columnNames.find(r=>r===e.name))}findColumnUniques(e){return this.uniques.filter(t=>!!t.columnNames.find(r=>r===e.name))}findColumnChecks(e){return this.checks.filter(t=>!!t.columnNames.find(r=>r===e.name))}static create(e,t){const r=e.database===t.database?void 0:e.database,i=e.schema===t.options.schema?void 0:e.schema,a={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,i,r),withoutRowid:e.withoutRowid,engine:e.engine,columns:e.columns.filter(s=>s&&!s.isVirtualProperty).map(s=>kc.createTableColumnOptions(s,t)),indices:e.indices.filter(s=>s.synchronize===!0).map(s=>At.create(s)),uniques:e.uniques.map(s=>un.create(s)),checks:e.checks.map(s=>Mr.create(s)),exclusions:e.exclusions.map(s=>Ja.create(s))};return new Ip(a)}};class cE{constructor(e,t,r,i,a){this.id=e,this.timestamp=t,this.name=r,this.instance=i,this.transaction=a}}class Cr{constructor(e,t,...r){this.value=e,this.type=t,this["@instanceof"]=Symbol.for("MssqlParameter"),this.params=[],this.params=r||[]}}class yf{constructor(e,t){this.connection=e,this.queryRunner=t,this.transaction="all";const{schema:r}=this.connection.driver.options,i=this.connection.driver.database;this.migrationsDatabase=i,this.migrationsSchema=r,this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,r,i)}async executeMigration(e){return this.withQueryRunner(async t=>{await this.createMigrationsTableIfNotExist(t);const r=this.connection.driver.createSchemaBuilder();return U.isRdbmsSchemaBuilder(r)&&await r.createMetadataTableIfNecessary(t),await t.beforeMigration(),await e.instance.up(t),await t.afterMigration(),await this.insertExecutedMigration(t,e),e})}async getAllMigrations(){return Promise.resolve(this.getMigrations())}async getExecutedMigrations(){return this.withQueryRunner(async e=>(await this.createMigrationsTableIfNotExist(e),await this.loadExecutedMigrations(e)))}async getPendingMigrations(){const e=await this.getAllMigrations(),t=await this.getExecutedMigrations();return e.filter(r=>!t.find(i=>i.name===r.name))}insertMigration(e){return this.withQueryRunner(t=>this.insertExecutedMigration(t,e))}deleteMigration(e){return this.withQueryRunner(t=>this.deleteExecutedMigration(t,e))}async showMigrations(){let e=!1;const t=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(t);const r=await this.loadExecutedMigrations(t),i=this.getMigrations();for(const a of i){const s=r.find(o=>o.name===a.name);s?this.connection.logger.logSchemaBuild(`[X] ${s.id} ${a.name}`):(e=!0,this.connection.logger.logSchemaBuild(`[ ] ${a.name}`))}return this.queryRunner||await t.release(),e}async executePendingMigrations(){const e=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();U.isRdbmsSchemaBuilder(t)&&await t.createMetadataTableIfNecessary(e);const r=await this.loadExecutedMigrations(e);let i=this.getLatestTimestampMigration(r);const a=this.getMigrations(),s=[],o=a.filter(c=>!r.find(h=>h.name===c.name));if(!o.length)return this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner||await e.release(),[];if(this.connection.logger.logSchemaBuild(`${r.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${a.length} migrations were found in the source code.`),i&&this.connection.logger.logSchemaBuild(`${i.name} is the last executed migration. It was executed on ${new Date(i.timestamp).toString()}.`),this.connection.logger.logSchemaBuild(`${o.length} migrations are new migrations must be executed.`),this.transaction==="all"){const c=o.filter(d=>{var h;return((h=d.instance)===null||h===void 0?void 0:h.transaction)!==void 0});if(c.length>0){const d=new Y_(c);throw this.connection.logger.logMigration(`Migrations failed, error: ${d.message}`),d}}const l={each:!0,none:!1,all:!1}[this.transaction];for(const c of o)if(c.instance){const d=c.instance.transaction;d===void 0?c.transaction=l:c.transaction=d}let u=!1;this.transaction==="all"&&!e.isTransactionActive&&(await e.beforeMigration(),await e.startTransaction(),u=!0);try{for(const c of o){if(this.fake){await this.insertExecutedMigration(e,c);continue}c.transaction&&!e.isTransactionActive&&(await e.beforeMigration(),await e.startTransaction(),u=!0),await c.instance.up(e).catch(d=>{throw this.connection.logger.logMigration(`Migration "${c.name}" failed, error: ${d==null?void 0:d.message}`),d}).then(async()=>{await this.insertExecutedMigration(e,c),c.transaction&&u&&(await e.commitTransaction(),await e.afterMigration())}).then(()=>{s.push(c),this.connection.logger.logSchemaBuild(`Migration ${c.name} has been ${this.fake?"(fake)":""} executed successfully.`)})}this.transaction==="all"&&u&&(await e.commitTransaction(),await e.afterMigration())}catch(c){if(u)try{await e.rollbackTransaction()}catch{}throw c}finally{this.queryRunner||await e.release()}return s}async undoLastMigration(){const e=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();U.isRdbmsSchemaBuilder(t)&&await t.createMetadataTableIfNecessary(e);const r=await this.loadExecutedMigrations(e);let i=this.getLatestExecutedMigration(r);if(!i){this.connection.logger.logSchemaBuild("No migrations were found in the database. Nothing to revert!");return}const s=this.getMigrations().find(l=>l.name===i.name);if(!s)throw new L(`No migration ${i.name} was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.`);this.connection.logger.logSchemaBuild(`${r.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${i.name} is the last executed migration. It was executed on ${new Date(i.timestamp).toString()}.`),this.connection.logger.logSchemaBuild("Now reverting it...");let o=!1;this.transaction!=="none"&&!e.isTransactionActive&&(await e.startTransaction(),o=!0);try{this.fake||(await e.beforeMigration(),await s.instance.down(e),await e.afterMigration()),await this.deleteExecutedMigration(e,s),this.connection.logger.logSchemaBuild(`Migration ${s.name} has been ${this.fake?"(fake)":""} reverted successfully.`),o&&await e.commitTransaction()}catch(l){if(o)try{await e.rollbackTransaction()}catch{}throw l}finally{this.queryRunner||await e.release()}}async createMigrationsTableIfNotExist(e){if(this.connection.driver.options.type==="mongodb")return;await e.hasTable(this.migrationsTable)||await e.createTable(new xt({database:this.migrationsDatabase,schema:this.migrationsSchema,name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]}))}async loadExecutedMigrations(e){return this.connection.driver.options.type==="mongodb"?e.cursor(this.migrationsTableName,{}).sort({_id:-1}).toArray():(await this.connection.manager.createQueryBuilder(e).select().orderBy(this.connection.driver.escape("id"),"DESC").from(this.migrationsTable,this.migrationsTableName).getRawMany()).map(r=>new cE(parseInt(r.id),parseInt(r.timestamp),r.name))}getMigrations(){const e=this.connection.migrations.map(t=>{const r=t.name||t.constructor.name,i=parseInt(r.substr(-13),10);if(!i||isNaN(i))throw new L(`${r} migration name is wrong. Migration class name should have a JavaScript timestamp appended.`);return new cE(void 0,i,r,t)});return this.checkForDuplicateMigrations(e),e.sort((t,r)=>t.timestamp-r.timestamp)}checkForDuplicateMigrations(e){const t=e.map(i=>i.name),r=Array.from(new Set(t.filter((i,a)=>t.indexOf(i)<a)));if(r.length>0)throw Error(`Duplicate migrations: ${r.join(", ")}`)}getLatestTimestampMigration(e){const t=e.map(r=>r).sort((r,i)=>(r.timestamp-i.timestamp)*-1);return t.length>0?t[0]:void 0}getLatestExecutedMigration(e){return e.length>0?e[0]:void 0}async insertExecutedMigration(e,t){const r={};this.connection.driver.options.type==="mssql"?(r.timestamp=new Cr(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),r.name=new Cr(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(r.timestamp=t.timestamp,r.name=t.name),this.connection.driver.options.type==="mongodb"?await e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insertOne(r):await e.manager.createQueryBuilder().insert().into(this.migrationsTable).values(r).execute()}async deleteExecutedMigration(e,t){const r={};if(this.connection.driver.options.type==="mssql"?(r.timestamp=new Cr(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),r.name=new Cr(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(r.timestamp=t.timestamp,r.name=t.name),this.connection.driver.options.type==="mongodb")await e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(r);else{const i=e.manager.createQueryBuilder();await i.delete().from(this.migrationsTable).where(`${i.escape("timestamp")} = :timestamp`).andWhere(`${i.escape("name")} = :name`).setParameters(r).execute()}}async withQueryRunner(e){const t=this.queryRunner||this.connection.createQueryRunner();try{return await e(t)}finally{this.queryRunner||await t.release()}}}function yc(n,e,t){let r=[],i={};return function a(s){i[s]=!0,r.push(s),n[s].forEach(function(o){if(!i[o])a(o);else if(r.indexOf(o)>=0)throw r.push(o),new L(`Dependency Cycle Found: ${r.join(" -> ")}`)}),r.pop(),(!e||n[s].length===0)&&t.indexOf(s)===-1&&t.push(s)}}class X_{constructor(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}addNode(e,t){this.hasNode(e)||(arguments.length===2?this.nodes[e]=t:this.nodes[e]=e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])}removeNode(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach(function(t){Object.keys(t).forEach(function(r){let i=t[r].indexOf(e);i>=0&&t[r].splice(i,1)},this)}))}hasNode(e){return this.nodes.hasOwnProperty(e)}getNodeData(e){if(this.hasNode(e))return this.nodes[e];throw new L(`Node does not exist: ${e}`)}setNodeData(e,t){if(this.hasNode(e))this.nodes[e]=t;else throw new L(`Node does not exist: ${e}`)}addDependency(e,t){if(!this.hasNode(e))throw new L(`Node does not exist: ${e}`);if(!this.hasNode(t))throw new L(`Node does not exist: ${t}`);return this.outgoingEdges[e].indexOf(t)===-1&&this.outgoingEdges[e].push(t),this.incomingEdges[t].indexOf(e)===-1&&this.incomingEdges[t].push(e),!0}removeDependency(e,t){let r;this.hasNode(e)&&(r=this.outgoingEdges[e].indexOf(t),r>=0&&this.outgoingEdges[e].splice(r,1)),this.hasNode(t)&&(r=this.incomingEdges[t].indexOf(e),r>=0&&this.incomingEdges[t].splice(r,1))}dependenciesOf(e,t){if(this.hasNode(e)){let r=[];yc(this.outgoingEdges,t,r)(e);let a=r.indexOf(e);return a>=0&&r.splice(a,1),r}else throw new L(`Node does not exist: ${e}`)}dependantsOf(e,t){if(this.hasNode(e)){let r=[];yc(this.incomingEdges,t,r)(e);let a=r.indexOf(e);return a>=0&&r.splice(a,1),r}else throw new L(`Node does not exist: ${e}`)}overallOrder(e){let t=this,r=[],i=Object.keys(this.nodes);if(i.length===0)return r;{let a=yc(this.outgoingEdges,!1,[]);i.forEach(function(o){a(o)});let s=yc(this.outgoingEdges,e,r);return i.filter(function(o){return t.incomingEdges[o].length===0}).forEach(function(o){s(o)}),r}}}class Bb{static isGreaterOrEqual(e,t){const r=dE(e),i=dE(t);return r[0]>i[0]||r[0]===i[0]&&r[1]>i[1]||r[0]===i[0]&&r[1]===i[1]&&r[2]>=i[2]}}function dE(n=""){const e=[0,0,0];return n.split(".").forEach((t,r)=>e[r]=parseInt(t,10)),e}class me{static isSQLiteFamily(e){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(e.options.type)}static isMySQLFamily(e){return["mysql","mariadb"].includes(e.options.type)}static isReleaseVersionOrGreater(e,t){return e.version!=null&&Bb.isGreaterOrEqual(e.version,t)}static isPostgresFamily(e){return["postgres","aurora-postgres","cockroachdb"].includes(e.options.type)}static buildDriverOptions(e,t){if(e.url){const r=this.parseConnectionUrl(e.url);t&&t.useSid&&r.database&&(r.sid=r.database);for(const i of Object.keys(r))typeof r[i]>"u"&&delete r[i];return Object.assign({},e,r)}return Object.assign({},e)}static buildMongoDBDriverOptions(e,t){if(e.url){const r=this.parseMongoDBConnectionUrl(e.url);t&&t.useSid&&r.database&&(r.sid=r.database);for(const i of Object.keys(r))typeof r[i]>"u"&&delete r[i];return Object.assign({},e,r)}return Object.assign({},e)}static buildAlias({maxAliasLength:e},t,...r){const i=r.length===1?r[0]:r.join(t&&t.joiner?t.joiner:"_");if(e&&e>0&&i.length>e){if(t&&t.shorten===!0){const a=Db(i);if(a.length<e)return a}return x_(i,{length:e})}return i}static buildColumnAlias({maxAliasLength:e},t,...r){return typeof t=="string"?(r.unshift(t),t={shorten:!1,joiner:"_"}):t=Object.assign({shorten:!1,joiner:"_"},t),this.buildAlias({maxAliasLength:e},t,...r)}static parseConnectionUrl(e){const t=e.split(":")[0],r=e.indexOf("//"),i=e.substr(r+2),a=i.indexOf("/"),s=a!==-1?i.substr(0,a):i;let o=a!==-1?i.substr(a+1):void 0;o&&o.indexOf("?")!==-1&&(o=o.substr(0,o.indexOf("?")));const l=s.lastIndexOf("@"),u=s.substr(0,l),c=s.substr(l+1);let d=u,h="";const p=u.indexOf(":");p!==-1&&(d=u.substr(0,p),h=u.substr(p+1));const[g,E]=c.split(":");return{type:t,host:g,username:decodeURIComponent(d),password:decodeURIComponent(h),port:E?parseInt(E):void 0,database:o||void 0}}static parseMongoDBConnectionUrl(e){const t=e.split(":")[0],r=e.indexOf("//"),i=e.substr(r+2),a=i.indexOf("/"),s=a!==-1?i.substr(0,a):i;let o=a!==-1?i.substr(a+1):void 0,l="",u,c,d,h,p={};if(o&&o.indexOf("?")!==-1){l=o.substr(o.indexOf("?")+1,o.length);const D=l.split("&");let F,Q;D.forEach(W=>{F=W.split("=")[0],Q=W.split("=")[1],p[F]=Q}),h=p.replicaSet,o=o.substr(0,o.indexOf("?"))}const g=s.lastIndexOf("@"),E=s.substr(0,g),A=s.substr(g+1);let b=E,T="";const C=E.indexOf(":");C!==-1&&(b=E.substr(0,C),T=E.substr(C+1)),h?d=A:[u,c]=A.split(":");let P={type:t,host:u,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(T),port:c?parseInt(c):void 0,database:o||void 0};for(const[D,F]of Object.entries(p))P[D]=F;return P}}class Z_{validateMany(e,t){e.forEach(r=>this.validate(r,e,t)),this.validateDependencies(e),this.validateEagerRelations(e)}validate(e,t,r){if(!e.primaryColumns.length&&!e.isJunction)throw new F_(e);if(e.primaryColumns.length>1&&!e.primaryColumns.every((s,o,l)=>s.primaryKeyConstraintName===l[0].primaryKeyConstraintName))throw new L(`Entity ${e.name} has multiple primary columns with different constraint names. Constraint names should be the equal.`);if(e.inheritancePattern==="STI"||e.tableType==="entity-child"){if(!e.discriminatorColumn)throw new L(`Entity ${e.name} using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?`);if(typeof e.discriminatorValue>"u")throw new L(`Entity ${e.name} has an undefined discriminator value. Discriminator value should be defined.`);const a=t.find(s=>s!==e&&(s.inheritancePattern==="STI"||s.tableType==="entity-child")&&s.tableName===e.tableName&&s.discriminatorValue===e.discriminatorValue&&s.inheritanceTree.some(o=>e.inheritanceTree.indexOf(o)!==-1));if(a)throw new L(`Entities ${e.name} and ${a.name} have the same discriminator values. Make sure they are different while using the @ChildEntity decorator.`)}if(e.relationCounts.forEach(a=>{if(a.relation.isManyToOne||a.relation.isOneToOne)throw new L("Relation count can not be implemented on ManyToOne or OneToOne relations.")}),r.options.type!=="mongodb"&&e.columns.filter(a=>!a.isVirtualProperty).forEach(a=>{const s=r.normalizeType(a);if(r.supportedDataTypes.indexOf(s)===-1)throw new z_(a,s,r.options.type);if(a.length&&r.withLengthColumnTypes.indexOf(s)===-1)throw new L(`Column ${a.propertyName} of Entity ${e.name} does not support length property.`);if(a.type==="enum"&&!a.enum&&!a.enumName)throw new L(`Column "${a.propertyName}" of Entity "${e.name}" is defined as enum, but missing "enum" or "enumName" properties.`)}),(me.isMySQLFamily(r)||r.options.type==="aurora-mysql")&&e.columns.filter(s=>s.isGenerated&&s.generationStrategy!=="uuid").length>1)throw new L(`Error in ${e.name} entity. There can be only one auto-increment column in MySql table.`);if(me.isMySQLFamily(r)&&t.filter(s=>s.database).length===0&&!r.database)throw new J_("database");if(r.options.type==="mssql"&&e.columns.filter(s=>s.charset).length>1)throw new L("Character set specifying is not supported in Sql Server");if(r.options.type==="postgres"){const a=e.columns.find(s=>s.asExpression&&(!s.generatedType||s.generatedType==="VIRTUAL"));if(a)throw new L(`Column "${a.propertyName}" of Entity "${e.name}" is defined as VIRTUAL, but Postgres supports only STORED generated columns.`)}const i=e.create(void 0,{fromDeserializer:!0});e.relations.forEach(a=>{if(a.isManyToMany||a.isOneToMany){if(a.persistenceEnabled===!1)return;const s=a.getEntityValue(i);if(Array.isArray(s))throw new W_(a)}}),e.relations.forEach(a=>{if(r.supportedOnDeleteTypes&&a.onDelete&&!r.supportedOnDeleteTypes.includes(a.onDelete))throw new L(`OnDeleteType "${a.onDelete}" is not supported for ${r.options.type}!`);if(r.supportedOnUpdateTypes&&a.onUpdate&&!r.supportedOnUpdateTypes.includes(a.onUpdate))throw new L(`OnUpdateType "${a.onUpdate}" is not valid for ${r.options.type}!`)}),e.relations.forEach(a=>{if(a.isCascadeRemove&&a.inverseRelation&&a.inverseRelation.isCascadeRemove)throw new L(`Relation ${e.name}#${a.propertyName} and ${a.inverseRelation.entityMetadata.name}#${a.inverseRelation.propertyName} both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.`)}),e.eagerRelations.forEach(a=>{})}validateDependencies(e){const t=new X_;e.forEach(r=>{t.addNode(r.name)}),e.forEach(r=>{r.relationsWithJoinColumns.filter(i=>!i.isNullable).forEach(i=>{t.addDependency(r.name,i.inverseEntityMetadata.name)})});try{t.overallOrder()}catch(r){throw new B_(r.toString().replace("Error: Dependency Cycle Found: ",""))}}validateEagerRelations(e){e.forEach(t=>{t.eagerRelations.forEach(r=>{if(r.inverseRelation&&r.inverseRelation.isEager)throw new L(`Circular eager relations are disallowed. ${t.targetName}#${r.propertyPath} contains "eager: true", and its inverse side ${r.inverseEntityMetadata.targetName}#${r.inverseRelation.propertyPath} contains "eager: true" as well. Remove "eager: true" from one side of the relation.`)})})}}class e1{}class t1{}class n1{}class Fb{}class r1{}class i1{}class a1{}class hE{}class s1{}class o1{}class l1{}class ln{static isFindOneOptions(e){const t=e;return t&&(Array.isArray(t.select)||Array.isArray(t.relations)||typeof t.select=="object"||typeof t.relations=="object"||typeof t.where=="object"||typeof t.join=="object"||typeof t.order=="object"||typeof t.cache=="object"||typeof t.cache=="boolean"||typeof t.cache=="number"||typeof t.comment=="string"||typeof t.lock=="object"||typeof t.loadRelationIds=="object"||typeof t.loadRelationIds=="boolean"||typeof t.loadEagerRelations=="boolean"||typeof t.withDeleted=="boolean"||typeof t.relationLoadStrategy=="string"||typeof t.transaction=="boolean")}static isFindManyOptions(e){const t=e;return t&&(this.isFindOneOptions(t)||typeof t.skip=="number"||typeof t.take=="number"||typeof t.skip=="string"||typeof t.take=="string")}static extractFindManyOptionsAlias(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias}static applyOptionsToTreeQueryBuilder(e,t){if(t!=null&&t.relations){const r=[...t.relations];if(ln.applyRelationsRecursively(e,r,e.expressionMap.mainAlias.name,e.expressionMap.mainAlias.metadata,""),r.length>0)throw new Q_(r)}return e}static applyRelationsRecursively(e,t,r,i,a){let s=[];if(a){const o=new RegExp("^"+a.replace(".","\\.")+"\\.");s=t.filter(l=>l.match(o)).map(l=>i.findRelationWithPropertyPath(l.replace(o,""))).filter(l=>l)}else s=t.map(o=>i.findRelationWithPropertyPath(o)).filter(o=>o);s.forEach(o=>{let l=me.buildAlias(e.connection.driver,{joiner:"__"},r,o.propertyPath);const u=r+"."+o.propertyPath;e.expressionMap.relationLoadStrategy==="query"?e.concatRelationMetadata(o):e.leftJoinAndSelect(u,l),t.splice(t.indexOf(a?a+"."+o.propertyPath:o.propertyPath),1);let c,d;if(e.expressionMap.relationLoadStrategy==="query")c=o.inverseEntityMetadata,d=l;else{const h=e.expressionMap.joinAttributes.find(p=>p.entityOrProperty===u);c=h.metadata,d=h.alias.name}if(!d||!c)throw new Qr(o.propertyPath,i);if(this.applyRelationsRecursively(e,t,d,c,a?a+"."+o.propertyPath:o.propertyPath),e.expressionMap.relationLoadStrategy==="join"){const h=i.relations.find(p=>p.propertyName===o.propertyPath);h&&this.joinEagerRelations(e,l,h.inverseEntityMetadata)}})}static joinEagerRelations(e,t,r){r.eagerRelations.forEach(i=>{let a=me.buildAlias(e.connection.driver,{joiner:"__"},t,i.propertyPath),s=!0;for(const u of e.expressionMap.joinAttributes)if(!(u.condition!==void 0||u.mapToProperty!==void 0||u.isMappingMany!==void 0||u.direction!=="LEFT"||u.entityOrProperty!==`${t}.${i.propertyPath}`)){s=!1,a=u.alias.name;break}const o=!!e.expressionMap.joinAttributes.find(u=>u.alias.name===a);s&&!o&&e.leftJoin(t+"."+i.propertyPath,a);let l=!0;for(const u of e.expressionMap.selects)if(!(u.aliasName!==void 0||u.virtual!==void 0||u.selection!==a)){l=!1;break}l&&e.addSelect(a),this.joinEagerRelations(e,a,i.inverseEntityMetadata)})}}class ka{static createRelationMaps(e,t,r,i){return i.map(a=>{var s;const o=t.treeParentRelation.joinColumns[0],l=(s=o.referencedColumn)!==null&&s!==void 0?s:t.primaryColumns[0],u=o.givenDatabaseName||o.databaseName,c=l.givenDatabaseName||l.databaseName,d=a[r+"_"+c],h=a[r+"_"+u];return{id:e.connection.driver.prepareHydratedValue(d,l),parentId:e.connection.driver.prepareHydratedValue(h,o)}})}static buildChildrenEntityTree(e,t,r,i,a){var s;const o=e.treeChildrenRelation.propertyName;if(a.depth===0){t[o]=[];return}const u=(s=e.treeParentRelation.joinColumns[0].referencedColumn)!==null&&s!==void 0?s:e.primaryColumns[0],c=u.getEntityValue(t),d=i.filter(p=>p.parentId===c),h=new Set(d.map(p=>p.id));t[o]=r.filter(p=>h.has(u.getEntityValue(p))),t[o].forEach(p=>{ka.buildChildrenEntityTree(e,p,r,i,{...a,depth:a.depth-1})})}static buildParentEntityTree(e,t,r,i){var a;const s=e.treeParentRelation.propertyName,l=(a=e.treeParentRelation.joinColumns[0].referencedColumn)!==null&&a!==void 0?a:e.primaryColumns[0],u=l.getEntityValue(t),c=i.find(h=>h.id===u),d=r.find(h=>c?l.getEntityValue(h)===c.parentId:!1);d&&(t[s]=d,ka.buildParentEntityTree(e,t[s],r,i))}}class kb{get metadata(){return this.manager.connection.getMetadata(this.target)}constructor(e,t,r){this.target=e,this.manager=t,this.queryRunner=r}createQueryBuilder(e,t){return this.manager.createQueryBuilder(this.metadata.target,e||this.metadata.targetName,t||this.queryRunner)}hasId(e){return this.manager.hasId(this.metadata.target,e)}getId(e){return this.manager.getId(this.metadata.target,e)}create(e){return this.manager.create(this.metadata.target,e)}merge(e,...t){return this.manager.merge(this.metadata.target,e,...t)}preload(e){return this.manager.preload(this.metadata.target,e)}save(e,t){return this.manager.save(this.metadata.target,e,t)}remove(e,t){return this.manager.remove(this.metadata.target,e,t)}softRemove(e,t){return this.manager.softRemove(this.metadata.target,e,t)}recover(e,t){return this.manager.recover(this.metadata.target,e,t)}insert(e){return this.manager.insert(this.metadata.target,e)}update(e,t){return this.manager.update(this.metadata.target,e,t)}upsert(e,t){return this.manager.upsert(this.metadata.target,e,t)}delete(e){return this.manager.delete(this.metadata.target,e)}softDelete(e){return this.manager.softDelete(this.metadata.target,e)}restore(e){return this.manager.restore(this.metadata.target,e)}exist(e){return this.manager.exists(this.metadata.target,e)}count(e){return this.manager.count(this.metadata.target,e)}countBy(e){return this.manager.countBy(this.metadata.target,e)}sum(e,t){return this.manager.sum(this.metadata.target,e,t)}average(e,t){return this.manager.average(this.metadata.target,e,t)}minimum(e,t){return this.manager.minimum(this.metadata.target,e,t)}maximum(e,t){return this.manager.maximum(this.metadata.target,e,t)}async find(e){return this.manager.find(this.metadata.target,e)}async findBy(e){return this.manager.findBy(this.metadata.target,e)}findAndCount(e){return this.manager.findAndCount(this.metadata.target,e)}findAndCountBy(e){return this.manager.findAndCountBy(this.metadata.target,e)}async findByIds(e){return this.manager.findByIds(this.metadata.target,e)}async findOne(e){return this.manager.findOne(this.metadata.target,e)}async findOneBy(e){return this.manager.findOneBy(this.metadata.target,e)}async findOneById(e){return this.manager.findOneById(this.metadata.target,e)}async findOneOrFail(e){return this.manager.findOneOrFail(this.metadata.target,e)}async findOneByOrFail(e){return this.manager.findOneByOrFail(this.metadata.target,e)}query(e,t){return this.manager.query(e,t)}clear(){return this.manager.clear(this.metadata.target)}increment(e,t,r){return this.manager.increment(this.metadata.target,e,t,r)}decrement(e,t,r){return this.manager.decrement(this.metadata.target,e,t,r)}extend(e){const t=this.constructor,{target:r,manager:i,queryRunner:a}=this,s=new class extends t{}(r,i,a);return Object.assign(s,e),s}}class u1 extends kb{async findTrees(e){const t=await this.findRoots(e);return await Promise.all(t.map(r=>this.findDescendantsTree(r,e))),t}findRoots(e){const t=o=>this.manager.connection.driver.escape(o),r=o=>this.manager.connection.driver.escape(o),i=this.metadata.treeParentRelation.joinColumns[0],a=i.givenDatabaseName||i.databaseName,s=this.createQueryBuilder("treeEntity");return ln.applyOptionsToTreeQueryBuilder(s,e),s.where(`${t("treeEntity")}.${r(a)} IS NULL`).getMany()}findDescendants(e,t){const r=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);return ln.applyOptionsToTreeQueryBuilder(r,t),r.getMany()}async findDescendantsTree(e,t){const r=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);ln.applyOptionsToTreeQueryBuilder(r,t);const i=await r.getRawAndEntities(),a=ka.createRelationMaps(this.manager,this.metadata,"treeEntity",i.raw);return ka.buildChildrenEntityTree(this.metadata,e,i.entities,a,{depth:-1,...t}),e}countDescendants(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()}createDescendantsQueryBuilder(e,t,r){const i=a=>this.manager.connection.driver.escape(a);if(this.metadata.treeType==="closure-table"){const a=this.metadata.closureJunctionTable.descendantColumns.map(l=>i(t)+"."+i(l.propertyPath)+" = "+i(e)+"."+i(l.referencedColumn.propertyPath)).join(" AND "),s={},o=this.metadata.closureJunctionTable.ancestorColumns.map(l=>(s[l.referencedColumn.propertyName]=l.referencedColumn.getEntityValue(r),i(t)+"."+i(l.propertyPath)+" = :"+l.referencedColumn.propertyName)).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,a).where(o).setParameters(s)}else if(this.metadata.treeType==="nested-set"){const a=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath,s={},o=this.metadata.treeParentRelation.joinColumns.map(l=>{const u=l.referencedColumn.propertyPath.replace(".","_");return s[u]=l.referencedColumn.getEntityValue(r),"joined."+l.referencedColumn.propertyPath+" = :"+u}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",a).where(o,s)}else if(this.metadata.treeType==="materialized-path")return this.createQueryBuilder(e).where(a=>{const s=a.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(r));return me.isSQLiteFamily(this.manager.connection.driver)?`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE ${s.getQuery()} || '%'`:`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE NULLIF(CONCAT(${s.getQuery()}, '%'), '%')`});throw new L("Supported only in tree entities")}findAncestors(e,t){const r=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);return ln.applyOptionsToTreeQueryBuilder(r,t),r.getMany()}async findAncestorsTree(e,t){const r=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);ln.applyOptionsToTreeQueryBuilder(r,t);const i=await r.getRawAndEntities(),a=ka.createRelationMaps(this.manager,this.metadata,"treeEntity",i.raw);return ka.buildParentEntityTree(this.metadata,e,i.entities,a),e}countAncestors(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()}createAncestorsQueryBuilder(e,t,r){if(this.metadata.treeType==="closure-table"){const i=this.metadata.closureJunctionTable.ancestorColumns.map(o=>t+"."+o.propertyPath+" = "+e+"."+o.referencedColumn.propertyPath).join(" AND "),a={},s=this.metadata.closureJunctionTable.descendantColumns.map(o=>(a[o.referencedColumn.propertyName]=o.referencedColumn.getEntityValue(r),t+"."+o.propertyPath+" = :"+o.referencedColumn.propertyName)).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(s).setParameters(a)}else if(this.metadata.treeType==="nested-set"){const i="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath,a={},s=this.metadata.treeParentRelation.joinColumns.map(o=>{const l=o.referencedColumn.propertyPath.replace(".","_");return a[l]=o.referencedColumn.getEntityValue(r),"joined."+o.referencedColumn.propertyPath+" = :"+l}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",i).where(s,a)}else if(this.metadata.treeType==="materialized-path")return this.createQueryBuilder(e).where(i=>{const a=i.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(r));return me.isSQLiteFamily(this.manager.connection.driver)?`${a.getQuery()} LIKE ${e}.${this.metadata.materializedPathColumn.propertyPath} || '%'`:`${a.getQuery()} LIKE CONCAT(${e}.${this.metadata.materializedPathColumn.propertyPath}, '%')`});throw new L("Supported only in tree entities")}}class c1{transform(e,t,r,i=!1){return this.groupAndTransform(e,t,r,i),e}groupAndTransform(e,t,r,i=!1){r.nonVirtualColumns.forEach(a=>{const s=a.getEntityValue(t);s!==void 0&&a.setEntityValue(e,s)}),r.relations.length&&r.relations.forEach(a=>{let s=a.getEntityValue(e);const o=a.getEntityValue(t,i);if(o!==void 0)if(a.isOneToMany||a.isManyToMany){if(!Array.isArray(o))return;s||(s=[],a.setEntityValue(e,s)),o.forEach(l=>{let u=s.find(d=>a.inverseEntityMetadata.compareEntities(l,d));const c=a.inverseEntityMetadata.findInheritanceMetadata(l);u||(u=c.create(void 0,{fromDeserializer:!0}),s.push(u)),this.groupAndTransform(u,l,c,i)})}else{if(!Ue.isObject(o)){Ue.isObject(s)||a.setEntityValue(e,o);return}const l=a.inverseEntityMetadata.findInheritanceMetadata(o);s||(s=l.create(void 0,{fromDeserializer:!0}),a.setEntityValue(e,s)),this.groupAndTransform(s,o,l,i)}})}}class d1{constructor(e,t,r,i){this.plainEntity=e,this.metadata=t,this.parentLoadMapItem=r,this.relation=i}get target(){return this.metadata.target}get id(){return this.metadata.getEntityIdMixedMap(this.plainEntity)}}class h1{constructor(){this.loadMapItems=[]}get mainLoadMapItem(){return this.loadMapItems.find(e=>!e.relation&&!e.parentLoadMapItem)}addLoadMap(e){this.loadMapItems.find(r=>r.target===e.target&&r.id===e.id)||this.loadMapItems.push(e)}fillEntities(e,t){t.forEach(r=>{const i=this.loadMapItems.find(a=>a.target===e&&a.metadata.compareEntities(r,a.plainEntity));i&&(i.entity=r)})}groupByTargetIds(){const e=[];return this.loadMapItems.forEach(t=>{let r=e.find(i=>i.target===t.target);r||(r={target:t.target,ids:[]},e.push(r)),r.ids.push(t.id)}),e}}class f1{constructor(e){this.manager=e}async transform(e,t){if(!t.hasAllPrimaryKeys(e))return Promise.reject("Given object does not have a primary column, cannot transform it to database entity.");const r=new h1,i=(a,s,o,l)=>{const u=new d1(a,s,o,l);r.addLoadMap(u),s.extractRelationValuesFromEntity(a,t.relations).filter(c=>c!=null).forEach(([c,d,h])=>i(d,h,u,c))};return i(e,t),await Promise.all(r.groupByTargetIds().map(a=>this.manager.findByIds(a.target,a.ids).then(s=>r.fillEntities(a.target,s)))),r.loadMapItems.forEach(a=>{!a.relation||!a.entity||!a.parentLoadMapItem||!a.parentLoadMapItem.entity||(a.relation.isManyToMany||a.relation.isOneToMany?(a.parentLoadMapItem.entity[a.relation.propertyName]||(a.parentLoadMapItem.entity[a.relation.propertyName]=[]),a.parentLoadMapItem.entity[a.relation.propertyName].push(a.entity)):a.parentLoadMapItem.entity[a.relation.propertyName]=a.entity)}),r.mainLoadMapItem?r.mainLoadMapItem.entity:void 0}}class p1{get repository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new mf(this.constructor);return this.manager.getRepository(e)}get treeRepository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new mf(this.constructor);return this.manager.getTreeRepository(e)}createQueryBuilder(e){const t=this.getCustomRepositoryTarget(this.constructor);if(!t)throw new mf(this.constructor);return this.manager.getRepository(t).createQueryBuilder(e)}createQueryBuilderFor(e,t){return this.getRepositoryFor(e).createQueryBuilder(t)}getRepositoryFor(e){return this.manager.getRepository(e)}getTreeRepositoryFor(e){return this.manager.getTreeRepository(e)}getCustomRepositoryTarget(e){const t=Wt().entityRepositories.find(r=>r.target===(typeof e=="function"?e:e.constructor));if(!t)throw new $b(e);return t.entity}}class fE{constructor(e){this.subjects=[...e],this.metadatas=this.getUniqueMetadatas(this.subjects)}sort(e){if(!this.metadatas.length)return this.subjects;const t=[];if(e==="delete"){const o=this.subjects.filter(l=>!l.entity&&!l.databaseEntity);t.push(...o),this.removeAlreadySorted(o)}const r=this.getNonNullableDependencies();let i=this.toposort(r);e==="insert"&&(i=i.reverse()),i.forEach(o=>{const l=this.subjects.filter(u=>u.metadata.targetName===o||u.metadata.inheritanceTree.some(c=>c.name===o));t.push(...l),this.removeAlreadySorted(l)});const a=this.getDependencies();let s=this.toposort(a);return e==="insert"&&(s=s.reverse()),s.forEach(o=>{const l=this.subjects.filter(u=>u.metadata.targetName===o);t.push(...l),this.removeAlreadySorted(l)}),t.push(...this.subjects),t}removeAlreadySorted(e){e.forEach(t=>{this.subjects.splice(this.subjects.indexOf(t),1)})}getUniqueMetadatas(e){const t=[];return e.forEach(r=>{t.indexOf(r.metadata)===-1&&t.push(r.metadata)}),t}getNonNullableDependencies(){return this.metadatas.reduce((e,t)=>(t.relationsWithJoinColumns.forEach(r=>{r.isNullable||e.push([t.targetName,r.inverseEntityMetadata.targetName])}),e),[])}getDependencies(){return this.metadatas.reduce((e,t)=>(t.relationsWithJoinColumns.forEach(r=>{r.inverseEntityMetadata!==t&&e.push([t.targetName,r.inverseEntityMetadata.targetName])}),e),[])}toposort(e){function t(u){let c=[];for(let d=0,h=u.length;d<h;d++){let p=u[d];c.indexOf(p[0])<0&&c.push(p[0]),c.indexOf(p[1])<0&&c.push(p[1])}return c}const r=t(e);let i=r.length,a=new Array(i),s={},o=i;for(;o--;)s[o]||l(r[o],o,[]);function l(u,c,d){if(d.indexOf(u)>=0)throw new L("Cyclic dependency: "+JSON.stringify(u));if(!~r.indexOf(u))throw new L("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(u));if(s[c])return;s[c]=!0;let h=e.filter(function(p){return p[0]===u});if(c=h.length){let p=d.concat(u);do{let g=h[--c][1];l(g,r.indexOf(g),p)}while(c)}a[--i]=u}return a}}function Ql(n){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ql(n)}function m1(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function y1(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}var Ub=6e4,jb=36e5;function g1(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Dp(n,e){return Dp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Dp(n,e)}function v1(n,e){if(Ql(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(Ql(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function E1(n){var e=v1(n,"string");return Ql(e)=="symbol"?e:String(e)}function pE(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,E1(r.key),r)}}function w1(n,e,t){return e&&pE(n.prototype,e),t&&pE(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function T1(n,e){var t;y1(1,arguments);var r=m1((t=e==null?void 0:e.additionalDigits)!==null&&t!==void 0?t:2);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof n=="string"||Object.prototype.toString.call(n)==="[object String]"))return new Date(NaN);var i=S1(n),a;if(i.date){var s=A1(i.date,r);a=R1(s.restDateString,s.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);var o=a.getTime(),l=0,u;if(i.time&&(l=x1(i.time),isNaN(l)))return new Date(NaN);if(i.timezone){if(u=_1(i.timezone),isNaN(u))return new Date(NaN)}else{var c=new Date(o+l),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(o+l+u)}var gc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},b1=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,N1=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,C1=/^([+-])(\d{2})(?::?(\d{2}))?$/;function S1(n){var e={},t=n.split(gc.dateTimeDelimiter),r;if(t.length>2)return e;if(/:/.test(t[0])?r=t[0]:(e.date=t[0],r=t[1],gc.timeZoneDelimiter.test(e.date)&&(e.date=n.split(gc.timeZoneDelimiter)[0],r=n.substr(e.date.length,n.length))),r){var i=gc.timezone.exec(r);i?(e.time=r.replace(i[1],""),e.timezone=i[1]):e.time=r}return e}function A1(n,e){var t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=n.match(t);if(!r)return{year:NaN,restDateString:""};var i=r[1]?parseInt(r[1]):null,a=r[2]?parseInt(r[2]):null;return{year:a===null?i:a*100,restDateString:n.slice((r[1]||r[2]).length)}}function R1(n,e){if(e===null)return new Date(NaN);var t=n.match(b1);if(!t)return new Date(NaN);var r=!!t[4],i=Zo(t[1]),a=Zo(t[2])-1,s=Zo(t[3]),o=Zo(t[4]),l=Zo(t[5])-1;if(r)return D1(e,o,l)?P1(e,o,l):new Date(NaN);var u=new Date(0);return!O1(e,a,s)||!I1(e,i)?new Date(NaN):(u.setUTCFullYear(e,a,Math.max(i,s)),u)}function Zo(n){return n?parseInt(n):1}function x1(n){var e=n.match(N1);if(!e)return NaN;var t=gf(e[1]),r=gf(e[2]),i=gf(e[3]);return $1(t,r,i)?t*jb+r*Ub+i*1e3:NaN}function gf(n){return n&&parseFloat(n.replace(",","."))||0}function _1(n){if(n==="Z")return 0;var e=n.match(C1);if(!e)return 0;var t=e[1]==="+"?-1:1,r=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return L1(r,i)?t*(r*jb+i*Ub):NaN}function P1(n,e,t){var r=new Date(0);r.setUTCFullYear(n,0,4);var i=r.getUTCDay()||7,a=(e-1)*7+t+1-i;return r.setUTCDate(r.getUTCDate()+a),r}var M1=[31,null,31,30,31,30,31,31,30,31,30,31];function Qb(n){return n%400===0||n%4===0&&n%100!==0}function O1(n,e,t){return e>=0&&e<=11&&t>=1&&t<=(M1[e]||(Qb(n)?29:28))}function I1(n,e){return e>=1&&e<=(Qb(n)?366:365)}function D1(n,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function $1(n,e,t){return n===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&n>=0&&n<25}function L1(n,e){return e>=0&&e<=59}class Ie{static normalizeHydratedDate(e){return e&&(typeof e=="string"?new Date(e):e)}static mixedDateToDateString(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e}static mixedDateToDate(e,t=!1,r=!0){let i=typeof e=="string"?T1(e):e;return t&&(i=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds())),r||i.setUTCMilliseconds(0),i}static mixedDateToTimeString(e,t=!1){return e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e}static mixedTimeToDate(e){if(typeof e=="string"){const[t,r,i]=e.split(":"),a=new Date;return t&&a.setHours(parseInt(t)),r&&a.setMinutes(parseInt(r)),i&&a.setSeconds(parseInt(i)),a}return e}static mixedTimeToString(e,t=!1){return e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e,typeof e=="string"?e.split(":").map(r=>r.length===1?"0"+r:r).join(":"):e}static mixedDateToDatetimeString(e,t){if(typeof e=="string"&&(e=new Date(e)),e instanceof Date){let r=this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds());t&&(r+=`.${this.formatMilliseconds(e.getMilliseconds())}`),e=r}return e}static mixedDateToUtcDatetimeString(e){return typeof e=="string"&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear(),4)+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e}static simpleArrayToString(e){return Array.isArray(e)?e.map(t=>String(t)).join(","):e}static stringToSimpleArray(e){return typeof e=="string"?e.length>0?e.split(","):[]:e}static simpleJsonToString(e){return JSON.stringify(e)}static stringToSimpleJson(e){return typeof e=="string"?JSON.parse(e):e}static simpleEnumToString(e){return""+e}static stringToSimpleEnum(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e}static formatZerolessValue(e,t=2){return`${"0".repeat(t)}${e}`.slice(-t)}static formatMilliseconds(e){return e<10?"00"+e:e<100?"0"+e:String(e)}}class be{static chunk(e,t){return Array.from(Array(Math.ceil(e.length/t)),(r,i)=>e.slice(i*t,i*t+t))}static splitClassesAndStrings(e){return[e.filter(t=>typeof t!="string"),e.filter(t=>typeof t=="string")]}static groupBy(e,t){return e.reduce((r,i)=>{const a=t(i);let s=r.find(o=>o.id===a);return s||(s={id:a,items:[]},r.push(s)),s.items.push(i),r},[])}static uniq(e,t){return e.reduce((r,i)=>{let a=!1;if(typeof t=="function"){const s=t(i);a=!!r.find(o=>t(o)===s)}else typeof t=="string"?a=!!r.find(s=>s[t]===i[t]):a=r.indexOf(i)!==-1;return a||r.push(i),r},[])}static isPlainObject(e){return e==null?!1:!e.constructor||e.constructor===Object}static mergeArrayKey(e,t,r,i){if(i.has(r)){e[t]=i.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){e[t]=r;return}e[t]||(e[t]=Array.isArray(r)?[]:{}),i.set(r,e[t]),this.merge(e[t],r,i),i.delete(r)}}static mergeObjectKey(e,t,r,i){if(i.has(r)){Object.assign(e,{[t]:i.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(e,{[t]:r});return}e[t]||Object.assign(e,{[t]:Array.isArray(r)?[]:{}}),i.set(r,e[t]),this.merge(e[t],r,i),i.delete(r)}}static merge(e,t,r=new Map){if(this.isPlainObject(e)&&this.isPlainObject(t))for(const i of Object.keys(t))i!=="__proto__"&&this.mergeObjectKey(e,i,t[i],r);if(Array.isArray(e)&&Array.isArray(t))for(let i=0;i<t.length;i++)this.mergeArrayKey(e,i,t[i],r)}static mergeDeep(e,...t){if(!t.length)return e;for(const r of t)be.merge(e,r);return e}static deepCompare(...e){let t,r,i,a;if(arguments.length<1)return!0;for(t=1,r=arguments.length;t<r;t++)if(i=[],a=[],!this.compare2Objects(i,a,arguments[0],arguments[t]))return!1;return!0}static deepValue(e,t){const r=t.split(".");for(let i=0,a=r.length;i<a;i++)e=e[r[i]];return e}static replaceEmptyObjectsWithBooleans(e){for(let t in e)e[t]&&typeof e[t]=="object"&&(Object.keys(e[t]).length===0?e[t]=!0:this.replaceEmptyObjectsWithBooleans(e[t]))}static propertyPathsToTruthyObject(e){let t={};for(let r of e){const i=r.split(".");if(!i.length)continue;(!t[i[0]]||t[i[0]]===!0)&&(t[i[0]]={});let a=t[i[0]];for(let[s,o]of i.entries())s!==0&&(a[o]?a=a[o]:s===i.length-1?(a[o]={},a=null):(a[o]={},a=a[o]))}return this.replaceEmptyObjectsWithBooleans(t),t}static compareIds(e,t){return e==null||t===void 0||t===null?!1:(typeof e.id=="string"&&typeof t.id=="string"||typeof e.id=="number"&&typeof t.id=="number")&&Object.keys(e).length===1&&Object.keys(t).length===1?e.id===t.id:be.deepCompare(e,t)}static toBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e==="true"||e==="1":typeof e=="number"?e>0:!1}static zipObject(e,t){return e.reduce((r,i,a)=>(r[i]=t[a],r),{})}static isArraysEqual(e,t){return e.length!==t.length?!1:e.every(r=>t.indexOf(r)!==-1)}static areMutuallyExclusive(...e){return!e.some(r=>{const i=e.filter(a=>a!==r);return r.some(a=>i.some(s=>s.includes(a)))})}static compare2Objects(e,t,r,i){let a;if(Number.isNaN(r)&&Number.isNaN(i)||r===i)return!0;if(r===null||i===null||r===void 0||i===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(i))return!0;if(typeof r=="function"&&typeof i=="function"||r instanceof Date&&i instanceof Date||r instanceof RegExp&&i instanceof RegExp||typeof r=="string"&&typeof i=="string"||typeof r=="number"&&typeof i=="number")return r.toString()===i.toString();if(!(typeof r=="object"&&typeof i=="object")||Object.prototype.isPrototypeOf.call(r,i)||Object.prototype.isPrototypeOf.call(i,r)||r.constructor!==i.constructor||r.prototype!==i.prototype||e.indexOf(r)>-1||t.indexOf(i)>-1)return!1;for(a in i){if(i.hasOwnProperty(a)!==r.hasOwnProperty(a))return!1;if(typeof i[a]!=typeof r[a])return!1}for(a in r){if(i.hasOwnProperty(a)!==r.hasOwnProperty(a))return!1;if(typeof i[a]!=typeof r[a])return!1;switch(typeof r[a]){case"object":case"function":if(e.push(r),t.push(i),!this.compare2Objects(e,t,r[a],i[a]))return!1;e.pop(),t.pop();break;default:if(r[a]!==i[a])return!1;break}}return!0}}class Ft{static transformFrom(e,t){return Array.isArray(e)?e.slice().reverse().reduce((i,a)=>a.from(i),t):e.from(t)}static transformTo(e,t){return Array.isArray(e)?e.reduce((r,i)=>i.to(r),t):e.to(t)}}class q1{compute(e){e.forEach(t=>{this.computeDiffColumns(t),this.computeDiffRelationalColumns(e,t)})}computeDiffColumns(e){e.entity&&e.metadata.columns.forEach(t=>{if(t.isVirtual||t.isDiscriminator)return;const r=e.changeMaps.find(a=>a.column===t);r&&e.changeMaps.splice(e.changeMaps.indexOf(r),1);const i=t.getEntityValue(e.entity);if(i!==void 0){if(e.databaseEntity){const a=t.type!=="json"&&t.type!=="jsonb";let s=t.getEntityValue(e.databaseEntity,a);if(t.relationMetadata){const l=t.relationMetadata.getEntityValue(e.entity);if(l!=null)return}let o=i;if(i!==null){switch(t.type){case"date":o=Ie.mixedDateToDateString(i);break;case"time":case"time with time zone":case"time without time zone":case"timetz":o=Ie.mixedDateToTimeString(i);break;case"datetime":case"datetime2":case Date:case"timestamp":case"timestamp without time zone":case"timestamp with time zone":case"timestamp with local time zone":case"timestamptz":o=Ie.mixedDateToUtcDatetimeString(i),s=Ie.mixedDateToUtcDatetimeString(s);break;case"json":case"jsonb":if(be.deepCompare(i,s))return;break;case"simple-array":o=Ie.simpleArrayToString(i),s=Ie.simpleArrayToString(s);break;case"simple-enum":o=Ie.simpleEnumToString(i),s=Ie.simpleEnumToString(s);break;case"simple-json":o=Ie.simpleJsonToString(i),s=Ie.simpleJsonToString(s);break}t.transformer&&(o=Ft.transformTo(t.transformer,i))}if(Buffer.isBuffer(o)&&Buffer.isBuffer(s)){if(o.equals(s))return}else if(o===s)return}e.diffColumns.includes(t)||e.diffColumns.push(t),e.changeMaps.push({column:t,value:i})}})}computeDiffRelationalColumns(e,t){t.entity&&t.metadata.relationsWithJoinColumns.forEach(r=>{let i=r.getEntityValue(t.entity);if(i===void 0)return;if(t.databaseEntity){let o=i;o!==null&&Ue.isObject(o)&&(o=r.getRelationIdMap(o));const l=r.getEntityValue(t.databaseEntity);if(be.compareIds(o,l))return;t.diffRelations.push(r)}const a=e.find(o=>o.mustBeInserted&&o.entity===i);a&&(i=a);const s=t.changeMaps.find(o=>o.relation===r);s?s.value=i:t.changeMaps.push({relation:r,value:i})})}}class $p{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class mE extends L{constructor(){super("Nested sets do not support multiple root entities.")}}class vf{constructor(e){this.queryRunner=e}async insert(e){const t=u=>this.queryRunner.connection.driver.escape(u),r=this.getTableName(e.metadata.tablePath),i=t(e.metadata.nestedSetLeftColumn.databaseName),a=t(e.metadata.nestedSetRightColumn.databaseName);let s=e.metadata.treeParentRelation.getEntityValue(e.entity);!s&&e.parentSubject&&e.parentSubject.entity&&(s=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const o=e.metadata.getEntityIdMap(s);let l;if(o&&(l=await this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.nestedSetRightColumn.propertyPath,"right").from(e.metadata.target,e.metadata.targetName).whereInIds(o).getRawOne().then(u=>{const c=u?u.right:void 0;return typeof c=="string"?parseInt(c):c})),l!==void 0)await this.queryRunner.query(`UPDATE ${r} SET ${i} = CASE WHEN ${i} > ${l} THEN ${i} + 2 ELSE ${i} END,${a} = ${a} + 2 WHERE ${a} >= ${l}`),be.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(l),e.metadata.nestedSetRightColumn.createValueMap(l+1));else{if(!await this.isUniqueRootEntity(e,s))throw new mE;be.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(1),e.metadata.nestedSetRightColumn.createValueMap(2))}}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let r=e.databaseEntity;if(!r&&t&&(r=e.metadata.treeChildrenRelation.getEntityValue(t).find(o=>Object.entries(e.identifier).every(([l,u])=>o[l]===u))),r===void 0||t===void 0)return;const i=e.metadata.treeParentRelation.getEntityValue(r),a=e.metadata.getEntityIdMap(i),s=e.metadata.getEntityIdMap(t);if(!be.compareIds(a,s)){if(t){const o=g=>this.queryRunner.connection.driver.escape(g),l=this.getTableName(e.metadata.tablePath),u=o(e.metadata.nestedSetLeftColumn.databaseName),c=o(e.metadata.nestedSetRightColumn.databaseName),d=e.metadata.getEntityIdMap(r);let h;d&&(h=(await this.getNestedSetIds(e.metadata,d))[0]);let p;if(s&&(p=(await this.getNestedSetIds(e.metadata,s))[0]),h!==void 0&&p!==void 0){const g=p.left>h.left,E=h.right-h.left+1;let A;g?A=p.left-h.right:A=p.right-h.left;const b=`WHEN ${u} >= ${h.left} AND ${u} < ${h.right} THEN ${u} + ${A} `,T=`WHEN ${c} > ${h.left} AND ${c} <= ${h.right} THEN ${c} + ${A} `;g?await this.queryRunner.query(`UPDATE ${l} SET ${u} = CASE WHEN ${u} > ${h.right} AND ${u} <= ${p.left} THEN ${u} - ${E} `+b+`ELSE ${u} END, ${c} = CASE WHEN ${c} > ${h.right} AND ${c} < ${p.left} THEN ${c} - ${E} `+T+`ELSE ${c} END`):await this.queryRunner.query(`UPDATE ${l} SET ${u} = CASE WHEN ${u} < ${h.left} AND ${u} > ${p.right} THEN ${u} + ${E} `+b+`ELSE ${u} END, ${c} = CASE WHEN ${c} < ${h.left} AND ${c} >= ${p.right} THEN ${c} + ${E} `+T+`ELSE ${c} END`)}}else if(!await this.isUniqueRootEntity(e,t))throw new mE}}async remove(e){Array.isArray(e)||(e=[e]);const t=e[0].metadata,r=u=>this.queryRunner.connection.driver.escape(u),i=this.getTableName(t.tablePath),a=r(t.nestedSetLeftColumn.databaseName),s=r(t.nestedSetRightColumn.databaseName);let o=[];for(const u of e){const c=t.getEntityIdMap(u.entity);c&&o.push(c)}let l=await this.getNestedSetIds(t,o);for(const u of l){const c=u.right-u.left+1;await this.queryRunner.query(`UPDATE ${i} SET ${a} = CASE WHEN ${a} > ${u.left} THEN ${a} - ${c} ELSE ${a} END, ${s} = CASE WHEN ${s} > ${u.right} THEN ${s} - ${c} ELSE ${s} END`)}}getNestedSetIds(e,t){const r={left:`${e.targetName}.${e.nestedSetLeftColumn.propertyPath}`,right:`${e.targetName}.${e.nestedSetRightColumn.propertyPath}`},i=this.queryRunner.manager.createQueryBuilder();return Object.entries(r).forEach(([a,s])=>{i.addSelect(s,a)}),i.from(e.target,e.targetName).whereInIds(t).orderBy(r.right,"DESC").getRawMany().then(a=>{const s=[];for(const o of a){const l={};for(const u of Object.keys(r)){const c=o?o[u]:void 0;l[u]=typeof c=="string"?parseInt(c):c}s.push(l)}return s})}async isUniqueRootEntity(e,t){const r=u=>this.queryRunner.connection.driver.escape(u),i=this.getTableName(e.metadata.tablePath),a=[],s=e.metadata.treeParentRelation.joinColumns.map(u=>{const c=r(u.databaseName),d=u.getEntityValue(t);if(d==null)return`${c} IS NULL`;a.push(d);const h=this.queryRunner.connection.driver.createParameter("entity_"+u.databaseName,a.length-1);return`${c} = ${h}`}).join(" AND "),o="count",l=await this.queryRunner.query(`SELECT COUNT(1) AS ${r(o)} FROM ${i} WHERE ${s}`,a,!0);return parseInt(l.records[0][o])===0}getTableName(e){return e.split(".").map(t=>t===""?t:this.queryRunner.connection.driver.escape(t)).join(".")}}class Ef{constructor(e){this.queryRunner=e}async insert(e){const t={};e.metadata.closureJunctionTable.ancestorColumns.forEach(i=>{t[i.databaseName]=e.identifier}),e.metadata.closureJunctionTable.descendantColumns.forEach(i=>{t[i.databaseName]=e.identifier}),await this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.closureJunctionTable.tablePath).values(t).updateEntity(!1).callListeners(!1).execute();let r=e.metadata.treeParentRelation.getEntityValue(e.entity);if(!r&&e.parentSubject&&e.parentSubject.entity&&(r=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),r){const i=d=>this.queryRunner.connection.driver.escape(d),a=this.getTableName(e.metadata.closureJunctionTable.tablePath),s=[],o=e.metadata.closureJunctionTable.ancestorColumns.map(d=>i(d.databaseName)),l=e.metadata.closureJunctionTable.descendantColumns.map(d=>i(d.databaseName)),u=e.metadata.primaryColumns.map(d=>(s.push(d.getEntityValue(e.insertedValueSet?e.insertedValueSet:e.entity)),this.queryRunner.connection.driver.createParameter("child_entity_"+d.databaseName,s.length-1))),c=e.metadata.closureJunctionTable.descendantColumns.map(d=>{const h=i(d.databaseName),p=d.referencedColumn.getEntityValue(r);if(!p)throw new uE(e.metadata.name);s.push(p);const g=this.queryRunner.connection.driver.createParameter("parent_entity_"+d.referencedColumn.databaseName,s.length-1);return`${h} = ${g}`});await this.queryRunner.query(`INSERT INTO ${a} (${[...o,...l].join(", ")}) SELECT ${o.join(", ")}, ${u.join(", ")} FROM ${a} WHERE ${c.join(" AND ")}`,s)}}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let r=e.databaseEntity;if(!r&&t&&(r=e.metadata.treeChildrenRelation.getEntityValue(t).find(p=>Object.entries(e.identifier).every(([g,E])=>p[g]===E))),r===void 0||t===void 0)return;const i=e.metadata.treeParentRelation.getEntityValue(r),a=e.metadata.getEntityIdMap(i),s=e.metadata.getEntityIdMap(t);if(be.compareIds(a,s))return;const o=p=>this.queryRunner.connection.driver.escape(p),l=e.metadata.closureJunctionTable,u=l.ancestorColumns.map(p=>o(p.databaseName)),c=l.descendantColumns.map(p=>o(p.databaseName)),d=(p,g)=>{const E=`sub${g}`,A=p.createQueryBuilder().select(c.join(", ")).from(l.tablePath,E);for(const b of l.ancestorColumns)A.andWhere(`${o(E)}.${o(b.databaseName)} = :value_${b.referencedColumn.databaseName}`);return p.createQueryBuilder().select(c.join(", ")).from(`(${A.getQuery()})`,g).setParameters(A.getParameters()).getQuery()},h={};for(const p of e.metadata.primaryColumns)h[`value_${p.databaseName}`]=r[p.databaseName];if(await this.queryRunner.manager.createQueryBuilder().delete().from(l.tablePath).where(p=>`(${c.join(", ")}) IN (${d(p,"descendant")})`).andWhere(p=>`(${u.join(", ")}) NOT IN (${d(p,"ancestor")})`).setParameters(h).execute(),t){const p=[],g=this.getTableName(l.tablePath),E=o("supertree"),A=o("subtree"),b=[...u.map(P=>`${E}.${P}`),...c.map(P=>`${A}.${P}`)],T=e.metadata.closureJunctionTable.ancestorColumns.map(P=>{const D=o(P.databaseName),F=P.referencedColumn.getEntityValue(r);p.push(F);const Q=this.queryRunner.connection.driver.createParameter("entity_"+P.referencedColumn.databaseName,p.length-1);return`${A}.${D} = ${Q}`}),C=e.metadata.closureJunctionTable.descendantColumns.map(P=>{const D=o(P.databaseName),F=P.referencedColumn.getEntityValue(t);if(!F)throw new uE(e.metadata.name);p.push(F);const Q=this.queryRunner.connection.driver.createParameter("parent_entity_"+P.referencedColumn.databaseName,p.length-1);return`${E}.${D} = ${Q}`});await this.queryRunner.query(`INSERT INTO ${g} (${[...u,...c].join(", ")}) SELECT ${b.join(", ")} FROM ${g} AS ${E}, ${g} AS ${A} WHERE ${[...T,...C].join(" AND ")}`,p)}}async remove(e){if(this.queryRunner.connection.driver.options.type!=="mssql")return;Array.isArray(e)||(e=[e]);const t=l=>this.queryRunner.connection.driver.escape(l),r=e.map(l=>l.identifier),i=e[0].metadata.closureJunctionTable,a=l=>l.map(u=>{const c=r.map(d=>d[u.referencedColumn.databaseName]);return`${t(u.databaseName)} IN (${c.join(", ")})`}).join(" AND "),s=a(i.ancestorColumns),o=a(i.descendantColumns);await this.queryRunner.manager.createQueryBuilder().delete().from(i.tablePath).where(s).orWhere(o).execute()}getTableName(e){return e.split(".").map(t=>t===""?t:this.queryRunner.connection.driver.escape(t)).join(".")}}class Or{constructor(e){this["@instanceof"]=Symbol.for("EntityMetadata"),this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.withoutRowid=!1,this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isAlwaysUsingConstructor=!0,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.beforeSoftRemoveListeners=[],this.beforeRecoverListeners=[],this.afterRemoveListeners=[],this.afterSoftRemoveListeners=[],this.afterRecoverListeners=[],this.connection=e.connection,this.inheritanceTree=e.inheritanceTree||[],this.inheritancePattern=e.inheritancePattern,this.treeType=e.tableTree?e.tableTree.type:void 0,this.treeOptions=e.tableTree?e.tableTree.options:void 0,this.parentClosureEntityMetadata=e.parentClosureEntityMetadata,this.tableMetadataArgs=e.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid,this.dependsOn=this.tableMetadataArgs.dependsOn}create(e,t){const r=!!(t&&t.pojo===!0);let i;return typeof this.target=="function"&&!r?!(t!=null&&t.fromDeserializer)||this.isAlwaysUsingConstructor?i=new this.target:i=Object.create(this.target.prototype):i={},this.connection.options.typename&&(i[this.connection.options.typename]=this.targetName),this.lazyRelations.forEach(a=>this.connection.relationLoader.enableLazyLoad(a,i,e)),i}hasId(e){return e?this.primaryColumns.every(t=>{const r=t.getEntityValue(e);return r!=null&&r!==""}):!1}hasAllPrimaryKeys(e){return this.primaryColumns.every(t=>{const r=t.getEntityValue(e);return r!=null})}ensureEntityIdMap(e){if(Ue.isObject(e))return e;if(this.hasMultiplePrimaryKeys)throw new M_(this,e);return this.primaryColumns[0].createValueMap(e)}getEntityIdMap(e){if(e)return Or.getValueMap(e,this.primaryColumns,{skipNulls:!0})}getEntityIdMixedMap(e){if(!e)return e;const t=this.getEntityIdMap(e);return this.hasMultiplePrimaryKeys?t:t&&this.primaryColumns[0].getEntityValue(t)}compareEntities(e,t){const r=this.getEntityIdMap(e);if(!r)return!1;const i=this.getEntityIdMap(t);return i?be.compareIds(r,i):!1}findColumnWithPropertyName(e){return this.columns.find(t=>t.propertyName===e)}findColumnWithDatabaseName(e){return this.columns.find(t=>t.databaseName===e)}hasColumnWithPropertyPath(e){return this.columns.some(r=>r.propertyPath===e)||this.hasRelationWithPropertyPath(e)}findColumnWithPropertyPath(e){const t=this.columns.find(i=>i.propertyPath===e);if(t)return t;const r=this.relations.find(i=>i.propertyPath===e);if(r&&r.joinColumns.length===1)return r.joinColumns[0]}findColumnWithPropertyPathStrict(e){return this.columns.find(t=>t.propertyPath===e)}findColumnsWithPropertyPath(e){const t=this.columns.find(i=>i.propertyPath===e);if(t)return[t];const r=this.findRelationWithPropertyPath(e);return r&&r.joinColumns?r.joinColumns:[]}hasRelationWithPropertyPath(e){return this.relations.some(t=>t.propertyPath===e)}findRelationWithPropertyPath(e){return this.relations.find(t=>t.propertyPath===e)}hasEmbeddedWithPropertyPath(e){return this.allEmbeddeds.some(t=>t.propertyPath===e)}findEmbeddedWithPropertyPath(e){return this.allEmbeddeds.find(t=>t.propertyPath===e)}mapPropertyPathsToColumns(e){return e.map(t=>{const r=this.findColumnWithPropertyPath(t);if(r==null)throw new Qr(t,this);return r})}extractRelationValuesFromEntity(e,t){const r=[];return t.forEach(i=>{const a=i.getEntityValue(e);Array.isArray(a)?a.forEach(s=>r.push([i,s,Or.getInverseEntityMetadata(s,i)])):a&&r.push([i,a,Or.getInverseEntityMetadata(a,i)])}),r}findInheritanceMetadata(e){if(this.inheritancePattern==="STI"&&this.childEntityMetadatas.length>0){let t;return this.discriminatorColumn&&(t=e[this.discriminatorColumn.propertyName]),this.childEntityMetadatas.find(r=>t===r.discriminatorValue||e.constructor===r.target)||this}return this}static getInverseEntityMetadata(e,t){return t.inverseEntityMetadata.findInheritanceMetadata(e)}static createPropertyPath(e,t,r=""){const i=[];return Object.keys(t).forEach(a=>{const s=r?r+"."+a:a;if(e.hasEmbeddedWithPropertyPath(s)){const o=this.createPropertyPath(e,t[a],s);i.push(...o)}else{const o=r?r+"."+a:a;i.push(o)}}),i}static difference(e,t){return e.filter(r=>!t.find(i=>be.compareIds(r,i)))}static getValueMap(e,t,r){return t.reduce((i,a)=>{const s=a.getEntityValueMap(e,r);if(!(i===void 0||s===null||s===void 0))return be.mergeDeep(i,s)},{})}build(){var e;const t=this.connection.namingStrategy,r=this.connection.options.entityPrefix,i=this.connection.options.entitySkipConstructor;this.engine=this.tableMetadataArgs.engine,this.database=this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:!((e=this.connection.options)===null||e===void 0)&&e.hasOwnProperty("schema")&&(this.schema=this.connection.options.schema),this.givenTableName=this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=this.tableMetadataArgs.synchronize!==!1,this.targetName=typeof this.tableMetadataArgs.target=="function"?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,this.tableMetadataArgs.type==="closure-junction"?this.tableNameWithoutPrefix=t.closureJunctionTableName(this.givenTableName):this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.tableNameWithoutPrefix=t.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=t.tableName(this.targetName,this.givenTableName),this.tableMetadataArgs.type==="junction"&&this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=Db(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=r?t.prefixTableName(r,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid===!0,this.tablePath=this.connection.driver.buildTableName(this.tableName,this.schema,this.database),this.orderBy=typeof this.tableMetadataArgs.orderBy=="function"?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,i!==void 0&&(this.isAlwaysUsingConstructor=!i),this.isJunction=this.tableMetadataArgs.type==="closure-junction"||this.tableMetadataArgs.type==="junction",this.isClosureJunction=this.tableMetadataArgs.type==="closure-junction"}registerColumn(e){this.ownColumns.indexOf(e)===-1&&(this.ownColumns.push(e),this.columns=this.embeddeds.reduce((t,r)=>t.concat(r.columnsFromTree),this.ownColumns),this.primaryColumns=this.columns.filter(t=>t.isPrimary),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter(t=>t.isGenerated||t.generationStrategy==="uuid").length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach(t=>t.registerColumn(e)))}createPropertiesMap(){const e={};return this.columns.forEach(t=>be.mergeDeep(e,t.createValueMap(t.propertyPath))),this.relations.forEach(t=>be.mergeDeep(e,t.createValueMap(t.propertyPath))),e}getInsertionReturningColumns(){return this.columns.filter(e=>e.default!==void 0||e.isGenerated||e.isCreateDate||e.isUpdateDate||e.isDeleteDate||e.isVersion)}}class yd{constructor(e){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=e}}class yE{constructor(e){this.queryRunner=e}async insert(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const r=e.metadata.getEntityIdMap(t);let i="";r&&(i=await this.getEntityPath(e,r));const a=e.metadata.treeParentRelation.joinColumns.map(s=>s.referencedColumn.getEntityValue(e.insertedValueSet)).join("_");await this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[e.metadata.materializedPathColumn.propertyPath]:i+a+"."}).where(e.identifier).execute()}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let r=e.databaseEntity;!r&&t&&(r=e.metadata.treeChildrenRelation.getEntityValue(t).find(d=>Object.entries(e.identifier).every(([h,p])=>d[h]===p)));const i=e.metadata.treeParentRelation.getEntityValue(r),a=this.getEntityParentReferencedColumnMap(e,i),s=this.getEntityParentReferencedColumnMap(e,t);if(be.compareIds(a,s))return;let o="";s&&(o=await this.getEntityPath(e,s));let l="";a&&(l=await this.getEntityPath(e,a)||"");const u=e.metadata.treeParentRelation.joinColumns.map(d=>d.referencedColumn.getEntityValue(r)).join("_"),c=e.metadata.materializedPathColumn.propertyPath;await this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[c]:()=>`REPLACE(${this.queryRunner.connection.driver.escape(c)}, '${l}${u}.', '${o}${u}.')`}).where(`${c} LIKE :path`,{path:`${l}${u}.%`}).execute()}getEntityParentReferencedColumnMap(e,t){if(t)return Or.getValueMap(t,e.metadata.treeParentRelation.joinColumns.map(r=>r.referencedColumn).filter(r=>r!=null),{skipNulls:!0})}getEntityPath(e,t){const r=e.metadata,i=(Array.isArray(t)?t:[t]).map(a=>r.ensureEntityIdMap(a));return this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.materializedPathColumn.propertyPath,"path").from(e.metadata.target,e.metadata.targetName).where(new yd(a=>{for(const s of i)a.orWhere(new yd(o=>o.where(s)))})).getRawOne().then(a=>a?a.path:"")}}class B1{constructor(e,t,r){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.softRemoveSubjects=[],this.recoverSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=r,this.validate(),this.recompute()}async execute(){let e;(!this.options||this.options.listeners!==!1)&&(e=this.broadcastBeforeEventsForAll(),e.promises.length>0&&await Promise.all(e.promises)),e&&e.count>0&&(this.insertSubjects.forEach(t=>t.recompute()),this.updateSubjects.forEach(t=>t.recompute()),this.removeSubjects.forEach(t=>t.recompute()),this.softRemoveSubjects.forEach(t=>t.recompute()),this.recoverSubjects.forEach(t=>t.recompute()),this.recompute()),this.insertSubjects=new fE(this.insertSubjects).sort("insert"),await this.executeInsertOperations(),this.updateSubjects=this.allSubjects.filter(t=>t.mustBeUpdated),await this.executeUpdateOperations(),this.removeSubjects=new fE(this.removeSubjects).sort("delete"),await this.executeRemoveOperations(),this.softRemoveSubjects=this.allSubjects.filter(t=>t.mustBeSoftRemoved),await this.executeSoftRemoveOperations(),this.recoverSubjects=this.allSubjects.filter(t=>t.mustBeRecovered),await this.executeRecoverOperations(),await this.updateSpecialColumnsInPersistedEntities(),(!this.options||this.options.listeners!==!1)&&(e=this.broadcastAfterEventsForAll(),e.promises.length>0&&await Promise.all(e.promises))}validate(){this.allSubjects.forEach(e=>{if(e.mustBeUpdated&&e.mustBeRemoved)throw new G_(e)})}recompute(){new q1().compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter(e=>e.mustBeInserted),this.updateSubjects=this.allSubjects.filter(e=>e.mustBeUpdated),this.removeSubjects=this.allSubjects.filter(e=>e.mustBeRemoved),this.softRemoveSubjects=this.allSubjects.filter(e=>e.mustBeSoftRemoved),this.recoverSubjects=this.allSubjects.filter(e=>e.mustBeRecovered),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0||this.softRemoveSubjects.length>0||this.recoverSubjects.length>0}broadcastBeforeEventsForAll(){const e=new $p;return this.insertSubjects.length&&this.insertSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeInsertEvent(e,t.metadata,t.entity)),this.updateSubjects.length&&this.updateSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations)),this.removeSubjects.length&&this.removeSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.recoverSubjects.length&&this.recoverSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeRecoverEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),e}broadcastAfterEventsForAll(){const e=new $p;return this.insertSubjects.length&&this.insertSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterInsertEvent(e,t.metadata,t.entity)),this.updateSubjects.length&&this.updateSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations)),this.removeSubjects.length&&this.removeSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.recoverSubjects.length&&this.recoverSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterRecoverEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),e}async executeInsertOperations(){const[e,t]=this.groupBulkSubjects(this.insertSubjects,"insert");for(const r of t){const i=e[r],a=[],s=[],o=[];if(this.queryRunner.connection.driver.options.type==="mongodb"?i.forEach(l=>{l.metadata.createDateColumn&&l.entity&&(l.entity[l.metadata.createDateColumn.databaseName]=new Date),l.metadata.updateDateColumn&&l.entity&&(l.entity[l.metadata.updateDateColumn.databaseName]=new Date),l.createValueSetAndPopChangeMap(),s.push(l),a.push(l.entity)}):this.queryRunner.connection.driver.options.type==="oracle"?i.forEach(l=>{o.push(l)}):i.forEach(l=>{l.changeMaps.length===0||l.metadata.treeType||this.queryRunner.connection.driver.options.type==="oracle"||this.queryRunner.connection.driver.options.type==="sap"?o.push(l):(s.push(l),a.push(l.createValueSetAndPopChangeMap()))}),U.isMongoEntityManager(this.queryRunner.manager)){const l=await this.queryRunner.manager.insert(i[0].metadata.target,a);i.forEach((u,c)=>{u.identifier=l.identifiers[c],u.generatedMap=l.generatedMaps[c],u.insertedValueSet=a[c]})}else{if(a.length>0){const l=await this.queryRunner.manager.createQueryBuilder().insert().into(i[0].metadata.target).values(a).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1).execute();s.forEach((u,c)=>{u.identifier=l.identifiers[c],u.generatedMap=l.generatedMaps[c],u.insertedValueSet=a[c]})}if(o.length>0)for(const l of o)l.insertedValueSet=l.createValueSetAndPopChangeMap(),l.metadata.treeType==="nested-set"&&await new vf(this.queryRunner).insert(l),await this.queryRunner.manager.createQueryBuilder().insert().into(l.metadata.target).values(l.insertedValueSet).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1).execute().then(u=>{l.identifier=u.identifiers[0],l.generatedMap=u.generatedMaps[0]}),l.metadata.treeType==="closure-table"?await new Ef(this.queryRunner).insert(l):l.metadata.treeType==="materialized-path"&&await new yE(this.queryRunner).insert(l)}i.forEach(l=>{l.generatedMap&&l.metadata.columns.forEach(u=>{const c=u.getEntityValue(l.generatedMap);if(c!=null){const d=this.queryRunner.connection.driver.prepareHydratedValue(c,u);u.setEntityValue(l.generatedMap,d)}})})}}async executeUpdateOperations(){const e=async a=>{if(!a.identifier)throw new mc(a);if(U.isMongoEntityManager(this.queryRunner.manager)){const s=this.cloneMongoSubjectEntity(a);a.metadata.objectIdColumn&&a.metadata.objectIdColumn.propertyName&&delete s[a.metadata.objectIdColumn.propertyName],a.metadata.createDateColumn&&a.metadata.createDateColumn.propertyName&&delete s[a.metadata.createDateColumn.propertyName],a.metadata.updateDateColumn&&a.metadata.updateDateColumn.propertyName&&(s[a.metadata.updateDateColumn.propertyName]=new Date),await this.queryRunner.manager.update(a.metadata.target,a.identifier,s)}else{const s=a.createValueSetAndPopChangeMap();switch(a.metadata.treeType){case"nested-set":await new vf(this.queryRunner).update(a);break;case"closure-table":await new Ef(this.queryRunner).update(a);break;case"materialized-path":await new yE(this.queryRunner).update(a);break}const o=this.queryRunner.manager.createQueryBuilder().update(a.metadata.target).set(s).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);a.entity?o.whereEntity(a.identifier):o.where(a.identifier);let u=(await o.execute()).generatedMaps[0];u&&(a.metadata.columns.forEach(c=>{const d=c.getEntityValue(u);if(d!=null){const h=this.queryRunner.connection.driver.prepareHydratedValue(d,c);c.setEntityValue(u,h)}}),a.generatedMap||(a.generatedMap={}),Object.assign(a.generatedMap,u))}},t=[],r=[];for(const a of this.updateSubjects)a.metadata.treeType==="nested-set"?t.push(a):r.push(a);const i=new Promise(async(a,s)=>{for(const o of t)try{await e(o)}catch(l){s(l)}a()});await Promise.all([...r.map(e),i])}async executeRemoveOperations(){const[e,t]=this.groupBulkSubjects(this.removeSubjects,"delete");for(const r of t){const i=e[r],a=i.map(s=>{if(!s.identifier)throw new mc(s);return s.identifier});if(U.isMongoEntityManager(this.queryRunner.manager))await this.queryRunner.manager.delete(i[0].metadata.target,a);else{switch(i[0].metadata.treeType){case"nested-set":await new vf(this.queryRunner).remove(i);break;case"closure-table":await new Ef(this.queryRunner).remove(i);break}await this.queryRunner.manager.createQueryBuilder().delete().from(i[0].metadata.target).where(a).callListeners(!1).execute()}}}cloneMongoSubjectEntity(e){const t={};if(e.entity)for(const r of e.metadata.columns)be.mergeDeep(t,r.getEntityValueMap(e.entity));return t}async executeSoftRemoveOperations(){await Promise.all(this.softRemoveSubjects.map(async e=>{if(!e.identifier)throw new mc(e);let t;if(U.isMongoEntityManager(this.queryRunner.manager)){const r=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete r[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete r[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(r[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(r[e.metadata.deleteDateColumn.propertyName]=new Date),t=await this.queryRunner.manager.update(e.metadata.target,e.identifier,r)}else{const r=this.queryRunner.manager.createQueryBuilder().softDelete().from(e.metadata.target).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);e.entity?r.whereEntity(e.identifier):r.where(e.identifier),t=await r.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach(r=>{const i=r.getEntityValue(e.generatedMap);if(i!=null){const a=this.queryRunner.connection.driver.prepareHydratedValue(i,r);r.setEntityValue(e.generatedMap,a)}})}))}async executeRecoverOperations(){await Promise.all(this.recoverSubjects.map(async e=>{if(!e.identifier)throw new mc(e);let t;if(U.isMongoEntityManager(this.queryRunner.manager)){const r=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete r[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete r[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(r[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(r[e.metadata.deleteDateColumn.propertyName]=null),t=await this.queryRunner.manager.update(e.metadata.target,e.identifier,r)}else{const r=this.queryRunner.manager.createQueryBuilder().restore().from(e.metadata.target).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);e.entity?r.whereEntity(e.identifier):r.where(e.identifier),t=await r.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach(r=>{const i=r.getEntityValue(e.generatedMap);if(i!=null){const a=this.queryRunner.connection.driver.prepareHydratedValue(i,r);r.setEntityValue(e.generatedMap,a)}})}))}updateSpecialColumnsInPersistedEntities(){this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.softRemoveSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.softRemoveSubjects),this.recoverSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.recoverSubjects),this.removeSubjects.length&&this.removeSubjects.forEach(e=>{e.entity&&e.metadata.primaryColumns.forEach(t=>{t.setEntityValue(e.entity,void 0)})}),this.allSubjects.forEach(e=>{e.entity&&(e.metadata.relationIds.forEach(t=>{t.setValue(e.entity)}),U.isMongoEntityManager(this.queryRunner.manager)&&e.metadata.objectIdColumn&&e.metadata.objectIdColumn.databaseName&&e.metadata.objectIdColumn.databaseName!==e.metadata.objectIdColumn.propertyName&&delete e.entity[e.metadata.objectIdColumn.databaseName])})}updateSpecialColumnsInInsertedAndUpdatedEntities(e){e.forEach(t=>{t.entity&&(t.metadata.columns.forEach(r=>{t.metadata.childEntityMetadatas.length>0&&t.metadata.childEntityMetadatas.map(i=>i.target).indexOf(r.target)!==-1||r.isVirtual||(r.isNullable&&r.getEntityValue(t.entity)===void 0&&r.setEntityValue(t.entity,null),t.updatedRelationMaps.length>0&&t.updatedRelationMaps.forEach(i=>{i.relation.joinColumns.forEach(a=>{a.isVirtual!==!0&&a.setEntityValue(t.entity,Ue.isObject(i.value)?a.referencedColumn.getEntityValue(i.value):i.value)})}))}),t.generatedMap&&this.queryRunner.manager.merge(t.metadata.target,t.entity,t.generatedMap))})}groupBulkSubjects(e,t){const r={},i=[],a=e.some(o=>o.metadata.getInsertionReturningColumns().length>0),s=t==="delete"||this.queryRunner.connection.driver.isReturningSqlSupported("insert")||a===!1;return e.forEach((o,l)=>{const u=s||o.metadata.isJunction?o.metadata.name:o.metadata.name+"_"+l;r[u]?r[u].push(o):(r[u]=[o],i.push(u))}),[r,i]}}class gi{constructor(e){this["@instanceof"]=Symbol.for("Subject"),this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.canBeSoftRemoved=!1,this.canBeRecovered=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=e.metadata,this.entity=e.entity,this.parentSubject=e.parentSubject,e.canBeInserted!==void 0&&(this.canBeInserted=e.canBeInserted),e.canBeUpdated!==void 0&&(this.canBeUpdated=e.canBeUpdated),e.mustBeRemoved!==void 0&&(this.mustBeRemoved=e.mustBeRemoved),e.canBeSoftRemoved!==void 0&&(this.canBeSoftRemoved=e.canBeSoftRemoved),e.canBeRecovered!==void 0&&(this.canBeRecovered=e.canBeRecovered),e.identifier!==void 0&&(this.identifier=e.identifier),e.changeMaps!==void 0&&this.changeMaps.push(...e.changeMaps),this.recompute()}get mustBeInserted(){return this.canBeInserted&&!this.databaseEntity}get mustBeUpdated(){return this.canBeUpdated&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.length>0}get mustBeSoftRemoved(){return this.canBeSoftRemoved&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)}get mustBeRecovered(){return this.canBeRecovered&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)}createValueSetAndPopChangeMap(){const e=[],t=this.changeMaps.reduce((r,i)=>{let a=i.value;U.isSubject(a)&&(a=a.insertedValueSet?a.insertedValueSet:a.entity);let s;if(this.metadata.isJunction&&i.column)s=i.column.createValueMap(i.column.referencedColumn.getEntityValue(a));else if(i.column)s=i.column.createValueMap(a);else if(i.relation)if(Ue.isObject(a)&&!Buffer.isBuffer(a)){const o=i.relation.getRelationIdMap(a);if(o===void 0)return e.push(i),this.canBeUpdated=!0,r;s=i.relation.createValueMap(o),this.updatedRelationMaps.push({relation:i.relation,value:o})}else s=i.relation.createValueMap(a),this.updatedRelationMaps.push({relation:i.relation,value:a});return be.mergeDeep(r,s),r},{});return this.changeMaps=e,t}recompute(){this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach(e=>{if(e.relationMetadata&&e.relationMetadata.inverseEntityMetadata===this.parentSubject.metadata){const t=e.referencedColumn.getEntityValue(this.parentSubject.entity);e.setEntityValue(this.entityWithFulfilledIds,t)}}),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))}}class F1{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.metadata.oneToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&this.buildForSubjectRelation(e,t)})})}buildForSubjectRelation(e,t){var r;let i=[];if(e.databaseEntity){const o=t.getEntityValue(e.databaseEntity);o&&(i=o.map(l=>t.inverseEntityMetadata.getEntityIdMap(l)))}let a=t.getEntityValue(e.entity);if(a===null&&(a=[]),a===void 0)return;const s=[];a.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o),u=this.subjects.find(d=>d.entity===o);if(u&&(l=u.identifier),!l){if(!u)return;u.changeMaps.push({relation:t.inverseRelation,value:e});return}i.find(d=>be.compareIds(l,d))||(u||(u=new gi({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:l}),this.subjects.push(u)),u.changeMaps.push({relation:t.inverseRelation,value:e})),s.push(l)}),((r=t.inverseRelation)===null||r===void 0?void 0:r.orphanedRowAction)!=="disable"&&Or.difference(i,s).forEach(o=>{const l=new gi({metadata:t.inverseEntityMetadata,parentSubject:e,identifier:o});!t.inverseRelation||t.inverseRelation.orphanedRowAction==="nullify"?(l.canBeUpdated=!0,l.changeMaps=[{relation:t.inverseRelation,value:null}]):t.inverseRelation.orphanedRowAction==="delete"?l.mustBeRemoved=!0:t.inverseRelation.orphanedRowAction==="soft-delete"&&(l.canBeSoftRemoved=!0),this.subjects.push(l)})}}class k1{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.metadata.oneToOneRelations.forEach(t=>{t.isOwning||t.persistenceEnabled===!1||this.buildForSubjectRelation(e,t)})})}buildForSubjectRelation(e,t){let r;e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));let i=t.getEntityValue(e.entity);if(i===void 0)return;if(i===null){if(r){const l=new gi({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:r,changeMaps:[{relation:t.inverseRelation,value:null}]});this.subjects.push(l)}return}let a=t.inverseEntityMetadata.getEntityIdMap(i),s=this.subjects.find(l=>!!l.entity&&l.entity===i);if(s&&(a=s.identifier),!a){if(!s)return;s.changeMaps.push({relation:t.inverseRelation,value:e})}r&&be.compareIds(a,r)||(s||(s=new gi({metadata:t.inverseEntityMetadata,canBeUpdated:!0,identifier:a}),this.subjects.push(s)),s.changeMaps.push({relation:t.inverseRelation,value:e}))}}class gE{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.entity&&e.metadata.manyToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&this.buildForSubjectRelation(e,t)})})}buildForAllRemoval(e){e.databaseEntity&&e.metadata.manyToManyRelations.forEach(t=>{if(t.persistenceEnabled===!1)return;t.getEntityValue(e.databaseEntity).forEach(i=>{const a=new gi({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,i)});this.subjects.push(a)})})}buildForSubjectRelation(e,t){let r=[];e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));let i=t.getEntityValue(e.entity);if(i===null&&(i=[]),!Array.isArray(i))return;i.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o);const u=this.subjects.find(g=>g.entity===o);if(u&&(l=u.identifier),!l&&!u||r.find(g=>be.compareIds(g,l)))return;const d=t.isOwning?e:u||o,h=t.isOwning?u||o:e,p=new gi({metadata:t.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});this.subjects.push(p),t.junctionEntityMetadata.ownerColumns.forEach(g=>{p.changeMaps.push({column:g,value:d})}),t.junctionEntityMetadata.inverseColumns.forEach(g=>{p.changeMaps.push({column:g,value:h})})});const a=[];i.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o);const u=this.subjects.find(c=>c.entity===o);u&&(l=u.identifier),l!=null&&a.push(l)}),r.filter(o=>!a.find(l=>be.compareIds(l,o))).forEach(o=>{const l=new gi({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,o)});this.subjects.push(l)})}buildJunctionIdentifier(e,t,r){const i=t.isOwning?e.entity:r,a=t.isOwning?r:e.entity,s={};return t.junctionEntityMetadata.ownerColumns.forEach(o=>{be.mergeDeep(s,o.createValueMap(o.referencedColumn.getEntityValue(i)))}),t.junctionEntityMetadata.inverseColumns.forEach(o=>{be.mergeDeep(s,o.createValueMap(o.referencedColumn.getEntityValue(a)))}),s}}class U1{constructor(e,t){this.queryRunner=e,this.subjects=t}async load(e){const t=this.groupByEntityTargets().map(async r=>{const i=[],a=[];if(r.subjects.forEach(u=>{u.databaseEntity||!u.identifier||(i.push(u.identifier),a.push(u))}),!i.length)return;const s=[];e==="save"||e==="soft-remove"||e==="recover"?r.subjects.forEach(u=>{u.metadata.relations.forEach(c=>{c.getEntityValue(u.entityWithFulfilledIds)!==void 0&&s.indexOf(c.propertyPath)===-1&&s.push(c.propertyPath)})}):s.push(...r.subjects[0].metadata.manyToManyRelations.map(u=>u.propertyPath));const o={loadEagerRelations:!1,loadRelationIds:{relations:s,disableMixedMap:!0},withDeleted:!0};let l=[];this.queryRunner.connection.driver.options.type==="mongodb"?l=await this.queryRunner.manager.getRepository(r.target).findByIds(i,o):l=await this.queryRunner.manager.getRepository(r.target).createQueryBuilder().setFindOptions(o).whereInIds(i).getMany(),l.forEach(u=>{this.findByPersistEntityLike(r.target,u).forEach(d=>{d.databaseEntity=u,d.identifier||(d.identifier=d.metadata.hasAllPrimaryKeys(u)?d.metadata.getEntityIdMap(u):void 0)})});for(let u of a)u.databaseEntityLoaded=!0});await Promise.all(t)}findByPersistEntityLike(e,t){return this.subjects.filter(r=>r.entity?r.entity===t?!0:r.metadata.target===e&&r.metadata.compareEntities(r.entityWithFulfilledIds,t):!1)}groupByEntityTargets(){return this.subjects.reduce((e,t)=>{let r=e.find(i=>i.target===t.metadata.target);return r||(r={target:t.metadata.target,subjects:[]},e.push(r)),r.subjects.push(t),e},[])}}class j1{constructor(e){this.allSubjects=e}build(e,t){e.metadata.extractRelationValuesFromEntity(e.entity,e.metadata.relations).forEach(([r,i,a])=>{if(i==null||!r.isCascadeInsert&&!r.isCascadeUpdate&&!r.isCascadeSoftRemove&&!r.isCascadeRecover||!Ue.isObject(i))return;const s=this.findByPersistEntityLike(a.target,i);if(s){s.canBeInserted===!1&&(s.canBeInserted=r.isCascadeInsert===!0&&t==="save"),s.canBeUpdated===!1&&(s.canBeUpdated=r.isCascadeUpdate===!0&&t==="save"),s.canBeSoftRemoved===!1&&(s.canBeSoftRemoved=r.isCascadeSoftRemove===!0&&t==="soft-remove"),s.canBeRecovered===!1&&(s.canBeRecovered=r.isCascadeRecover===!0&&t==="recover");return}const o=new gi({metadata:a,parentSubject:e,entity:i,canBeInserted:r.isCascadeInsert===!0&&t==="save",canBeUpdated:r.isCascadeUpdate===!0&&t==="save",canBeSoftRemoved:r.isCascadeSoftRemove===!0&&t==="soft-remove",canBeRecovered:r.isCascadeRecover===!0&&t==="recover"});this.allSubjects.push(o),this.build(o,t)})}findByPersistEntityLike(e,t){return this.allSubjects.find(r=>r.entity?r.entity===t?!0:r.metadata.target===e&&r.metadata.compareEntities(r.entityWithFulfilledIds,t):!1)}}class vc{constructor(e,t,r,i,a,s){this.connection=e,this.queryRunner=t,this.mode=r,this.target=i,this.entity=a,this.options=s}async execute(){if(!this.entity||typeof this.entity!="object")return Promise.reject(new L_(this.mode,this.entity));await Promise.resolve();const e=this.queryRunner||this.connection.createQueryRunner();let t=e.data;this.options&&this.options.data&&(e.data=this.options.data);try{const r=Array.isArray(this.entity)?this.entity:[this.entity],i=this.options&&this.options.chunk&&this.options.chunk>0?be.chunk(r,this.options.chunk):[r],s=(await Promise.all(i.map(async l=>{const u=[];l.forEach(d=>{const h=this.target?this.target:d.constructor;if(h===Object)throw new O_(this.mode);let p=this.connection.getMetadata(h).findInheritanceMetadata(d);u.push(new gi({metadata:p,entity:d,canBeInserted:this.mode==="save",canBeUpdated:this.mode==="save",mustBeRemoved:this.mode==="remove",canBeSoftRemoved:this.mode==="soft-remove",canBeRecovered:this.mode==="recover"}))});const c=new j1(u);return u.forEach(d=>{c.build(d,this.mode)}),await new U1(e,u).load(this.mode),this.mode==="save"||this.mode==="soft-remove"||this.mode==="recover"?(new F1(u).build(),new k1(u).build(),new gE(u).build()):u.forEach(d=>{d.mustBeRemoved&&new gE(u).buildForAllRemoval(d)}),new B1(e,u,this.options)}))).filter(l=>l.hasExecutableOperations);if(s.length===0)return;let o=!1;try{e.isTransactionActive||this.connection.driver.transactionSupport!=="none"&&(!this.options||this.options.transaction!==!1)&&(o=!0,await e.startTransaction());for(const l of s)await l.execute();o===!0&&await e.commitTransaction()}catch(l){if(o)try{await e.rollbackTransaction()}catch{}throw l}}finally{e.data=t,this.queryRunner||await e.release()}}}class Vb{constructor(e,t){this["@instanceof"]=Symbol.for("EntityManager"),this.repositories=new Map,this.treeRepositories=[],this.plainObjectToEntityTransformer=new c1,this.connection=e,t&&(this.queryRunner=t,Ue.assign(this.queryRunner,{manager:this}))}async transaction(e,t){const r=typeof e=="string"?e:void 0,i=typeof e=="function"?e:t;if(!i)throw new L("Transaction method requires callback in second parameter if isolation level is supplied.");if(this.queryRunner&&this.queryRunner.isReleased)throw new Lb;const a=this.queryRunner||this.connection.createQueryRunner();try{await a.startTransaction(r);const s=await i(a.manager);return await a.commitTransaction(),s}catch(s){try{await a.rollbackTransaction()}catch{}throw s}finally{this.queryRunner||await a.release()}}async query(e,t){return this.connection.query(e,t,this.queryRunner)}createQueryBuilder(e,t,r){return t?this.connection.createQueryBuilder(e,t,r||this.queryRunner):this.connection.createQueryBuilder(e||r||this.queryRunner)}hasId(e,t){const r=arguments.length===2?e:e.constructor,i=arguments.length===2?t:e;return this.connection.getMetadata(r).hasId(i)}getId(e,t){const r=arguments.length===2?e:e.constructor,i=arguments.length===2?t:e;return this.connection.getMetadata(r).getEntityIdMixedMap(i)}create(e,t){const r=this.connection.getMetadata(e);if(!t)return r.create(this.queryRunner);if(Array.isArray(t))return t.map(a=>this.create(e,a));const i=r.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(i,t,r,!0),i}merge(e,t,...r){const i=this.connection.getMetadata(e);return r.forEach(a=>this.plainObjectToEntityTransformer.transform(t,a,i)),t}async preload(e,t){const r=this.connection.getMetadata(e),a=await new f1(this.connection.manager).transform(t,r);if(a)return this.merge(e,a,t)}save(e,t,r){let i=arguments.length>1&&(typeof e=="function"||U.isEntitySchema(e)||typeof e=="string")?e:void 0;const a=i?t:e,s=i?r:t;return U.isEntitySchema(i)&&(i=i.options.name),Array.isArray(a)&&a.length===0?Promise.resolve(a):new vc(this.connection,this.queryRunner,"save",i,a,s).execute().then(()=>a)}remove(e,t,r){const i=arguments.length>1&&(typeof e=="function"||U.isEntitySchema(e)||typeof e=="string")?e:void 0,a=i?t:e,s=i?r:t;return Array.isArray(a)&&a.length===0?Promise.resolve(a):new vc(this.connection,this.queryRunner,"remove",i,a,s).execute().then(()=>a)}softRemove(e,t,r){let i=arguments.length>1&&(typeof e=="function"||U.isEntitySchema(e)||typeof e=="string")?e:void 0;const a=i?t:e,s=i?r:t;return U.isEntitySchema(i)&&(i=i.options.name),Array.isArray(a)&&a.length===0?Promise.resolve(a):new vc(this.connection,this.queryRunner,"soft-remove",i,a,s).execute().then(()=>a)}recover(e,t,r){let i=arguments.length>1&&(typeof e=="function"||U.isEntitySchema(e)||typeof e=="string")?e:void 0;const a=i?t:e,s=i?r:t;return U.isEntitySchema(i)&&(i=i.options.name),Array.isArray(a)&&a.length===0?Promise.resolve(a):new vc(this.connection,this.queryRunner,"recover",i,a,s).execute().then(()=>a)}async insert(e,t){return this.createQueryBuilder().insert().into(e).values(t).execute()}async upsert(e,t,r){const i=this.connection.getMetadata(e);let a;Array.isArray(r)?a={conflictPaths:r}:a=r;let s;Array.isArray(t)?s=t:s=[t];const o=i.mapPropertyPathsToColumns(Array.isArray(a.conflictPaths)?a.conflictPaths:Object.keys(a.conflictPaths)),l=i.columns.filter(u=>!o.includes(u)&&s.some(c=>typeof u.getEntityValue(c)<"u"));return this.createQueryBuilder().insert().into(e).values(s).orUpdate([...o,...l].map(u=>u.databaseName),o.map(u=>u.databaseName),{skipUpdateIfNoValuesChanged:a.skipUpdateIfNoValuesChanged,indexPredicate:a.indexPredicate,upsertType:a.upsertType||this.connection.driver.supportedUpsertTypes[0]}).execute()}update(e,t,r){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new L("Empty criteria(s) are not allowed for the update method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().update(e).set(r).whereInIds(t).execute():this.createQueryBuilder().update(e).set(r).where(t).execute()}delete(e,t){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new L("Empty criteria(s) are not allowed for the delete method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()}softDelete(e,t){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new L("Empty criteria(s) are not allowed for the delete method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().softDelete().from(e).whereInIds(t).execute():this.createQueryBuilder().softDelete().from(e).where(t).execute()}restore(e,t){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new L("Empty criteria(s) are not allowed for the delete method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().restore().from(e).whereInIds(t).execute():this.createQueryBuilder().restore().from(e).where(t).execute()}exists(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,ln.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getExists()}count(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,ln.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getCount()}countBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t}).getCount()}sum(e,t,r){return this.callAggregateFun(e,"SUM",t,r)}average(e,t,r){return this.callAggregateFun(e,"AVG",t,r)}minimum(e,t,r){return this.callAggregateFun(e,"MIN",t,r)}maximum(e,t,r){return this.callAggregateFun(e,"MAX",t,r)}async callAggregateFun(e,t,r,i={}){const a=this.connection.getMetadata(e),s=await this.createQueryBuilder(e,a.name).setFindOptions({where:i}).select(`${t}(${this.connection.driver.escape(String(r))})`,t).getRawOne();return s[t]===null?null:parseFloat(s[t])}async find(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,ln.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getMany()}async findBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t}).getMany()}findAndCount(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,ln.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getManyAndCount()}findAndCountBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t}).getManyAndCount()}async findByIds(e,t){if(!t.length)return Promise.resolve([]);const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).andWhereInIds(t).getMany()}async findOne(e,t){let i=this.connection.getMetadata(e).name;if(t&&t.join&&(i=t.join.alias),!t.where)throw new Error("You must provide selection conditions in order to find a single row.");return this.createQueryBuilder(e,i).setFindOptions({...t,take:1}).getOne()}async findOneBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t,take:1}).getOne()}async findOneById(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({take:1}).whereInIds(r.ensureEntityIdMap(t)).getOne()}async findOneOrFail(e,t){return this.findOne(e,t).then(r=>r===null?Promise.reject(new Op(e,t)):Promise.resolve(r))}async findOneByOrFail(e,t){return this.findOneBy(e,t).then(r=>r===null?Promise.reject(new Op(e,t)):Promise.resolve(r))}async clear(e){const t=this.connection.getMetadata(e),r=this.queryRunner||this.connection.createQueryRunner();try{return await r.clearTable(t.tablePath)}finally{this.queryRunner||await r.release()}}async increment(e,t,r,i){const a=this.connection.getMetadata(e),s=a.findColumnWithPropertyPath(r);if(!s)throw new L(`Column ${r} was not found in ${a.targetName} entity.`);if(isNaN(Number(i)))throw new L(`Value "${i}" is not a number.`);const o=r.split(".").reduceRight((l,u)=>({[u]:l}),()=>this.connection.driver.escape(s.databaseName)+" + "+i);return this.createQueryBuilder(e,"entity").update(e).set(o).where(t).execute()}async decrement(e,t,r,i){const a=this.connection.getMetadata(e),s=a.findColumnWithPropertyPath(r);if(!s)throw new L(`Column ${r} was not found in ${a.targetName} entity.`);if(isNaN(Number(i)))throw new L(`Value "${i}" is not a number.`);const o=r.split(".").reduceRight((l,u)=>({[u]:l}),()=>this.connection.driver.escape(s.databaseName)+" - "+i);return this.createQueryBuilder(e,"entity").update(e).set(o).where(t).execute()}getRepository(e){const t=this.repositories.get(e);if(t)return t;if(this.connection.driver.options.type==="mongodb"){const r=new n1(e,this,this.queryRunner);return this.repositories.set(e,r),r}else{const r=new kb(e,this,this.queryRunner);return this.repositories.set(e,r),r}}getTreeRepository(e){if(this.connection.driver.treeSupport===!1)throw new I_(this.connection.driver);const t=this.treeRepositories.find(i=>i.target===e);if(t)return t;const r=new u1(e,this,this.queryRunner);return this.treeRepositories.push(r),r}getMongoRepository(e){return this.connection.getMongoRepository(e)}withRepository(e){const t=e.constructor,{target:r,manager:i,queryRunner:a,...s}=e;return Object.assign(new t(e.target,this),{...s})}getCustomRepository(e){const t=Wt().entityRepositories.find(a=>a.target===(typeof e=="function"?e:e.constructor));if(!t)throw new $b(e);const r=t.entity?this.connection.getMetadata(t.entity):void 0,i=new t.target(this,r);if(i instanceof p1)i.manager||(i.manager=this);else{if(!r)throw new q_(e);i.manager=this,i.metadata=r}return i}async release(){if(!this.queryRunner)throw new H_;return this.queryRunner.release()}}class Q1 extends Vb{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("SqljsEntityManager"),this.driver=e.driver}async loadDatabase(e){await this.driver.load(e)}async saveDatabase(e){await this.driver.save(e)}exportDatabase(){return this.driver.export()}}class V1{create(e,t){return e.driver.options.type==="mongodb"?new t1(e):e.driver.options.type==="sqljs"?new Q1(e,t):new Vb(e,t)}}class Ci{constructor(e){this["@instanceof"]=Symbol.for("View"),this.indices=[],e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,this.expression=e.expression,this.materialized=!!e.materialized)}clone(){return new Ci({database:this.database,schema:this.schema,name:this.name,expression:this.expression,materialized:this.materialized})}addIndex(e){this.indices.push(e)}removeIndex(e){const t=this.indices.find(r=>r.name===e.name);t&&this.indices.splice(this.indices.indexOf(t),1)}static create(e,t){const r={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,e.schema,e.database),expression:e.expression,materialized:e.tableMetadataArgs.materialized};return new Ci(r)}}class vE{static viewMetadataCmp(e,t){return!e||!t?0:e.dependsOn&&(e.dependsOn.has(t.target)||e.dependsOn.has(t.name))?1:t.dependsOn&&(t.dependsOn.has(e.target)||t.dependsOn.has(e.name))?-1:0}}class th{constructor(e){this.connection=e,this["@instanceof"]=Symbol.for("RdbmsSchemaBuilder")}async build(){this.queryRunner=this.connection.createQueryRunner(),this.currentDatabase=this.connection.driver.database,this.currentSchema=this.connection.driver.schema;const e=this.connection.driver.options.type!=="cockroachdb"&&this.connection.driver.options.type!=="spanner"&&this.connection.options.migrationsTransactionMode!=="none";await this.queryRunner.beforeMigration(),e&&await this.queryRunner.startTransaction();try{await this.createMetadataTableIfNecessary(this.queryRunner);const t=this.entityToSyncMetadatas.map(i=>this.getTablePath(i)),r=this.viewEntityToSyncMetadatas.map(i=>this.getTablePath(i));await this.queryRunner.getTables(t),await this.queryRunner.getViews(r),await this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&await this.connection.queryResultCache.synchronize(this.queryRunner),e&&await this.queryRunner.commitTransaction()}catch(t){try{e&&await this.queryRunner.rollbackTransaction()}catch{}throw t}finally{await this.queryRunner.afterMigration(),await this.queryRunner.release()}}async createMetadataTableIfNecessary(e){(this.viewEntityToSyncMetadatas.length>0||this.hasGeneratedColumns())&&await this.createTypeormMetadataTable(e)}async log(){this.queryRunner=this.connection.createQueryRunner();try{const e=this.entityToSyncMetadatas.map(r=>this.getTablePath(r)),t=this.viewEntityToSyncMetadatas.map(r=>this.getTablePath(r));return await this.queryRunner.getTables(e),await this.queryRunner.getViews(t),this.queryRunner.enableSqlMemory(),await this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&await this.connection.queryResultCache.synchronize(this.queryRunner),this.queryRunner.getMemorySql()}finally{this.queryRunner.disableSqlMemory(),await this.queryRunner.release()}}get entityToSyncMetadatas(){return this.connection.entityMetadatas.filter(e=>e.synchronize&&e.tableType!=="entity-child"&&e.tableType!=="view")}get viewEntityToSyncMetadatas(){return this.connection.entityMetadatas.filter(e=>e.tableType==="view"&&e.synchronize).sort(vE.viewMetadataCmp)}hasGeneratedColumns(){return this.connection.entityMetadatas.some(e=>e.columns.some(t=>t.generatedType))}async executeSchemaSyncOperationsInProperOrder(){await this.dropOldViews(),await this.dropOldForeignKeys(),await this.dropOldIndices(),await this.dropOldChecks(),await this.dropOldExclusions(),await this.dropCompositeUniqueConstraints(),await this.renameColumns(),await this.createNewTables(),await this.dropRemovedColumns(),await this.addNewColumns(),await this.updatePrimaryKeys(),await this.updateExistColumns(),await this.createNewIndices(),await this.createNewChecks(),await this.createNewExclusions(),await this.createCompositeUniqueConstraints(),await this.createForeignKeys(),await this.createViews(),await this.createNewViewIndices()}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema||this.currentSchema,t.database||this.currentDatabase)}async dropOldForeignKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=t.foreignKeys.filter(i=>{const a=e.foreignKeys.find(s=>i.name===s.name&&this.getTablePath(i)===this.getTablePath(s.referencedEntityMetadata));return!a||a.onDelete&&a.onDelete!==i.onDelete||a.onUpdate&&a.onUpdate!==i.onUpdate});r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old foreign keys of ${t.name}: ${r.map(i=>i.name).join(", ")}`),await this.queryRunner.dropForeignKeys(t,r))}}async renameTables(){}async renameColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===this.getTablePath(e));if(!t||e.columns.length!==t.columns.length)continue;const r=e.columns.filter(s=>!s.isVirtualProperty).filter(s=>!t.columns.find(o=>o.name===s.databaseName&&o.type===this.connection.driver.normalizeType(s)&&o.isNullable===s.isNullable&&o.isUnique===this.connection.driver.normalizeIsUnique(s)));if(r.length===0||r.length>1)continue;const i=t.columns.filter(s=>!e.columns.find(o=>!o.isVirtualProperty&&o.databaseName===s.name&&this.connection.driver.normalizeType(o)===s.type&&o.isNullable===s.isNullable&&this.connection.driver.normalizeIsUnique(o)===s.isUnique));if(i.length===0||i.length>1)continue;const a=i[0].clone();a.name=r[0].databaseName,this.connection.logger.logSchemaBuild(`renaming column "${i[0].name}" in "${t.name}" to "${a.name}"`),await this.queryRunner.renameColumn(t,i[0],a)}}async dropOldIndices(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=t.indices.filter(i=>{const a=e.indices.find(s=>s.name===i.name);return a?a.synchronize===!1?!1:a.isUnique!==i.isUnique||a.isSpatial!==i.isSpatial||this.connection.driver.isFullTextColumnTypeSupported()&&a.isFulltext!==i.isFulltext||a.columns.length!==i.columnNames.length?!0:!a.columns.every(s=>i.columnNames.indexOf(s.databaseName)!==-1):!0}).map(async i=>{this.connection.logger.logSchemaBuild(`dropping an index: "${i.name}" from table ${t.name}`),await this.queryRunner.dropIndex(t,i)});await Promise.all(r)}if(this.connection.options.type==="postgres"){const e=this.queryRunner;for(const t of this.viewEntityToSyncMetadatas){const r=this.queryRunner.loadedViews.find(a=>this.getTablePath(a)===this.getTablePath(t));if(!r)continue;const i=r.indices.filter(a=>{const s=t.indices.find(o=>o.name===a.name);return s?s.synchronize===!1?!1:s.isUnique!==a.isUnique||s.isSpatial!==a.isSpatial||this.connection.driver.isFullTextColumnTypeSupported()&&s.isFulltext!==a.isFulltext||s.columns.length!==a.columnNames.length?!0:!s.columns.every(o=>a.columnNames.indexOf(o.databaseName)!==-1):!0}).map(async a=>{this.connection.logger.logSchemaBuild(`dropping an index: "${a.name}" from view ${r.name}`),await e.dropViewIndex(r,a)});await Promise.all(i)}}}async dropOldChecks(){if(!(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"))for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=t.checks.filter(i=>!e.checks.find(a=>a.name===i.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old check constraint: ${r.map(i=>`"${i.name}"`).join(", ")} from table "${t.name}"`),await this.queryRunner.dropCheckConstraints(t,r))}}async dropCompositeUniqueConstraints(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=t.uniques.filter(i=>i.columnNames.length>1&&!e.uniques.find(a=>a.name===i.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old unique constraint: ${r.map(i=>`"${i.name}"`).join(", ")} from table "${t.name}"`),await this.queryRunner.dropUniqueConstraints(t,r))}}async dropOldExclusions(){if(this.connection.driver.options.type==="postgres")for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=t.exclusions.filter(i=>!e.exclusions.find(a=>a.name===i.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old exclusion constraint: ${r.map(i=>`"${i.name}"`).join(", ")} from table "${t.name}"`),await this.queryRunner.dropExclusionConstraints(t,r))}}async createNewTables(){for(const e of this.entityToSyncMetadatas){if(this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e)))continue;this.connection.logger.logSchemaBuild(`creating a new table: ${this.getTablePath(e)}`);const r=xt.create(e,this.connection.driver);await this.queryRunner.createTable(r,!1,!1),this.queryRunner.loadedTables.push(r)}}async createViews(){for(const e of this.viewEntityToSyncMetadatas){if(this.queryRunner.loadedViews.find(i=>{const a=typeof i.expression=="string"?i.expression.trim():i.expression(this.connection).getQuery(),s=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.getTablePath(i)===this.getTablePath(e)&&a===s}))continue;this.connection.logger.logSchemaBuild(`creating a new view: ${this.getTablePath(e)}`);const r=Ci.create(e,this.connection.driver);await this.queryRunner.createView(r,!0),this.queryRunner.loadedViews.push(r)}}async dropOldViews(){const e=[],t=this.viewEntityToSyncMetadatas,r=new Map;for(const s of this.queryRunner.loadedViews){const o=t.find(l=>this.getTablePath(s)===this.getTablePath(l));o&&r.set(s,o)}for(const s of this.queryRunner.loadedViews){const o=r.get(s);if(!o)continue;const l=typeof s.expression=="string"?s.expression.trim():s.expression(this.connection).getQuery(),u=typeof o.expression=="string"?o.expression.trim():o.expression(this.connection).getQuery();l!==u&&(this.connection.logger.logSchemaBuild(`dropping an old view: ${s.name}`),e.push(s))}const i=s=>{const o=r.get(s);let l=[s];if(!o)return l;for(const[u,c]of r.entries())u!==s&&c.dependsOn&&(c.dependsOn.has(o.target)||c.dependsOn.has(o.name))&&(l=l.concat(i(u)));return l},a=new Set(e.map(s=>i(s)).reduce((s,o)=>s.concat(o),[]).sort((s,o)=>vE.viewMetadataCmp(r.get(s),r.get(o))).reverse());for(const s of a)await this.queryRunner.dropView(s);this.queryRunner.loadedViews=this.queryRunner.loadedViews.filter(s=>!a.has(s))}async dropRemovedColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=t.columns.filter(i=>!e.columns.find(a=>a.isVirtualProperty||a.databaseName===i.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`columns dropped in ${t.name}: `+r.map(i=>i.name).join(", ")),await this.queryRunner.dropColumns(t,r))}}async addNewColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===this.getTablePath(e));if(!t)continue;const r=e.columns.filter(s=>!s.isVirtualProperty&&!t.columns.find(o=>o.name===s.databaseName));if(r.length===0)continue;const a=this.metadataColumnsToTableColumnOptions(r).map(s=>new Tn(s));a.length!==0&&(this.connection.logger.logSchemaBuild("new columns added: "+r.map(s=>s.databaseName).join(", ")),await this.queryRunner.addColumns(t,a))}}async updatePrimaryKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.columns.filter(a=>a.isPrimary);if(t.columns.filter(a=>a.isPrimary).length!==r.length&&r.length>1){const a=r.map(s=>new Tn(kc.createTableColumnOptions(s,this.connection.driver)));await this.queryRunner.updatePrimaryKeys(t,a)}}}async updateExistColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=this.connection.driver.findChangedColumns(t.columns,e.columns);if(r.length===0)continue;for(const a of r)await this.dropColumnReferencedForeignKeys(this.getTablePath(e),a.databaseName);for(const a of r)await this.dropColumnCompositeIndices(this.getTablePath(e),a.databaseName);if(!(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="spanner"))for(const a of r)await this.dropColumnCompositeUniques(this.getTablePath(e),a.databaseName);const i=r.map(a=>{const s=t.columns.find(u=>u.name===a.databaseName),o=kc.createTableColumnOptions(a,this.connection.driver),l=new Tn(o);return{oldColumn:s,newColumn:l}});i.length!==0&&(this.connection.logger.logSchemaBuild(`columns changed in "${t.name}". updating: `+r.map(a=>a.databaseName).join(", ")),await this.queryRunner.changeColumns(t,i))}}async createNewIndices(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=e.indices.filter(i=>!t.indices.find(a=>a.name===i.name)&&i.synchronize===!0).map(i=>At.create(i));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new indices ${r.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createIndices(t,r))}}async createNewViewIndices(){if(this.connection.options.type!=="postgres"||!me.isPostgresFamily(this.connection.driver))return;const e=this.queryRunner;for(const t of this.viewEntityToSyncMetadatas){const r=this.queryRunner.loadedViews.find(a=>{const s=typeof a.expression=="string"?a.expression.trim():a.expression(this.connection).getQuery(),o=typeof t.expression=="string"?t.expression.trim():t.expression(this.connection).getQuery();return this.getTablePath(a)===this.getTablePath(t)&&s===o});if(!r||!r.materialized)continue;const i=t.indices.filter(a=>!r.indices.find(s=>s.name===a.name)&&a.synchronize===!0).map(a=>At.create(a));i.length!==0&&(this.connection.logger.logSchemaBuild(`adding new indices ${i.map(a=>`"${a.name}"`).join(", ")} in view "${r.name}"`),await e.createViewIndices(r,i))}}async createNewChecks(){if(!(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"))for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=e.checks.filter(i=>!t.checks.find(a=>a.name===i.name)).map(i=>Mr.create(i));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new check constraints: ${r.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createCheckConstraints(t,r))}}async createCompositeUniqueConstraints(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=e.uniques.filter(i=>i.columns.length>1&&!t.uniques.find(a=>a.name===i.name)).map(i=>un.create(i));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new unique constraints: ${r.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createUniqueConstraints(t,r))}}async createNewExclusions(){if(this.connection.driver.options.type==="postgres")for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=e.exclusions.filter(i=>!t.exclusions.find(a=>a.name===i.name)).map(i=>Ja.create(i));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new exclusion constraints: ${r.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createExclusionConstraints(t,r))}}async createForeignKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.foreignKeys.filter(a=>!t.foreignKeys.find(s=>s.name===a.name&&this.getTablePath(s)===this.getTablePath(a.referencedEntityMetadata)));if(r.length===0)continue;const i=r.map(a=>ir.create(a,this.connection.driver));this.connection.logger.logSchemaBuild(`creating a foreign keys: ${r.map(a=>a.name).join(", ")} on table "${t.name}"`),await this.queryRunner.createForeignKeys(t,i)}}async dropColumnReferencedForeignKeys(e,t){const r=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===e);if(!r)return;const i=[],a=r.foreignKeys.find(s=>s.columnNames.indexOf(t)!==-1);if(a){const s=r.clone();s.foreignKeys=[a],i.push(s),r.removeForeignKey(a)}for(const s of this.queryRunner.loadedTables){const o=s.foreignKeys.filter(l=>this.getTablePath(l)===e&&l.referencedColumnNames.indexOf(t)!==-1);if(o.length>0){const l=s.clone();l.foreignKeys=o,i.push(l),o.forEach(u=>s.removeForeignKey(u))}}if(i.length>0)for(const s of i)this.connection.logger.logSchemaBuild(`dropping related foreign keys of ${s.name}: ${s.foreignKeys.map(o=>o.name).join(", ")}`),await this.queryRunner.dropForeignKeys(s,s.foreignKeys)}async dropColumnCompositeIndices(e,t){const r=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===e);if(!r)return;const i=r.indices.filter(a=>a.columnNames.length>1&&a.columnNames.indexOf(t)!==-1);i.length!==0&&(this.connection.logger.logSchemaBuild(`dropping related indices of "${e}"."${t}": ${i.map(a=>a.name).join(", ")}`),await this.queryRunner.dropIndices(r,i))}async dropColumnCompositeUniques(e,t){const r=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===e);if(!r)return;const i=r.uniques.filter(a=>a.columnNames.length>1&&a.columnNames.indexOf(t)!==-1);i.length!==0&&(this.connection.logger.logSchemaBuild(`dropping related unique constraints of "${e}"."${t}": ${i.map(a=>a.name).join(", ")}`),await this.queryRunner.dropUniqueConstraints(r,i))}metadataColumnsToTableColumnOptions(e){return e.map(t=>kc.createTableColumnOptions(t,this.connection.driver))}async createTypeormMetadataTable(e){const t=this.currentSchema,r=this.currentDatabase,i=this.connection.driver.buildTableName(this.connection.metadataTableName,t,r),a=this.connection.driver.options.type==="spanner";await e.createTable(new xt({database:r,schema:t,name:i,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1,isPrimary:a},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0,isPrimary:a},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0,isPrimary:a},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0,isPrimary:a},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0,isPrimary:a},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0,isPrimary:a}]}),!0)}}class Cu{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime","json"],this.supportedUpsertTypes=["on-conflict-do-update"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=me.buildDriverOptions(this.options).database}async connect(){this.databaseConnection=await this.createDatabaseConnection()}afterConnect(){return Promise.resolve()}async disconnect(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close(r=>r?t(r):e())})}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,r;return(r=(t=this.attachedDatabases)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return(t=Object.values(this.attachedDatabases).find(({attachHandle:r})=>e===r))===null||t===void 0?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new th(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=Ft.transformTo(t.transformer,e)),e==null?e:t.type===Boolean||t.type==="boolean"?e===!0?1:0:t.type==="date"?Ie.mixedDateToDateString(e):t.type==="time"?Ie.mixedDateToTimeString(e):t.type==="datetime"||t.type===Date?Ie.mixedDateToUtcDatetimeString(e):t.type==="json"||t.type==="simple-json"?Ie.simpleJsonToString(e):t.type==="simple-array"?Ie.simpleArrayToString(e):t.type==="simple-enum"?Ie.simpleEnumToString(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?Ft.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?(e&&typeof e=="string"&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=Ie.normalizeHydratedDate(e)):t.type==="date"?e=Ie.mixedDateToDateString(e):t.type==="time"?e=Ie.mixedTimeToString(e):t.type==="json"||t.type==="simple-json"?e=Ie.stringToSimpleJson(e):t.type==="simple-array"?e=Ie.stringToSimpleArray(e):t.type==="simple-enum"?e=Ie.stringToSimpleEnum(e,t):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=Ft.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,r){const i=Object.keys(r).map(a=>typeof r[a]=="boolean"?r[a]===!0?1:0:r[a]instanceof Date?Ie.mixedDateToUtcDatetimeString(r[a]):r[a]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,s,o)=>{if(!t.hasOwnProperty(o))return a;let l=t[o];return s?l.map(u=>(i.push(u),this.createParameter(o,i.length-1))).join(", "):typeof l=="function"?l():typeof l=="number"?String(l):typeof l=="boolean"?(i.push(+l),this.createParameter(o,i.length-1)):l instanceof Date?(i.push(Ie.mixedDateToUtcDatetimeString(l)),this.createParameter(o,i.length-1)):(i.push(l),this.createParameter(o,i.length-1))}),[e,i])}escape(e){return'"'+e+'"'}buildTableName(e,t,r){return e}parseTableName(e){var t;const r=this.database,i=void 0;if(U.isTable(e)||U.isView(e)){const s=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||s.database||r,schema:e.schema||s.schema||i,tableName:s.tableName}}if(U.isTableForeignKey(e)){const s=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||s.database||r,schema:e.referencedSchema||s.schema||i,tableName:s.tableName}}if(U.isEntityMetadata(e))return{database:e.database||r,schema:e.schema||i,tableName:e.tableName};const a=e.split(".");return a.length===3?{database:a[0]||r,schema:a[1]||i,tableName:a[2]}:a.length===2?{database:(t=this.getAttachedDatabasePathRelativeByHandle(a[0]))!==null&&t!==void 0?t:r,schema:a[0],tableName:a[1]}:{database:r,schema:i,tableName:e}}normalizeType(e){return e.type===Number||e.type==="int"?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"varchar":e.type||""}normalizeDefault(e){const t=e.default;if(typeof t=="number")return""+t;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!=null)return`${t}`}normalizeIsUnique(e){return e.entityMetadata.uniques.some(t=>t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+="("+e.precision+","+e.scale+")":e.precision!==null&&e.precision!==void 0&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,r,i){const a=e.generatedColumns.reduce((s,o)=>{let l;return o.generationStrategy==="increment"&&t&&(l=t-i+r+1),l?be.mergeDeep(s,o.createValueMap(l)):s},{});return Object.keys(a).length>0?a:void 0}findChangedColumns(e,t){return t.filter(r=>{const i=e.find(s=>s.name===r.databaseName);return i?i.name!==r.databaseName||i.type!==this.normalizeType(r)||i.length!==r.length||i.precision!==r.precision||i.scale!==r.scale||this.normalizeDefault(r)!==i.default||i.isPrimary!==r.isPrimary||i.isNullable!==r.isNullable||i.generatedType!==r.generatedType||i.asExpression!==r.asExpression||i.isUnique!==this.normalizeIsUnique(r)||i.enum&&r.enum&&!be.isArraysEqual(i.enum,r.enum.map(s=>s+""))||r.generationStrategy!=="uuid"&&i.isGenerated!==r.isGenerated:!1})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){throw new L("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")}loadDependencies(){}}class I{constructor(e,t){this.query=e,this.parameters=t,this["@instanceof"]=Symbol.for("Query")}}class Ec{constructor(){this.upQueries=[],this.downQueries=[]}}class nh{constructor(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new Ec,this.transactionDepth=0,this.cachedTablePaths={}}async beforeMigration(){}async afterMigration(){}async getTable(e){return this.loadedTables=await this.loadTables([e]),this.loadedTables.length>0?this.loadedTables[0]:void 0}async getTables(e){return e?(this.loadedTables=await this.loadTables(e),this.loadedTables):await this.loadTables(e)}async getView(e){return this.loadedViews=await this.loadViews([e]),this.loadedViews.length>0?this.loadedViews[0]:void 0}async getViews(e){return this.loadedViews=await this.loadViews(e),this.loadedViews}enableSqlMemory(){this.sqlInMemory=new Ec,this.sqlMemoryMode=!0}disableSqlMemory(){this.sqlInMemory=new Ec,this.sqlMemoryMode=!1}clearSqlMemory(){this.sqlInMemory=new Ec}getMemorySql(){return this.sqlInMemory}async executeMemoryUpSql(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)await this.query(e,t)}async executeMemoryDownSql(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())await this.query(e,t)}getReplicationMode(){return this.mode}async getCachedView(e){const t=this.loadedViews.find(i=>i.name===e);if(t)return t;const r=await this.loadViews([e]);if(r.length>0)return this.loadedViews.push(r[0]),r[0];throw new L(`View "${e}" does not exist.`)}async getCachedTable(e){if(e in this.cachedTablePaths){const r=this.cachedTablePaths[e],i=this.loadedTables.find(a=>this.getTablePath(a)===r);if(i)return i}const t=await this.loadTables([e]);if(t.length>0){const r=this.getTablePath(t[0]),i=this.loadedTables.find(a=>this.getTablePath(a)===r);return i||(this.cachedTablePaths[e]=this.getTablePath(t[0]),this.loadedTables.push(t[0]),t[0])}else throw new L(`Table "${e}" does not exist.`)}replaceCachedTable(e,t){const r=this.getTablePath(e),i=this.loadedTables.find(a=>this.getTablePath(a)===r);for(const[a,s]of Object.entries(this.cachedTablePaths))s===r&&(this.cachedTablePaths[a]=this.getTablePath(t));i&&(i.database=t.database,i.schema=t.schema,i.name=t.name,i.columns=t.columns,i.indices=t.indices,i.foreignKeys=t.foreignKeys,i.uniques=t.uniques,i.checks=t.checks,i.justCreated=t.justCreated,i.engine=t.engine)}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema,t.database)}getTypeormMetadataTableName(){const e=this.connection.driver.options;return this.connection.driver.buildTableName(this.connection.metadataTableName,e.schema,e.database)}selectTypeormMetadataSql({database:e,schema:t,table:r,type:i,name:a}){const s=this.connection.createQueryBuilder(),o=s.select().from(this.getTypeormMetadataTableName(),"t").where(`${s.escape("type")} = :type`,{type:i}).andWhere(`${s.escape("name")} = :name`,{name:a});e&&o.andWhere(`${s.escape("database")} = :database`,{database:e}),t&&o.andWhere(`${s.escape("schema")} = :schema`,{schema:t}),r&&o.andWhere(`${s.escape("table")} = :table`,{table:r});const[l,u]=o.getQueryAndParameters();return new I(l,u)}insertTypeormMetadataSql({database:e,schema:t,table:r,type:i,name:a,value:s}){const[o,l]=this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({database:e,schema:t,table:r,type:i,name:a,value:s}).getQueryAndParameters();return new I(o,l)}deleteTypeormMetadataSql({database:e,schema:t,table:r,type:i,name:a}){const s=this.connection.createQueryBuilder(),o=s.delete().from(this.getTypeormMetadataTableName()).where(`${s.escape("type")} = :type`,{type:i}).andWhere(`${s.escape("name")} = :name`,{name:a});e&&o.andWhere(`${s.escape("database")} = :database`,{database:e}),t&&o.andWhere(`${s.escape("schema")} = :schema`,{schema:t}),r&&o.andWhere(`${s.escape("table")} = :table`,{table:r});const[l,u]=o.getQueryAndParameters();return new I(l,u)}isColumnChanged(e,t,r,i,a=!0){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||r&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||i&&e.comment!==t.comment||a&&this.isEnumChanged(e,t)}isEnumChanged(e,t){return!be.isArraysEqual(e.enum||[],t.enum||[])}isDefaultColumnLength(e,t,r){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&this.connection.driver.getColumnLength(a))return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length?this.connection.driver.dataTypeDefaults[t.type].length.toString()===r.toString():!1}isDefaultColumnPrecision(e,t,r){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&a.precision!==null&&a.precision!==void 0)return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].precision!==null&&this.connection.driver.dataTypeDefaults[t.type].precision!==void 0?this.connection.driver.dataTypeDefaults[t.type].precision===r:!1}isDefaultColumnScale(e,t,r){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&a.scale!==null&&a.scale!==void 0)return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].scale!==null&&this.connection.driver.dataTypeDefaults[t.type].scale!==void 0?this.connection.driver.dataTypeDefaults[t.type].scale===r:!1}async executeQueries(e,t){if(U.isQuery(e)&&(e=[e]),U.isQuery(t)&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),this.sqlMemoryMode===!0)return Promise.resolve();for(const{query:r,parameters:i}of e)await this.query(r,i)}generateIndexName(e,t){return this.connection.namingStrategy.indexName(e,t.columnNames,t.where)}}var Oe;(function(n){n.VIEW="VIEW",n.MATERIALIZED_VIEW="MATERIALIZED_VIEW",n.GENERATED_COLUMN="GENERATED_COLUMN"})(Oe||(Oe={}));class Co extends nh{constructor(){super(),this.transactionPromise=null}connect(){return Promise.resolve(this.driver.databaseConnection)}release(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()}async startTransaction(e){if(this.driver.transactionSupport==="none")throw new L(`Transactions aren't supported by ${this.connection.driver.options.type}.`);if(this.isTransactionActive&&this.driver.transactionSupport==="simple")throw new D_;if(e&&e!=="READ UNCOMMITTED"&&e!=="SERIALIZABLE")throw new L("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?(e&&(e==="READ UNCOMMITTED"?await this.query("PRAGMA read_uncommitted = true"):await this.query("PRAGMA read_uncommitted = false")),await this.query("BEGIN TRANSACTION")):await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}stream(e,t,r,i){throw new L("Stream is not supported by sqlite driver.")}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){return Promise.resolve(!1)}async getCurrentDatabase(){return Promise.resolve(void 0)}async hasSchema(e){throw new L("This driver does not support table schemas")}async getCurrentSchema(){return Promise.resolve(void 0)}async hasTable(e){const r=`SELECT * FROM "sqlite_master" WHERE "type" = 'table' AND "name" = '${U.isTable(e)?e.name:e}'`;return!!(await this.query(r)).length}async hasColumn(e,t){const r=U.isTable(e)?e.name:e,i=`PRAGMA table_xinfo(${this.escapePath(r)})`;return!!(await this.query(i)).find(s=>s.name===t)}async createDatabase(e,t){return Promise.resolve()}async dropDatabase(e,t){return Promise.resolve()}async createSchema(e,t){return Promise.resolve()}async dropSchema(e,t){return Promise.resolve()}async createTable(e,t=!1,r=!0,i=!0){const a=[],s=[];if(t&&await this.hasTable(e))return Promise.resolve();a.push(this.createTableSql(e,r)),s.push(this.dropTableSql(e)),i&&e.indices.forEach(l=>{l.name||(l.name=this.connection.namingStrategy.indexName(e,l.columnNames,l.where)),a.push(this.createIndexSql(e,l)),s.push(this.dropIndexSql(l))});const o=e.columns.filter(l=>l.generatedType&&l.asExpression);for(const l of o){const u=this.insertTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:l.name,value:l.asExpression}),c=this.deleteTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:l.name});a.push(u),s.push(c)}await this.executeQueries(a,s)}async dropTable(e,t,r=!0,i=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const a=r,s=U.isTable(e)?e:await this.getCachedTable(e),o=[],l=[];i&&s.indices.forEach(c=>{o.push(this.dropIndexSql(c)),l.push(this.createIndexSql(s,c))}),o.push(this.dropTableSql(s,t)),l.push(this.createTableSql(s,a));const u=s.columns.filter(c=>c.generatedType&&c.asExpression);for(const c of u){const d=this.deleteTypeormMetadataSql({table:s.name,type:Oe.GENERATED_COLUMN,name:c.name}),h=this.insertTypeormMetadataSql({table:s.name,type:Oe.GENERATED_COLUMN,name:c.name,value:c.asExpression});o.push(d),l.push(h)}await this.executeQueries(o,l)}async createView(e,t=!1){const r=[],i=[];r.push(this.createViewSql(e)),t&&r.push(this.insertViewDefinitionSql(e)),i.push(this.dropViewSql(e)),t&&i.push(this.deleteViewDefinitionSql(e)),await this.executeQueries(r,i)}async dropView(e){const t=U.isView(e)?e.name:e,r=await this.getCachedView(t),i=[],a=[];i.push(this.deleteViewDefinitionSql(r)),i.push(this.dropViewSql(r)),a.push(this.insertViewDefinitionSql(r)),a.push(this.createViewSql(r)),await this.executeQueries(i,a)}async renameTable(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();i.name=t;const a=new I(`ALTER TABLE ${this.escapePath(r.name)} RENAME TO ${this.escapePath(t)}`),s=new I(`ALTER TABLE ${this.escapePath(t)} RENAME TO ${this.escapePath(r.name)}`);await this.executeQueries(a,s),i.uniques.forEach(o=>{const l=this.connection.namingStrategy.uniqueConstraintName(r,o.columnNames);o.name===l&&(o.name=this.connection.namingStrategy.uniqueConstraintName(i,o.columnNames))}),i.foreignKeys.forEach(o=>{const l=this.connection.namingStrategy.foreignKeyName(r,o.columnNames,this.getTablePath(o),o.referencedColumnNames);o.name===l&&(o.name=this.connection.namingStrategy.foreignKeyName(i,o.columnNames,this.getTablePath(o),o.referencedColumnNames))}),i.indices.forEach(o=>{const l=this.connection.namingStrategy.indexName(r,o.columnNames,o.where);o.name===l&&(o.name=this.connection.namingStrategy.indexName(i,o.columnNames,o.where))}),r.name=i.name,await this.recreateTable(i,r)}async addColumn(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);return this.addColumns(r,[t])}async addColumns(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.addColumn(a)),await this.recreateTable(i,r)}async renameColumn(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e),a=U.isTableColumn(t)?t:i.columns.find(o=>o.name===t);if(!a)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);let s;return U.isTableColumn(r)?s=r:(s=a.clone(),s.name=r),this.changeColumn(i,a,s)}async changeColumn(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e),a=U.isTableColumn(t)?t:i.columns.find(s=>s.name===t);if(!a)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);await this.changeColumns(i,[{oldColumn:a,newColumn:r}])}async changeColumns(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>{a.newColumn.name!==a.oldColumn.name&&(i.findColumnUniques(a.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.uniqueConstraintName(r,o.columnNames);o.columnNames.splice(o.columnNames.indexOf(a.oldColumn.name),1),o.columnNames.push(a.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.uniqueConstraintName(i,o.columnNames))}),i.findColumnForeignKeys(a.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.foreignKeyName(r,o.columnNames,this.getTablePath(o),o.referencedColumnNames);o.columnNames.splice(o.columnNames.indexOf(a.oldColumn.name),1),o.columnNames.push(a.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.foreignKeyName(i,o.columnNames,this.getTablePath(o),o.referencedColumnNames))}),i.findColumnIndices(a.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.indexName(r,o.columnNames,o.where);o.columnNames.splice(o.columnNames.indexOf(a.oldColumn.name),1),o.columnNames.push(a.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.indexName(i,o.columnNames,o.where))}));const s=i.columns.find(o=>o.name===a.oldColumn.name);s&&(i.columns[i.columns.indexOf(s)]=a.newColumn)}),await this.recreateTable(i,r)}async dropColumn(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableColumn(t)?t:r.findColumnByName(t);if(!i)throw new L(`Column "${t}" was not found in table "${r.name}"`);await this.dropColumns(r,[i])}async dropColumns(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>{const s=U.isTableColumn(a)?a:r.findColumnByName(a);if(!s)throw new Error(`Column "${a}" was not found in table "${r.name}"`);i.removeColumn(s),i.findColumnUniques(s).forEach(o=>i.removeUniqueConstraint(o)),i.findColumnIndices(s).forEach(o=>i.removeIndex(o)),i.findColumnForeignKeys(s).forEach(o=>i.removeForeignKey(o))}),await this.recreateTable(i,r)}async createPrimaryKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();i.columns.forEach(a=>{t.find(s=>s===a.name)&&(a.isPrimary=!0)}),await this.recreateTable(i,r),r.columns.forEach(a=>{t.find(s=>s===a.name)&&(a.isPrimary=!0)})}async updatePrimaryKeys(e,t){await Promise.resolve()}async dropPrimaryKey(e){const t=U.isTable(e)?e:await this.getCachedTable(e),r=t.clone();r.primaryColumns.forEach(i=>{i.isPrimary=!1}),await this.recreateTable(r,t),t.primaryColumns.forEach(i=>{i.isPrimary=!1})}async createUniqueConstraint(e,t){await this.createUniqueConstraints(e,[t])}async createUniqueConstraints(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.addUniqueConstraint(a)),await this.recreateTable(i,r)}async dropUniqueConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableUnique(t)?t:r.uniques.find(a=>a.name===t);if(!i)throw new L(`Supplied unique constraint was not found in table ${r.name}`);await this.dropUniqueConstraints(r,[i])}async dropUniqueConstraints(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.removeUniqueConstraint(a)),await this.recreateTable(i,r)}async createCheckConstraint(e,t){await this.createCheckConstraints(e,[t])}async createCheckConstraints(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.addCheckConstraint(a)),await this.recreateTable(i,r)}async dropCheckConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableCheck(t)?t:r.checks.find(a=>a.name===t);if(!i)throw new L(`Supplied check constraint was not found in table ${r.name}`);await this.dropCheckConstraints(r,[i])}async dropCheckConstraints(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.removeCheckConstraint(a)),await this.recreateTable(i,r)}async createExclusionConstraint(e,t){throw new L("Sqlite does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new L("Sqlite does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new L("Sqlite does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new L("Sqlite does not support exclusion constraints.")}async createForeignKey(e,t){await this.createForeignKeys(e,[t])}async createForeignKeys(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.addForeignKey(a)),await this.recreateTable(i,r)}async dropForeignKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableForeignKey(t)?t:r.foreignKeys.find(a=>a.name===t);if(!i)throw new L(`Supplied foreign key was not found in table ${r.name}`);await this.dropForeignKeys(e,[i])}async dropForeignKeys(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone();t.forEach(a=>i.removeForeignKey(a)),await this.recreateTable(i,r)}async createIndex(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const i=this.createIndexSql(r,t),a=this.dropIndexSql(t);await this.executeQueries(i,a),r.addIndex(t)}async createIndices(e,t){const r=t.map(i=>this.createIndex(e,i));await Promise.all(r)}async dropIndex(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!i)throw new L(`Supplied index ${t} was not found in table ${r.name}`);i.name||(i.name=this.generateIndexName(r,i));const a=this.dropIndexSql(i),s=this.createIndexSql(r,i);await this.executeQueries(a,s),r.removeIndex(i)}async dropIndices(e,t){const r=t.map(i=>this.dropIndex(e,i));await Promise.all(r)}async clearTable(e){await this.query(`DELETE FROM ${this.escapePath(e)}`)}async clearDatabase(e){let t;e&&this.driver.getAttachedDatabaseHandleByRelativePath(e)&&(t=this.driver.getAttachedDatabaseHandleByRelativePath(e)),await this.query("PRAGMA foreign_keys = OFF");const r=this.isTransactionActive;r||await this.startTransaction();try{const i=t?`SELECT 'DROP VIEW "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'view'`:`SELECT 'DROP VIEW "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'view'`,a=await this.query(i);await Promise.all(a.map(l=>this.query(l.query)));const s=t?`SELECT 'DROP TABLE "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`:`SELECT 'DROP TABLE "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`,o=await this.query(s);await Promise.all(o.map(l=>this.query(l.query))),r||await this.commitTransaction()}catch(i){try{r||await this.rollbackTransaction()}catch{}throw i}finally{await this.query("PRAGMA foreign_keys = ON")}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const r=e.map(s=>"'"+s+"'").join(", ");let i=`SELECT "t".* FROM "${this.getTypeormMetadataTableName()}" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = 'view' WHERE "t"."type" = '${Oe.VIEW}'`;return r.length>0&&(i+=` AND "t"."name" IN (${r})`),(await this.query(i)).map(s=>{const o=new Ci;return o.name=s.name,o.expression=s.value,o})}async loadTableRecords(e,t){let r;const[i,a]=this.splitTablePath(e);return i&&this.driver.getAttachedDatabasePathRelativeByHandle(i)&&(r=this.driver.getAttachedDatabasePathRelativeByHandle(i)),this.query(`SELECT ${r?`'${r}'`:null} as database, ${i?`'${i}'`:null} as schema, * FROM ${i?`"${i}".`:""}${this.escapePath("sqlite_master")} WHERE "type" = '${t}' AND "${t==="table"?"name":"tbl_name"}" IN ('${a}')`)}async loadPragmaRecords(e,t){const[,r]=this.splitTablePath(e);return this.query(`PRAGMA ${t}("${r}")`)}async loadTables(e){if(e&&e.length===0)return[];let t=[],r;if(e){const i=e.filter(o=>o.split(".").length===1).map(o=>`'${o}'`),a=e.filter(o=>o.split(".").length>1),s=o=>{const l=[...a.map(u=>this.loadTableRecords(u,o))];return i.length&&l.push(this.query(`SELECT * FROM "sqlite_master" WHERE "type" = '${o}' AND "${o==="table"?"name":"tbl_name"}" IN (${i})`)),l};t=(await Promise.all(s("table"))).reduce((o,l)=>[...o,...l],[]).filter(Boolean),r=(await Promise.all(s("index"))).reduce((o,l)=>[...o,...l],[]).filter(Boolean)}else{t.push(...await this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'table'`));const a=t.map(({name:s})=>`'${s}'`).join(", ");r=await this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'index' AND "tbl_name" IN (${a})`)}return t.length===0?[]:Promise.all(t.map(async i=>{const a=i.database&&this.driver.getAttachedDatabaseHandleByRelativePath(i.database)?`${this.driver.getAttachedDatabaseHandleByRelativePath(i.database)}.${i.name}`:i.name,s=i.sql,o=s.includes("WITHOUT ROWID"),l=new xt({name:a,withoutRowid:o}),[u,c,d]=await Promise.all([this.loadPragmaRecords(a,"table_xinfo"),this.loadPragmaRecords(a,"index_list"),this.loadPragmaRecords(a,"foreign_key_list")]);let h;const p=i.sql;let g=p.toUpperCase().indexOf("AUTOINCREMENT");if(g!==-1){h=p.substr(0,g);const M=h.lastIndexOf(","),Z=h.lastIndexOf("(");M!==-1?(h=h.substr(M),h=h.substr(0,h.lastIndexOf('"')),h=h.substr(h.indexOf('"')+1)):Z!==-1&&(h=h.substr(Z),h=h.substr(0,h.lastIndexOf('"')),h=h.substr(h.indexOf('"')+1))}l.columns=await Promise.all(u.map(async M=>{const Z=new Tn;if(Z.name=M.name,Z.type=M.type.toLowerCase(),Z.default=M.dflt_value!==null&&M.dflt_value!==void 0?M.dflt_value:void 0,Z.isNullable=M.notnull===0,Z.isPrimary=M.pk>0,Z.comment="",Z.isGenerated=h===M.name,Z.isGenerated&&(Z.generationStrategy="increment"),M.hidden===2||M.hidden===3){Z.generatedType=M.hidden===2?"VIRTUAL":"STORED";const G=await this.selectTypeormMetadataSql({table:l.name,type:Oe.GENERATED_COLUMN,name:Z.name}),oe=await this.query(G.query,G.parameters);oe[0]&&oe[0].value?Z.asExpression=oe[0].value:Z.asExpression=""}if(Z.type==="varchar"){const G=s.match(new RegExp('"('+Z.name+`)" varchar CHECK\\s*\\(\\s*"\\1"\\s+IN\\s*\\(('[^']+'(?:\\s*,\\s*'[^']+')+)\\s*\\)\\s*\\)`));G&&(Z.enum=G[2].substr(1,G[2].length-2).split("','"))}let q=Z.type.indexOf("(");if(q!==-1){const G=Z.type;let oe=G.substr(0,q);if(this.driver.withLengthColumnTypes.find(he=>he===oe)){let he=parseInt(G.substring(q+1,G.length-1));he&&(Z.length=he.toString(),Z.type=oe)}if(this.driver.withPrecisionColumnTypes.find(he=>he===oe)){const he=new RegExp(`^${oe}\\((\\d+),?\\s?(\\d+)?\\)`),pe=G.match(he);pe&&pe[1]&&(Z.precision=+pe[1]),this.driver.withScaleColumnTypes.find(ee=>ee===oe)&&pe&&pe[2]&&(Z.scale=+pe[2]),Z.type=oe}}return Z}));let E;const A=[],b=/CONSTRAINT "([^"]*)" FOREIGN KEY ?\((.*?)\) REFERENCES "([^"]*)"/g;for(;(E=b.exec(s))!==null;)A.push({name:E[1],columns:E[2].substr(1,E[2].length-2).split('", "'),referencedTableName:E[3]});const T=be.uniq(d,M=>M.id);l.foreignKeys=T.map(M=>{const Z=d.filter(he=>he.id===M.id&&he.table===M.table),q=Z.map(he=>he.from),G=Z.map(he=>he.to),oe=A.find(he=>he.referencedTableName===M.table&&he.columns.every(pe=>q.indexOf(pe)!==-1));return new ir({name:oe==null?void 0:oe.name,columnNames:q,referencedTableName:M.table,referencedColumnNames:G,onDelete:M.on_delete,onUpdate:M.on_update})});let C;const P=[],D=/CONSTRAINT "([^"]*)" UNIQUE ?\((.*?)\)/g;for(;(C=D.exec(s))!==null;)P.push({name:C[1],columns:C[2].substr(1,C[2].length-2).split('", "')});const F=c.filter(M=>M.origin==="u").map(M=>M.name).filter((M,Z,q)=>q.indexOf(M)===Z).map(async M=>{const Z=c.find(he=>he.name===M),G=(await this.query(`PRAGMA index_info("${Z.name}")`)).sort((he,pe)=>parseInt(he.seqno)-parseInt(pe.seqno)).map(he=>he.name);if(G.length===1){const he=l.columns.find(pe=>!!G.find(ee=>ee===pe.name));he&&(he.isUnique=!0)}const oe=P.find(he=>he.columns.every(pe=>G.indexOf(pe)!==-1));return new un({name:oe?oe.name:this.connection.namingStrategy.uniqueConstraintName(l,G),columnNames:G})});l.uniques=await Promise.all(F);let Q;const W=/CONSTRAINT "([^"]*)" CHECK ?(\(.*?\))([,]|[)]$)/g;for(;(Q=W.exec(s))!==null;)l.checks.push(new Mr({name:Q[1],expression:Q[2]}));const B=c.filter(M=>M.origin==="c").map(M=>M.name).filter((M,Z,q)=>q.indexOf(M)===Z).map(async M=>{const Z=r.find(de=>de.name===M),q=/WHERE (.*)/.exec(Z.sql),G=c.find(de=>de.name===M),he=(await this.query(`PRAGMA index_info("${G.name}")`)).sort((de,Ee)=>parseInt(de.seqno)-parseInt(Ee.seqno)).map(de=>de.name),pe=`${i.database?`${i.database}.`:""}${G.name}`,ee=G.unique==="1"||G.unique===1;return new At({table:l,name:pe,columnNames:he,isUnique:ee,where:q?q[1]:void 0})}),K=await Promise.all(B);return l.indices=K.filter(M=>!!M),l}))}createTableSql(e,t,r){const i=e.columns.filter(p=>p.isPrimary),a=i.find(p=>p.isGenerated&&p.generationStrategy==="increment"),s=i.length>1;if(s&&a)throw new L("Sqlite does not support AUTOINCREMENT on composite primary key");const o=e.columns.map(p=>this.buildCreateColumnSql(p,s)).join(", "),[l]=this.splitTablePath(e.name);let u=`CREATE TABLE ${this.escapePath(e.name)} (${o}`,[c,d]=this.splitTablePath(e.name);const h=r?`${c?`${c}.`:""}${d.replace(/^temporary_/,"")}`:e.name;if(e.columns.filter(p=>p.isUnique).forEach(p=>{e.uniques.some(E=>E.columnNames.length===1&&E.columnNames[0]===p.name)||e.uniques.push(new un({name:this.connection.namingStrategy.uniqueConstraintName(e,[p.name]),columnNames:[p.name]}))}),e.uniques.length>0){const p=e.uniques.map(g=>{const E=g.name?g.name:this.connection.namingStrategy.uniqueConstraintName(h,g.columnNames),A=g.columnNames.map(b=>`"${b}"`).join(", ");return`CONSTRAINT "${E}" UNIQUE (${A})`}).join(", ");u+=`, ${p}`}if(e.checks.length>0){const p=e.checks.map(g=>`CONSTRAINT "${g.name?g.name:this.connection.namingStrategy.checkConstraintName(h,g.expression)}" CHECK (${g.expression})`).join(", ");u+=`, ${p}`}if(e.foreignKeys.length>0&&t){const p=e.foreignKeys.filter(g=>{const[E]=this.splitTablePath(g.referencedTableName);return E===l}).map(g=>{const[,E]=this.splitTablePath(g.referencedTableName),A=g.columnNames.map(C=>`"${C}"`).join(", ");g.name||(g.name=this.connection.namingStrategy.foreignKeyName(h,g.columnNames,this.getTablePath(g),g.referencedColumnNames));const b=g.referencedColumnNames.map(C=>`"${C}"`).join(", ");let T=`CONSTRAINT "${g.name}" FOREIGN KEY (${A}) REFERENCES "${E}" (${b})`;return g.onDelete&&(T+=` ON DELETE ${g.onDelete}`),g.onUpdate&&(T+=` ON UPDATE ${g.onUpdate}`),g.deferrable&&(T+=` DEFERRABLE ${g.deferrable}`),T}).join(", ");u+=`, ${p}`}if(i.length>1){const p=i.map(g=>`"${g.name}"`).join(", ");u+=`, PRIMARY KEY (${p})`}return u+=")",e.withoutRowid&&(u+=" WITHOUT ROWID"),new I(u)}dropTableSql(e,t){const r=U.isTable(e)?e.name:e,i=t?`DROP TABLE IF EXISTS ${this.escapePath(r)}`:`DROP TABLE ${this.escapePath(r)}`;return new I(i)}createViewSql(e){return typeof e.expression=="string"?new I(`CREATE VIEW "${e.name}" AS ${e.expression}`):new I(`CREATE VIEW "${e.name}" AS ${e.expression(this.connection).getQuery()}`)}insertViewDefinitionSql(e){const t=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:Oe.VIEW,name:e.name,value:t})}dropViewSql(e){const t=U.isView(e)?e.name:e;return new I(`DROP VIEW "${t}"`)}deleteViewDefinitionSql(e){const t=U.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:Oe.VIEW,name:t})}createIndexSql(e,t){const r=t.columnNames.map(s=>`"${s}"`).join(", "),[i,a]=this.splitTablePath(e.name);return new I(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX ${i?`"${i}".`:""}${this.escapePath(t.name)} ON "${a}" (${r}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e){let t=U.isTableIndex(e)?e.name:e;return new I(`DROP INDEX ${this.escapePath(t)}`)}buildCreateColumnSql(e,t){let r='"'+e.name+'"';return U.isColumnMetadata(e)?r+=" "+this.driver.normalizeType(e):r+=" "+this.connection.driver.createFullType(e),e.enum&&(r+=' CHECK( "'+e.name+'" IN ('+e.enum.map(i=>"'"+i+"'").join(",")+") )"),e.isPrimary&&!t&&(r+=" PRIMARY KEY"),e.isGenerated===!0&&e.generationStrategy==="increment"&&(r+=" AUTOINCREMENT"),e.collation&&(r+=" COLLATE "+e.collation),e.isNullable!==!0&&(r+=" NOT NULL"),e.asExpression?r+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`:e.default!==void 0&&e.default!==null&&(r+=" DEFAULT ("+e.default+")"),r}async recreateTable(e,t,r=!0){const i=[],a=[];t.indices.forEach(u=>{i.push(this.dropIndexSql(u)),a.push(this.createIndexSql(t,u))});let[s,o]=this.splitTablePath(e.name),[,l]=this.splitTablePath(t.name);if(e.name=o=`${s?`${s}.`:""}temporary_${o}`,i.push(this.createTableSql(e,!0,!0)),a.push(this.dropTableSql(e)),r){let u=e.columns.filter(d=>!d.generatedType).map(d=>`"${d.name}"`),c=t.columns.filter(d=>!d.generatedType).map(d=>`"${d.name}"`);c.length<u.length?u=e.columns.filter(d=>{const h=t.columns.find(p=>p.name===d.name);return h&&h.generatedType?!1:!d.generatedType&&h}).map(d=>`"${d.name}"`):c.length>u.length&&(c=t.columns.filter(d=>!d.generatedType&&e.columns.find(h=>h.name===d.name)).map(d=>`"${d.name}"`)),i.push(new I(`INSERT INTO ${this.escapePath(e.name)}(${u.join(", ")}) SELECT ${c.join(", ")} FROM ${this.escapePath(t.name)}`)),a.push(new I(`INSERT INTO ${this.escapePath(t.name)}(${c.join(", ")}) SELECT ${u.join(", ")} FROM ${this.escapePath(e.name)}`))}i.push(this.dropTableSql(t)),a.push(this.createTableSql(t,!0)),i.push(new I(`ALTER TABLE ${this.escapePath(e.name)} RENAME TO ${this.escapePath(l)}`)),a.push(new I(`ALTER TABLE ${this.escapePath(t.name)} RENAME TO ${this.escapePath(o)}`)),e.name=t.name,e.indices.forEach(u=>{u.name||(u.name=this.connection.namingStrategy.indexName(e,u.columnNames,u.where)),i.push(this.createIndexSql(e,u)),a.push(this.dropIndexSql(u))}),t.columns.filter(u=>{const c=e.columns.find(d=>d.name===u.name);return u.generatedType&&u.asExpression&&(!c||!c.generatedType&&!c.asExpression)}).forEach(u=>{const c=this.deleteTypeormMetadataSql({table:t.name,type:Oe.GENERATED_COLUMN,name:u.name}),d=this.insertTypeormMetadataSql({table:t.name,type:Oe.GENERATED_COLUMN,name:u.name,value:u.asExpression});i.push(c),a.push(d)}),e.columns.filter(u=>u.generatedType&&u.asExpression&&!t.columns.some(c=>c.name===u.name)).forEach(u=>{const c=this.insertTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:u.name,value:u.asExpression}),d=this.deleteTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:u.name});i.push(c),a.push(d)}),e.columns.filter(u=>u.generatedType&&u.asExpression).forEach(u=>{const c=t.columns.find(E=>E.name===u.name&&E.generatedType&&u.generatedType&&E.asExpression!==u.asExpression);if(!c)return;const d=this.deleteTypeormMetadataSql({table:t.name,type:Oe.GENERATED_COLUMN,name:c.name}),h=this.insertTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:u.name,value:u.asExpression});i.push(d),i.push(h);const p=this.insertTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:c.name,value:c.asExpression}),g=this.deleteTypeormMetadataSql({table:t.name,type:Oe.GENERATED_COLUMN,name:u.name});a.push(p),a.push(g)}),await this.executeQueries(i,a),this.replaceCachedTable(t,e)}splitTablePath(e){return e.indexOf(".")!==-1?e.split("."):[void 0,e]}escapePath(e,t){return(U.isTable(e)||U.isView(e)?e.name:e).replace(/^\.+|\.+$/g,"").split(".").map(i=>t?i:`"${i}"`).join(".")}}class $i{constructor(e){this.queryRunner=e}async broadcast(e,...t){const r=new $p,i=this[`broadcast${e}Event`];typeof i=="function"&&i.call(this,r,...t),await r.wait()}broadcastBeforeInsertEvent(e,t,r){r&&t.beforeInsertListeners.length&&t.beforeInsertListeners.forEach(i=>{if(i.isAllowed(r)){const a=i.execute(r);a instanceof Promise&&e.promises.push(a),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(i=>{if(this.isAllowedSubscriber(i,t.target)&&i.beforeInsert){const a=i.beforeInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t});a instanceof Promise&&e.promises.push(a),e.count++}})}broadcastBeforeUpdateEvent(e,t,r,i,a,s){r&&t.beforeUpdateListeners.length&&t.beforeUpdateListeners.forEach(o=>{if(o.isAllowed(r)){const l=o.execute(r);l instanceof Promise&&e.promises.push(l),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(o=>{if(this.isAllowedSubscriber(o,t.target)&&o.beforeUpdate){const l=o.beforeUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,updatedColumns:a||[],updatedRelations:s||[]});l instanceof Promise&&e.promises.push(l),e.count++}})}broadcastBeforeRemoveEvent(e,t,r,i,a){r&&t.beforeRemoveListeners.length&&t.beforeRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeRemove){const o=s.beforeRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i??a)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastBeforeSoftRemoveEvent(e,t,r,i,a){r&&t.beforeSoftRemoveListeners.length&&t.beforeSoftRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeSoftRemove){const o=s.beforeSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i??a)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastBeforeRecoverEvent(e,t,r,i,a){r&&t.beforeRecoverListeners.length&&t.beforeRecoverListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeRecover){const o=s.beforeRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i??a)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterInsertEvent(e,t,r){r&&t.afterInsertListeners.length&&t.afterInsertListeners.forEach(i=>{if(i.isAllowed(r)){const a=i.execute(r);a instanceof Promise&&e.promises.push(a),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(i=>{if(this.isAllowedSubscriber(i,t.target)&&i.afterInsert){const a=i.afterInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t});a instanceof Promise&&e.promises.push(a),e.count++}})}broadcastBeforeTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionStart){const r=t.beforeTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionStart){const r=t.afterTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastBeforeTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionCommit){const r=t.beforeTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionCommit){const r=t.afterTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastBeforeTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionRollback){const r=t.beforeTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionRollback){const r=t.afterTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterUpdateEvent(e,t,r,i,a,s){r&&t.afterUpdateListeners.length&&t.afterUpdateListeners.forEach(o=>{if(o.isAllowed(r)){const l=o.execute(r);l instanceof Promise&&e.promises.push(l),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(o=>{if(this.isAllowedSubscriber(o,t.target)&&o.afterUpdate){const l=o.afterUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,updatedColumns:a||[],updatedRelations:s||[]});l instanceof Promise&&e.promises.push(l),e.count++}})}broadcastAfterRemoveEvent(e,t,r,i,a){r&&t.afterRemoveListeners.length&&t.afterRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterRemove){const o=s.afterRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i??a)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterSoftRemoveEvent(e,t,r,i,a){r&&t.afterSoftRemoveListeners.length&&t.afterSoftRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterSoftRemove){const o=s.afterSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i??a)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterRecoverEvent(e,t,r,i,a){r&&t.afterRecoverListeners.length&&t.afterRecoverListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterRecover){const o=s.afterRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i??a)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastLoadEventsForAll(e,t,r){return this.broadcastLoadEvent(e,t,r)}broadcastLoadEvent(e,t,r){const i=this.queryRunner.connection.subscribers.filter(a=>this.isAllowedSubscriber(a,t.target)&&a.afterLoad);if(t.relations.length||t.afterLoadListeners.length||i.length){const a=r.filter(s=>!(s instanceof Promise));t.relations.length&&t.relations.forEach(s=>{a.forEach(o=>{if(s.isLazy&&!o.hasOwnProperty(s.propertyName))return;const l=s.getEntityValue(o);Ue.isObject(l)&&this.broadcastLoadEvent(e,s.inverseEntityMetadata,Array.isArray(l)?l:[l])})}),t.afterLoadListeners.length&&t.afterLoadListeners.forEach(s=>{a.forEach(o=>{if(s.isAllowed(o)){const l=s.execute(o);l instanceof Promise&&e.promises.push(l),e.count++}})}),i.forEach(s=>{a.forEach(o=>{const l=s.afterLoad(o,{entity:o,metadata:t,connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});l instanceof Promise&&e.promises.push(l),e.count++})})}}isAllowedSubscriber(e,t){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===t||e.listenTo().isPrototypeOf(t)}}class ni{constructor(){this.records=[]}}class z1 extends Co{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new $i(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async query(e,t,r=!1){if(this.isReleased)throw new yn;const i=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const a=+new Date;try{const s=await new Promise(async(d,h)=>{i.executeSql(e,t,p=>d(p),p=>h(p))}),o=this.driver.options.maxQueryExecutionTime,u=+new Date-a;o&&u>o&&this.driver.connection.logger.logQuerySlow(u,e,t,this);const c=new ni;if(e.substr(0,11)==="INSERT INTO")c.raw=s.insertId;else{let d=[];for(let h=0;h<s.rows.length;h++)d.push(s.rows.item(h));c.records=d,c.raw=d}return r?c:c.raw}catch(s){throw this.driver.connection.logger.logQueryError(s,e,t,this),new Gr(e,t,s)}}async startTransaction(){throw new L("Transactions are not supported by the Cordova driver")}async commitTransaction(){throw new L("Transactions are not supported by the Cordova driver")}async rollbackTransaction(){throw new L("Transactions are not supported by the Cordova driver")}async clearDatabase(){await this.query("PRAGMA foreign_keys = OFF");try{const t=await this.query(`SELECT 'DROP VIEW "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'view'`),i=await this.query(`SELECT 'DROP TABLE "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`);await Promise.all(t.map(a=>this.query(a.query))),await Promise.all(i.map(a=>this.query(a.query)))}finally{await this.query("PRAGMA foreign_keys = ON")}}parametrize(e,t=0){return Object.keys(e).map((r,i)=>`"${r}"=?`)}}class W1 extends Cu{constructor(e){super(e),this.transactionSupport="none",this.database=this.options.database,this.loadDependencies()}async disconnect(){return this.queryRunner=void 0,new Promise((e,t)=>{this.databaseConnection.close(e,t)})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new z1(this)),this.queryRunner}async createDatabaseConnection(){const e=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{}),t=await new Promise(r=>{this.sqlite.openDatabase(e,i=>r(i))});return await new Promise((r,i)=>{t.executeSql("PRAGMA foreign_keys = ON",[],()=>r(),a=>i(a))}),t}loadDependencies(){try{const e=this.options.driver||window.sqlitePlugin;this.sqlite=e}catch{throw new No("Cordova-SQLite","cordova-sqlite-storage")}}}class H1 extends Co{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new $i(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}query(e,t,r=!1){if(this.isReleased)throw new yn;return new Promise(async(i,a)=>{const s=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=+new Date;s.executeSql(e,t,l=>{const u=this.driver.options.maxQueryExecutionTime,d=+new Date-o;u&&d>u&&this.driver.connection.logger.logQuerySlow(d,e,t,this);const h=new ni;if(l!=null&&l.hasOwnProperty("rowsAffected")&&(h.affected=l.rowsAffected),l!=null&&l.hasOwnProperty("rows")){let p=[];for(let g=0;g<l.rows.length;g++)p.push(l.rows.item(g));h.raw=p,h.records=p}e.substr(0,11)==="INSERT INTO"&&(h.raw=l.insertId),i(r?h:h.raw)},l=>{this.driver.connection.logger.logQueryError(l,e,t,this),a(new Gr(e,t,l))})})}parametrize(e,t=0){return Object.keys(e).map((r,i)=>`"${r}"=?`)}}class G1{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.supportedUpsertTypes=["on-conflict-do-update"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=this.options.database,this.loadDependencies()}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new H1(this)),this.queryRunner}async connect(){this.databaseConnection=await this.createDatabaseConnection()}afterConnect(){return Promise.resolve()}async disconnect(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close(e,t)})}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,r;return(r=(t=this.attachedDatabases)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return(t=Object.values(this.attachedDatabases).find(({attachHandle:r})=>e===r))===null||t===void 0?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new th(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=Ft.transformTo(t.transformer,e)),e==null?e:t.type===Boolean||t.type==="boolean"?e===!0?1:0:t.type==="date"?Ie.mixedDateToDateString(e):t.type==="time"?Ie.mixedDateToTimeString(e):t.type==="datetime"||t.type===Date?Ie.mixedDateToUtcDatetimeString(e):t.type==="simple-array"?Ie.simpleArrayToString(e):t.type==="simple-json"?Ie.simpleJsonToString(e):t.type==="simple-enum"?Ie.simpleEnumToString(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?Ft.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?(e&&typeof e=="string"&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=Ie.normalizeHydratedDate(e)):t.type==="date"?e=Ie.mixedDateToDateString(e):t.type==="time"?e=Ie.mixedTimeToString(e):t.type==="simple-array"?e=Ie.stringToSimpleArray(e):t.type==="simple-json"?e=Ie.stringToSimpleJson(e):t.type==="simple-enum"?e=Ie.stringToSimpleEnum(e,t):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=Ft.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,r){const i=Object.keys(r).map(a=>typeof r[a]=="boolean"?r[a]===!0?1:0:r[a]instanceof Date?Ie.mixedDateToUtcDatetimeString(r[a]):r[a]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,s,o)=>{if(!t.hasOwnProperty(o))return a;let l=t[o];return s?l.map(u=>(i.push(u),this.createParameter(o,i.length-1))).join(", "):typeof l=="function"?l():typeof l=="number"?String(l):typeof l=="boolean"?(i.push(+l),this.createParameter(o,i.length-1)):l instanceof Date?(i.push(Ie.mixedDateToUtcDatetimeString(l)),this.createParameter(o,i.length-1)):(i.push(l),this.createParameter(o,i.length-1))}),[e,i])}escape(e){return'"'+e+'"'}buildTableName(e,t,r){return e}parseTableName(e){var t;const r=this.database,i=void 0;if(U.isTable(e)||U.isView(e)){const s=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||s.database||r,schema:e.schema||s.schema||i,tableName:s.tableName}}if(U.isTableForeignKey(e)){const s=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||s.database||r,schema:e.referencedSchema||s.schema||i,tableName:s.tableName}}if(U.isEntityMetadata(e))return{database:e.database||r,schema:e.schema||i,tableName:e.tableName};const a=e.split(".");return a.length===3?{database:a[0]||r,schema:a[1]||i,tableName:a[2]}:a.length===2?{database:(t=this.getAttachedDatabasePathRelativeByHandle(a[0]))!==null&&t!==void 0?t:r,schema:a[0],tableName:a[1]}:{database:r,schema:i,tableName:e}}normalizeType(e){return e.type===Number||e.type==="int"?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"varchar":e.type||""}normalizeDefault(e){const t=e.default;if(typeof t=="number")return""+t;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!=null)return`${t}`}normalizeIsUnique(e){return e.entityMetadata.uniques.some(t=>t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+="("+e.precision+","+e.scale+")":e.precision!==null&&e.precision!==void 0&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,r,i){const a=e.generatedColumns.reduce((s,o)=>{let l;return o.generationStrategy==="increment"&&t&&(l=t-i+r+1),l?be.mergeDeep(s,o.createValueMap(l)):s},{});return Object.keys(a).length>0?a:void 0}findChangedColumns(e,t){return t.filter(r=>{const i=e.find(s=>s.name===r.databaseName);return i?i.name!==r.databaseName||i.type!==this.normalizeType(r)||i.length!==r.length||i.precision!==r.precision||i.scale!==r.scale||this.normalizeDefault(r)!==i.default||i.isPrimary!==r.isPrimary||i.isNullable!==r.isNullable||i.generatedType!==r.generatedType||i.asExpression!==r.asExpression||i.isUnique!==this.normalizeIsUnique(r)||i.enum&&r.enum&&!be.isArraysEqual(i.enum,r.enum.map(s=>s+""))||r.generationStrategy!=="uuid"&&i.isGenerated!==r.isGenerated:!1})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){return new Promise((e,t)=>{const r=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{});this.sqlite.openDatabase(r,i=>{const a=i;a.executeSql("PRAGMA foreign_keys = ON",[],s=>{e(a)},s=>{t(s)})},i=>{t(i)})})}loadDependencies(){try{const e=this.options.driver||require("react-native-sqlite-storage");this.sqlite=e}catch{throw new No("React-Native","react-native-sqlite-storage")}}}class K1 extends Co{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new $i(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async query(e,t,r=!1){if(this.isReleased)throw new yn;const i=this.driver.connection;return new Promise(async(a,s)=>{const o=await this.connect(),l=e.substr(0,11)==="INSERT INTO";i.logger.logQuery(e,t,this);const u=(d,h)=>{const p=this.driver.options.maxQueryExecutionTime,E=+new Date-c;p&&E>p&&i.logger.logQuerySlow(E,e,t,this),d&&(i.logger.logQueryError(d,e,t,this),s(new Gr(e,t,d)));const A=new ni;A.raw=h,!l&&Array.isArray(h)&&(A.records=h),a(r?A:A.raw)},c=+new Date;l?o.execSQL(e,t,u):o.all(e,t,u)})}parametrize(e,t=0){return Object.keys(e).map((r,i)=>`"${r}"=?`)}}class J1 extends Cu{constructor(e){super(e),this.connection=e,this.options=e.options,this.database=this.options.database,this.driver=this.options.driver,this.loadDependencies()}async disconnect(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close().then(e).catch(t)})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new K1(this)),this.queryRunner}normalizeType(e){return e.type===Buffer?"blob":super.normalizeType(e)}createDatabaseConnection(){return new Promise((e,t)=>{const r=Object.assign({},{readOnly:this.options.readOnly,key:this.options.key,multithreading:this.options.multithreading,migrate:this.options.migrate,iosFlags:this.options.iosFlags,androidFlags:this.options.androidFlags},this.options.extra||{});new this.sqlite(this.options.database,r,(i,a)=>{if(i)return t(i);a.resultType(this.sqlite.RESULTSASOBJECT),a.execSQL("PRAGMA foreign_keys = ON",[],(s,o)=>{if(s)return t(s);e(a)})})})}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new No("Nativescript","nativescript-sqlite")}}class Y1 extends Co{constructor(e){super(),this.isDirty=!1,this.driver=e,this.connection=e.connection,this.broadcaster=new $i(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async flush(){this.isDirty&&(await this.driver.autoSave(),this.isDirty=!1)}async release(){return await this.flush(),super.release()}async commitTransaction(){await super.commitTransaction(),this.isTransactionActive||await this.flush()}async query(e,t=[],r=!1){if(this.isReleased)throw new yn;const i=e.trim().split(" ",1)[0],a=this.driver.databaseConnection;this.driver.connection.logger.logQuery(e,t,this);const s=+new Date;let o;try{o=a.prepare(e),t&&(t=t.map(p=>typeof p<"u"?p:null),o.bind(t));const l=this.driver.options.maxQueryExecutionTime,c=+new Date-s;l&&c>l&&this.driver.connection.logger.logQuerySlow(c,e,t,this);const d=[];for(;o.step();)d.push(o.getAsObject());const h=new ni;return h.affected=a.getRowsModified(),h.records=d,h.raw=d,o.free(),i!=="SELECT"&&(this.isDirty=!0),r?h:h.raw}catch(l){throw o&&o.free(),this.driver.connection.logger.logQueryError(l,e,t,this),new Gr(e,t,l)}}}class X1 extends Cu{constructor(e){if(super(e),this.options.autoSave&&!this.options.location&&!this.options.autoSaveCallback)throw new j_("location or autoSaveCallback");this.loadDependencies()}async connect(){this.databaseConnection=await this.createDatabaseConnection()}async disconnect(){this.queryRunner=void 0,this.databaseConnection.close()}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new Y1(this)),this.queryRunner}async load(e,t=!0){if(typeof e=="string")if(ft.type==="node")if(ft.fileExist(e)){const r=ft.readFileSync(e);return this.createDatabaseConnectionWithImport(r)}else{if(t)throw new L(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}else{let r=null;if(this.options.useLocalForage)if(window.localforage)r=await window.localforage.getItem(e);else throw new L("localforage is not defined - please import localforage.js into your site");else r=ft.getGlobalVariable().localStorage.getItem(e);if(r!=null)return this.createDatabaseConnectionWithImport(JSON.parse(r));if(t)throw new L(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}else return this.createDatabaseConnectionWithImport(e)}async save(e){if(!e&&!this.options.location)throw new L("No location is set, specify a location parameter or add the location option to your configuration");let t="";if(e?t=e:this.options.location&&(t=this.options.location),ft.type==="node")try{const r=Buffer.from(this.databaseConnection.export());await ft.writeFile(t,r)}catch(r){throw new L(`Could not save database, error: ${r}`)}else{const r=this.databaseConnection.export(),i=[].slice.call(r);if(this.options.useLocalForage)if(window.localforage)await window.localforage.setItem(t,JSON.stringify(i));else throw new L("localforage is not defined - please import localforage.js into your site");else ft.getGlobalVariable().localStorage.setItem(t,JSON.stringify(i))}}async autoSave(){var e;this.options.autoSave&&!(!((e=this.queryRunner)===null||e===void 0)&&e.isTransactionActive)&&(this.options.autoSaveCallback?await this.options.autoSaveCallback(this.export()):await this.save())}export(){return this.databaseConnection.export()}createGeneratedMap(e,t){const r=e.generatedColumns.reduce((i,a)=>{if(a.isPrimary&&a.generationStrategy==="increment"){const s="SELECT last_insert_rowid()";try{let o=this.databaseConnection.exec(s);return this.connection.logger.logQuery(s),be.mergeDeep(i,a.createValueMap(o[0].values[0][0]))}catch(o){this.connection.logger.logQueryError(o,s,[])}}return i},{});return Object.keys(r).length>0?r:void 0}createDatabaseConnection(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)}async createDatabaseConnectionWithImport(e){const r=typeof this.sqlite.Database=="function"?this.sqlite:await this.sqlite(this.options.sqlJsConfig);return e&&e.length>0?this.databaseConnection=new r.Database(e):this.databaseConnection=new r.Database,this.databaseConnection.exec("PRAGMA foreign_keys = ON"),this.databaseConnection}loadDependencies(){if(ft.type==="browser"){const e=this.options.driver||window.SQL;this.sqlite=e}else try{const e=this.options.driver||ft.load("sql.js");this.sqlite=e}catch{throw new No("sql.js","sql.js")}}}class Z1 extends Co{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new $i(this)}async startTransaction(){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive&&typeof this.transaction>"u")throw new lr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive&&typeof this.transaction>"u")throw new lr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async beforeMigration(){const e=await this.connect();return new Promise((t,r)=>{e.exec([{sql:"PRAGMA foreign_keys = OFF",args:[]}],!1,i=>i?r(i):t())})}async afterMigration(){const e=await this.connect();return new Promise((t,r)=>{e.exec([{sql:"PRAGMA foreign_keys = ON",args:[]}],!1,i=>i?r(i):t())})}async query(e,t,r=!1){if(this.isReleased)throw new yn;return new Promise(async(i,a)=>{const s=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=+new Date;s.transaction(async l=>{typeof this.transaction>"u"&&(await this.startTransaction(),this.transaction=l),this.transaction.executeSql(e,t,(u,c)=>{const d=this.driver.options.maxQueryExecutionTime,p=+new Date-o;d&&p>d&&this.driver.connection.logger.logQuerySlow(p,e,t,this);const g=new ni;if(c!=null&&c.hasOwnProperty("rowsAffected")&&(g.affected=c.rowsAffected),c!=null&&c.hasOwnProperty("rows")){let E=[];for(let A=0;A<c.rows.length;A++)E.push(c.rows.item(A));g.raw=E,g.records=E}e.startsWith("INSERT INTO")&&(g.raw=c.insertId),i(r?g:g.raw)},(u,c)=>{this.driver.connection.logger.logQueryError(c,e,t,this),a(new Gr(e,t,c))})},async l=>{await this.rollbackTransaction(),a(l)},()=>{this.isTransactionActive=!1,this.transaction=void 0})})}}class eP extends Cu{constructor(e){super(e),this.database=this.options.database,this.sqlite=this.options.driver}async disconnect(){return new Promise((e,t)=>{try{this.queryRunner=void 0,this.databaseConnection._db.close(),this.databaseConnection=void 0,e()}catch(r){t(r)}})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new Z1(this)),this.queryRunner}createDatabaseConnection(){return new Promise((e,t)=>{try{const r=this.sqlite.openDatabase(this.options.database);r.transaction(i=>{i.executeSql("PRAGMA foreign_keys = ON",[],(a,s)=>{e(r)},(a,s)=>{t({transaction:a,error:s})})},i=>{t(i)})}catch(r){t(r)}})}}class tP extends nh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.client=t,this.broadcaster=new $i(this)}async connect(){return{}}release(){return this.isReleased=!0,this.databaseConnection&&this.databaseConnection.release(),Promise.resolve()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?await this.client.startTransaction():await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new yn;const i=await this.client.query(e,t),a=new ni;return a.raw=i,i!=null&&i.hasOwnProperty("records")&&Array.isArray(i.records)&&(a.records=i.records),i!=null&&i.hasOwnProperty("numberOfRecordsUpdated")&&(a.affected=i.numberOfRecordsUpdated),r?a:a.raw}stream(e,t,r,i){if(this.isReleased)throw new yn;return new Promise(async(a,s)=>{try{const l=(await this.connect()).query(e,t);r&&l.on("end",r),i&&l.on("error",i),a(l)}catch(o){s(o)}})}async getDatabases(){return Promise.resolve([])}async getSchemas(e){throw new L("MySql driver does not support table schemas")}async hasDatabase(e){return!!(await this.query(`SELECT * FROM \`INFORMATION_SCHEMA\`.\`SCHEMATA\` WHERE \`SCHEMA_NAME\` = '${e}'`)).length}async getCurrentDatabase(){return(await this.query("SELECT DATABASE() AS `db_name`"))[0].db_name}async hasSchema(e){throw new L("MySql driver does not support table schemas")}async getCurrentSchema(){return(await this.query("SELECT SCHEMA() AS `schema_name`"))[0].schema_name}async hasTable(e){const t=this.driver.parseTableName(e),r=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${t.database}' AND \`TABLE_NAME\` = '${t.tableName}'`;return!!(await this.query(r)).length}async hasColumn(e,t){const r=this.driver.parseTableName(e),i=U.isTableColumn(t)?t.name:t,a=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${r.database}' AND \`TABLE_NAME\` = '${r.tableName}' AND \`COLUMN_NAME\` = '${i}'`;return!!(await this.query(a)).length}async createDatabase(e,t){const r=t?`CREATE DATABASE IF NOT EXISTS \`${e}\``:`CREATE DATABASE \`${e}\``,i=`DROP DATABASE \`${e}\``;await this.executeQueries(new I(r),new I(i))}async dropDatabase(e,t){const r=t?`DROP DATABASE IF EXISTS \`${e}\``:`DROP DATABASE \`${e}\``,i=`CREATE DATABASE \`${e}\``;await this.executeQueries(new I(r),new I(i))}async createSchema(e,t){throw new L("Schema create queries are not supported by MySql driver.")}async dropSchema(e,t){throw new L("Schema drop queries are not supported by MySql driver.")}async createTable(e,t=!1,r=!0){if(t&&await this.hasTable(e))return Promise.resolve();const i=[],a=[];return i.push(this.createTableSql(e,r)),a.push(this.dropTableSql(e)),e.indices.forEach(s=>a.push(this.dropIndexSql(e,s))),r&&e.foreignKeys.forEach(s=>a.push(this.dropForeignKeySql(e,s))),this.executeQueries(i,a)}async dropTable(e,t,r=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const i=r,a=this.getTablePath(e),s=await this.getCachedTable(a),o=[],l=[];r&&s.foreignKeys.forEach(u=>o.push(this.dropForeignKeySql(s,u))),s.indices.forEach(u=>o.push(this.dropIndexSql(s,u))),o.push(this.dropTableSql(s)),l.push(this.createTableSql(s,i)),await this.executeQueries(o,l)}async createView(e,t=!1){const r=[],i=[];r.push(this.createViewSql(e)),t&&r.push(await this.insertViewDefinitionSql(e)),i.push(this.dropViewSql(e)),t&&i.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(r,i)}async dropView(e){const t=U.isView(e)?e.name:e,r=await this.getCachedView(t),i=[],a=[];i.push(await this.deleteViewDefinitionSql(r)),i.push(this.dropViewSql(r)),a.push(await this.insertViewDefinitionSql(r)),a.push(this.createViewSql(r)),await this.executeQueries(i,a)}async renameTable(e,t){const r=[],i=[],a=U.isTable(e)?e:await this.getCachedTable(e),s=a.clone(),{database:o}=this.driver.parseTableName(a);s.name=o?`${o}.${t}`:t,r.push(new I(`RENAME TABLE ${this.escapePath(a)} TO ${this.escapePath(s)}`)),i.push(new I(`RENAME TABLE ${this.escapePath(s)} TO ${this.escapePath(a)}`)),s.indices.forEach(l=>{const u=l.columnNames.map(h=>`\`${h}\``).join(", "),c=this.connection.namingStrategy.indexName(s,l.columnNames,l.where);let d="";l.isUnique&&(d+="UNIQUE "),l.isSpatial&&(d+="SPATIAL "),l.isFulltext&&(d+="FULLTEXT "),r.push(new I(`ALTER TABLE ${this.escapePath(s)} DROP INDEX \`${l.name}\`, ADD ${d}INDEX \`${c}\` (${u})`)),i.push(new I(`ALTER TABLE ${this.escapePath(s)} DROP INDEX \`${c}\`, ADD ${d}INDEX \`${l.name}\` (${u})`)),l.name=c}),s.foreignKeys.forEach(l=>{const u=l.columnNames.map(g=>`\`${g}\``).join(", "),c=l.referencedColumnNames.map(g=>`\`${g}\``).join(","),d=this.connection.namingStrategy.foreignKeyName(s,l.columnNames);let h=`ALTER TABLE ${this.escapePath(s)} DROP FOREIGN KEY \`${l.name}\`, ADD CONSTRAINT \`${d}\` FOREIGN KEY (${u}) REFERENCES ${this.escapePath(this.getTablePath(l))}(${c})`;l.onDelete&&(h+=` ON DELETE ${l.onDelete}`),l.onUpdate&&(h+=` ON UPDATE ${l.onUpdate}`);let p=`ALTER TABLE ${this.escapePath(s)} DROP FOREIGN KEY \`${d}\`, ADD CONSTRAINT \`${l.name}\` FOREIGN KEY (${u}) REFERENCES ${this.escapePath(this.getTablePath(l))}(${c})`;l.onDelete&&(p+=` ON DELETE ${l.onDelete}`),l.onUpdate&&(p+=` ON UPDATE ${l.onUpdate}`),r.push(new I(h)),i.push(new I(p)),l.name=d}),await this.executeQueries(r,i),a.name=s.name,this.replaceCachedTable(a,s)}async addColumn(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone(),a=[],s=[],o=i.primaryColumns.length>0;if(a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(t,o,!1)}`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN \`${t.name}\``)),t.isPrimary&&o){const u=i.columns.find(h=>h.isGenerated&&h.generationStrategy==="increment");if(u){const h=u.clone();h.isGenerated=!1,h.generationStrategy=void 0,a.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(h,!0)}`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(t,!0)}`))}const c=i.primaryColumns;let d=c.map(h=>`\`${h.name}\``).join(", ");if(a.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${d})`)),c.push(t),d=c.map(h=>`\`${h.name}\``).join(", "),a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${d})`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),u){const h=u.clone();h.isGenerated=!1,h.generationStrategy=void 0,a.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(t,!0)}`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(h,!0)}`))}}const l=i.indices.find(u=>u.columnNames.length===1&&u.columnNames[0]===t.name);if(l)a.push(this.createIndexSql(r,l)),s.push(this.dropIndexSql(r,l));else if(t.isUnique){const u=new At({name:this.connection.namingStrategy.indexName(r,[t.name]),columnNames:[t.name],isUnique:!0});i.indices.push(u),i.uniques.push(new un({name:u.name,columnNames:u.columnNames})),a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD UNIQUE INDEX \`${u.name}\` (\`${t.name}\`)`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${u.name}\``))}await this.executeQueries(a,s),i.addColumn(t),this.replaceCachedTable(r,i)}async addColumns(e,t){for(const r of t)await this.addColumn(e,r)}async renameColumn(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e),a=U.isTableColumn(t)?t:i.columns.find(o=>o.name===t);if(!a)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);let s;U.isTableColumn(r)?s=r:(s=a.clone(),s.name=r),await this.changeColumn(i,a,s)}async changeColumn(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e);let a=i.clone();const s=[],o=[],l=U.isTableColumn(t)?t:i.columns.find(u=>u.name===t);if(!l)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);if(r.isGenerated!==l.isGenerated&&r.generationStrategy!=="uuid"||l.type!==r.type||l.length!==r.length||l.generatedType!==r.generatedType)await this.dropColumn(i,l),await this.addColumn(i,r),a=i.clone();else{if(r.name!==l.name){s.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${l.name}\` \`${r.name}\` ${this.buildCreateColumnSql(l,!0,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${r.name}\` \`${l.name}\` ${this.buildCreateColumnSql(l,!0,!0)}`)),a.findColumnIndices(l).forEach(c=>{c.columnNames.splice(c.columnNames.indexOf(l.name),1),c.columnNames.push(r.name);const d=c.columnNames.map(g=>`\`${g}\``).join(", "),h=this.connection.namingStrategy.indexName(a,c.columnNames,c.where);let p="";c.isUnique&&(p+="UNIQUE "),c.isSpatial&&(p+="SPATIAL "),c.isFulltext&&(p+="FULLTEXT "),s.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${c.name}\`, ADD ${p}INDEX \`${h}\` (${d})`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${h}\`, ADD ${p}INDEX \`${c.name}\` (${d})`)),c.name=h}),a.findColumnForeignKeys(l).forEach(c=>{c.columnNames.splice(c.columnNames.indexOf(l.name),1),c.columnNames.push(r.name);const d=c.columnNames.map(A=>`\`${A}\``).join(", "),h=c.referencedColumnNames.map(A=>`\`${A}\``).join(","),p=this.connection.namingStrategy.foreignKeyName(a,c.columnNames);let g=`ALTER TABLE ${this.escapePath(i)} DROP FOREIGN KEY \`${c.name}\`, ADD CONSTRAINT \`${p}\` FOREIGN KEY (${d}) REFERENCES ${this.escapePath(this.getTablePath(c))}(${h})`;c.onDelete&&(g+=` ON DELETE ${c.onDelete}`),c.onUpdate&&(g+=` ON UPDATE ${c.onUpdate}`);let E=`ALTER TABLE ${this.escapePath(i)} DROP FOREIGN KEY \`${p}\`, ADD CONSTRAINT \`${c.name}\` FOREIGN KEY (${d}) REFERENCES ${this.escapePath(this.getTablePath(c))}(${h})`;c.onDelete&&(E+=` ON DELETE ${c.onDelete}`),c.onUpdate&&(E+=` ON UPDATE ${c.onUpdate}`),s.push(new I(g)),o.push(new I(E)),c.name=p});const u=a.columns.find(c=>c.name===l.name);a.columns[a.columns.indexOf(u)].name=r.name,l.name=r.name}if(this.isColumnChanged(l,r,!0)&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${l.name}\` ${this.buildCreateColumnSql(r,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${r.name}\` ${this.buildCreateColumnSql(l,!0)}`))),r.isPrimary!==l.isPrimary){const u=a.columns.find(d=>d.isGenerated&&d.generationStrategy==="increment");if(u){const d=u.clone();d.isGenerated=!1,d.generationStrategy=void 0,s.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${u.name}\` ${this.buildCreateColumnSql(d,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(u,!0)}`))}const c=a.primaryColumns;if(c.length>0){const d=c.map(h=>`\`${h.name}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${d})`))}if(r.isPrimary===!0){c.push(r);const d=a.columns.find(p=>p.name===r.name);d.isPrimary=!0;const h=c.map(p=>`\`${p.name}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${h})`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`))}else{const d=c.find(p=>p.name===r.name);c.splice(c.indexOf(d),1);const h=a.columns.find(p=>p.name===r.name);if(h.isPrimary=!1,c.length>0){const p=c.map(g=>`\`${g.name}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${p})`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`))}}if(u){const d=u.clone();d.isGenerated=!1,d.generationStrategy=void 0,s.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(u,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${u.name}\` ${this.buildCreateColumnSql(d,!0)}`))}}if(r.isUnique!==l.isUnique)if(r.isUnique===!0){const u=new At({name:this.connection.namingStrategy.indexName(i,[r.name]),columnNames:[r.name],isUnique:!0});a.indices.push(u),a.uniques.push(new un({name:u.name,columnNames:u.columnNames})),s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD UNIQUE INDEX \`${u.name}\` (\`${r.name}\`)`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${u.name}\``))}else{const u=a.indices.find(d=>d.columnNames.length===1&&d.isUnique===!0&&!!d.columnNames.find(h=>h===r.name));a.indices.splice(a.indices.indexOf(u),1);const c=a.uniques.find(d=>d.name===u.name);a.uniques.splice(a.uniques.indexOf(c),1),s.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${u.name}\``)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD UNIQUE INDEX \`${u.name}\` (\`${r.name}\`)`))}}await this.executeQueries(s,o),this.replaceCachedTable(i,a)}async changeColumns(e,t){for(const{oldColumn:r,newColumn:i}of t)await this.changeColumn(e,r,i)}async dropColumn(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableColumn(t)?t:r.findColumnByName(t);if(!i)throw new L(`Column "${t}" was not found in table "${r.name}"`);const a=r.clone(),s=[],o=[];if(i.isPrimary){const u=a.columns.find(h=>h.isGenerated&&h.generationStrategy==="increment");if(u){const h=u.clone();h.isGenerated=!1,h.generationStrategy=void 0,s.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${u.name}\` ${this.buildCreateColumnSql(h,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(u,!0)}`))}const c=a.primaryColumns.map(h=>`\`${h.name}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(a)} DROP PRIMARY KEY`)),o.push(new I(`ALTER TABLE ${this.escapePath(a)} ADD PRIMARY KEY (${c})`));const d=a.findColumnByName(i.name);if(d.isPrimary=!1,a.primaryColumns.length>0){const h=a.primaryColumns.map(p=>`\`${p.name}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(a)} ADD PRIMARY KEY (${h})`)),o.push(new I(`ALTER TABLE ${this.escapePath(a)} DROP PRIMARY KEY`))}if(u&&u.name!==i.name){const h=u.clone();h.isGenerated=!1,h.generationStrategy=void 0,s.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(u,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${u.name}\` ${this.buildCreateColumnSql(h,!0)}`))}}const l=a.indices.find(u=>u.columnNames.length===1&&u.columnNames[0]===i.name);if(l)a.indices.splice(a.indices.indexOf(l),1),s.push(this.dropIndexSql(r,l)),o.push(this.createIndexSql(r,l));else if(i.isUnique){const u=this.connection.namingStrategy.uniqueConstraintName(r,[i.name]),c=a.uniques.find(p=>p.name===u);c&&a.uniques.splice(a.uniques.indexOf(c),1);const d=this.connection.namingStrategy.indexName(r,[i.name]),h=a.indices.find(p=>p.name===d);h&&a.indices.splice(a.indices.indexOf(h),1),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${d}\``)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD UNIQUE INDEX \`${d}\` (\`${i.name}\`)`))}s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN \`${i.name}\``)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(i,!0)}`)),await this.executeQueries(s,o),a.removeColumn(i),this.replaceCachedTable(r,a)}async dropColumns(e,t){for(const r of t)await this.dropColumn(e,r)}async createPrimaryKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone(),a=this.createPrimaryKeySql(r,t),s=this.dropPrimaryKeySql(r);await this.executeQueries(a,s),i.columns.forEach(o=>{t.find(l=>l===o.name)&&(o.isPrimary=!0)}),this.replaceCachedTable(r,i)}async updatePrimaryKeys(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone(),a=t.map(h=>h.name),s=[],o=[],l=i.columns.find(h=>h.isGenerated&&h.generationStrategy==="increment");if(l){const h=l.clone();h.isGenerated=!1,h.generationStrategy=void 0,s.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${l.name}\` ${this.buildCreateColumnSql(h,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(l,!0)}`))}const u=i.primaryColumns;if(u.length>0){const h=u.map(p=>`\`${p.name}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${h})`))}i.columns.filter(h=>a.indexOf(h.name)!==-1).forEach(h=>h.isPrimary=!0);const c=a.map(h=>`\`${h}\``).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${c})`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`));const d=l||t.find(h=>h.isGenerated&&h.generationStrategy==="increment");if(d){const h=d.clone();h.isGenerated=!1,h.generationStrategy=void 0,s.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(d,!0)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(h,!0)}`));const p=i.columns.find(g=>g.name===d.name);p.isGenerated=!0,p.generationStrategy="increment"}await this.executeQueries(s,o),this.replaceCachedTable(r,i)}async dropPrimaryKey(e){const t=U.isTable(e)?e:await this.getCachedTable(e),r=this.dropPrimaryKeySql(t),i=this.createPrimaryKeySql(t,t.primaryColumns.map(a=>a.name));await this.executeQueries(r,i),t.primaryColumns.forEach(a=>{a.isPrimary=!1})}async createUniqueConstraint(e,t){throw new L("MySql does not support unique constraints. Use unique index instead.")}async createUniqueConstraints(e,t){throw new L("MySql does not support unique constraints. Use unique index instead.")}async dropUniqueConstraint(e,t){throw new L("MySql does not support unique constraints. Use unique index instead.")}async dropUniqueConstraints(e,t){throw new L("MySql does not support unique constraints. Use unique index instead.")}async createCheckConstraint(e,t){throw new L("MySql does not support check constraints.")}async createCheckConstraints(e,t){throw new L("MySql does not support check constraints.")}async dropCheckConstraint(e,t){throw new L("MySql does not support check constraints.")}async dropCheckConstraints(e,t){throw new L("MySql does not support check constraints.")}async createExclusionConstraint(e,t){throw new L("MySql does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new L("MySql does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new L("MySql does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new L("MySql does not support exclusion constraints.")}async createForeignKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames));const i=this.createForeignKeySql(r,t),a=this.dropForeignKeySql(r,t);await this.executeQueries(i,a),r.addForeignKey(t)}async createForeignKeys(e,t){const r=t.map(i=>this.createForeignKey(e,i));await Promise.all(r)}async dropForeignKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableForeignKey(t)?t:r.foreignKeys.find(o=>o.name===t);if(!i)throw new L(`Supplied foreign key was not found in table ${r.name}`);const a=this.dropForeignKeySql(r,i),s=this.createForeignKeySql(r,i);await this.executeQueries(a,s),r.removeForeignKey(i)}async dropForeignKeys(e,t){const r=t.map(i=>this.dropForeignKey(e,i));await Promise.all(r)}async createIndex(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const i=this.createIndexSql(r,t),a=this.dropIndexSql(r,t);await this.executeQueries(i,a),r.addIndex(t,!0)}async createIndices(e,t){const r=t.map(i=>this.createIndex(e,i));await Promise.all(r)}async dropIndex(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!i)throw new L(`Supplied index ${t} was not found in table ${r.name}`);i.name||(i.name=this.generateIndexName(r,i));const a=this.dropIndexSql(r,i),s=this.createIndexSql(r,i);await this.executeQueries(a,s),r.removeIndex(i,!0)}async dropIndices(e,t){const r=t.map(i=>this.dropIndex(e,i));await Promise.all(r)}async clearTable(e){await this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)}async clearDatabase(e){const t=e||this.driver.database;if(t){if(!await this.hasDatabase(t))return Promise.resolve()}else throw new L("Can not clear database. No database is specified");const r=this.isTransactionActive;r||await this.startTransaction();try{const i=`SELECT concat('DROP VIEW IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`VIEWS\` WHERE \`TABLE_SCHEMA\` = '${t}'`,a=await this.query(i);await Promise.all(a.map(c=>this.query(c.query)));const s="SET FOREIGN_KEY_CHECKS = 0;",o=`SELECT concat('DROP TABLE IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_SCHEMA\` = '${t}'`,l="SET FOREIGN_KEY_CHECKS = 1;";await this.query(s);const u=await this.query(o);await Promise.all(u.map(c=>this.query(c.query))),await this.query(l),r||await this.commitTransaction()}catch(i){try{r||await this.rollbackTransaction()}catch{}throw i}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const r=await this.getCurrentDatabase(),i=e.map(o=>{let{database:l,tableName:u}=this.driver.parseTableName(o);return l||(l=r),`(\`t\`.\`schema\` = '${l}' AND \`t\`.\`name\` = '${u}')`}).join(" OR "),a=`SELECT \`t\`.*, \`v\`.\`check_option\` FROM ${this.escapePath(this.getTypeormMetadataTableName())} \`t\` INNER JOIN \`information_schema\`.\`views\` \`v\` ON \`v\`.\`table_schema\` = \`t\`.\`schema\` AND \`v\`.\`table_name\` = \`t\`.\`name\` WHERE \`t\`.\`type\` = '${Oe.VIEW}' ${i?`AND (${i})`:""}`;return(await this.query(a)).map(o=>{const l=new Ci,u=o.schema===r?void 0:o.schema;return l.database=o.schema,l.name=this.driver.buildTableName(o.name,void 0,u),l.expression=o.value,l})}async loadTables(e){if(e&&e.length===0)return[];const t=[],r=await this.getCurrentDatabase();if(!e)t.push(...await this.query("SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES`"));else{const T="SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES` WHERE "+e.map(C=>{let[P,D]=C.split(".");return D||(D=P,P=this.driver.database||r),`(\`TABLE_SCHEMA\` = '${P}' AND \`TABLE_NAME\` = '${D}')`}).join(" OR ");t.push(...await this.query(T))}if(t.length===0)return[];const i=t.map(({TABLE_NAME:b,TABLE_SCHEMA:T})=>`(\`TABLE_SCHEMA\` = '${T}' AND \`TABLE_NAME\` = '${b}')`).join(" OR "),a="SELECT * FROM `INFORMATION_SCHEMA`.`COLUMNS` WHERE "+i,s=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` WHERE \`CONSTRAINT_NAME\` = 'PRIMARY' AND (${i})`,o="SELECT `SCHEMA_NAME`, `DEFAULT_CHARACTER_SET_NAME` as `CHARSET`, `DEFAULT_COLLATION_NAME` AS `COLLATION` FROM `INFORMATION_SCHEMA`.`SCHEMATA`",u=`SELECT \`s\`.* FROM \`INFORMATION_SCHEMA\`.\`STATISTICS\` \`s\` LEFT JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`rc\` ON \`s\`.\`INDEX_NAME\` = \`rc\`.\`CONSTRAINT_NAME\` WHERE (${t.map(({TABLE_NAME:b,TABLE_SCHEMA:T})=>`(\`s\`.\`TABLE_SCHEMA\` = '${T}' AND \`s\`.\`TABLE_NAME\` = '${b}')`).join(" OR ")}) AND \`s\`.\`INDEX_NAME\` != 'PRIMARY' AND \`rc\`.\`CONSTRAINT_NAME\` IS NULL`,d="SELECT `kcu`.`TABLE_SCHEMA`, `kcu`.`TABLE_NAME`, `kcu`.`CONSTRAINT_NAME`, `kcu`.`COLUMN_NAME`, `kcu`.`REFERENCED_TABLE_SCHEMA`, `kcu`.`REFERENCED_TABLE_NAME`, `kcu`.`REFERENCED_COLUMN_NAME`, `rc`.`DELETE_RULE` `ON_DELETE`, `rc`.`UPDATE_RULE` `ON_UPDATE` FROM `INFORMATION_SCHEMA`.`KEY_COLUMN_USAGE` `kcu` INNER JOIN `INFORMATION_SCHEMA`.`REFERENTIAL_CONSTRAINTS` `rc` ON `rc`.`constraint_name` = `kcu`.`constraint_name` WHERE "+t.map(({TABLE_NAME:b,TABLE_SCHEMA:T})=>`(\`kcu\`.\`TABLE_SCHEMA\` = '${T}' AND \`kcu\`.\`TABLE_NAME\` = '${b}')`).join(" OR "),[h,p,g,E,A]=await Promise.all([this.query(a),this.query(s),this.query(o),this.query(u),this.query(d)]);return Promise.all(t.map(async b=>{const T=new xt,C=g.find(B=>B.SCHEMA_NAME===b.TABLE_SCHEMA),P=C.COLLATION,D=C.CHARSET,F=b.TABLE_SCHEMA===r?void 0:b.TABLE_SCHEMA;T.database=b.TABLE_SCHEMA,T.name=this.driver.buildTableName(b.TABLE_NAME,void 0,F),T.columns=h.filter(B=>B.TABLE_NAME===b.TABLE_NAME&&B.TABLE_SCHEMA===b.TABLE_SCHEMA).map(B=>{const K=E.filter(oe=>oe.TABLE_NAME===b.TABLE_NAME&&oe.TABLE_SCHEMA===b.TABLE_SCHEMA&&oe.COLUMN_NAME===B.COLUMN_NAME&&parseInt(oe.NON_UNIQUE,10)===0),M=this.connection.entityMetadatas.find(oe=>this.getTablePath(T)===this.getTablePath(oe)),Z=K.length>0&&M&&M.indices.some(oe=>K.some(he=>oe.name===he.INDEX_NAME&&oe.synchronize===!1)),q=K.every(oe=>E.some(he=>he.INDEX_NAME===oe.INDEX_NAME&&he.COLUMN_NAME!==B.COLUMN_NAME)),G=new Tn;if(G.name=B.COLUMN_NAME,G.type=B.DATA_TYPE.toLowerCase(),G.unsigned=G.zerofill?!0:B.COLUMN_TYPE.indexOf("unsigned")!==-1,this.driver.withWidthColumnTypes.indexOf(G.type)!==-1){const oe=B.COLUMN_TYPE.substring(B.COLUMN_TYPE.indexOf("(")+1,B.COLUMN_TYPE.indexOf(")"));G.width=oe&&!this.isDefaultColumnWidth(T,G,parseInt(oe))?parseInt(oe):void 0}if(B.COLUMN_DEFAULT===null||B.COLUMN_DEFAULT===void 0?G.default=void 0:G.default=B.COLUMN_DEFAULT==="CURRENT_TIMESTAMP"?B.COLUMN_DEFAULT:`'${B.COLUMN_DEFAULT}'`,B.EXTRA.indexOf("on update")!==-1&&(G.onUpdate=B.EXTRA.substring(B.EXTRA.indexOf("on update")+10)),B.GENERATION_EXPRESSION&&(G.asExpression=B.GENERATION_EXPRESSION,G.generatedType=B.EXTRA.indexOf("VIRTUAL")!==-1?"VIRTUAL":"STORED"),G.isUnique=K.length>0&&!Z&&!q,G.isNullable=B.IS_NULLABLE==="YES",G.isPrimary=p.some(oe=>oe.TABLE_NAME===B.TABLE_NAME&&oe.TABLE_SCHEMA===B.TABLE_SCHEMA&&oe.COLUMN_NAME===B.COLUMN_NAME),G.zerofill=B.COLUMN_TYPE.indexOf("zerofill")!==-1,G.isGenerated=B.EXTRA.indexOf("auto_increment")!==-1,G.isGenerated&&(G.generationStrategy="increment"),G.comment=typeof B.COLUMN_COMMENT=="string"&&B.COLUMN_COMMENT.length===0?void 0:B.COLUMN_COMMENT,B.CHARACTER_SET_NAME&&(G.charset=B.CHARACTER_SET_NAME===D?void 0:B.CHARACTER_SET_NAME),B.COLLATION_NAME&&(G.collation=B.COLLATION_NAME===P?void 0:B.COLLATION_NAME),this.driver.withLengthColumnTypes.indexOf(G.type)!==-1&&B.CHARACTER_MAXIMUM_LENGTH){const oe=B.CHARACTER_MAXIMUM_LENGTH.toString();G.length=this.isDefaultColumnLength(T,G,oe)?"":oe}if((G.type==="decimal"||G.type==="double"||G.type==="float")&&(B.NUMERIC_PRECISION!==null&&!this.isDefaultColumnPrecision(T,G,B.NUMERIC_PRECISION)&&(G.precision=parseInt(B.NUMERIC_PRECISION)),B.NUMERIC_SCALE!==null&&!this.isDefaultColumnScale(T,G,B.NUMERIC_SCALE)&&(G.scale=parseInt(B.NUMERIC_SCALE))),G.type==="enum"||G.type==="simple-enum"||G.type==="set"){const oe=B.COLUMN_TYPE,he=oe.substring(oe.indexOf("(")+1,oe.lastIndexOf(")")).split(",");G.enum=he.map(pe=>pe.substring(1,pe.length-1)),G.length=""}return(G.type==="datetime"||G.type==="time"||G.type==="timestamp")&&B.DATETIME_PRECISION!==null&&B.DATETIME_PRECISION!==void 0&&!this.isDefaultColumnPrecision(T,G,parseInt(B.DATETIME_PRECISION))&&(G.precision=parseInt(B.DATETIME_PRECISION)),G});const Q=be.uniq(A.filter(B=>B.TABLE_NAME===b.TABLE_NAME&&B.TABLE_SCHEMA===b.TABLE_SCHEMA),B=>B.CONSTRAINT_NAME);T.foreignKeys=Q.map(B=>{const K=A.filter(q=>q.CONSTRAINT_NAME===B.CONSTRAINT_NAME),M=B.REFERENCED_TABLE_SCHEMA===r?void 0:B.REFERENCED_TABLE_SCHEMA,Z=this.driver.buildTableName(B.REFERENCED_TABLE_NAME,void 0,M);return new ir({name:B.CONSTRAINT_NAME,columnNames:K.map(q=>q.COLUMN_NAME),referencedDatabase:B.REFERENCED_TABLE_SCHEMA,referencedTableName:Z,referencedColumnNames:K.map(q=>q.REFERENCED_COLUMN_NAME),onDelete:B.ON_DELETE,onUpdate:B.ON_UPDATE})});const W=be.uniq(E.filter(B=>B.TABLE_NAME===b.TABLE_NAME&&B.TABLE_SCHEMA===b.TABLE_SCHEMA),B=>B.INDEX_NAME);return T.indices=W.map(B=>{const K=E.filter(Z=>Z.TABLE_SCHEMA===B.TABLE_SCHEMA&&Z.TABLE_NAME===B.TABLE_NAME&&Z.INDEX_NAME===B.INDEX_NAME),M=parseInt(B.NON_UNIQUE,10);return new At({table:T,name:B.INDEX_NAME,columnNames:K.map(Z=>Z.COLUMN_NAME),isUnique:M===0,isSpatial:B.INDEX_TYPE==="SPATIAL",isFulltext:B.INDEX_TYPE==="FULLTEXT"})}),T}))}createTableSql(e,t){const r=e.columns.map(a=>this.buildCreateColumnSql(a,!0)).join(", ");let i=`CREATE TABLE ${this.escapePath(e)} (${r}`;if(e.columns.filter(a=>a.isUnique).forEach(a=>{const s=e.indices.some(l=>l.columnNames.length===1&&!!l.isUnique&&l.columnNames.indexOf(a.name)!==-1),o=e.uniques.some(l=>l.columnNames.length===1&&l.columnNames.indexOf(a.name)!==-1);!s&&!o&&e.indices.push(new At({name:this.connection.namingStrategy.uniqueConstraintName(e,[a.name]),columnNames:[a.name],isUnique:!0}))}),e.uniques.length>0&&e.uniques.forEach(a=>{e.indices.some(o=>o.name===a.name)||e.indices.push(new At({name:a.name,columnNames:a.columnNames,isUnique:!0}))}),e.indices.length>0){const a=e.indices.map(s=>{const o=s.columnNames.map(u=>`\`${u}\``).join(", ");s.name||(s.name=this.connection.namingStrategy.indexName(e,s.columnNames,s.where));let l="";return s.isUnique&&(l+="UNIQUE "),s.isSpatial&&(l+="SPATIAL "),s.isFulltext&&(l+="FULLTEXT "),`${l}INDEX \`${s.name}\` (${o})`}).join(", ");i+=`, ${a}`}if(e.foreignKeys.length>0&&t){const a=e.foreignKeys.map(s=>{const o=s.columnNames.map(c=>`\`${c}\``).join(", ");s.name||(s.name=this.connection.namingStrategy.foreignKeyName(e,s.columnNames));const l=s.referencedColumnNames.map(c=>`\`${c}\``).join(", ");let u=`CONSTRAINT \`${s.name}\` FOREIGN KEY (${o}) REFERENCES ${this.escapePath(this.getTablePath(s))} (${l})`;return s.onDelete&&(u+=` ON DELETE ${s.onDelete}`),s.onUpdate&&(u+=` ON UPDATE ${s.onUpdate}`),u}).join(", ");i+=`, ${a}`}if(e.primaryColumns.length>0){const a=e.primaryColumns.map(s=>`\`${s.name}\``).join(", ");i+=`, PRIMARY KEY (${a})`}return i+=`) ENGINE=${e.engine||"InnoDB"}`,new I(i)}dropTableSql(e){return new I(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){return typeof e.expression=="string"?new I(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression}`):new I(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression(this.connection).getQuery()}`)}async insertViewDefinitionSql(e){const t=await this.getCurrentDatabase(),r=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:Oe.VIEW,schema:t,name:e.name,value:r})}dropViewSql(e){return new I(`DROP VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){const t=await this.getCurrentDatabase(),r=U.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:Oe.VIEW,schema:t,name:r})}createIndexSql(e,t){const r=t.columnNames.map(a=>`\`${a}\``).join(", ");let i="";return t.isUnique&&(i+="UNIQUE "),t.isSpatial&&(i+="SPATIAL "),t.isFulltext&&(i+="FULLTEXT "),new I(`CREATE ${i}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${r})`)}dropIndexSql(e,t){let r=U.isTableIndex(t)?t.name:t;return new I(`DROP INDEX \`${r}\` ON ${this.escapePath(e)}`)}createPrimaryKeySql(e,t){const r=t.map(i=>`\`${i}\``).join(", ");return new I(`ALTER TABLE ${this.escapePath(e)} ADD PRIMARY KEY (${r})`)}dropPrimaryKeySql(e){return new I(`ALTER TABLE ${this.escapePath(e)} DROP PRIMARY KEY`)}createForeignKeySql(e,t){const r=t.columnNames.map(s=>`\`${s}\``).join(", "),i=t.referencedColumnNames.map(s=>`\`${s}\``).join(",");let a=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${r}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${i})`;return t.onDelete&&(a+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(a+=` ON UPDATE ${t.onUpdate}`),new I(a)}dropForeignKeySql(e,t){const r=U.isTableForeignKey(t)?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP FOREIGN KEY \`${r}\``)}escapeComment(e){return!e||e.length===0?"''":(e=e.replace(/\\/g,"\\\\").replace(/'/g,"''").replace(/\u0000/g,""),`'${e}'`)}escapePath(e){const{database:t,tableName:r}=this.driver.parseTableName(e);return t&&t!==this.driver.database?`\`${t}\`.\`${r}\``:`\`${r}\``}buildCreateColumnSql(e,t,r=!1){let i="";return r?i=this.connection.driver.createFullType(e):i=`\`${e.name}\` ${this.connection.driver.createFullType(e)}`,e.asExpression&&(i+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`),e.zerofill?i+=" ZEROFILL":e.unsigned&&(i+=" UNSIGNED"),e.enum&&(i+=` (${e.enum.map(a=>"'"+a+"'").join(", ")})`),e.charset&&(i+=` CHARACTER SET "${e.charset}"`),e.collation&&(i+=` COLLATE "${e.collation}"`),e.isNullable||(i+=" NOT NULL"),e.isNullable&&(i+=" NULL"),e.isPrimary&&!t&&(i+=" PRIMARY KEY"),e.isGenerated&&e.generationStrategy==="increment"&&(i+=" AUTO_INCREMENT"),e.comment&&(i+=` COMMENT ${this.escapeComment(e.comment)}`),e.default!==void 0&&e.default!==null&&(i+=` DEFAULT ${e.default}`),e.onUpdate&&(i+=` ON UPDATE ${e.onUpdate}`),i}isDefaultColumnWidth(e,t,r){if(this.connection.hasMetadata(e.name)){const s=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(s&&s.width)return!1}const i=this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].width;if(i){const s=["int","tinyint","smallint","mediumint"].indexOf(t.type)!==-1;return t.unsigned&&s?i-1===r:i===r}return!1}}class nP{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["bit","int","integer","tinyint","smallint","mediumint","bigint","float","double","double precision","real","decimal","dec","numeric","fixed","bool","boolean","date","datetime","timestamp","time","year","char","nchar","national char","varchar","nvarchar","national varchar","blob","text","tinyblob","tinytext","mediumblob","mediumtext","longblob","longtext","enum","set","binary","varbinary","json","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.supportedUpsertTypes=["on-duplicate-key-update"],this.spatialTypes=["geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.withLengthColumnTypes=["char","varchar","nvarchar","binary","varbinary"],this.withWidthColumnTypes=["bit","tinyint","smallint","mediumint","int","integer","bigint"],this.withPrecisionColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real","time","datetime","timestamp"],this.withScaleColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real"],this.unsignedAndZerofillTypes=["int","integer","smallint","tinyint","mediumint","bigint","decimal","dec","numeric","fixed","float","double","double precision","real"],this.mappedDataTypes={createDate:"datetime",createDatePrecision:6,createDateDefault:"CURRENT_TIMESTAMP(6)",updateDate:"datetime",updateDatePrecision:6,updateDateDefault:"CURRENT_TIMESTAMP(6)",deleteDate:"datetime",deleteDatePrecision:6,deleteDateNullable:!0,version:"int",treeLevel:"int",migrationId:"int",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.dataTypeDefaults={varchar:{length:255},nvarchar:{length:255},"national varchar":{length:255},char:{length:1},binary:{length:1},varbinary:{length:255},decimal:{precision:10,scale:0},dec:{precision:10,scale:0},numeric:{precision:10,scale:0},fixed:{precision:10,scale:0},float:{precision:12},double:{precision:22},time:{precision:0},datetime:{precision:0},timestamp:{precision:0},bit:{width:1},int:{width:11},integer:{width:11},tinyint:{width:4},smallint:{width:6},mediumint:{width:9},bigint:{width:20}},this.maxAliasLength=63,this.cteCapabilities={enabled:!1},this.connection=e,this.options=e.options,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions),this.database=me.buildDriverOptions(this.options).database}async connect(){if(!this.database){const e=await this.createQueryRunner("master");this.database=await e.getCurrentDatabase(),await e.release()}}afterConnect(){return Promise.resolve()}async disconnect(){}createSchemaBuilder(){return new th(this.connection)}createQueryRunner(e){return new tP(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions))}escapeQueryWithParameters(e,t,r){const i=Object.keys(r).map(a=>r[a]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,s,o)=>{if(!t.hasOwnProperty(o))return a;let l=t[o];return s?l.map(u=>(i.push(u),this.createParameter(o,i.length-1))).join(", "):typeof l=="function"?l():(i.push(l),this.createParameter(o,i.length-1))}),[e,i])}escape(e){return"`"+e+"`"}buildTableName(e,t,r){let i=[e];return r&&i.unshift(r),i.join(".")}parseTableName(e){const t=this.database,r=void 0;if(U.isTable(e)||U.isView(e)){const a=this.parseTableName(e.name);return{database:e.database||a.database||t,schema:e.schema||a.schema||r,tableName:a.tableName}}if(U.isTableForeignKey(e)){const a=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||a.database||t,schema:e.referencedSchema||a.schema||r,tableName:a.tableName}}if(U.isEntityMetadata(e))return{database:e.database||t,schema:e.schema||r,tableName:e.tableName};const i=e.split(".");return{database:(i.length>1?i[0]:void 0)||t,schema:r,tableName:i.length>1?i[1]:i[0]}}preparePersistentValue(e,t){return t.transformer&&(e=Ft.transformTo(t.transformer,e)),!this.options.formatOptions||this.options.formatOptions.castParameters!==!1?this.client.preparePersistentValue(e,t):e==null?e:t.type===Boolean?e===!0?1:0:t.type==="date"?Ie.mixedDateToDateString(e):t.type==="time"?Ie.mixedDateToTimeString(e):t.type==="json"?JSON.stringify(e):t.type==="timestamp"||t.type==="datetime"||t.type===Date?Ie.mixedDateToDate(e):t.type==="simple-array"||t.type==="set"?Ie.simpleArrayToString(e):t.type==="simple-json"?Ie.simpleJsonToString(e):t.type==="enum"||t.type==="simple-enum"?""+e:e}prepareHydratedValue(e,t){return e==null?t.transformer?Ft.transformFrom(t.transformer,e):e:!this.options.formatOptions||this.options.formatOptions.castParameters!==!1?this.client.prepareHydratedValue(e,t):(t.type===Boolean||t.type==="bool"||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?e=Ie.normalizeHydratedDate(e):t.type==="date"?e=Ie.mixedDateToDateString(e):t.type==="json"?e=typeof e=="string"?JSON.parse(e):e:t.type==="time"?e=Ie.mixedTimeToString(e):t.type==="simple-array"||t.type==="set"?e=Ie.stringToSimpleArray(e):t.type==="simple-json"?e=Ie.stringToSimpleJson(e):(t.type==="enum"||t.type==="simple-enum")&&t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0?e=parseInt(e):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=Ft.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number||e.type==="integer"?"int":e.type===String?"varchar":e.type===Date?"datetime":e.type===Buffer?"blob":e.type===Boolean?"tinyint":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"enum":e.type==="double precision"||e.type==="real"?"double":e.type==="dec"||e.type==="numeric"||e.type==="fixed"?"decimal":e.type==="bool"||e.type==="boolean"?"tinyint":e.type==="nvarchar"||e.type==="national varchar"?"varchar":e.type==="nchar"||e.type==="national char"?"char":e.type||""}normalizeDefault(e){const t=e.default;if(t!==null){if((e.type==="enum"||e.type==="simple-enum")&&t!==void 0)return`'${t}'`;if(e.type==="set"&&t!==void 0)return`'${Ie.simpleArrayToString(t)}'`;if(typeof t=="number")return`${t}`;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!==void 0)return`${t}`}}normalizeIsUnique(e){return e.entityMetadata.indices.some(t=>t.isUnique&&t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){if(e.length)return e.length.toString();if(e.generationStrategy==="uuid")return"36";switch(e.type){case String:case"varchar":case"nvarchar":case"national varchar":return"255";case"varbinary":return"255";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+=`(${e.precision},${e.scale})`:e.precision!==null&&e.precision!==void 0&&(t+=`(${e.precision})`),e.isArray&&(t+=" array"),t}obtainMasterConnection(){return new Promise((e,t)=>{this.poolCluster?this.poolCluster.getConnection("MASTER",(r,i)=>{r?t(r):e(this.prepareDbConnection(i))}):this.pool?this.pool.getConnection((r,i)=>{r?t(r):e(this.prepareDbConnection(i))}):t(new L("Connection is not established with mysql database"))})}obtainSlaveConnection(){return this.poolCluster?new Promise((e,t)=>{this.poolCluster.getConnection("SLAVE*",(r,i)=>{r?t(r):e(this.prepareDbConnection(i))})}):this.obtainMasterConnection()}createGeneratedMap(e,t,r){const i=e.generatedColumns.reduce((a,s)=>{let o;return s.generationStrategy==="increment"&&t.insertId&&(o=t.insertId+r),be.mergeDeep(a,s.createValueMap(o))},{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter(r=>{const i=e.find(s=>s.name===r.databaseName);if(!i)return!1;let a=r.length;return!a&&r.generationStrategy==="uuid"&&(a=this.getColumnLength(r)),i.name!==r.databaseName||i.type!==this.normalizeType(r)||i.length!==a||i.width!==r.width||i.precision!==r.precision||i.scale!==r.scale||i.zerofill!==r.zerofill||i.unsigned!==r.unsigned||i.asExpression!==r.asExpression||i.generatedType!==r.generatedType||i.comment!==this.escapeComment(r.comment)||!this.compareDefaultValues(this.normalizeDefault(r),i.default)||i.enum&&r.enum&&!be.isArraysEqual(i.enum,r.enum.map(s=>s+""))||i.onUpdate!==r.onUpdate||i.isPrimary!==r.isPrimary||i.isNullable!==r.isNullable||i.isUnique!==this.normalizeIsUnique(r)||r.generationStrategy!=="uuid"&&i.isGenerated!==r.isGenerated})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!0}createParameter(e,t){return"?"}loadDependencies(){const e=this.options.driver||ft.load("typeorm-aurora-data-api-driver");this.DataApiDriver=e,this.DataApiDriver=this.DataApiDriver.default||this.DataApiDriver}createConnectionOptions(e,t){return t=Object.assign({},t,me.buildDriverOptions(t)),Object.assign({},{resourceArn:e.resourceArn,secretArn:e.secretArn,database:e.database,region:e.region,type:e.type},{host:t.host,user:t.username,password:t.password,database:t.database,port:t.port,ssl:e.ssl},e.extra||{})}async createPool(e){return{}}prepareDbConnection(e){const{logger:t}=this.connection;return e.listeners("error").length===0&&e.on("error",r=>t.log("warn",`MySQL connection raised an error. ${r}`)),e}compareDefaultValues(e,t){return typeof e=="string"&&typeof t=="string"&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}escapeComment(e){return e&&(e=e.replace(/\u0000/g,""),e)}}class rP extends nh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new $i(this)}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:(this.mode==="slave"&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const r=i=>this.releasePostgresConnection(i);return this.releaseCallback=i=>{this.databaseConnection.removeListener("error",r),t(i)},this.databaseConnection.on("error",r),this.databaseConnection}):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const r=i=>this.releasePostgresConnection(i);return this.releaseCallback=i=>{this.databaseConnection.removeListener("error",r),t(i)},this.databaseConnection.on("error",r),this.databaseConnection}),this.databaseConnectionPromise)}async releasePostgresConnection(e){if(this.isReleased)return;this.isReleased=!0,this.releaseCallback&&(this.releaseCallback(e),this.releaseCallback=void 0);const t=this.driver.connectedQueryRunners.indexOf(this);t!==-1&&this.driver.connectedQueryRunners.splice(t,1)}release(){return this.releasePostgresConnection()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?(await this.query("START TRANSACTION"),e&&await this.query("SET TRANSACTION ISOLATION LEVEL "+e)):await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new yn;const i=await this.connect();this.driver.connection.logger.logQuery(e,t,this);try{const a=+new Date,s=await i.query(e,t),o=this.driver.options.maxQueryExecutionTime,u=+new Date-a;o&&u>o&&this.driver.connection.logger.logQuerySlow(u,e,t,this);const c=new ni;if(s){switch(s.hasOwnProperty("rows")&&(c.records=s.rows),s.hasOwnProperty("rowCount")&&(c.affected=s.rowCount),s.command){case"DELETE":case"UPDATE":c.raw=[s.rows,s.rowCount];break;default:c.raw=s.rows}if(!r)return c.raw}return c}catch(a){throw this.driver.connection.logger.logQueryError(a,e,t,this),new Gr(e,t,a)}}async stream(e,t,r,i){const a=this.driver.loadStreamDependency();if(this.isReleased)throw new yn;const s=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=s.query(new a(e,t));return r&&o.on("end",r),i&&o.on("error",i),o}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){return!!(await this.query(`SELECT * FROM pg_database WHERE datname='${e}';`)).length}async getCurrentDatabase(){return(await this.query("SELECT * FROM current_database()"))[0].current_database}async hasSchema(e){return!!(await this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length}async getCurrentSchema(){return(await this.query("SELECT * FROM current_schema()"))[0].current_schema}async hasTable(e){const t=this.driver.parseTableName(e);t.schema||(t.schema=await this.getCurrentSchema());const r=`SELECT * FROM "information_schema"."tables" WHERE "table_schema" = '${t.schema}' AND "table_name" = '${t.tableName}'`;return!!(await this.query(r)).length}async hasColumn(e,t){const r=this.driver.parseTableName(e);r.schema||(r.schema=await this.getCurrentSchema());const i=`SELECT * FROM "information_schema"."columns" WHERE "table_schema" = '${r.schema}' AND "table_name" = '${r.tableName}' AND "column_name" = '${t}'`;return!!(await this.query(i)).length}async createDatabase(e,t){if(t&&await this.hasDatabase(e))return Promise.resolve();const r=`CREATE DATABASE "${e}"`,i=`DROP DATABASE "${e}"`;await this.executeQueries(new I(r),new I(i))}async dropDatabase(e,t){const r=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,i=`CREATE DATABASE "${e}"`;await this.executeQueries(new I(r),new I(i))}async createSchema(e,t){const r=e.indexOf(".")===-1?e:e.split(".")[1],i=t?`CREATE SCHEMA IF NOT EXISTS "${r}"`:`CREATE SCHEMA "${r}"`,a=`DROP SCHEMA "${r}" CASCADE`;await this.executeQueries(new I(i),new I(a))}async dropSchema(e,t,r){const i=e.indexOf(".")===-1?e:e.split(".")[1],a=t?`DROP SCHEMA IF EXISTS "${i}" ${r?"CASCADE":""}`:`DROP SCHEMA "${i}" ${r?"CASCADE":""}`,s=`CREATE SCHEMA "${i}"`;await this.executeQueries(new I(a),new I(s))}async createTable(e,t=!1,r=!0,i=!0){if(t&&await this.hasTable(e))return Promise.resolve();const a=[],s=[],o=e.columns.filter(c=>c.type==="enum"||c.type==="simple-enum"),l=[];for(const c of o){const d=await this.hasEnumType(e,c),h=this.buildEnumName(e,c);!d&&l.indexOf(h)===-1&&(l.push(h),a.push(this.createEnumTypeSql(e,c,h)),s.push(this.dropEnumTypeSql(e,c,h)))}const u=e.columns.filter(c=>c.generatedType==="STORED"&&c.asExpression);for(const c of u){const d=(await this.getTableNameWithSchema(e.name)).split("."),h=d[1],p=d[0],g=this.insertTypeormMetadataSql({database:this.driver.database,schema:p,table:h,type:Oe.GENERATED_COLUMN,name:c.name,value:c.asExpression}),E=this.deleteTypeormMetadataSql({database:this.driver.database,schema:p,table:h,type:Oe.GENERATED_COLUMN,name:c.name});a.push(g),s.push(E)}a.push(this.createTableSql(e,r)),s.push(this.dropTableSql(e)),r&&e.foreignKeys.forEach(c=>s.push(this.dropForeignKeySql(e,c))),i&&e.indices.forEach(c=>{c.name||(c.name=this.connection.namingStrategy.indexName(e,c.columnNames,c.where)),a.push(this.createIndexSql(e,c)),s.push(this.dropIndexSql(e,c))}),await this.executeQueries(a,s)}async dropTable(e,t,r=!0,i=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const a=r,s=this.getTablePath(e),o=await this.getCachedTable(s),l=[],u=[];i&&o.indices.forEach(d=>{l.push(this.dropIndexSql(o,d)),u.push(this.createIndexSql(o,d))}),r&&o.foreignKeys.forEach(d=>l.push(this.dropForeignKeySql(o,d))),l.push(this.dropTableSql(o)),u.push(this.createTableSql(o,a));const c=o.columns.filter(d=>d.generatedType&&d.asExpression);for(const d of c){const h=(await this.getTableNameWithSchema(o.name)).split("."),p=h[1],g=h[0],E=this.deleteTypeormMetadataSql({database:this.driver.database,schema:g,table:p,type:Oe.GENERATED_COLUMN,name:d.name}),A=this.insertTypeormMetadataSql({database:this.driver.database,schema:g,table:p,type:Oe.GENERATED_COLUMN,name:d.name,value:d.asExpression});l.push(E),u.push(A)}await this.executeQueries(l,u)}async createView(e,t=!1){const r=[],i=[];r.push(this.createViewSql(e)),t&&r.push(await this.insertViewDefinitionSql(e)),i.push(this.dropViewSql(e)),t&&i.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(r,i)}async dropView(e){const t=U.isView(e)?e.name:e,r=await this.getCachedView(t),i=[],a=[];i.push(await this.deleteViewDefinitionSql(r)),i.push(this.dropViewSql(r)),a.push(await this.insertViewDefinitionSql(r)),a.push(this.createViewSql(r)),await this.executeQueries(i,a)}async renameTable(e,t){const r=[],i=[],a=U.isTable(e)?e:await this.getCachedTable(e),s=a.clone(),{schema:o,tableName:l}=this.driver.parseTableName(a);if(s.name=o?`${o}.${t}`:t,r.push(new I(`ALTER TABLE ${this.escapePath(a)} RENAME TO "${t}"`)),i.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME TO "${l}"`)),s.primaryColumns.length>0&&!s.primaryColumns[0].primaryKeyConstraintName){const c=s.primaryColumns.map(p=>p.name),d=this.connection.namingStrategy.primaryKeyName(a,c),h=this.connection.namingStrategy.primaryKeyName(s,c);r.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${d}" TO "${h}"`)),i.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${h}" TO "${d}"`))}s.columns.map(c=>{if(c.isGenerated&&c.generationStrategy==="increment"){const d=this.buildSequencePath(a,c.name),h=this.buildSequenceName(a,c.name),p=this.buildSequencePath(s,c.name),g=this.buildSequenceName(s,c.name),E=`ALTER SEQUENCE ${this.escapePath(d)} RENAME TO "${g}"`,A=`ALTER SEQUENCE ${this.escapePath(p)} RENAME TO "${h}"`;r.push(new I(E)),i.push(new I(A))}}),s.uniques.forEach(c=>{const d=this.connection.namingStrategy.uniqueConstraintName(a,c.columnNames);if(c.name!==d)return;const h=this.connection.namingStrategy.uniqueConstraintName(s,c.columnNames);r.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${c.name}" TO "${h}"`)),i.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${h}" TO "${c.name}"`)),c.name=h}),s.indices.forEach(c=>{const d=this.connection.namingStrategy.indexName(a,c.columnNames,c.where);if(c.name!==d)return;const{schema:h}=this.driver.parseTableName(s),p=this.connection.namingStrategy.indexName(s,c.columnNames,c.where),g=h?`ALTER INDEX "${h}"."${c.name}" RENAME TO "${p}"`:`ALTER INDEX "${c.name}" RENAME TO "${p}"`,E=h?`ALTER INDEX "${h}"."${p}" RENAME TO "${c.name}"`:`ALTER INDEX "${p}" RENAME TO "${c.name}"`;r.push(new I(g)),i.push(new I(E)),c.name=p}),s.foreignKeys.forEach(c=>{const d=this.connection.namingStrategy.foreignKeyName(a,c.columnNames,this.getTablePath(c),c.referencedColumnNames);if(c.name!==d)return;const h=this.connection.namingStrategy.foreignKeyName(s,c.columnNames,this.getTablePath(c),c.referencedColumnNames);r.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${c.name}" TO "${h}"`)),i.push(new I(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${h}" TO "${c.name}"`)),c.name=h});const u=s.columns.filter(c=>c.type==="enum"||c.type==="simple-enum");for(let c of u){if(c.enumName)continue;const d=await this.getUserDefinedTypeName(a,c);r.push(new I(`ALTER TYPE "${d.schema}"."${d.name}" RENAME TO ${this.buildEnumName(s,c,!1)}`)),i.push(new I(`ALTER TYPE ${this.buildEnumName(s,c)} RENAME TO "${d.name}"`))}await this.executeQueries(r,i)}async addColumn(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=r.clone(),a=[],s=[];if((t.type==="enum"||t.type==="simple-enum")&&(await this.hasEnumType(r,t)||(a.push(this.createEnumTypeSql(r,t)),s.push(this.dropEnumTypeSql(r,t)))),a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(r,t)}`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN "${t.name}"`)),t.isPrimary){const l=i.primaryColumns;if(l.length>0){const d=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,l.map(p=>p.name)),h=l.map(p=>`"${p.name}"`).join(", ");a.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${d}"`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${d}" PRIMARY KEY (${h})`))}l.push(t);const u=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,l.map(d=>d.name)),c=l.map(d=>`"${d.name}"`).join(", ");a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${u}" PRIMARY KEY (${c})`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${u}"`))}const o=i.indices.find(l=>l.columnNames.length===1&&l.columnNames[0]===t.name);if(o&&(a.push(this.createIndexSql(r,o)),s.push(this.dropIndexSql(r,o))),t.isUnique){const l=new un({name:this.connection.namingStrategy.uniqueConstraintName(r,[t.name]),columnNames:[t.name]});i.uniques.push(l),a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${l.name}" UNIQUE ("${t.name}")`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${l.name}"`))}if(t.generatedType==="STORED"&&t.asExpression){const l=(await this.getTableNameWithSchema(r.name)).split("."),u=l[1],c=l[0],d=this.insertTypeormMetadataSql({database:this.driver.database,schema:c,table:u,type:Oe.GENERATED_COLUMN,name:t.name,value:t.asExpression}),h=this.deleteTypeormMetadataSql({database:this.driver.database,schema:c,table:u,type:Oe.GENERATED_COLUMN,name:t.name});a.push(d),s.push(h)}t.comment&&(a.push(new I(`COMMENT ON COLUMN ${this.escapePath(r)}."${t.name}" IS ${this.escapeComment(t.comment)}`)),s.push(new I(`COMMENT ON COLUMN ${this.escapePath(r)}."${t.name}" IS ${this.escapeComment(t.comment)}`))),await this.executeQueries(a,s),i.addColumn(t),this.replaceCachedTable(r,i)}async addColumns(e,t){for(const r of t)await this.addColumn(e,r)}async renameColumn(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e),a=U.isTableColumn(t)?t:i.columns.find(o=>o.name===t);if(!a)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);let s;return U.isTableColumn(r)?s=r:(s=a.clone(),s.name=r),this.changeColumn(i,a,s)}async changeColumn(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e);let a=i.clone();const s=[],o=[];let l=!1;const u=U.isTableColumn(t)?t:i.columns.find(c=>c.name===t);if(!u)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);if(u.type!==r.type||u.length!==r.length||r.isArray!==u.isArray||!u.generatedType&&r.generatedType==="STORED"||u.asExpression!==r.asExpression&&r.generatedType==="STORED")await this.dropColumn(i,u),await this.addColumn(i,r),a=i.clone();else{if(u.name!==r.name){if(s.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME COLUMN "${u.name}" TO "${r.name}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME COLUMN "${r.name}" TO "${u.name}"`)),u.type==="enum"||u.type==="simple-enum"){const d=await this.getUserDefinedTypeName(i,u);s.push(new I(`ALTER TYPE "${d.schema}"."${d.name}" RENAME TO ${this.buildEnumName(i,r,!1)}`)),o.push(new I(`ALTER TYPE ${this.buildEnumName(i,r)} RENAME TO "${d.name}"`))}if(u.isPrimary===!0&&!u.primaryKeyConstraintName){const h=a.primaryColumns.map(E=>E.name),p=this.connection.namingStrategy.primaryKeyName(a,h);h.splice(h.indexOf(u.name),1),h.push(r.name);const g=this.connection.namingStrategy.primaryKeyName(a,h);s.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${p}" TO "${g}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${g}" TO "${p}"`))}if(u.isGenerated===!0&&r.generationStrategy==="increment"){const d=this.buildSequencePath(i,u.name),h=this.buildSequenceName(i,u.name),p=this.buildSequencePath(i,r.name),g=this.buildSequenceName(i,r.name),E=`ALTER SEQUENCE ${this.escapePath(d)} RENAME TO "${g}"`,A=`ALTER SEQUENCE ${this.escapePath(p)} RENAME TO "${h}"`;s.push(new I(E)),o.push(new I(A))}a.findColumnUniques(u).forEach(d=>{const h=this.connection.namingStrategy.uniqueConstraintName(a,d.columnNames);if(d.name!==h)return;d.columnNames.splice(d.columnNames.indexOf(u.name),1),d.columnNames.push(r.name);const p=this.connection.namingStrategy.uniqueConstraintName(a,d.columnNames);s.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${d.name}" TO "${p}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${p}" TO "${d.name}"`)),d.name=p}),a.findColumnIndices(u).forEach(d=>{const h=this.connection.namingStrategy.indexName(a,d.columnNames,d.where);if(d.name!==h)return;d.columnNames.splice(d.columnNames.indexOf(u.name),1),d.columnNames.push(r.name);const{schema:p}=this.driver.parseTableName(i),g=this.connection.namingStrategy.indexName(a,d.columnNames,d.where),E=p?`ALTER INDEX "${p}"."${d.name}" RENAME TO "${g}"`:`ALTER INDEX "${d.name}" RENAME TO "${g}"`,A=p?`ALTER INDEX "${p}"."${g}" RENAME TO "${d.name}"`:`ALTER INDEX "${g}" RENAME TO "${d.name}"`;s.push(new I(E)),o.push(new I(A)),d.name=g}),a.findColumnForeignKeys(u).forEach(d=>{const h=this.connection.namingStrategy.foreignKeyName(a,d.columnNames,this.getTablePath(d),d.referencedColumnNames);if(d.name!==h)return;d.columnNames.splice(d.columnNames.indexOf(u.name),1),d.columnNames.push(r.name);const p=this.connection.namingStrategy.foreignKeyName(a,d.columnNames,this.getTablePath(d),d.referencedColumnNames);s.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${d.name}" TO "${p}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${p}" TO "${d.name}"`)),d.name=p});const c=a.columns.find(d=>d.name===u.name);a.columns[a.columns.indexOf(c)].name=r.name,u.name=r.name}if((r.precision!==u.precision||r.scale!==u.scale)&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(r)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(u)}`))),(r.type==="enum"||r.type==="simple-enum")&&(u.type==="enum"||u.type==="simple-enum")&&(!be.isArraysEqual(r.enum,u.enum)||r.enumName!==u.enumName)){const c=r.isArray?"[]":"",d=this.buildEnumName(i,r),h=this.buildEnumName(i,u),p=this.buildEnumName(i,u,!1),g=this.buildEnumName(i,u,!0,!1,!0),E=this.buildEnumName(i,u,!1,!1,!0);s.push(new I(`ALTER TYPE ${h} RENAME TO ${E}`)),o.push(new I(`ALTER TYPE ${g} RENAME TO ${p}`)),s.push(this.createEnumTypeSql(i,r,d)),o.push(this.dropEnumTypeSql(i,r,d)),u.default!==null&&u.default!==void 0&&(l=!0,s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" DROP DEFAULT`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" SET DEFAULT ${u.default}`)));const A=`${d}${c} USING "${r.name}"::"text"::${d}${c}`,b=`${g}${c} USING "${r.name}"::"text"::${g}${c}`;s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${A}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${b}`)),r.default!==null&&r.default!==void 0&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT ${r.default}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`))),s.push(this.dropEnumTypeSql(i,u,g)),o.push(this.createEnumTypeSql(i,u,g))}if(u.isNullable!==r.isNullable&&(r.isNullable?(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" DROP NOT NULL`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" SET NOT NULL`))):(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" SET NOT NULL`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" DROP NOT NULL`)))),u.comment!==r.comment&&(s.push(new I(`COMMENT ON COLUMN ${this.escapePath(i)}."${u.name}" IS ${this.escapeComment(r.comment)}`)),o.push(new I(`COMMENT ON COLUMN ${this.escapePath(i)}."${r.name}" IS ${this.escapeComment(u.comment)}`))),r.isPrimary!==u.isPrimary){const c=a.primaryColumns;if(c.length>0){const d=c[0].primaryKeyConstraintName?c[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,c.map(p=>p.name)),h=c.map(p=>`"${p.name}"`).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${d}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${d}" PRIMARY KEY (${h})`))}if(r.isPrimary===!0){c.push(r);const d=a.columns.find(g=>g.name===r.name);d.isPrimary=!0;const h=c[0].primaryKeyConstraintName?c[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,c.map(g=>g.name)),p=c.map(g=>`"${g.name}"`).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${h}" PRIMARY KEY (${p})`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${h}"`))}else{const d=c.find(p=>p.name===r.name);c.splice(c.indexOf(d),1);const h=a.columns.find(p=>p.name===r.name);if(h.isPrimary=!1,c.length>0){const p=c[0].primaryKeyConstraintName?c[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,c.map(E=>E.name)),g=c.map(E=>`"${E.name}"`).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${p}" PRIMARY KEY (${g})`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${p}"`))}}}if(r.isUnique!==u.isUnique)if(r.isUnique===!0){const c=new un({name:this.connection.namingStrategy.uniqueConstraintName(i,[r.name]),columnNames:[r.name]});a.uniques.push(c),s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${c.name}" UNIQUE ("${r.name}")`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${c.name}"`))}else{const c=a.uniques.find(d=>d.columnNames.length===1&&!!d.columnNames.find(h=>h===r.name));a.uniques.splice(a.uniques.indexOf(c),1),s.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${c.name}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${c.name}" UNIQUE ("${r.name}")`))}if(u.isGenerated!==r.isGenerated&&(u.isGenerated&&(u.generationStrategy==="uuid"?(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" DROP DEFAULT`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${u.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):u.generationStrategy==="increment"&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(i,r))}')`)),s.push(new I(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(i,r))}`)),o.push(new I(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(i,r))} OWNED BY ${this.escapePath(i)}."${r.name}"`)))),r.generationStrategy==="uuid"?r.isGenerated===!0?(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT ${this.driver.uuidGenerator}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`))):(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):r.generationStrategy==="increment"&&(r.isGenerated===!0?(s.push(new I(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(i,r))} OWNED BY ${this.escapePath(i)}."${r.name}"`)),o.push(new I(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(i,r))}`)),s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(i,r))}')`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`))):(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(i,r))}')`)),s.push(new I(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(i,r))}`)),o.push(new I(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(i,r))} OWNED BY ${this.escapePath(i)}."${r.name}"`))))),r.default!==u.default&&!l&&(r.default!==null&&r.default!==void 0?(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT ${r.default}`)),u.default!==null&&u.default!==void 0?o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT ${u.default}`)):o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`))):u.default!==null&&u.default!==void 0&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" SET DEFAULT ${u.default}`)))),((r.spatialFeatureType||"").toLowerCase()!==(u.spatialFeatureType||"").toLowerCase()||r.srid!==u.srid)&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(r)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(u)}`))),r.generatedType!==u.generatedType&&(!r.generatedType||r.generatedType==="VIRTUAL")){const c=(await this.getTableNameWithSchema(i.name)).split("."),d=c[1],h=c[0];s.push(new I(`ALTER TABLE ${this.escapePath(i)} RENAME COLUMN "${u.name}" TO "TEMP_OLD_${u.name}"`)),s.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD ${this.buildCreateColumnSql(i,r)}`)),s.push(new I(`UPDATE ${this.escapePath(i)} SET "${r.name}" = "TEMP_OLD_${u.name}"`)),s.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP COLUMN "TEMP_OLD_${u.name}"`)),s.push(this.deleteTypeormMetadataSql({database:this.driver.database,schema:h,table:d,type:Oe.GENERATED_COLUMN,name:u.name})),o.push(this.insertTypeormMetadataSql({database:this.driver.database,schema:h,table:d,type:Oe.GENERATED_COLUMN,name:u.name,value:u.asExpression})),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD ${this.buildCreateColumnSql(i,u)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP COLUMN "${r.name}"`))}}await this.executeQueries(s,o),this.replaceCachedTable(i,a)}async changeColumns(e,t){for(const{oldColumn:r,newColumn:i}of t)await this.changeColumn(e,r,i)}async dropColumn(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableColumn(t)?t:r.findColumnByName(t);if(!i)throw new L(`Column "${t}" was not found in table "${r.name}"`);const a=r.clone(),s=[],o=[];if(i.isPrimary){const d=i.primaryKeyConstraintName?i.primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,a.primaryColumns.map(g=>g.name)),h=a.primaryColumns.map(g=>`"${g.name}"`).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${d}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${d}" PRIMARY KEY (${h})`));const p=a.findColumnByName(i.name);if(p.isPrimary=!1,a.primaryColumns.length>0){const g=a.primaryColumns[0].primaryKeyConstraintName?a.primaryColumns[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,a.primaryColumns.map(A=>A.name)),E=a.primaryColumns.map(A=>`"${A.name}"`).join(", ");s.push(new I(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${g}" PRIMARY KEY (${E})`)),o.push(new I(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${g}"`))}}const l=a.indices.find(d=>d.columnNames.length===1&&d.columnNames[0]===i.name);l&&(a.indices.splice(a.indices.indexOf(l),1),s.push(this.dropIndexSql(r,l)),o.push(this.createIndexSql(r,l)));const u=a.checks.find(d=>!!d.columnNames&&d.columnNames.length===1&&d.columnNames[0]===i.name);u&&(a.checks.splice(a.checks.indexOf(u),1),s.push(this.dropCheckConstraintSql(r,u)),o.push(this.createCheckConstraintSql(r,u)));const c=a.uniques.find(d=>d.columnNames.length===1&&d.columnNames[0]===i.name);if(c&&(a.uniques.splice(a.uniques.indexOf(c),1),s.push(this.dropUniqueConstraintSql(r,c)),o.push(this.createUniqueConstraintSql(r,c))),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN "${i.name}"`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(r,i)}`)),(i.type==="enum"||i.type==="simple-enum")&&await this.hasEnumType(r,i)){const h=await this.getUserDefinedTypeName(r,i),p=`"${h.schema}"."${h.name}"`;s.push(this.dropEnumTypeSql(r,i,p)),o.push(this.createEnumTypeSql(r,i,p))}if(i.generatedType==="STORED"){const d=(await this.getTableNameWithSchema(r.name)).split("."),h=d[1],p=d[0],g=this.deleteTypeormMetadataSql({database:this.driver.database,schema:p,table:h,type:Oe.GENERATED_COLUMN,name:i.name}),E=this.insertTypeormMetadataSql({database:this.driver.database,schema:p,table:h,type:Oe.GENERATED_COLUMN,name:i.name,value:i.asExpression});s.push(g),o.push(E)}await this.executeQueries(s,o),a.removeColumn(i),this.replaceCachedTable(r,a)}async dropColumns(e,t){for(const r of t)await this.dropColumn(e,r)}async createPrimaryKey(e,t,r){const i=U.isTable(e)?e:await this.getCachedTable(e),a=i.clone(),s=this.createPrimaryKeySql(i,t,r);a.columns.forEach(l=>{t.find(u=>u===l.name)&&(l.isPrimary=!0)});const o=this.dropPrimaryKeySql(a);await this.executeQueries(s,o),this.replaceCachedTable(i,a)}async updatePrimaryKeys(e,t){var r;const i=U.isTable(e)?e:await this.getCachedTable(e),a=i.clone(),s=t.map(h=>h.name),o=[],l=[],u=a.primaryColumns;if(u.length>0){const h=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,u.map(g=>g.name)),p=u.map(g=>`"${g.name}"`).join(", ");o.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${h}"`)),l.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${h}" PRIMARY KEY (${p})`))}a.columns.filter(h=>s.indexOf(h.name)!==-1).forEach(h=>h.isPrimary=!0);const c=!((r=u[0])===null||r===void 0)&&r.primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,s),d=s.map(h=>`"${h}"`).join(", ");o.push(new I(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${c}" PRIMARY KEY (${d})`)),l.push(new I(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${c}"`)),await this.executeQueries(o,l),this.replaceCachedTable(i,a)}async dropPrimaryKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=this.dropPrimaryKeySql(r),a=this.createPrimaryKeySql(r,r.primaryColumns.map(s=>s.name),t);await this.executeQueries(i,a),r.primaryColumns.forEach(s=>{s.isPrimary=!1})}async createUniqueConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(r,t.columnNames));const i=this.createUniqueConstraintSql(r,t),a=this.dropUniqueConstraintSql(r,t);await this.executeQueries(i,a),r.addUniqueConstraint(t)}async createUniqueConstraints(e,t){for(const r of t)await this.createUniqueConstraint(e,r)}async dropUniqueConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableUnique(t)?t:r.uniques.find(o=>o.name===t);if(!i)throw new L(`Supplied unique constraint was not found in table ${r.name}`);const a=this.dropUniqueConstraintSql(r,i),s=this.createUniqueConstraintSql(r,i);await this.executeQueries(a,s),r.removeUniqueConstraint(i)}async dropUniqueConstraints(e,t){for(const r of t)await this.dropUniqueConstraint(e,r)}async createCheckConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r,t.expression));const i=this.createCheckConstraintSql(r,t),a=this.dropCheckConstraintSql(r,t);await this.executeQueries(i,a),r.addCheckConstraint(t)}async createCheckConstraints(e,t){const r=t.map(i=>this.createCheckConstraint(e,i));await Promise.all(r)}async dropCheckConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableCheck(t)?t:r.checks.find(o=>o.name===t);if(!i)throw new L(`Supplied check constraint was not found in table ${r.name}`);const a=this.dropCheckConstraintSql(r,i),s=this.createCheckConstraintSql(r,i);await this.executeQueries(a,s),r.removeCheckConstraint(i)}async dropCheckConstraints(e,t){const r=t.map(i=>this.dropCheckConstraint(e,i));await Promise.all(r)}async createExclusionConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.exclusionConstraintName(r,t.expression));const i=this.createExclusionConstraintSql(r,t),a=this.dropExclusionConstraintSql(r,t);await this.executeQueries(i,a),r.addExclusionConstraint(t)}async createExclusionConstraints(e,t){const r=t.map(i=>this.createExclusionConstraint(e,i));await Promise.all(r)}async dropExclusionConstraint(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableExclusion(t)?t:r.exclusions.find(o=>o.name===t);if(!i)throw new L(`Supplied exclusion constraint was not found in table ${r.name}`);const a=this.dropExclusionConstraintSql(r,i),s=this.createExclusionConstraintSql(r,i);await this.executeQueries(a,s),r.removeExclusionConstraint(i)}async dropExclusionConstraints(e,t){const r=t.map(i=>this.dropExclusionConstraint(e,i));await Promise.all(r)}async createForeignKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const i=this.createForeignKeySql(r,t),a=this.dropForeignKeySql(r,t);await this.executeQueries(i,a),r.addForeignKey(t)}async createForeignKeys(e,t){for(const r of t)await this.createForeignKey(e,r)}async dropForeignKey(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableForeignKey(t)?t:r.foreignKeys.find(o=>o.name===t);if(!i)throw new L(`Supplied foreign key was not found in table ${r.name}`);i.name||(i.name=this.connection.namingStrategy.foreignKeyName(r,i.columnNames,this.getTablePath(i),i.referencedColumnNames));const a=this.dropForeignKeySql(r,i),s=this.createForeignKeySql(r,i);await this.executeQueries(a,s),r.removeForeignKey(i)}async dropForeignKeys(e,t){for(const r of t)await this.dropForeignKey(e,r)}async createIndex(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const i=this.createIndexSql(r,t),a=this.dropIndexSql(r,t);await this.executeQueries(i,a),r.addIndex(t)}async createViewIndex(e,t){const r=U.isView(e)?e:await this.getCachedView(e);t.name||(t.name=this.generateIndexName(r,t));const i=this.createViewIndexSql(r,t),a=this.dropIndexSql(r,t);await this.executeQueries(i,a),r.addIndex(t)}async createIndices(e,t){for(const r of t)await this.createIndex(e,r)}async createViewIndices(e,t){for(const r of t)await this.createViewIndex(e,r)}async dropIndex(e,t){const r=U.isTable(e)?e:await this.getCachedTable(e),i=U.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!i)throw new L(`Supplied index ${t} was not found in table ${r.name}`);i.name||(i.name=this.generateIndexName(r,i));const a=this.dropIndexSql(r,i),s=this.createIndexSql(r,i);await this.executeQueries(a,s),r.removeIndex(i)}async dropViewIndex(e,t){const r=U.isView(e)?e:await this.getCachedView(e),i=U.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!i)throw new L(`Supplied index ${t} was not found in view ${r.name}`);i.name||(i.name=this.generateIndexName(r,i));const a=this.dropIndexSql(r,i),s=this.createViewIndexSql(r,i);await this.executeQueries(a,s),r.removeIndex(i)}async dropIndices(e,t){for(const r of t)await this.dropIndex(e,r)}async clearTable(e){await this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)}async clearDatabase(){const e=[];this.connection.entityMetadatas.filter(i=>i.schema).forEach(i=>{!!e.find(s=>s===i.schema)||e.push(i.schema)}),e.push(this.driver.options.schema||"current_schema()");const t=e.map(i=>i==="current_schema()"?i:"'"+i+"'").join(", "),r=this.isTransactionActive;r||await this.startTransaction();try{const i=await this.getVersion(),a=`SELECT 'DROP VIEW IF EXISTS "' || schemaname || '"."' || viewname || '" CASCADE;' as "query" FROM "pg_views" WHERE "schemaname" IN (${t}) AND "viewname" NOT IN ('geography_columns', 'geometry_columns', 'raster_columns', 'raster_overviews')`,s=await this.query(a);if(await Promise.all(s.map(u=>this.query(u.query))),Bb.isGreaterOrEqual(i,"9.3")){const u=`SELECT 'DROP MATERIALIZED VIEW IF EXISTS "' || schemaname || '"."' || matviewname || '" CASCADE;' as "query" FROM "pg_matviews" WHERE "schemaname" IN (${t})`,c=await this.query(u);await Promise.all(c.map(d=>this.query(d.query)))}const o=`SELECT 'DROP TABLE IF EXISTS "' || schemaname || '"."' || tablename || '" CASCADE;' as "query" FROM "pg_tables" WHERE "schemaname" IN (${t}) AND "tablename" NOT IN ('spatial_ref_sys')`,l=await this.query(o);await Promise.all(l.map(u=>this.query(u.query))),await this.dropEnumTypes(t),r||await this.commitTransaction()}catch(i){try{r||await this.rollbackTransaction()}catch{}throw i}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const r=await this.getCurrentDatabase(),i=await this.getCurrentSchema(),a=e.length===0?"1=1":e.map(d=>this.driver.parseTableName(d)).map(({schema:d,tableName:h})=>(d||(d=this.driver.options.schema||i),`("t"."schema" = '${d}' AND "t"."name" = '${h}')`)).join(" OR "),o=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('m') AND "cnst"."contype" IS NULL AND (${e.length===0?"1=1":e.map(d=>this.driver.parseTableName(d)).map(({schema:d,tableName:h})=>(d||(d=this.driver.options.schema||i),`("ns"."nspname" = '${d}' AND "t"."relname" = '${h}')`)).join(" OR ")})`,l=`SELECT "t".* FROM ${this.escapePath(this.getTypeormMetadataTableName())} "t" INNER JOIN "pg_catalog"."pg_class" "c" ON "c"."relname" = "t"."name" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "c"."relnamespace" AND "n"."nspname" = "t"."schema" WHERE "t"."type" IN ('${Oe.VIEW}', '${Oe.MATERIALIZED_VIEW}') ${a?`AND (${a})`:""}`,u=await this.query(l),c=await this.query(o);return u.map(d=>{const h=be.uniq(c.filter(E=>E.table_name===d.name&&E.table_schema===d.schema),E=>E.constraint_name),p=new Ci,g=d.schema===i&&!this.driver.options.schema?void 0:d.schema;return p.database=r,p.schema=d.schema,p.name=this.driver.buildTableName(d.name,g),p.expression=d.value,p.materialized=d.type===Oe.MATERIALIZED_VIEW,p.indices=h.map(E=>{const A=c.filter(b=>b.table_schema===E.table_schema&&b.table_name===E.table_name&&b.constraint_name===E.constraint_name);return new At({view:p,name:E.constraint_name,columnNames:A.map(b=>b.column_name),isUnique:E.is_unique==="TRUE",where:E.condition,isFulltext:!1})}),p})}async loadTables(e){if(e&&e.length===0)return[];const t=await this.getCurrentSchema(),r=await this.getCurrentDatabase(),i=[];if(!e)i.push(...await this.query('SELECT "table_schema", "table_name" FROM "information_schema"."tables"'));else{const C='SELECT "table_schema", "table_name" FROM "information_schema"."tables" WHERE '+e.map(P=>this.driver.parseTableName(P)).map(({schema:P,tableName:D})=>`("table_schema" = '${P||t}' AND "table_name" = '${D}')`).join(" OR ");i.push(...await this.query(C))}if(i.length===0)return[];const s=`SELECT columns.*, pg_catalog.col_description(('"' || table_catalog || '"."' || table_schema || '"."' || table_name || '"')::regclass::oid, ordinal_position) AS description, ('"' || "udt_schema" || '"."' || "udt_name" || '"')::"regtype" AS "regtype", pg_catalog.format_type("col_attr"."atttypid", "col_attr"."atttypmod") AS "format_type" FROM "information_schema"."columns" LEFT JOIN "pg_catalog"."pg_attribute" AS "col_attr" ON "col_attr"."attname" = "columns"."column_name" AND "col_attr"."attrelid" = ( SELECT "cls"."oid" FROM "pg_catalog"."pg_class" AS "cls" LEFT JOIN "pg_catalog"."pg_namespace" AS "ns" ON "ns"."oid" = "cls"."relnamespace" WHERE "cls"."relname" = "columns"."table_name" AND "ns"."nspname" = "columns"."table_schema" ) WHERE `+i.map(({table_schema:T,table_name:C})=>`("table_schema" = '${T}' AND "table_name" = '${C}')`).join(" OR "),o=i.map(({table_schema:T,table_name:C})=>`("ns"."nspname" = '${T}' AND "t"."relname" = '${C}')`).join(" OR "),l=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", pg_get_constraintdef("cnst"."oid") AS "expression", CASE "cnst"."contype" WHEN 'p' THEN 'PRIMARY' WHEN 'u' THEN 'UNIQUE' WHEN 'c' THEN 'CHECK' WHEN 'x' THEN 'EXCLUDE' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" IN ('r', 'p') AND (${o})`,u=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('r', 'p') AND "cnst"."contype" IS NULL AND (${o})`,c=i.map(({table_schema:T,table_name:C})=>`("ns"."nspname" = '${T}' AND "cl"."relname" = '${C}')`).join(" OR "),h=await this.hasSupportForPartitionedTables()?` AND "cl"."relispartition" = 'f'`:"",p=`SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update", "con"."condeferrable" AS "deferrable", "con"."condeferred" AS "deferred" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", "con1"."condeferrable", CASE WHEN "con1"."condeferred" THEN 'INITIALLY DEFERRED' ELSE 'INITIALLY IMMEDIATE' END as condeferred, CASE "con1"."confdeltype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confdeltype", CASE "con1"."confupdtype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = 'f' AND (${c}) ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" ${h}INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"`,[g,E,A,b]=await Promise.all([this.query(s),this.query(l),this.query(u),this.query(p)]);return Promise.all(i.map(async T=>{const C=new xt,P=(M,Z)=>M[Z]===t&&(!this.driver.options.schema||this.driver.options.schema===t)?void 0:M[Z],D=P(T,"table_schema");C.database=r,C.schema=T.table_schema,C.name=this.driver.buildTableName(T.table_name,D),C.columns=await Promise.all(g.filter(M=>M.table_name===T.table_name&&M.table_schema===T.table_schema).map(async M=>{const Z=E.filter(pe=>pe.table_name===M.table_name&&pe.table_schema===M.table_schema&&pe.column_name===M.column_name),q=new Tn;if(q.name=M.column_name,q.type=M.regtype.toLowerCase(),(q.type==="numeric"||q.type==="decimal"||q.type==="float")&&(M.numeric_precision!==null&&!this.isDefaultColumnPrecision(C,q,M.numeric_precision)?q.precision=M.numeric_precision:M.numeric_scale!==null&&!this.isDefaultColumnScale(C,q,M.numeric_scale)&&(q.precision=void 0),M.numeric_scale!==null&&!this.isDefaultColumnScale(C,q,M.numeric_scale)?q.scale=M.numeric_scale:M.numeric_precision!==null&&!this.isDefaultColumnPrecision(C,q,M.numeric_precision)&&(q.scale=void 0)),(q.type==="interval"||q.type==="time without time zone"||q.type==="time with time zone"||q.type==="timestamp without time zone"||q.type==="timestamp with time zone")&&(q.precision=this.isDefaultColumnPrecision(C,q,M.datetime_precision)?void 0:M.datetime_precision),M.data_type==="USER-DEFINED"||M.data_type==="ARRAY"){const{name:pe}=await this.getUserDefinedTypeName(C,q),de=this.buildEnumName(C,q,!1,!0)!==pe?pe:void 0,Ee=`SELECT "e"."enumlabel" AS "value" FROM "pg_enum" "e" INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${T.table_schema}' AND "t"."typname" = '${de||pe}'`,ye=await this.query(Ee);if(ye.length&&(q.type="enum",q.enum=ye.map(re=>re.value),q.enumName=de),M.data_type==="ARRAY"){q.isArray=!0;const re=q.type.replace("[]","");q.type=this.connection.driver.normalizeType({type:re})}}if(q.type==="geometry"||q.type==="geography"){const pe=`SELECT * FROM (SELECT "f_table_schema" "table_schema", "f_table_name" "table_name", "f_${q.type}_column" "column_name", "srid", "type" FROM "${q.type}_columns") AS _ WHERE "column_name" = '${M.column_name}' AND "table_schema" = '${M.table_schema}' AND "table_name" = '${M.table_name}'`,ee=await this.query(pe);ee.length>0&&(q.spatialFeatureType=ee[0].type,q.srid=ee[0].srid)}if(this.driver.withLengthColumnTypes.indexOf(q.type)!==-1){let pe;if(q.isArray){const ee=/\((\d+)\)/.exec(M.format_type);pe=ee?ee[1]:void 0}else M.character_maximum_length&&(pe=M.character_maximum_length.toString());pe&&(q.length=this.isDefaultColumnLength(C,q,pe)?"":pe)}q.isNullable=M.is_nullable==="YES";const G=Z.find(pe=>pe.constraint_type==="PRIMARY");if(G){q.isPrimary=!0;const ee=E.filter(Ee=>Ee.table_name===M.table_name&&Ee.table_schema===M.table_schema&&Ee.column_name!==M.column_name&&Ee.constraint_type==="PRIMARY").map(Ee=>Ee.column_name);ee.push(M.column_name);const de=this.connection.namingStrategy.primaryKeyName(C,ee);G.constraint_name!==de&&(q.primaryKeyConstraintName=G.constraint_name)}const oe=Z.filter(pe=>pe.constraint_type==="UNIQUE"),he=oe.every(pe=>E.some(ee=>ee.constraint_type==="UNIQUE"&&ee.constraint_name===pe.constraint_name&&ee.column_name!==M.column_name));if(q.isUnique=oe.length>0&&!he,M.is_identity==="YES")q.isGenerated=!0,q.generationStrategy="identity",q.generatedIdentity=M.identity_generation;else if(M.column_default!==null&&M.column_default!==void 0){const pe=`nextval('${this.buildSequenceName(C,M.column_name)}'::regclass)`,ee=`nextval('${this.buildSequencePath(C,M.column_name)}'::regclass)`,de=M.column_default.replace(/"/g,"");de===pe||de===ee?(q.isGenerated=!0,q.generationStrategy="increment"):M.column_default==="gen_random_uuid()"||/^uuid_generate_v\d\(\)/.test(M.column_default)?q.type==="uuid"?(q.isGenerated=!0,q.generationStrategy="uuid"):q.default=M.column_default:M.column_default==="now()"||M.column_default.indexOf("'now'::text")!==-1?q.default=M.column_default:(q.default=M.column_default.replace(/::[\w\s.\[\]\-"]+/g,""),q.default=q.default.replace(/^(-?\d+)$/,"'$1'"))}if(M.is_generated==="ALWAYS"&&M.generation_expression){q.generatedType="STORED";const pe=await this.selectTypeormMetadataSql({database:r,schema:T.table_schema,table:T.table_name,type:Oe.GENERATED_COLUMN,name:q.name}),ee=await this.query(pe.query,pe.parameters);ee[0]&&ee[0].value?q.asExpression=ee[0].value:q.asExpression=""}return q.comment=M.description?M.description:void 0,M.character_set_name&&(q.charset=M.character_set_name),M.collation_name&&(q.collation=M.collation_name),q}));const F=be.uniq(E.filter(M=>M.table_name===T.table_name&&M.table_schema===T.table_schema&&M.constraint_type==="UNIQUE"),M=>M.constraint_name);C.uniques=F.map(M=>{const Z=E.filter(q=>q.constraint_name===M.constraint_name);return new un({name:M.constraint_name,columnNames:Z.map(q=>q.column_name),deferrable:M.deferrable?M.deferred:void 0})});const Q=be.uniq(E.filter(M=>M.table_name===T.table_name&&M.table_schema===T.table_schema&&M.constraint_type==="CHECK"),M=>M.constraint_name);C.checks=Q.map(M=>{const Z=E.filter(q=>q.constraint_name===M.constraint_name);return new Mr({name:M.constraint_name,columnNames:Z.map(q=>q.column_name),expression:M.expression.replace(/^\s*CHECK\s*\((.*)\)\s*$/i,"$1")})});const W=be.uniq(E.filter(M=>M.table_name===T.table_name&&M.table_schema===T.table_schema&&M.constraint_type==="EXCLUDE"),M=>M.constraint_name);C.exclusions=W.map(M=>new Ja({name:M.constraint_name,expression:M.expression.substring(8)}));const B=be.uniq(b.filter(M=>M.table_name===T.table_name&&M.table_schema===T.table_schema),M=>M.constraint_name);C.foreignKeys=B.map(M=>{const Z=b.filter(oe=>oe.constraint_name===M.constraint_name),q=P(M,"referenced_table_schema"),G=this.driver.buildTableName(M.referenced_table_name,q);return new ir({name:M.constraint_name,columnNames:Z.map(oe=>oe.column_name),referencedSchema:M.referenced_table_schema,referencedTableName:G,referencedColumnNames:Z.map(oe=>oe.referenced_column_name),onDelete:M.on_delete,onUpdate:M.on_update,deferrable:M.deferrable?M.deferred:void 0})});const K=be.uniq(A.filter(M=>M.table_name===T.table_name&&M.table_schema===T.table_schema),M=>M.constraint_name);return C.indices=K.map(M=>{const Z=A.filter(q=>q.table_schema===M.table_schema&&q.table_name===M.table_name&&q.constraint_name===M.constraint_name);return new At({table:C,name:M.constraint_name,columnNames:Z.map(q=>q.column_name),isUnique:M.is_unique==="TRUE",where:M.condition,isSpatial:Z.every(q=>this.driver.spatialTypes.indexOf(q.type_name)>=0),isFulltext:!1})}),C}))}createTableSql(e,t){const r=e.columns.map(s=>this.buildCreateColumnSql(e,s)).join(", ");let i=`CREATE TABLE ${this.escapePath(e)} (${r}`;if(e.columns.filter(s=>s.isUnique).forEach(s=>{e.uniques.some(l=>l.columnNames.length===1&&l.columnNames[0]===s.name)||e.uniques.push(new un({name:this.connection.namingStrategy.uniqueConstraintName(e,[s.name]),columnNames:[s.name]}))}),e.uniques.length>0){const s=e.uniques.map(o=>{const l=o.name?o.name:this.connection.namingStrategy.uniqueConstraintName(e,o.columnNames),u=o.columnNames.map(d=>`"${d}"`).join(", ");let c=`CONSTRAINT "${l}" UNIQUE (${u})`;return o.deferrable&&(c+=` DEFERRABLE ${o.deferrable}`),c}).join(", ");i+=`, ${s}`}if(e.checks.length>0){const s=e.checks.map(o=>`CONSTRAINT "${o.name?o.name:this.connection.namingStrategy.checkConstraintName(e,o.expression)}" CHECK (${o.expression})`).join(", ");i+=`, ${s}`}if(e.exclusions.length>0){const s=e.exclusions.map(o=>`CONSTRAINT "${o.name?o.name:this.connection.namingStrategy.exclusionConstraintName(e,o.expression)}" EXCLUDE ${o.expression}`).join(", ");i+=`, ${s}`}if(e.foreignKeys.length>0&&t){const s=e.foreignKeys.map(o=>{const l=o.columnNames.map(d=>`"${d}"`).join(", ");o.name||(o.name=this.connection.namingStrategy.foreignKeyName(e,o.columnNames,this.getTablePath(o),o.referencedColumnNames));const u=o.referencedColumnNames.map(d=>`"${d}"`).join(", ");let c=`CONSTRAINT "${o.name}" FOREIGN KEY (${l}) REFERENCES ${this.escapePath(this.getTablePath(o))} (${u})`;return o.onDelete&&(c+=` ON DELETE ${o.onDelete}`),o.onUpdate&&(c+=` ON UPDATE ${o.onUpdate}`),o.deferrable&&(c+=` DEFERRABLE ${o.deferrable}`),c}).join(", ");i+=`, ${s}`}const a=e.columns.filter(s=>s.isPrimary);if(a.length>0){const s=a[0].primaryKeyConstraintName?a[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(e,a.map(l=>l.name)),o=a.map(l=>`"${l.name}"`).join(", ");i+=`, CONSTRAINT "${s}" PRIMARY KEY (${o})`}return i+=")",e.columns.filter(s=>s.comment).forEach(s=>i+=`; COMMENT ON COLUMN ${this.escapePath(e)}."${s.name}" IS ${this.escapeComment(s.comment)}`),new I(i)}async getVersion(){return(await this.query("SELECT version()"))[0].version.replace(/^PostgreSQL ([\d\.]+) .*$/,"$1")}dropTableSql(e){return new I(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",r=this.escapePath(e);return typeof e.expression=="string"?new I(`CREATE ${t}VIEW ${r} AS ${e.expression}`):new I(`CREATE ${t}VIEW ${r} AS ${e.expression(this.connection).getQuery()}`)}async insertViewDefinitionSql(e){const t=await this.getCurrentSchema();let{schema:r,tableName:i}=this.driver.parseTableName(e);r||(r=t);const a=e.materialized?Oe.MATERIALIZED_VIEW:Oe.VIEW,s=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:a,schema:r,name:i,value:s})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new I(`DROP ${t}VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){const t=await this.getCurrentSchema();let{schema:r,tableName:i}=this.driver.parseTableName(e);r||(r=t);const a=e.materialized?Oe.MATERIALIZED_VIEW:Oe.VIEW;return this.deleteTypeormMetadataSql({type:a,schema:r,name:i})}async dropEnumTypes(e){const t=`SELECT 'DROP TYPE IF EXISTS "' || n.nspname || '"."' || t.typname || '" CASCADE;' as "query" FROM "pg_type" "t" INNER JOIN "pg_enum" "e" ON "e"."enumtypid" = "t"."oid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" IN (${e}) GROUP BY "n"."nspname", "t"."typname"`,r=await this.query(t);await Promise.all(r.map(i=>this.query(i.query)))}async hasEnumType(e,t){let{schema:r}=this.driver.parseTableName(e);r||(r=await this.getCurrentSchema());const i=this.buildEnumName(e,t,!1,!0),a=`SELECT "n"."nspname", "t"."typname" FROM "pg_type" "t" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${r}' AND "t"."typname" = '${i}'`;return!!(await this.query(a)).length}createEnumTypeSql(e,t,r){r||(r=this.buildEnumName(e,t));const i=t.enum.map(a=>`'${a.replace("'","''")}'`).join(", ");return new I(`CREATE TYPE ${r} AS ENUM(${i})`)}dropEnumTypeSql(e,t,r){return r||(r=this.buildEnumName(e,t)),new I(`DROP TYPE ${r}`)}createIndexSql(e,t){const r=t.columnNames.map(i=>`"${i}"`).join(", ");return new I(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX "${t.name}" ON ${this.escapePath(e)} ${t.isSpatial?"USING GiST ":""}(${r}) ${t.where?"WHERE "+t.where:""}`)}createViewIndexSql(e,t){const r=t.columnNames.map(i=>`"${i}"`).join(", ");return new I(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX "${t.name}" ON ${this.escapePath(e)} (${r}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e,t){let r=U.isTableIndex(t)?t.name:t;const{schema:i}=this.driver.parseTableName(e);return i?new I(`DROP INDEX "${i}"."${r}"`):new I(`DROP INDEX "${r}"`)}createPrimaryKeySql(e,t,r){const i=r||this.connection.namingStrategy.primaryKeyName(e,t),a=t.map(s=>`"${s}"`).join(", ");return new I(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${i}" PRIMARY KEY (${a})`)}dropPrimaryKeySql(e){if(!e.primaryColumns.length)throw new L(`Table ${e} has no primary keys.`);const t=e.primaryColumns.map(a=>a.name),r=e.primaryColumns[0].primaryKeyConstraintName,i=r||this.connection.namingStrategy.primaryKeyName(e,t);return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${i}"`)}createUniqueConstraintSql(e,t){const r=t.columnNames.map(a=>'"'+a+'"').join(", ");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" UNIQUE (${r})`;return t.deferrable&&(i+=` DEFERRABLE ${t.deferrable}`),new I(i)}dropUniqueConstraintSql(e,t){const r=U.isTableUnique(t)?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createCheckConstraintSql(e,t){return new I(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const r=U.isTableCheck(t)?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createExclusionConstraintSql(e,t){return new I(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" EXCLUDE ${t.expression}`)}dropExclusionConstraintSql(e,t){const r=U.isTableExclusion(t)?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createForeignKeySql(e,t){const r=t.columnNames.map(s=>'"'+s+'"').join(", "),i=t.referencedColumnNames.map(s=>'"'+s+'"').join(",");let a=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" FOREIGN KEY (${r}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${i})`;return t.onDelete&&(a+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(a+=` ON UPDATE ${t.onUpdate}`),t.deferrable&&(a+=` DEFERRABLE ${t.deferrable}`),new I(a)}dropForeignKeySql(e,t){const r=U.isTableForeignKey(t)?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}buildSequenceName(e,t){const{tableName:r}=this.driver.parseTableName(e),i=U.isTableColumn(t)?t.name:t;let a=`${r}_${i}_seq`;return a.length>this.connection.driver.maxAliasLength&&(a=`${r.substring(0,29)}_${i.substring(0,Math.max(29,63-e.name.length-5))}_seq`),a}buildSequencePath(e,t){const{schema:r}=this.driver.parseTableName(e);return r?`${r}.${this.buildSequenceName(e,t)}`:this.buildSequenceName(e,t)}buildEnumName(e,t,r=!0,i,a){const{schema:s,tableName:o}=this.driver.parseTableName(e);let l=t.enumName?t.enumName:`${o}_${t.name.toLowerCase()}_enum`;return s&&r&&(l=`${s}.${l}`),a&&(l=l+"_old"),l.split(".").map(u=>i?u:`"${u}"`).join(".")}async getUserDefinedTypeName(e,t){let{schema:r,tableName:i}=this.driver.parseTableName(e);r||(r=await this.getCurrentSchema());const a=await this.query(`SELECT "udt_schema", "udt_name" FROM "information_schema"."columns" WHERE "table_schema" = '${r}' AND "table_name" = '${i}' AND "column_name"='${t.name}'`);let s=a[0].udt_name;return s.indexOf("_")===0&&(s=s.substr(1,s.length)),{schema:a[0].udt_schema,name:s}}escapeComment(e){return!e||e.length===0?"NULL":(e=e.replace(/'/g,"''").replace(/\u0000/g,""),`'${e}'`)}escapePath(e){const{schema:t,tableName:r}=this.driver.parseTableName(e);return t&&t!==this.driver.searchSchema?`"${t}"."${r}"`:`"${r}"`}async getTableNameWithSchema(e){const t=U.isTable(e)?e.name:e;return t.indexOf(".")===-1?`${(await this.query("SELECT current_schema()"))[0].current_schema}.${t}`:`${t.split(".")[0]}.${t.split(".")[1]}`}buildCreateColumnSql(e,t){let r='"'+t.name+'"';if(t.isGenerated===!0&&t.generationStrategy!=="uuid")if(t.generationStrategy==="identity"){const i=t.generatedIdentity||"BY DEFAULT";r+=` ${t.type} GENERATED ${i} AS IDENTITY`}else(t.type==="integer"||t.type==="int"||t.type==="int4")&&(r+=" SERIAL"),(t.type==="smallint"||t.type==="int2")&&(r+=" SMALLSERIAL"),(t.type==="bigint"||t.type==="int8")&&(r+=" BIGSERIAL");return t.type==="enum"||t.type==="simple-enum"?(r+=" "+this.buildEnumName(e,t),t.isArray&&(r+=" array")):(!t.isGenerated||t.type==="uuid")&&(r+=" "+this.connection.driver.createFullType(t)),t.generatedType==="STORED"&&t.asExpression&&(r+=` GENERATED ALWAYS AS (${t.asExpression}) STORED`),t.charset&&(r+=' CHARACTER SET "'+t.charset+'"'),t.collation&&(r+=' COLLATE "'+t.collation+'"'),t.isNullable!==!0&&(r+=" NOT NULL"),t.default!==void 0&&t.default!==null&&(r+=" DEFAULT "+t.default),t.isGenerated&&t.generationStrategy==="uuid"&&!t.default&&(r+=` DEFAULT ${this.driver.uuidGenerator}`),r}async hasSupportForPartitionedTables(){return!!(await this.query("SELECT TRUE FROM information_schema.columns WHERE table_name = 'pg_class' and column_name = 'relispartition'")).length}}class iP extends rP{constructor(e,t){super(e,t)}}class aP extends iP{constructor(e,t,r){super(e,r),this.client=t}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:(this.mode==="slave"&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)),this.databaseConnectionPromise)}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?await this.client.startTransaction():await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new lr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new yn;const i=await this.client.query(e,t),a=new ni;return a.raw=i,i!=null&&i.hasOwnProperty("records")&&Array.isArray(i.records)&&(a.records=i.records),i!=null&&i.hasOwnProperty("numberOfRecordsUpdated")&&(a.affected=i.numberOfRecordsUpdated),r?a:a.raw}}class sP extends Fb{}class oP extends sP{constructor(e){super(),this.transactionSupport="nested",this.connection=e,this.options=e.options,this.isReplicated=!1,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions),this.database=me.buildDriverOptions(this.options).database}async connect(){}async disconnect(){}createQueryRunner(e){return new aP(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions),e)}preparePersistentValue(e,t){return this.options.formatOptions&&this.options.formatOptions.castParameters===!1?super.preparePersistentValue(e,t):(t.transformer&&(e=Ft.transformTo(t.transformer,e)),this.client.preparePersistentValue(e,t))}prepareHydratedValue(e,t){return this.options.formatOptions&&this.options.formatOptions.castParameters===!1?super.prepareHydratedValue(e,t):(t.transformer&&(e=Ft.transformFrom(t.transformer,e)),this.client.prepareHydratedValue(e,t))}loadDependencies(){const e=this.options.driver||ft.load("typeorm-aurora-data-api-driver"),{pg:t}=e;this.DataApiDriver=t}executeQuery(e,t){return this.connection.query(t)}async afterConnect(){const e=await this.checkMetadataForExtensions();return e.hasExtensions&&await this.enableExtensions(e,this.connection),Promise.resolve()}}class lP extends Co{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new $i(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async executeSet(e){if(this.isReleased)throw new yn;return(await this.connect()).executeSet(e,!1)}async query(e,t,r=!1){if(this.isReleased)throw new yn;const i=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const a=e.substr(0,e.indexOf(" "));try{let s;["BEGIN","ROLLBACK","COMMIT","CREATE","ALTER","DROP"].indexOf(a)!==-1?s=await i.execute(e,!1):["INSERT","UPDATE","DELETE"].indexOf(a)!==-1?s=await i.run(e,t,!1):s=await i.query(e,t||[]);const o=new ni;return s!=null&&s.hasOwnProperty("values")&&(o.raw=s.values,o.records=s.values),s!=null&&s.hasOwnProperty("changes")&&(o.affected=s.changes.changes,o.raw=s.changes.lastId||s.changes.changes),r?o:o.raw}catch(s){throw this.driver.connection.logger.logQueryError(s,e,t,this),new Gr(e,t,s)}}parametrize(e){return Object.keys(e).map(t=>`"${t}"=?`)}}class uP extends Cu{constructor(e){super(e),this.database=this.options.database,this.driver=this.options.driver,this.sqlite=this.options.driver}async connect(){this.databaseConnection=this.createDatabaseConnection(),await this.databaseConnection}async disconnect(){return this.queryRunner=void 0,(await this.databaseConnection).close().then(()=>{this.databaseConnection=void 0})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new lP(this)),this.queryRunner}async createDatabaseConnection(){const e=this.options.mode||"no-encryption",t=e!=="no-encryption",r=typeof this.options.version>"u"?1:this.options.version,i=await this.sqlite.createConnection(this.options.database,t,e,r);return await i.open(),await i.query("PRAGMA foreign_keys = ON"),this.options.journalMode&&["DELETE","TRUNCATE","PERSIST","MEMORY","WAL","OFF"].indexOf(this.options.journalMode)!==-1&&await i.query(`PRAGMA journal_mode = ${this.options.journalMode}`),i}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new No("Capacitor","@capacitor-community/sqlite")}}class cP extends nh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new $i(this)}async connect(){if(this.session)return Promise.resolve(this.session);const[e]=await this.driver.instanceDatabase.createSession({});return this.session=e,this.sessionTransaction=await e.transaction(),this.session}async release(){return this.isReleased=!0,this.session&&await this.session.delete(),this.session=void 0,Promise.resolve()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}await this.connect(),await this.sessionTransaction.begin(),this.connection.logger.logQuery("START TRANSACTION"),await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive||!this.sessionTransaction)throw new lr;await this.broadcaster.broadcast("BeforeTransactionCommit"),await this.sessionTransaction.commit(),this.connection.logger.logQuery("COMMIT"),this.isTransactionActive=!1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive||!this.sessionTransaction)throw new lr;await this.broadcaster.broadcast("BeforeTransactionRollback"),await this.sessionTransaction.rollback(),this.connection.logger.logQuery("ROLLBACK"),this.isTransactionActive=!1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new yn;try{const i=+new Date;await this.connect();let a;const s=e.startsWith("SELECT"),o=s&&!this.isTransactionActive?this.driver.instanceDatabase:this.sessionTransaction;!this.isTransactionActive&&!s&&await this.sessionTransaction.begin();try{this.driver.connection.logger.logQuery(e,t,this),a=await o.run({sql:e,params:t?t.reduce((h,p,g)=>(h["param"+g]=p,h),{}):void 0,json:!0}),!this.isTransactionActive&&!s&&await this.sessionTransaction.commit()}catch(h){try{!this.isTransactionActive&&!s&&await this.sessionTransaction.rollback()}catch{}throw h}const l=this.driver.options.maxQueryExecutionTime,c=+new Date-i;l&&c>l&&this.driver.connection.logger.logQuerySlow(c,e,t,this);const d=new ni;return d.raw=a,d.records=a?a[0]:[],a&&a[1]&&a[1].rowCountExact&&(d.affected=parseInt(a[1].rowCountExact)),r?d:d.records}catch(i){throw this.driver.connection.logger.logQueryError(i,e,t,this),new Gr(e,t,i)}finally{}}async updateDDL(e,t){if(this.isReleased)throw new yn;this.driver.connection.logger.logQuery(e,t,this);try{const r=+new Date,[i]=await this.driver.instanceDatabase.updateSchema(e);await i.promise();const a=this.driver.options.maxQueryExecutionTime,o=+new Date-r;a&&o>a&&this.driver.connection.logger.logQuerySlow(o,e,t,this)}catch(r){throw this.driver.connection.logger.logQueryError(r,e,t,this),new Gr(e,t,r)}}async stream(e,t,r,i){if(this.isReleased)throw new yn;try{this.driver.connection.logger.logQuery(e,t,this);const a={sql:e,params:t?t.reduce((o,l,u)=>(o["param"+u]=l,o),{}):void 0,json:!0},s=this.driver.instanceDatabase.runStream(a);return r&&s.on("end",r),i&&s.on("error",i),s}catch(a){throw this.driver.connection.logger.logQueryError(a,e,t,this),new Gr(e,t,a)}}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){throw new L("Check database queries are not supported by Spanner driver.")}async getCurrentDatabase(){throw new L("Check database queries are not supported by Spanner driver.")}async hasSchema(e){return!!(await this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length}async getCurrentSchema(){throw new L("Check schema queries are not supported by Spanner driver.")}async hasTable(e){const r=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` = '${e instanceof xt?e.name:e}'`;return!!(await this.query(r)).length}async hasColumn(e,t){const i=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` = '${e instanceof xt?e.name:e}' AND \`COLUMN_NAME\` = '${t}'`;return!!(await this.query(i)).length}async createDatabase(e,t){if(t&&await this.hasDatabase(e))return Promise.resolve();const r=`CREATE DATABASE "${e}"`,i=`DROP DATABASE "${e}"`;await this.executeQueries(new I(r),new I(i))}async dropDatabase(e,t){const r=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,i=`CREATE DATABASE "${e}"`;await this.executeQueries(new I(r),new I(i))}async createSchema(e,t){return Promise.resolve()}async dropSchema(e,t,r){return Promise.resolve()}async createTable(e,t=!1,r=!0,i=!0){if(t&&await this.hasTable(e))return Promise.resolve();const a=[],s=[];a.push(this.createTableSql(e,r)),s.push(this.dropTableSql(e)),r&&e.foreignKeys.forEach(l=>s.push(this.dropForeignKeySql(e,l))),i&&e.indices.forEach(l=>{l.name||(l.name=this.connection.namingStrategy.indexName(e,l.columnNames,l.where)),a.push(this.createIndexSql(e,l)),s.push(this.dropIndexSql(e,l))});const o=e.columns.filter(l=>l.generatedType&&l.asExpression);for(const l of o){const u=this.insertTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:l.name,value:l.asExpression}),c=this.deleteTypeormMetadataSql({table:e.name,type:Oe.GENERATED_COLUMN,name:l.name});a.push(u),s.push(c)}await this.executeQueries(a,s)}async dropTable(e,t,r=!0,i=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const a=r,s=this.getTablePath(e),o=await this.getCachedTable(s),l=[],u=[];i&&o.indices.forEach(d=>{l.push(this.dropIndexSql(o,d)),u.push(this.createIndexSql(o,d))}),r&&o.foreignKeys.forEach(d=>l.push(this.dropForeignKeySql(o,d))),l.push(this.dropTableSql(o)),u.push(this.createTableSql(o,a));const c=o.columns.filter(d=>d.generatedType&&d.asExpression);for(const d of c){const h=this.deleteTypeormMetadataSql({table:o.name,type:Oe.GENERATED_COLUMN,name:d.name}),p=this.insertTypeormMetadataSql({table:o.name,type:Oe.GENERATED_COLUMN,name:d.name,value:d.asExpression});l.push(h),u.push(p)}await this.executeQueries(l,u)}async createView(e){const t=[],r=[];t.push(this.createViewSql(e)),t.push(await this.insertViewDefinitionSql(e)),r.push(this.dropViewSql(e)),r.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(t,r)}async dropView(e){const t=e instanceof Ci?e.name:e,r=await this.getCachedView(t),i=[],a=[];i.push(await this.deleteViewDefinitionSql(r)),i.push(this.dropViewSql(r)),a.push(await this.insertViewDefinitionSql(r)),a.push(this.createViewSql(r)),await this.executeQueries(i,a)}async renameTable(e,t){throw new L("Rename table queries are not supported by Spanner driver.")}async addColumn(e,t){const r=e instanceof xt?e:await this.getCachedTable(e),i=r.clone(),a=[],s=[];a.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(t)}`)),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN ${this.driver.escape(t.name)}`));const o=i.indices.find(l=>l.columnNames.length===1&&l.columnNames[0]===t.name);if(o)a.push(this.createIndexSql(r,o)),s.push(this.dropIndexSql(r,o));else if(t.isUnique){const l=new At({name:this.connection.namingStrategy.indexName(r,[t.name]),columnNames:[t.name],isUnique:!0});i.indices.push(l),i.uniques.push(new un({name:l.name,columnNames:l.columnNames})),a.push(this.createIndexSql(r,l)),s.push(this.dropIndexSql(r,l))}if(t.generatedType&&t.asExpression){const l=this.insertTypeormMetadataSql({table:r.name,type:Oe.GENERATED_COLUMN,name:t.name,value:t.asExpression}),u=this.deleteTypeormMetadataSql({table:r.name,type:Oe.GENERATED_COLUMN,name:t.name});a.push(l),s.push(u)}await this.executeQueries(a,s),i.addColumn(t),this.replaceCachedTable(r,i)}async addColumns(e,t){for(const r of t)await this.addColumn(e,r)}async renameColumn(e,t,r){const i=e instanceof xt?e:await this.getCachedTable(e),a=t instanceof Tn?t:i.columns.find(o=>o.name===t);if(!a)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);let s;return r instanceof Tn?s=r:(s=a.clone(),s.name=r),this.changeColumn(i,a,s)}async changeColumn(e,t,r){const i=e instanceof xt?e:await this.getCachedTable(e);let a=i.clone();const s=[],o=[],l=t instanceof Tn?t:i.columns.find(u=>u.name===t);if(!l)throw new L(`Column "${t}" was not found in the "${i.name}" table.`);if(l.name!==r.name||l.type!==r.type||l.length!==r.length||l.isArray!==r.isArray||l.generatedType!==r.generatedType||l.asExpression!==r.asExpression)await this.dropColumn(i,l),await this.addColumn(i,r),a=i.clone();else if((r.precision!==l.precision||r.scale!==l.scale)&&(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(r)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(l)}`))),l.isNullable!==r.isNullable&&(r.isNullable?(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" DROP NOT NULL`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" SET NOT NULL`))):(s.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" SET NOT NULL`)),o.push(new I(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" DROP NOT NULL`)))),r.isUnique!==l.isUnique)if(r.isUnique===!0){const u=new At({name:this.connection.namingStrategy.indexName(i,[r.name]),columnNames:[r.name],isUnique:!0});a.indices.push(u),a.uniques.push(new un({name:u.name,columnNames:u.columnNames})),s.push(this.createIndexSql(i,u)),o.push(this.dropIndexSql(i,u))}else{const u=a.indices.find(d=>d.columnNames.length===1&&d.isUnique===!0&&!!d.columnNames.find(h=>h===r.name));a.indices.splice(a.indices.indexOf(u),1);const c=a.uniques.find(d=>d.name===u.name);a.uniques.splice(a.uniques.indexOf(c),1),s.push(this.dropIndexSql(i,u)),o.push(this.createIndexSql(i,u))}await this.executeQueries(s,o),this.replaceCachedTable(i,a)}async changeColumns(e,t){for(const{oldColumn:r,newColumn:i}of t)await this.changeColumn(e,r,i)}async dropColumn(e,t){const r=e instanceof xt?e:await this.getCachedTable(e),i=t instanceof Tn?t:r.findColumnByName(t);if(!i)throw new L(`Column "${t}" was not found in table "${r.name}"`);const a=r.clone(),s=[],o=[],l=a.indices.find(c=>c.columnNames.length===1&&c.columnNames[0]===i.name);l&&(a.indices.splice(a.indices.indexOf(l),1),s.push(this.dropIndexSql(r,l)),o.push(this.createIndexSql(r,l)));const u=a.checks.find(c=>!!c.columnNames&&c.columnNames.length===1&&c.columnNames[0]===i.name);if(u&&(a.checks.splice(a.checks.indexOf(u),1),s.push(this.dropCheckConstraintSql(r,u)),o.push(this.createCheckConstraintSql(r,u))),s.push(new I(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN ${this.driver.escape(i.name)}`)),o.push(new I(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(i)}`)),i.generatedType&&i.asExpression){const c=this.deleteTypeormMetadataSql({table:r.name,type:Oe.GENERATED_COLUMN,name:i.name}),d=this.insertTypeormMetadataSql({table:r.name,type:Oe.GENERATED_COLUMN,name:i.name,value:i.asExpression});s.push(c),o.push(d)}await this.executeQueries(s,o),a.removeColumn(i),this.replaceCachedTable(r,a)}async dropColumns(e,t){for(const r of t)await this.dropColumn(e,r)}async createPrimaryKey(e,t){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async updatePrimaryKeys(e,t){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async dropPrimaryKey(e){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async createUniqueConstraint(e,t){throw new L("Spanner does not support unique constraints. Use unique index instead.")}async createUniqueConstraints(e,t){throw new L("Spanner does not support unique constraints. Use unique index instead.")}async dropUniqueConstraint(e,t){throw new L("Spanner does not support unique constraints. Use unique index instead.")}async dropUniqueConstraints(e,t){throw new L("Spanner does not support unique constraints. Use unique index instead.")}async createCheckConstraint(e,t){const r=e instanceof xt?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r,t.expression));const i=this.createCheckConstraintSql(r,t),a=this.dropCheckConstraintSql(r,t);await this.executeQueries(i,a),r.addCheckConstraint(t)}async createCheckConstraints(e,t){const r=t.map(i=>this.createCheckConstraint(e,i));await Promise.all(r)}async dropCheckConstraint(e,t){const r=e instanceof xt?e:await this.getCachedTable(e),i=t instanceof Mr?t:r.checks.find(o=>o.name===t);if(!i)throw new L(`Supplied check constraint was not found in table ${r.name}`);const a=this.dropCheckConstraintSql(r,i),s=this.createCheckConstraintSql(r,i);await this.executeQueries(a,s),r.removeCheckConstraint(i)}async dropCheckConstraints(e,t){const r=t.map(i=>this.dropCheckConstraint(e,i));await Promise.all(r)}async createExclusionConstraint(e,t){throw new L("Spanner does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new L("Spanner does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new L("Spanner does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new L("Spanner does not support exclusion constraints.")}async createForeignKey(e,t){const r=e instanceof xt?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const i=this.createForeignKeySql(r,t),a=this.dropForeignKeySql(r,t);await this.executeQueries(i,a),r.addForeignKey(t)}async createForeignKeys(e,t){for(const r of t)await this.createForeignKey(e,r)}async dropForeignKey(e,t){const r=e instanceof xt?e:await this.getCachedTable(e),i=t instanceof ir?t:r.foreignKeys.find(o=>o.name===t);if(!i)throw new L(`Supplied foreign key was not found in table ${r.name}`);const a=this.dropForeignKeySql(r,i),s=this.createForeignKeySql(r,i);await this.executeQueries(a,s),r.removeForeignKey(i)}async dropForeignKeys(e,t){for(const r of t)await this.dropForeignKey(e,r)}async createIndex(e,t){const r=e instanceof xt?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const i=this.createIndexSql(r,t),a=this.dropIndexSql(r,t);await this.executeQueries(i,a),r.addIndex(t)}async createIndices(e,t){for(const r of t)await this.createIndex(e,r)}async dropIndex(e,t){const r=e instanceof xt?e:await this.getCachedTable(e),i=t instanceof At?t:r.indices.find(o=>o.name===t);if(!i)throw new L(`Supplied index ${t} was not found in table ${r.name}`);i.name||(i.name=this.generateIndexName(r,i));const a=this.dropIndexSql(r,i),s=this.createIndexSql(r,i);await this.executeQueries(a,s),r.removeIndex(i)}async dropIndices(e,t){for(const r of t)await this.dropIndex(e,r)}async clearTable(e){await this.query(`DELETE FROM ${this.escapePath(e)} WHERE true`)}async clearDatabase(){const t=await this.query("SELECT concat('DROP INDEX `', INDEX_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`INDEXES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `INDEX_TYPE` = 'INDEX' AND `SPANNER_IS_MANAGED` = false"),i=await this.query("SELECT concat('ALTER TABLE `', TABLE_NAME, '`', ' DROP CONSTRAINT `', CONSTRAINT_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLE_CONSTRAINTS` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `CONSTRAINT_TYPE` = 'FOREIGN KEY'"),s=await this.query("SELECT concat('DROP TABLE `', TABLE_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'");if(!t.length&&!i.length&&!s.length)return;const o=this.isTransactionActive;o||await this.startTransaction();try{for(let l of t)await this.updateDDL(l.query);for(let l of i)await this.updateDDL(l.query);for(let l of s)await this.updateDDL(l.query);await this.commitTransaction()}catch(l){try{o||await this.rollbackTransaction()}catch{}throw l}}async executeMemoryUpSql(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)this.isDMLQuery(e)?await this.query(e,t):await this.updateDDL(e,t)}async executeMemoryDownSql(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())this.isDMLQuery(e)?await this.query(e,t):await this.updateDDL(e,t)}async loadViews(e){return Promise.resolve([])}async loadTables(e){if(e&&e.length===0)return[];const t=[];if(!e||!e.length)t.push(...await this.query("SELECT `TABLE_NAME` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'"));else{const g=`SELECT \`TABLE_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` IN (${e.map(E=>`'${E}'`).join(", ")})`;t.push(...await this.query(g))}if(!t.length)return[];const r=t.map(g=>`'${g.TABLE_NAME}'`).join(", "),i=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` IN (${r})`,a=`SELECT \`KCU\`.\`TABLE_NAME\`, \`KCU\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'PRIMARY KEY' AND \`TC\`.\`TABLE_NAME\` IN (${r})`,s=`SELECT \`I\`.\`TABLE_NAME\`, \`I\`.\`INDEX_NAME\`, \`I\`.\`IS_UNIQUE\`, \`I\`.\`IS_NULL_FILTERED\`, \`IC\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`INDEXES\` \`I\` INNER JOIN \`INFORMATION_SCHEMA\`.\`INDEX_COLUMNS\` \`IC\` ON \`IC\`.\`INDEX_NAME\` = \`I\`.\`INDEX_NAME\` AND \`IC\`.\`TABLE_NAME\` = \`I\`.\`TABLE_NAME\` WHERE \`I\`.\`TABLE_CATALOG\` = '' AND \`I\`.\`TABLE_SCHEMA\` = '' AND \`I\`.\`TABLE_NAME\` IN (${r}) AND \`I\`.\`INDEX_TYPE\` = 'INDEX' AND \`I\`.\`SPANNER_IS_MANAGED\` = false`,o=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`CC\`.\`CHECK_CLAUSE\`, \`CCU\`.\`COLUMN_NAME\`FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CHECK_CONSTRAINTS\` \`CC\` ON \`CC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'CHECK' AND \`TC\`.\`TABLE_NAME\` IN (${r}) AND \`TC\`.\`CONSTRAINT_NAME\` NOT LIKE 'CK_IS_NOT_NULL%'`,l=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`KCU\`.\`COLUMN_NAME\`, \`CTU\`.\`TABLE_NAME\` AS \`REFERENCED_TABLE_NAME\`, \`CCU\`.\`COLUMN_NAME\` AS \`REFERENCED_COLUMN_NAME\`, \`RC\`.\`UPDATE_RULE\`, \`RC\`.\`DELETE_RULE\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_TABLE_USAGE\` \`CTU\` ON \`CTU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`RC\` ON \`RC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'FOREIGN KEY' AND \`TC\`.\`TABLE_NAME\` IN (${r})`,[u,c,d,h,p]=await Promise.all([this.query(i),this.query(a),this.query(s),this.query(o),this.query(l)]);return Promise.all(t.map(async g=>{const E=new xt;E.name=this.driver.buildTableName(g.TABLE_NAME),E.columns=await Promise.all(u.filter(C=>C.TABLE_NAME===g.TABLE_NAME).map(async C=>{const P=d.filter(K=>K.TABLE_NAME===g.TABLE_NAME&&K.COLUMN_NAME===C.COLUMN_NAME&&K.IS_UNIQUE===!0),D=this.connection.entityMetadatas.find(K=>this.getTablePath(E)===this.getTablePath(K)),F=P.length>0&&D&&D.indices.some(K=>P.some(M=>K.name===M.INDEX_NAME&&K.synchronize===!1)),Q=P.every(K=>d.some(M=>M.INDEX_NAME===K.INDEX_NAME&&M.COLUMN_NAME!==C.COLUMN_NAME)),W=new Tn;W.name=C.COLUMN_NAME;let B=C.SPANNER_TYPE.toLowerCase();if(B.indexOf("array")!==-1&&(W.isArray=!0,B=B.substring(B.indexOf("<")+1,B.indexOf(">"))),B.indexOf("(")!==-1?W.type=B.substring(0,B.indexOf("(")):W.type=B,this.driver.withLengthColumnTypes.indexOf(W.type)!==-1&&(W.length=B.substring(B.indexOf("(")+1,B.indexOf(")"))),C.IS_GENERATED==="ALWAYS"){W.asExpression=C.GENERATION_EXPRESSION,W.generatedType="STORED";const K=await this.selectTypeormMetadataSql({table:g.TABLE_NAME,type:Oe.GENERATED_COLUMN,name:W.name}),M=await this.query(K.query,K.parameters);M[0]&&M[0].value?W.asExpression=M[0].value:W.asExpression=""}return W.isUnique=P.length>0&&!F&&!Q,W.isNullable=C.IS_NULLABLE==="YES",W.isPrimary=c.some(K=>K.TABLE_NAME===C.TABLE_NAME&&K.COLUMN_NAME===C.COLUMN_NAME),W}));const A=p.filter(C=>C.TABLE_NAME===g.TABLE_NAME);E.foreignKeys=be.uniq(A,C=>C.CONSTRAINT_NAME).map(C=>{const P=A.filter(D=>D.CONSTRAINT_NAME===C.CONSTRAINT_NAME);return new ir({name:C.CONSTRAINT_NAME,columnNames:be.uniq(P.map(D=>D.COLUMN_NAME)),referencedDatabase:C.REFERENCED_TABLE_SCHEMA,referencedTableName:C.REFERENCED_TABLE_NAME,referencedColumnNames:be.uniq(P.map(D=>D.REFERENCED_COLUMN_NAME)),onDelete:C.DELETE_RULE,onUpdate:C.UPDATE_RULE})});const b=d.filter(C=>C.TABLE_NAME===g.TABLE_NAME);E.indices=be.uniq(b,C=>C.INDEX_NAME).map(C=>{const P=b.filter(D=>D.INDEX_NAME===C.INDEX_NAME);return new At({table:E,name:C.INDEX_NAME,columnNames:P.map(D=>D.COLUMN_NAME),isUnique:C.IS_UNIQUE,isNullFiltered:C.IS_NULL_FILTERED})});const T=h.filter(C=>C.TABLE_NAME===g.TABLE_NAME);return E.checks=be.uniq(T,C=>C.CONSTRAINT_NAME).map(C=>{const P=T.filter(D=>D.CONSTRAINT_NAME===C.CONSTRAINT_NAME);return new Mr({name:C.CONSTRAINT_NAME,columnNames:P.map(D=>D.COLUMN_NAME),expression:C.CHECK_CLAUSE})}),E}))}createTableSql(e,t){const r=e.columns.map(s=>this.buildCreateColumnSql(s)).join(", ");let i=`CREATE TABLE ${this.escapePath(e)} (${r}`;if(e.columns.filter(s=>s.isUnique).forEach(s=>{const o=e.indices.some(u=>u.columnNames.length===1&&!!u.isUnique&&u.columnNames.indexOf(s.name)!==-1),l=e.uniques.some(u=>u.columnNames.length===1&&u.columnNames.indexOf(s.name)!==-1);!o&&!l&&e.indices.push(new At({name:this.connection.namingStrategy.uniqueConstraintName(e,[s.name]),columnNames:[s.name],isUnique:!0}))}),e.uniques.length>0&&e.uniques.forEach(s=>{e.indices.some(l=>l.name===s.name)||e.indices.push(new At({name:s.name,columnNames:s.columnNames,isUnique:!0}))}),e.checks.length>0){const s=e.checks.map(o=>`CONSTRAINT \`${o.name?o.name:this.connection.namingStrategy.checkConstraintName(e,o.expression)}\` CHECK (${o.expression})`).join(", ");i+=`, ${s}`}if(e.foreignKeys.length>0&&t){const s=e.foreignKeys.map(o=>{const l=o.columnNames.map(c=>`\`${c}\``).join(", ");o.name||(o.name=this.connection.namingStrategy.foreignKeyName(e,o.columnNames,this.getTablePath(o),o.referencedColumnNames));const u=o.referencedColumnNames.map(c=>`\`${c}\``).join(", ");return`CONSTRAINT \`${o.name}\` FOREIGN KEY (${l}) REFERENCES ${this.escapePath(this.getTablePath(o))} (${u})`}).join(", ");i+=`, ${s}`}i+=")";const a=e.columns.filter(s=>s.isPrimary);if(a.length>0){const s=a.map(o=>this.driver.escape(o.name)).join(", ");i+=` PRIMARY KEY (${s})`}return new I(i)}dropTableSql(e){return new I(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",r=this.escapePath(e),i=typeof e.expression=="string"?e.expression:e.expression(this.connection).getQuery();return new I(`CREATE ${t}VIEW ${r} SQL SECURITY INVOKER AS ${i}`)}async insertViewDefinitionSql(e){let{schema:t,tableName:r}=this.driver.parseTableName(e);const i=e.materialized?Oe.MATERIALIZED_VIEW:Oe.VIEW,a=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:i,schema:t,name:r,value:a})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new I(`DROP ${t}VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){let{schema:t,tableName:r}=this.driver.parseTableName(e);const i=e.materialized?Oe.MATERIALIZED_VIEW:Oe.VIEW;return this.deleteTypeormMetadataSql({type:i,schema:t,name:r})}createIndexSql(e,t){const r=t.columnNames.map(a=>this.driver.escape(a)).join(", ");let i="";return t.isUnique&&(i+="UNIQUE "),t.isNullFiltered&&(i+="NULL_FILTERED "),new I(`CREATE ${i}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${r})`)}dropIndexSql(e,t){let r=t instanceof At?t.name:t;return new I(`DROP INDEX \`${r}\``)}createCheckConstraintSql(e,t){return new I(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const r=t instanceof Mr?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${r}\``)}createForeignKeySql(e,t){const r=t.columnNames.map(s=>this.driver.escape(s)).join(", "),i=t.referencedColumnNames.map(s=>this.driver.escape(s)).join(",");let a=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${r}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${i})`;return new I(a)}dropForeignKeySql(e,t){const r=t instanceof ir?t.name:t;return new I(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${r}\``)}escapePath(e){const{tableName:t}=this.driver.parseTableName(e);return`\`${t}\``}buildCreateColumnSql(e){let t=`${this.driver.escape(e.name)} ${this.connection.driver.createFullType(e)}`;return e.generatedType==="STORED"&&e.asExpression?t+=` AS (${e.asExpression}) STORED`:e.isNullable||(t+=" NOT NULL"),t}async executeQueries(e,t){if(e instanceof I&&(e=[e]),t instanceof I&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),this.sqlMemoryMode===!0)return Promise.resolve();for(const{query:r,parameters:i}of e)this.isDMLQuery(r)?await this.query(r,i):await this.updateDDL(r,i)}isDMLQuery(e){return e.startsWith("INSERT")||e.startsWith("UPDATE")||e.startsWith("DELETE")}}class dP{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="none",this.supportedDataTypes=["bool","int64","float64","numeric","string","json","bytes","date","timestamp","array"],this.supportedUpsertTypes=[],this.spatialTypes=[],this.withLengthColumnTypes=["string","bytes"],this.withWidthColumnTypes=[],this.withPrecisionColumnTypes=[],this.withScaleColumnTypes=[],this.mappedDataTypes={createDate:"timestamp",createDateDefault:"",updateDate:"timestamp",updateDateDefault:"",deleteDate:"timestamp",deleteDateNullable:!0,version:"int64",treeLevel:"int64",migrationId:"int64",migrationName:"string",migrationTimestamp:"int64",cacheId:"string",cacheIdentifier:"string",cacheTime:"int64",cacheDuration:"int64",cacheQuery:"string",cacheResult:"string",metadataType:"string",metadataDatabase:"string",metadataSchema:"string",metadataTable:"string",metadataName:"string",metadataValue:"string"},this.dataTypeDefaults={},this.maxAliasLength=63,this.cteCapabilities={enabled:!0},this._isReturningSqlSupported={delete:!1,insert:!1,update:!1},this.connection=e,this.options=e.options,this.isReplicated=!!this.options.replication,this.loadDependencies()}async connect(){this.instance=this.spanner.instance(this.options.instanceId),this.instanceDatabase=this.instance.database(this.options.databaseId)}afterConnect(){return Promise.resolve()}async disconnect(){this.instanceDatabase.close()}createSchemaBuilder(){return new th(this.connection)}createQueryRunner(e){return new cP(this,e)}escapeQueryWithParameters(e,t,r){const i=Object.keys(r).map(a=>r[a]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,s,o)=>{if(!t.hasOwnProperty(o))return a;let l=t[o];return l===null?a:s?l.map(u=>(i.push(u),this.createParameter(o,i.length-1))).join(", "):l instanceof Function?l():(i.push(l),this.createParameter(o,i.length-1))}),e=e.replace(/([ ]+)?=([ ]+)?:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,s,o,l,u)=>t.hasOwnProperty(u)&&t[u]===null?" IS NULL":a),[e,i])}escape(e){return`\`${e}\``}buildTableName(e,t,r){let i=[e];return r&&i.unshift(r),i.join(".")}parseTableName(e){const t=this.database,r=void 0;if(e instanceof xt||e instanceof Ci){const a=this.parseTableName(e.name);return{database:e.database||a.database||t,schema:e.schema||a.schema||r,tableName:a.tableName}}if(e instanceof ir){const a=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||a.database||t,schema:e.referencedSchema||a.schema||r,tableName:a.tableName}}if(e instanceof Or)return{database:e.database||t,schema:e.schema||r,tableName:e.tableName};const i=e.split(".");return{database:(i.length>1?i[0]:void 0)||t,schema:r,tableName:i.length>1?i[1]:i[0]}}preparePersistentValue(e,t){return t.transformer&&(e=Ft.transformTo(t.transformer,e)),e==null?e:t.type==="numeric"?(this.options.driver||ft.load("spanner")).Spanner.numeric(e):t.type==="date"?Ie.mixedDateToDateString(e):t.type==="json"?e:t.type==="timestamp"||t.type===Date?Ie.mixedDateToDate(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?Ft.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="bool"?e=!!e:t.type==="timestamp"||t.type===Date?e=new Date(e):t.type==="numeric"?e=e.value:t.type==="date"?e=Ie.mixedDateToDateString(e):t.type==="json"?e=typeof e=="string"?JSON.parse(e):e:t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=Ft.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number?"int64":e.type===String||e.type==="uuid"?"string":e.type===Date?"timestamp":e.type===Buffer?"bytes":e.type===Boolean?"bool":e.type||""}normalizeDefault(e){return e.default===""?`"${e.default}"`:`${e.default}`}normalizeIsUnique(e){return e.entityMetadata.indices.some(t=>t.isUnique&&t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){if(e.length)return e.length.toString();if(e.generationStrategy==="uuid")return"36";switch(e.type){case String:case"string":case"bytes":return"max";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+=`(${e.precision},${e.scale})`:e.precision!==null&&e.precision!==void 0&&(t+=`(${e.precision})`),e.isArray&&(t=`array<${t}>`),t}obtainMasterConnection(){return this.instanceDatabase}obtainSlaveConnection(){return this.instanceDatabase}createGeneratedMap(e,t,r){if(!t)return;if(t.insertId===void 0)return Object.keys(t).reduce((a,s)=>{const o=e.findColumnWithDatabaseName(s);return o&&be.mergeDeep(a,o.createValueMap(t[s])),a},{});const i=e.generatedColumns.reduce((a,s)=>{let o;return s.generationStrategy==="increment"&&t.insertId&&(o=t.insertId+r),be.mergeDeep(a,s.createValueMap(o))},{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter(r=>{const i=e.find(s=>s.name===r.databaseName);return i?i.name!==r.databaseName||i.type!==this.normalizeType(r)||i.length!==this.getColumnLength(r)||i.asExpression!==r.asExpression||i.generatedType!==r.generatedType||i.isPrimary!==r.isPrimary||!this.compareNullableValues(r,i)||i.isUnique!==this.normalizeIsUnique(r):!1})}isReturningSqlSupported(e){return this._isReturningSqlSupported[e]}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"@param"+t}loadDependencies(){try{const e=this.options.driver||ft.load("spanner");this.spanner=new e.Spanner({projectId:this.options.projectId})}catch(e){throw console.error(e),new No("Spanner","@google-cloud/spanner")}}compareNullableValues(e,t){return e.generatedType?!0:e.isNullable===t.isNullable}compareDefaultValues(e,t){return typeof e=="string"&&typeof t=="string"&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}normalizeDatetimeFunction(e){if(!e)return e;if(e.toUpperCase().indexOf("CURRENT_TIMESTAMP")!==-1||e.toUpperCase().indexOf("NOW")!==-1){const r=e.match(/\(\d+\)/);return r?`CURRENT_TIMESTAMP${r[0]}`:"CURRENT_TIMESTAMP"}else return e}escapeComment(e){return e&&(e=e.replace(/\u0000/g,""),e)}}class hP{create(e){const{type:t}=e.options;switch(t){case"mysql":return new hE(e);case"postgres":return new Fb(e);case"cockroachdb":return new r1(e);case"sap":return new a1(e);case"mariadb":return new hE(e);case"sqlite":return new o1(e);case"better-sqlite3":return new l1(e);case"cordova":return new W1(e);case"nativescript":return new J1(e);case"react-native":return new G1(e);case"sqljs":return new X1(e);case"oracle":return new s1(e);case"mssql":return new i1(e);case"mongodb":return new e1(e);case"expo":return new eP(e);case"aurora-mysql":return new nP(e);case"aurora-postgres":return new oP(e);case"capacitor":return new uP(e);case"spanner":return new dP(e);default:throw new k_(t,["aurora-mysql","aurora-postgres","better-sqlite3","capacitor","cockroachdb","cordova","expo","mariadb","mongodb","mssql","mysql","nativescript","oracle","postgres","react-native","sap","sqlite","sqljs","spanner"])}}}function wf(n,e,t=[".js",".cjs",".ts"]){return[]}const fP=new class{constructor(){this.instances=[]}get(n){let e=this.instances.find(t=>t.type===n);return e||(e={type:n,object:new n},this.instances.push(e)),e.object}};function EE(n){return fP.get(n)}class Zn{constructor(e){this["@instanceof"]=Symbol.for("ColumnMetadata"),this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isVirtualProperty=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isDeleteDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),e.args.options.default===null&&(this.isNullable=!0),e.args.options.nullable!==void 0&&(this.isNullable=e.args.options.nullable),e.args.options.select!==void 0&&(this.isSelect=e.args.options.select),e.args.options.insert!==void 0&&(this.isInsert=e.args.options.insert),e.args.options.update!==void 0&&(this.isUpdate=e.args.options.update),e.args.options.readonly!==void 0&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),e.args.options.default!==void 0&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),e.args.options.generatedIdentity&&(this.generatedIdentity=e.args.options.generatedIdentity),e.args.options.scale!==null&&e.args.options.scale!==void 0&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),e.args.options.precision!==null&&(this.precision=e.args.options.precision),e.args.options.enum&&(Ue.isObject(e.args.options.enum)&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter(t=>isNaN(+t)&&typeof e.args.options.enum[t]!="function").map(t=>e.args.options.enum[t]):this.enum=e.args.options.enum),e.args.options.enumName&&(this.enumName=e.args.options.enumName),e.args.options.primaryKeyConstraintName&&(this.primaryKeyConstraintName=e.args.options.primaryKeyConstraintName),e.args.options.foreignKeyConstraintName&&(this.foreignKeyConstraintName=e.args.options.foreignKeyConstraintName),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtualProperty=e.args.mode==="virtual-property",this.isVirtual=e.args.mode==="virtual",this.isTreeLevel=e.args.mode==="treeLevel",this.isCreateDate=e.args.mode==="createDate",this.isUpdateDate=e.args.mode==="updateDate",this.isDeleteDate=e.args.mode==="deleteDate",this.isVersion=e.args.mode==="version",this.isObjectId=e.args.mode==="objectId"),this.isVirtualProperty&&(this.isInsert=!1,this.isUpdate=!1),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),e.args.options.srid!==void 0&&(this.srid=e.args.options.srid),e.args.options.query&&(this.query=e.args.options.query),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.createDateDefault),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.updateDateDefault),this.onUpdate||(this.onUpdate=e.connection.driver.mappedDataTypes.updateDateDefault),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isDeleteDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.deleteDate),this.isNullable||(this.isNullable=e.connection.driver.mappedDataTypes.deleteDateNullable),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.deleteDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.deleteDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}createValueMap(e,t=!1){if(this.embeddedMetadata){const r=[...this.embeddedMetadata.parentPropertyNames],i=(a,s)=>{const o=a.shift();return o?(s[o]={},i(a,s[o]),s):((this.generationStrategy==="increment"||this.generationStrategy==="rowid")&&this.type==="bigint"&&e!==null&&(e=String(e)),s[t?this.databaseName:this.propertyName]=e,s)};return i(r,{})}else return(this.generationStrategy==="increment"||this.generationStrategy==="rowid")&&this.type==="bigint"&&e!==null&&(e=String(e)),{[t?this.databaseName:this.propertyName]:e}}getEntityValueMap(e,t){var r;if(this.embeddedMetadata){const a=[...this.embeddedMetadata.parentPropertyNames],s=this.embeddedMetadata.isArray,o=(u,c)=>{if(c===void 0)return{};const d=u.shift();if(d){const h=o(u,c[d]);return Object.keys(h).length>0?{[d]:h}:{}}return s&&Array.isArray(c)?c.map(h=>({[this.propertyName]:h[this.propertyName]})):c[this.propertyName]!==void 0?{[this.propertyName]:c[this.propertyName]}:{}},l=o(a,e);return Object.keys(l).length>0?l:void 0}else if(this.relationMetadata&&!(!((r=Object.getOwnPropertyDescriptor(e,this.relationMetadata.propertyName))===null||r===void 0)&&r.get)&&e[this.relationMetadata.propertyName]&&Ue.isObject(e[this.relationMetadata.propertyName])){const a=this.relationMetadata.joinColumns.reduce((s,o)=>{const l=o.referencedColumn.getEntityValueMap(e[this.relationMetadata.propertyName]);return l===void 0?s:be.mergeDeep(s,l)},{});return Object.keys(a).length>0?{[this.propertyName]:a}:void 0}else return e[this.propertyName]!==void 0?{[this.propertyName]:e[this.propertyName]}:void 0}getEntityValue(e,t=!1){if(e==null)return;let r;if(this.embeddedMetadata){const i=[...this.embeddedMetadata.parentPropertyNames],a=this.embeddedMetadata.isArray,s=(l,u)=>{const c=l.shift();return c&&u?s(l,u[c]):u},o=s(i,e);if(o)if(this.relationMetadata&&this.referencedColumn){const l=this.relationMetadata.getEntityValue(o);l&&Ue.isObject(l)&&!U.isFindOperator(l)&&!Buffer.isBuffer(l)?r=this.referencedColumn.getEntityValue(l):o[this.propertyName]&&Ue.isObject(o[this.propertyName])&&!U.isFindOperator(o[this.propertyName])&&!Buffer.isBuffer(o[this.propertyName])&&!(o[this.propertyName]instanceof Date)?r=this.referencedColumn.getEntityValue(o[this.propertyName]):r=o[this.propertyName]}else this.referencedColumn?r=this.referencedColumn.getEntityValue(o[this.propertyName]):a&&Array.isArray(o)?r=o.map(l=>l[this.propertyName]):r=o[this.propertyName]}else if(this.relationMetadata&&this.referencedColumn){const i=this.relationMetadata.getEntityValue(e);i&&Ue.isObject(i)&&!U.isFindOperator(i)&&typeof i!="function"&&!Buffer.isBuffer(i)?r=this.referencedColumn.getEntityValue(i):e[this.propertyName]&&Ue.isObject(e[this.propertyName])&&!U.isFindOperator(e[this.propertyName])&&typeof e[this.propertyName]!="function"&&!Buffer.isBuffer(e[this.propertyName])&&!(e[this.propertyName]instanceof Date)?r=this.referencedColumn.getEntityValue(e[this.propertyName]):r=e[this.propertyName]}else this.referencedColumn?r=this.referencedColumn.getEntityValue(e[this.propertyName]):r=e[this.propertyName];return t&&this.transformer&&(r=Ft.transformTo(this.transformer,r)),r}setEntityValue(e,t){if(this.embeddedMetadata){const r=(i,a)=>{const s=i.shift();return s?(a[s.propertyName]||(a[s.propertyName]=s.create()),r(i,a[s.propertyName]),a):(a[this.propertyName]=t,a)};return r([...this.embeddedMetadata.embeddedMetadataTree],e)}else!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName?(this.propertyName in e||(e[this.propertyName]={}),e[this.propertyName][this.referencedColumn.propertyName]=t):e[this.propertyName]=t}compareEntityValue(e,t){const r=this.getEntityValue(e);return Ue.isObject(r)?r.equals(t):r===t}build(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this}buildPropertyPath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e}buildDatabasePath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e}buildDatabaseName(e){let t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return e.driver.options.type==="mongodb"&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)}}class Sr{constructor(e){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.isNullFiltered=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,e.args.synchronize!==null&&e.args.synchronize!==void 0&&(this.synchronize=e.args.synchronize),this.isUnique=!!e.args.unique,this.isSpatial=!!e.args.spatial,this.isFulltext=!!e.args.fulltext,this.isNullFiltered=!!e.args.nullFiltered,this.parser=e.args.parser,this.where=e.args.where,this.isSparse=e.args.sparse,this.isBackground=e.args.background,this.expireAfterSeconds=e.args.expireAfterSeconds,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}build(e){if(this.synchronize===!1)return this.name=this.givenName,this;const t={};if(this.givenColumnNames){let r=[];if(Array.isArray(this.givenColumnNames))r=this.givenColumnNames.map(i=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+i:i.trim()),r.forEach(i=>t[i]=1);else{const i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(r=i.map(a=>String(a)),r.forEach(a=>t[a]=1)):(r=Object.keys(i).map(a=>String(a)),Object.keys(i).forEach(a=>t[a]=i[a]))}this.columns=r.map(i=>{const a=this.entityMetadata.columns.find(u=>u.propertyPath===i);if(a)return[a];const s=this.entityMetadata.relations.find(u=>u.isWithJoinColumn&&u.propertyName===i);if(s)return s.joinColumns;const o=this.givenName?'"'+this.givenName+'" ':"",l=this.entityMetadata.targetName;throw new L(`Index ${o}contains column that is missing in the entity (${l}): `+i)}).reduce((i,a)=>i.concat(a))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce((r,i)=>{const a=this.entityMetadata.columns.find(s=>s.propertyPath===i);return a&&(r[a.databasePath]=t[i]),r},{}),this.name=this.givenName?this.givenName:e.indexName(this.entityMetadata.tableName,this.columns.map(r=>r.databaseName),this.where),this}}class wE{constructor(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isCascadeSoftRemove=!1,this.isCascadeRecover=!1,this.isNullable=!0,this.createForeignKeyConstraints=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;const t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("insert")!==-1,this.isCascadeUpdate=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("update")!==-1,this.isCascadeRemove=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("remove")!==-1,this.isCascadeSoftRemove=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("soft-remove")!==-1,this.isCascadeRecover=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("recover")!==-1,this.isNullable=!(t.options.nullable===!1||this.isPrimary),this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.createForeignKeyConstraints=t.options.createForeignKeyConstraints!==!1,this.isEager=t.options.eager||!1,this.persistenceEnabled=t.options.persistence!==!1,this.orphanedRowAction=t.options.orphanedRowAction||"nullify",this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,typeof t.type=="function"?this.type=typeof t.type=="function"?t.type():t.type:U.isEntitySchema(t.type)?this.type=t.type.options.name:Ue.isObject(t.type)&&typeof t.type.name=="string"?this.type=t.type.name:this.type=t.type,this.isOneToOne=this.relationType==="one-to-one",this.isOneToMany=this.relationType==="one-to-many",this.isManyToOne=this.relationType==="many-to-one",this.isManyToMany=this.relationType==="many-to-many",this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}getRelationIdMap(e){const r=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(i=>i.referencedColumn);return Or.getValueMap(e,r)}ensureRelationIdMap(e){if(Ue.isObject(e))return e;const r=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(i=>i.referencedColumn);if(r.length>1)throw new L("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return r[0].createValueMap(e)}getEntityValue(e,t=!1){if(e!=null)if(this.embeddedMetadata){const r=[...this.embeddedMetadata.parentPropertyNames],i=(s,o)=>{const l=s.shift();return l?o[l]?i(s,o[l]):void 0:o},a=i(r,e);return this.isLazy?a["__"+this.propertyName+"__"]!==void 0?a["__"+this.propertyName+"__"]:t===!0?a[this.propertyName]:void 0:a?a[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}else return this.isLazy?e["__"+this.propertyName+"__"]!==void 0?e["__"+this.propertyName+"__"]:t===!0?e[this.propertyName]:void 0:e[this.propertyName]}setEntityValue(e,t){const r=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){const i=(a,s)=>{const o=a.shift();return o?(s[o.propertyName]||(s[o.propertyName]=o.create()),i(a,s[o.propertyName]),s):(s[r]=t,s)};return i([...this.embeddedMetadata.embeddedMetadataTree],e)}else e[r]=t}createValueMap(e){if(this.embeddedMetadata){const t=[...this.embeddedMetadata.parentPropertyNames],r=(i,a)=>{const s=i.shift();return s?(a[s]={},r(i,a[s]),a):(a[this.propertyName]=e,a)};return r(t,{})}else return{[this.propertyName]:e}}build(){this.propertyPath=this.buildPropertyPath()}registerForeignKeys(...e){this.foreignKeys.push(...e)}registerJoinColumns(e=[],t=[]){this.joinColumns=e,this.inverseJoinColumns=t,this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner}registerJunctionEntityMetadata(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)}buildInverseSidePropertyPath(){if(this.givenInverseSidePropertyFactory){const e=this.inverseEntityMetadata.propertiesMap;if(typeof this.givenInverseSidePropertyFactory=="function")return this.givenInverseSidePropertyFactory(e);if(typeof this.givenInverseSidePropertyFactory=="string")return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""}buildPropertyPath(){return!this.embeddedMetadata||!this.embeddedMetadata.parentPropertyNames.length?this.propertyName:this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName}}class pP{constructor(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isAlwaysUsingConstructor=!0,this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}create(e){return typeof this.type!="function"?{}:e!=null&&e.fromDeserializer||!this.isAlwaysUsingConstructor?Object.create(this.type.prototype):new this.type}build(e){return this.embeddeds.forEach(t=>t.build(e)),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),e.options.entitySkipConstructor&&(this.isAlwaysUsingConstructor=!e.options.entitySkipConstructor),this}buildPartialPrefix(){if(this.customPrefix===void 0||this.customPrefix===!0)return[this.propertyName];if(this.customPrefix===""||this.customPrefix===!1)return[];if(typeof this.customPrefix=="string")return[this.customPrefix];throw new L(`Invalid prefix option given for ${this.entityMetadata.targetName}#${this.propertyName}`)}buildPrefix(e){if(e.driver.options.type==="mongodb")return this.propertyName;let t=[];return this.parentEmbeddedMetadata&&t.push(this.parentEmbeddedMetadata.buildPrefix(e)),t.push(...this.buildPartialPrefix()),t.join("_")}buildParentPropertyNames(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]}buildParentPrefixes(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()}buildEmbeddedMetadataTree(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]}buildColumnsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildColumnsFromTree()),this.columns)}buildRelationsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationsFromTree()),this.relations)}buildListenersFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildListenersFromTree()),this.listeners)}buildIndicesFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildIndicesFromTree()),this.indices)}buildUniquesFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildUniquesFromTree()),this.uniques)}buildRelationIdsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationIdsFromTree()),this.relationIds)}buildRelationCountsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationCountsFromTree()),this.relationCounts)}}class TE{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}setValue(e){const t=this.relation.getEntityValue(e);if(Array.isArray(t))e[this.propertyName]=t.map(r=>this.relation.inverseEntityMetadata.getEntityIdMixedMap(r)).filter(r=>r!=null);else{const r=this.relation.inverseEntityMetadata.getEntityIdMixedMap(t);r!==void 0&&(e[this.propertyName]=r)}}build(){const e=typeof this.relationNameOrFactory=="function"?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new L(`Cannot find relation ${e}. Wrong relation specified for @RelationId decorator.`);this.relation=t}}class bE{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}build(){const e=typeof this.relationNameOrFactory=="function"?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new L(`Cannot find relation ${e}. Wrong relation specified for @RelationCount decorator.`);this.relation=t}}class Ct{}Ct.AFTER_LOAD="after-load";Ct.BEFORE_INSERT="before-insert";Ct.AFTER_INSERT="after-insert";Ct.BEFORE_UPDATE="before-update";Ct.AFTER_UPDATE="after-update";Ct.BEFORE_REMOVE="before-remove";Ct.AFTER_REMOVE="after-remove";Ct.BEFORE_SOFT_REMOVE="before-soft-remove";Ct.AFTER_SOFT_REMOVE="after-soft-remove";Ct.BEFORE_RECOVER="before-recover";Ct.AFTER_RECOVER="after-recover";class Vl{constructor(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,this.givenName=e.name,e.namingStrategy&&this.build(e.namingStrategy)}build(e){this.columnNames=this.columns.map(t=>t.databaseName),this.referencedColumnNames=this.referencedColumns.map(t=>t.databaseName),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=this.givenName?this.givenName:e.foreignKeyName(this.entityMetadata.tableName,this.columnNames,this.referencedEntityMetadata.tableName,this.referencedColumnNames)}}class mP{constructor(e){this.connection=e}build(e,t){var r,i;const a=this.collectReferencedColumns(e,t),s=this.collectInverseReferencedColumns(e,t),o=t.name||this.connection.namingStrategy.joinTableName(e.entityMetadata.tableNameWithoutPrefix,e.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyPath,e.inverseRelation?e.inverseRelation.propertyName:""),l=new Or({connection:this.connection,args:{target:"",name:o,type:"junction",database:t.database||e.entityMetadata.database,schema:t.schema||e.entityMetadata.schema,synchronize:t.synchronize}});l.build();const u=a.map(d=>{const h=t.joinColumns?t.joinColumns.find(g=>(!g.referencedColumnName||g.referencedColumnName===d.propertyName)&&!!g.name):void 0,p=h&&h.name?h.name:this.connection.namingStrategy.joinTableColumnName(e.entityMetadata.tableNameWithoutPrefix,d.propertyName,d.databaseName);return new Zn({connection:this.connection,entityMetadata:l,referencedColumn:d,args:{target:"",mode:"virtual",propertyName:p,options:{name:p,length:!d.length&&(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(d)!=="uuid"&&(d.generationStrategy==="uuid"||d.type==="uuid")?"36":d.length,width:d.width,type:d.type,precision:d.precision,scale:d.scale,charset:d.charset,collation:d.collation,zerofill:d.zerofill,unsigned:d.zerofill?!0:d.unsigned,enum:d.enum,enumName:d.enumName,foreignKeyConstraintName:h==null?void 0:h.foreignKeyConstraintName,nullable:!1,primary:!0}}})}),c=s.map(d=>{const h=t.inverseJoinColumns?t.inverseJoinColumns.find(g=>(!g.referencedColumnName||g.referencedColumnName===d.propertyName)&&!!g.name):void 0,p=h&&h.name?h.name:this.connection.namingStrategy.joinTableInverseColumnName(e.inverseEntityMetadata.tableNameWithoutPrefix,d.propertyName,d.databaseName);return new Zn({connection:this.connection,entityMetadata:l,referencedColumn:d,args:{target:"",mode:"virtual",propertyName:p,options:{length:!d.length&&(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(d)!=="uuid"&&(d.generationStrategy==="uuid"||d.type==="uuid")?"36":d.length,width:d.width,type:d.type,precision:d.precision,scale:d.scale,charset:d.charset,collation:d.collation,zerofill:d.zerofill,unsigned:d.zerofill?!0:d.unsigned,enum:d.enum,enumName:d.enumName,foreignKeyConstraintName:h==null?void 0:h.foreignKeyConstraintName,name:p,nullable:!1,primary:!0}}})});return this.changeDuplicatedColumnNames(u,c),l.ownerColumns=u,l.inverseColumns=c,l.ownColumns=[...u,...c],l.ownColumns.forEach(d=>d.relationMetadata=e),l.foreignKeys=e.createForeignKeyConstraints?[new Vl({entityMetadata:l,referencedEntityMetadata:e.entityMetadata,columns:u,referencedColumns:a,name:(r=u[0])===null||r===void 0?void 0:r.foreignKeyConstraintName,onDelete:this.connection.driver.options.type==="spanner"?"NO ACTION":e.onDelete||"CASCADE",onUpdate:this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="spanner"?"NO ACTION":e.onUpdate||"CASCADE"}),new Vl({entityMetadata:l,referencedEntityMetadata:e.inverseEntityMetadata,columns:c,referencedColumns:s,name:(i=c[0])===null||i===void 0?void 0:i.foreignKeyConstraintName,onDelete:this.connection.driver.options.type==="spanner"?"NO ACTION":e.inverseRelation?e.inverseRelation.onDelete:"CASCADE",onUpdate:this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="spanner"?"NO ACTION":e.inverseRelation?e.inverseRelation.onUpdate:"CASCADE"})]:[],l.ownIndices=[new Sr({entityMetadata:l,columns:u,args:{target:l.target,synchronize:!0}}),new Sr({entityMetadata:l,columns:c,args:{target:l.target,synchronize:!0}})],l}collectReferencedColumns(e,t){const r=t.joinColumns?t.joinColumns.find(i=>!!i.referencedColumnName):!1;return!t.joinColumns||t.joinColumns&&!r?e.entityMetadata.columns.filter(i=>i.isPrimary):t.joinColumns.map(i=>{const a=e.entityMetadata.columns.find(s=>s.propertyName===i.referencedColumnName);if(!a)throw new L(`Referenced column ${i.referencedColumnName} was not found in entity ${e.entityMetadata.name}`);return a})}collectInverseReferencedColumns(e,t){const r=!!t.inverseJoinColumns,i=r?t.inverseJoinColumns.find(a=>!!a.referencedColumnName):!1;return!r||r&&!i?e.inverseEntityMetadata.primaryColumns:t.inverseJoinColumns.map(a=>{const s=e.inverseEntityMetadata.ownColumns.find(o=>o.propertyName===a.referencedColumnName);if(!s)throw new L(`Referenced column ${a.referencedColumnName} was not found in entity ${e.inverseEntityMetadata.name}`);return s})}changeDuplicatedColumnNames(e,t){e.forEach(r=>{t.forEach(i=>{if(r.givenDatabaseName===i.givenDatabaseName){const a=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(r.propertyName,1);r.propertyName=a,r.givenDatabaseName=a;const s=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(i.propertyName,2);i.propertyName=s,i.givenDatabaseName=s}})})}}class yP{constructor(e){this.connection=e}build(e){const t=new Or({parentClosureEntityMetadata:e,connection:this.connection,args:{target:"",name:e.treeOptions&&e.treeOptions.closureTableName?e.treeOptions.closureTableName:e.tableNameWithoutPrefix,type:"closure-junction"}});return t.build(),e.primaryColumns.forEach(r=>{t.ownColumns.push(new Zn({connection:this.connection,entityMetadata:t,closureType:"ancestor",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.ancestorColumnName?e.treeOptions.ancestorColumnName(r):r.propertyName+"_ancestor",options:{primary:!0,length:r.length,type:r.type}}})),t.ownColumns.push(new Zn({connection:this.connection,entityMetadata:t,closureType:"descendant",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.descendantColumnName?e.treeOptions.descendantColumnName(r):r.propertyName+"_descendant",options:{primary:!0,length:r.length,type:r.type}}}))}),t.ownIndices=[new Sr({entityMetadata:t,columns:[t.ownColumns[0]],args:{target:t.target,synchronize:!0}}),new Sr({entityMetadata:t,columns:[t.ownColumns[1]],args:{target:t.target,synchronize:!0}})],e.treeLevelColumn&&t.ownColumns.push(new Zn({connection:this.connection,entityMetadata:t,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),t.foreignKeys=[new Vl({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[0]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver.options.type==="mssql"?"NO ACTION":"CASCADE"}),new Vl({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[1]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver.options.type==="mssql"?"NO ACTION":"CASCADE"})],t}}class Uc{constructor(e){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,this.givenName=e.args.name,this.givenColumnNames=e.args.columns,this.deferrable=e.args.deferrable)}build(e){const t={};if(this.givenColumnNames){let r=[];if(Array.isArray(this.givenColumnNames))r=this.givenColumnNames.map(i=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+i:i.trim()),r.forEach(i=>t[i]=1);else{const i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(r=i.map(a=>String(a)),r.forEach(a=>t[a]=1)):(r=Object.keys(i).map(a=>String(a)),Object.keys(i).forEach(a=>t[a]=i[a]))}this.columns=r.map(i=>{const a=this.entityMetadata.columns.find(u=>u.propertyPath===i);if(a)return[a];const s=this.entityMetadata.relations.find(u=>u.isWithJoinColumn&&u.propertyName===i);if(s)return s.joinColumns;const o=this.givenName?'"'+this.givenName+'" ':"",l=this.entityMetadata.targetName;throw new L(`Unique constraint ${o}contains column that is missing in the entity (${l}): `+i)}).reduce((i,a)=>i.concat(a))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce((r,i)=>{const a=this.entityMetadata.columns.find(s=>s.propertyPath===i);return a&&(r[a.databasePath]=t[i]),r},{}),this.name=this.givenName?this.givenName:e.uniqueConstraintName(this.entityMetadata.tableName,this.columns.map(r=>r.databaseName)),this}}class gP{constructor(e){this.connection=e}build(e,t){var r;const i=this.collectReferencedColumns(e,t),a=this.collectColumns(e,t,i);if(!i.length||!t.createForeignKeyConstraints)return{foreignKey:void 0,columns:a,uniqueConstraint:void 0};const s=new Vl({name:(r=e[0])===null||r===void 0?void 0:r.foreignKeyConstraintName,entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:a,referencedColumns:i,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if(a.every(l=>l.isPrimary)||!t.isOneToOne)return{foreignKey:s,columns:a,uniqueConstraint:void 0};const o=new Uc({entityMetadata:t.entityMetadata,columns:s.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tableName,s.columns.map(l=>l.databaseName)),target:t.entityMetadata.target}});return o.build(this.connection.namingStrategy),{foreignKey:s,columns:a,uniqueConstraint:o}}collectReferencedColumns(e,t){const r=e.find(s=>!!s.referencedColumnName),i=e.length===0&&t.isManyToOne,a=e.length>0&&!r;return i||a?t.inverseEntityMetadata.primaryColumns:e.map(s=>{const o=t.inverseEntityMetadata.ownColumns.find(l=>l.propertyName===s.referencedColumnName);if(!o)throw new L(`Referenced column ${s.referencedColumnName} was not found in entity ${t.inverseEntityMetadata.name}`);return o})}collectColumns(e,t,r){return r.map(i=>{const a=e.find(u=>(!u.referencedColumnName||u.referencedColumnName===i.propertyName)&&!!u.name),s=a?a.name:this.connection.namingStrategy.joinColumnName(t.propertyName,i.propertyName);let l=(t.embeddedMetadata?t.embeddedMetadata.columns:t.entityMetadata.ownColumns).find(u=>u.databaseNameWithoutPrefixes===s);return l||(l=new Zn({connection:this.connection,entityMetadata:t.entityMetadata,embeddedMetadata:t.embeddedMetadata,args:{target:"",mode:"virtual",propertyName:t.propertyName,options:{name:s,type:i.type,length:!i.length&&(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(i)!=="uuid"&&(i.generationStrategy==="uuid"||i.type==="uuid")?"36":i.length,width:i.width,charset:i.charset,collation:i.collation,precision:i.precision,scale:i.scale,zerofill:i.zerofill,unsigned:i.unsigned,comment:i.comment,enum:i.enum,enumName:i.enumName,primary:t.isPrimary,nullable:t.isNullable}}}),t.entityMetadata.registerColumn(l)),l.referencedColumn=i,l.type=i.type,l.relationMetadata=t,l.build(this.connection),l})}}class NE{constructor(e){this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.type=e.args.type}isAllowed(e){return this.entityMetadata.target===e.constructor||typeof this.entityMetadata.target=="function"&&e.constructor.prototype instanceof this.entityMetadata.target}execute(e){if(!this.embeddedMetadata)return e[this.propertyName]();this.callEntityEmbeddedMethod(e,this.embeddedMetadata.propertyPath.split("."))}callEntityEmbeddedMethod(e,t){const r=t.shift();!r||!e[r]||(t.length===0?Array.isArray(e[r])?e[r].map(i=>i[this.propertyName]()):e[r][this.propertyName]():e[r]&&this.callEntityEmbeddedMethod(e[r],t))}}class vP{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.checkConstraintName(this.entityMetadata.tableName,this.expression),this}}class EP{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.exclusionConstraintName(this.entityMetadata.tableName,this.expression),this}}class CE{constructor(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new mP(e),this.closureJunctionEntityMetadataBuilder=new yP(e),this.relationJoinColumnBuilder=new gP(e)}build(e){const i=(e?this.metadataArgsStorage.filterTables(e):this.metadataArgsStorage.tables).filter(a=>a.type==="regular"||a.type==="closure"||a.type==="entity-child"||a.type==="view").map(a=>this.createEntityMetadata(a));return i.forEach(a=>this.computeParentEntityMetadata(i,a)),i.forEach(a=>{a.childEntityMetadatas=i.filter(s=>typeof a.target=="function"&&typeof s.target=="function"&&Fc.isInherited(s.target,a.target))}),i.filter(a=>a.tableType!=="entity-child").forEach(a=>a.build()),i.filter(a=>a.tableType==="entity-child").forEach(a=>a.build()),i.filter(a=>a.tableType!=="entity-child").forEach(a=>this.computeEntityMetadataStep1(i,a)),i.filter(a=>a.tableType==="entity-child").forEach(a=>this.computeEntityMetadataStep1(i,a)),i.forEach(a=>this.computeEntityMetadataStep2(a)),i.forEach(a=>this.computeInverseProperties(a,i)),i.filter(a=>a.tableType!=="entity-child").forEach(a=>{a.relations.filter(s=>s.isOneToOne||s.isManyToOne).forEach(s=>{const o=this.metadataArgsStorage.filterJoinColumns(s.target,s.propertyName),{foreignKey:l,columns:u,uniqueConstraint:c}=this.relationJoinColumnBuilder.build(o,s);if(l&&(s.registerForeignKeys(l),a.foreignKeys.push(l)),u&&s.registerJoinColumns(u),c)if(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="mssql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){const d=new Sr({entityMetadata:c.entityMetadata,columns:c.columns,args:{target:c.target,name:c.name,unique:!0,synchronize:!0}});this.connection.driver.options.type==="mssql"&&(d.where=d.columns.map(h=>`${this.connection.driver.escape(h.databaseName)} IS NOT NULL`).join(" AND ")),this.connection.driver.options.type==="spanner"&&(d.isNullFiltered=!0),s.embeddedMetadata?s.embeddedMetadata.indices.push(d):s.entityMetadata.ownIndices.push(d),this.computeEntityMetadataStep2(a)}else s.embeddedMetadata?s.embeddedMetadata.uniques.push(c):s.entityMetadata.ownUniques.push(c),this.computeEntityMetadataStep2(a);if(l&&this.connection.driver.options.type==="cockroachdb"){const d=new Sr({entityMetadata:s.entityMetadata,columns:l.columns,args:{target:s.entityMetadata.target,synchronize:!0}});s.embeddedMetadata?s.embeddedMetadata.indices.push(d):s.entityMetadata.ownIndices.push(d),this.computeEntityMetadataStep2(a)}}),a.relations.filter(s=>s.isManyToMany).forEach(s=>{const o=this.metadataArgsStorage.findJoinTable(s.target,s.propertyName);if(!o)return;const l=this.junctionEntityMetadataBuilder.build(s,o);s.registerForeignKeys(...l.foreignKeys),s.registerJoinColumns(l.ownIndices[0].columns,l.ownIndices[1].columns),s.registerJunctionEntityMetadata(l),this.computeEntityMetadataStep2(l),this.computeInverseProperties(l,i),i.push(l)})}),i.forEach(a=>{a.relationsWithJoinColumns=a.relations.filter(s=>s.isWithJoinColumn),a.hasNonNullableRelations=a.relationsWithJoinColumns.some(s=>!s.isNullable||s.isPrimary)}),i.filter(a=>a.treeType==="closure-table").forEach(a=>{const s=this.closureJunctionEntityMetadataBuilder.build(a);a.closureJunctionTable=s,this.computeEntityMetadataStep2(s),this.computeInverseProperties(s,i),i.push(s)}),i.filter(a=>a.inheritancePattern==="STI"&&a.discriminatorColumn).forEach(a=>this.createKeysForTableInheritance(a)),i.forEach(a=>{a.indices.forEach(s=>s.build(this.connection.namingStrategy))}),i.forEach(a=>{a.uniques.forEach(s=>s.build(this.connection.namingStrategy))}),i.forEach(a=>{a.checks.forEach(s=>s.build(this.connection.namingStrategy))}),i.forEach(a=>{a.exclusions.forEach(s=>s.build(this.connection.namingStrategy))}),i.filter(a=>typeof a.target=="function").forEach(a=>{a.relations.filter(s=>s.isLazy).forEach(s=>{this.connection.relationLoader.enableLazyLoad(s,a.target.prototype)})}),i.forEach(a=>{a.columns.forEach(s=>{const o=this.metadataArgsStorage.findGenerated(s.target,s.propertyName);o&&(s.isGenerated=!0,s.generationStrategy=o.strategy,o.strategy==="uuid"?s.type="uuid":o.strategy==="rowid"?s.type="int":s.type=s.type||Number,s.build(this.connection),this.computeEntityMetadataStep2(a))})}),i}createEntityMetadata(e){const t=typeof e.target=="function"?Fc.getInheritanceTree(e.target):[e.target],r=this.metadataArgsStorage.findInheritanceType(e.target),i=this.metadataArgsStorage.findTree(e.target);let a;return(r&&r.pattern==="STI"||e.type==="entity-child")&&(a=this.metadataArgsStorage.filterSingleTableChildren(e.target).map(s=>s.target).filter(s=>typeof s=="function"),t.push(...a)),new Or({connection:this.connection,args:e,inheritanceTree:t,tableTree:i,inheritancePattern:r?r.pattern:void 0})}computeParentEntityMetadata(e,t){t.tableType==="entity-child"&&(t.parentEntityMetadata=e.find(r=>r.inheritanceTree.indexOf(t.target)!==-1&&r.inheritancePattern==="STI"))}computeEntityMetadataStep1(e,t){const r=this.metadataArgsStorage.findInheritanceType(t.target),i=this.metadataArgsStorage.findDiscriminatorValue(t.target);if(typeof i<"u"?t.discriminatorValue=i.value:t.discriminatorValue=t.target.name,t.embeddeds=this.createEmbeddedsRecursively(t,this.metadataArgsStorage.filterEmbeddeds(t.inheritanceTree)).map(s=>(t.inheritancePattern==="STI"&&(s.columns=s.columns.map(o=>(o.isNullable=!0,o))),s)),t.ownColumns=this.metadataArgsStorage.filterColumns(t.inheritanceTree).map(s=>{if(t.tableType==="entity-child")return t.parentEntityMetadata.ownColumns.find(u=>u.propertyName===s.propertyName);const o=new Zn({connection:this.connection,entityMetadata:t,args:s});return e.find(u=>u.tableType==="entity-child"&&u.target===s.target)&&(o.isNullable=!0),o}),r&&r.column){const s=r.column&&r.column.name?r.column.name:"type";let o=t.ownColumns.find(l=>l.propertyName===s);o?o.isDiscriminator=!0:(o=new Zn({connection:this.connection,entityMetadata:t,args:{target:t.target,mode:"virtual",propertyName:s,options:r.column||{name:s,type:"varchar",nullable:!1}}}),o.isVirtual=!0,o.isDiscriminator=!0,t.ownColumns.push(o))}if(t.tableType==="entity-child"){const s=t.parentEntityMetadata.ownColumns.find(o=>o.isDiscriminator);s&&!t.ownColumns.find(o=>o===s)&&t.ownColumns.push(s),t.inheritancePattern=t.parentEntityMetadata.inheritancePattern,!t.treeType&&t.parentEntityMetadata.treeType&&(t.treeType=t.parentEntityMetadata.treeType,t.treeOptions=t.parentEntityMetadata.treeOptions,t.treeParentRelation=t.parentEntityMetadata.treeParentRelation,t.treeLevelColumn=t.parentEntityMetadata.treeLevelColumn)}const{namingStrategy:a}=this.connection;if(t.treeType==="materialized-path")t.ownColumns.push(new Zn({connection:this.connection,entityMetadata:t,materializedPath:!0,args:{target:t.target,mode:"virtual",propertyName:"mpath",options:{name:a.materializedPathColumnName,type:String,nullable:!0,default:""}}}));else if(t.treeType==="nested-set"){const{left:s,right:o}=a.nestedSetColumnNames;t.ownColumns.push(new Zn({connection:this.connection,entityMetadata:t,nestedSetLeft:!0,args:{target:t.target,mode:"virtual",propertyName:s,options:{name:s,type:Number,nullable:!1,default:1}}})),t.ownColumns.push(new Zn({connection:this.connection,entityMetadata:t,nestedSetRight:!0,args:{target:t.target,mode:"virtual",propertyName:o,options:{name:o,type:Number,nullable:!1,default:2}}}))}if(t.ownRelations=this.metadataArgsStorage.filterRelations(t.inheritanceTree).map(s=>{if(t.tableType==="entity-child"){const o=t.parentEntityMetadata.ownRelations.find(u=>u.propertyName===s.propertyName),l=typeof s.type=="function"?s.type():s.type;if(o.type!==l){const u=Object.create(o);return u.type=l,u}return o}return new wE({entityMetadata:t,args:s})}),t.relationIds=this.metadataArgsStorage.filterRelationIds(t.inheritanceTree).map(s=>t.tableType==="entity-child"?t.parentEntityMetadata.relationIds.find(o=>o.propertyName===s.propertyName):new TE({entityMetadata:t,args:s})),t.relationCounts=this.metadataArgsStorage.filterRelationCounts(t.inheritanceTree).map(s=>t.tableType==="entity-child"?t.parentEntityMetadata.relationCounts.find(o=>o.propertyName===s.propertyName):new bE({entityMetadata:t,args:s})),t.ownListeners=this.metadataArgsStorage.filterListeners(t.inheritanceTree).map(s=>new NE({entityMetadata:t,args:s})),t.checks=this.metadataArgsStorage.filterChecks(t.inheritanceTree).map(s=>new vP({entityMetadata:t,args:s})),this.connection.driver.options.type==="postgres"&&(t.exclusions=this.metadataArgsStorage.filterExclusions(t.inheritanceTree).map(s=>new EP({entityMetadata:t,args:s}))),this.connection.driver.options.type==="cockroachdb"){t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter(o=>!o.unique).map(o=>new Sr({entityMetadata:t,args:o}));const s=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter(o=>o.unique).map(o=>new Uc({entityMetadata:t,args:{target:o.target,name:o.name,columns:o.columns}}));t.ownUniques.push(...s)}else t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).map(s=>new Sr({entityMetadata:t,args:s}));if(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){const s=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map(o=>new Sr({entityMetadata:t,args:{target:o.target,name:o.name,columns:o.columns,unique:!0,synchronize:!0}}));t.ownIndices.push(...s)}else{const s=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map(o=>new Uc({entityMetadata:t,args:o}));t.ownUniques.push(...s)}}createEmbeddedsRecursively(e,t){return t.map(r=>{const i=new pP({entityMetadata:e,args:r}),a=typeof i.type=="function"?Fc.getInheritanceTree(i.type):[i.type];return i.columns=this.metadataArgsStorage.filterColumns(a).map(s=>new Zn({connection:this.connection,entityMetadata:e,embeddedMetadata:i,args:s})),i.relations=this.metadataArgsStorage.filterRelations(a).map(s=>new wE({entityMetadata:e,embeddedMetadata:i,args:s})),i.listeners=this.metadataArgsStorage.filterListeners(a).map(s=>new NE({entityMetadata:e,embeddedMetadata:i,args:s})),i.indices=this.metadataArgsStorage.filterIndices(a).map(s=>new Sr({entityMetadata:e,embeddedMetadata:i,args:s})),i.uniques=this.metadataArgsStorage.filterUniques(a).map(s=>new Uc({entityMetadata:e,embeddedMetadata:i,args:s})),i.relationIds=this.metadataArgsStorage.filterRelationIds(a).map(s=>new TE({entityMetadata:e,args:s})),i.relationCounts=this.metadataArgsStorage.filterRelationCounts(a).map(s=>new bE({entityMetadata:e,args:s})),i.embeddeds=this.createEmbeddedsRecursively(e,this.metadataArgsStorage.filterEmbeddeds(a)),i.embeddeds.forEach(s=>s.parentEmbeddedMetadata=i),e.allEmbeddeds.push(i),i})}computeEntityMetadataStep2(e){e.embeddeds.forEach(t=>t.build(this.connection)),e.embeddeds.forEach(t=>{t.columnsFromTree.forEach(r=>r.build(this.connection)),t.relationsFromTree.forEach(r=>r.build())}),e.ownColumns.forEach(t=>t.build(this.connection)),e.ownRelations.forEach(t=>t.build()),e.relations=e.embeddeds.reduce((t,r)=>t.concat(r.relationsFromTree),e.ownRelations),e.eagerRelations=e.relations.filter(t=>t.isEager),e.lazyRelations=e.relations.filter(t=>t.isLazy),e.oneToOneRelations=e.relations.filter(t=>t.isOneToOne),e.oneToManyRelations=e.relations.filter(t=>t.isOneToMany),e.manyToOneRelations=e.relations.filter(t=>t.isManyToOne),e.manyToManyRelations=e.relations.filter(t=>t.isManyToMany),e.ownerOneToOneRelations=e.relations.filter(t=>t.isOneToOneOwner),e.ownerManyToManyRelations=e.relations.filter(t=>t.isManyToManyOwner),e.treeParentRelation=e.relations.find(t=>t.isTreeParent),e.treeChildrenRelation=e.relations.find(t=>t.isTreeChildren),e.columns=e.embeddeds.reduce((t,r)=>t.concat(r.columnsFromTree),e.ownColumns),e.listeners=e.embeddeds.reduce((t,r)=>t.concat(r.listenersFromTree),e.ownListeners),e.afterLoadListeners=e.listeners.filter(t=>t.type===Ct.AFTER_LOAD),e.afterInsertListeners=e.listeners.filter(t=>t.type===Ct.AFTER_INSERT),e.afterUpdateListeners=e.listeners.filter(t=>t.type===Ct.AFTER_UPDATE),e.afterRemoveListeners=e.listeners.filter(t=>t.type===Ct.AFTER_REMOVE),e.afterSoftRemoveListeners=e.listeners.filter(t=>t.type===Ct.AFTER_SOFT_REMOVE),e.afterRecoverListeners=e.listeners.filter(t=>t.type===Ct.AFTER_RECOVER),e.beforeInsertListeners=e.listeners.filter(t=>t.type===Ct.BEFORE_INSERT),e.beforeUpdateListeners=e.listeners.filter(t=>t.type===Ct.BEFORE_UPDATE),e.beforeRemoveListeners=e.listeners.filter(t=>t.type===Ct.BEFORE_REMOVE),e.beforeSoftRemoveListeners=e.listeners.filter(t=>t.type===Ct.BEFORE_SOFT_REMOVE),e.beforeRecoverListeners=e.listeners.filter(t=>t.type===Ct.BEFORE_RECOVER),e.indices=e.embeddeds.reduce((t,r)=>t.concat(r.indicesFromTree),e.ownIndices),e.uniques=e.embeddeds.reduce((t,r)=>t.concat(r.uniquesFromTree),e.ownUniques),e.primaryColumns=e.columns.filter(t=>t.isPrimary),e.nonVirtualColumns=e.columns.filter(t=>!t.isVirtual),e.ancestorColumns=e.columns.filter(t=>t.closureType==="ancestor"),e.descendantColumns=e.columns.filter(t=>t.closureType==="descendant"),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter(t=>t.isGenerated||t.isObjectId),e.hasUUIDGeneratedColumns=e.columns.filter(t=>t.isGenerated||t.generationStrategy==="uuid").length>0,e.createDateColumn=e.columns.find(t=>t.isCreateDate),e.updateDateColumn=e.columns.find(t=>t.isUpdateDate),e.deleteDateColumn=e.columns.find(t=>t.isDeleteDate),e.versionColumn=e.columns.find(t=>t.isVersion),e.discriminatorColumn=e.columns.find(t=>t.isDiscriminator),e.treeLevelColumn=e.columns.find(t=>t.isTreeLevel),e.nestedSetLeftColumn=e.columns.find(t=>t.isNestedSetLeft),e.nestedSetRightColumn=e.columns.find(t=>t.isNestedSetRight),e.materializedPathColumn=e.columns.find(t=>t.isMaterializedPath),e.objectIdColumn=e.columns.find(t=>t.isObjectId),e.foreignKeys.forEach(t=>t.build(this.connection.namingStrategy)),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach(t=>t.build()),e.relationCounts.forEach(t=>t.build()),e.embeddeds.forEach(t=>{t.relationIdsFromTree.forEach(r=>r.build()),t.relationCountsFromTree.forEach(r=>r.build())})}computeInverseProperties(e,t){e.relations.forEach(r=>{const i=t.find(a=>a.target===r.type||typeof r.type=="string"&&(a.targetName===r.type||a.givenTableName===r.type));if(!i)throw new L("Entity metadata for "+e.name+"#"+r.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");r.inverseEntityMetadata=i,r.inverseSidePropertyPath=r.buildInverseSidePropertyPath(),r.inverseRelation=i.relations.find(a=>a.propertyPath===r.inverseSidePropertyPath)})}createKeysForTableInheritance(e){e.indices.push(new Sr({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))}}class gd extends L{static createEntitySchemaIsRequiredException(e){return new gd(`EntitySchema is required for ${e} embedded field`)}static createTargetIsRequired(e){return new gd(`Target field is required for ${e} embedded EntitySchema`)}constructor(e){super(e)}}class wP{transform(e){const t=new Nb;return e.forEach(r=>{var i;const a=r.options,s={target:a.target||a.name,name:a.tableName,database:a.database,schema:a.schema,type:a.type||"regular",orderBy:a.orderBy,synchronize:a.synchronize,withoutRowid:!!a.withoutRowid,expression:a.expression};t.tables.push(s);const{inheritance:o}=a;o&&t.inheritances.push({target:a.target,pattern:(i=o.pattern)!==null&&i!==void 0?i:"STI",column:o.column?typeof o.column=="string"?{name:o.column}:o.column:void 0}),this.transformColumnsRecursive(a,t)}),t}transformColumnsRecursive(e,t){Object.keys(e.columns).forEach(r=>{const a=e.columns[r];let s="regular";a.createDate&&(s="createDate"),a.updateDate&&(s="updateDate"),a.deleteDate&&(s="deleteDate"),a.version&&(s="version"),a.treeChildrenCount&&(s="treeChildrenCount"),a.treeLevel&&(s="treeLevel"),a.objectId&&(s="objectId");const o={target:e.target||e.name,mode:s,propertyName:r,options:{type:a.type,name:a.objectId?"_id":a.name,primaryKeyConstraintName:a.primaryKeyConstraintName,length:a.length,width:a.width,nullable:a.nullable,readonly:a.readonly,update:a.update,select:a.select,insert:a.insert,primary:a.primary,unique:a.unique,comment:a.comment,default:a.default,onUpdate:a.onUpdate,precision:a.precision,scale:a.scale,zerofill:a.zerofill,unsigned:a.unsigned,charset:a.charset,collation:a.collation,enum:a.enum,enumName:a.enumName,asExpression:a.asExpression,generatedType:a.generatedType,hstoreType:a.hstoreType,array:a.array,transformer:a.transformer,spatialFeatureType:a.spatialFeatureType,srid:a.srid}};if(t.columns.push(o),a.generated){const l={target:e.target||e.name,propertyName:r,strategy:typeof a.generated=="string"?a.generated:"increment"};t.generations.push(l)}a.unique&&t.uniques.push({target:e.target||e.name,columns:[r]})}),e.relations&&Object.keys(e.relations).forEach(r=>{const i=e.relations[r],a={target:e.target||e.name,propertyName:r,relationType:i.type,isLazy:i.lazy||!1,type:i.target,inverseSideProperty:i.inverseSide,isTreeParent:i.treeParent,isTreeChildren:i.treeChildren,options:{eager:i.eager||!1,cascade:i.cascade,nullable:i.nullable,onDelete:i.onDelete,onUpdate:i.onUpdate,deferrable:i.deferrable,createForeignKeyConstraints:i.createForeignKeyConstraints,persistence:i.persistence,orphanedRowAction:i.orphanedRowAction}};if(t.relations.push(a),i.joinColumn)if(typeof i.joinColumn=="boolean"){const s={target:e.target||e.name,propertyName:r};t.joinColumns.push(s)}else{const s=Array.isArray(i.joinColumn)?i.joinColumn:[i.joinColumn];for(const o of s){const l={target:e.target||e.name,propertyName:r,name:o.name,referencedColumnName:o.referencedColumnName,foreignKeyConstraintName:o.foreignKeyConstraintName};t.joinColumns.push(l)}}if(i.joinTable)if(typeof i.joinTable=="boolean"){const s={target:e.target||e.name,propertyName:r};t.joinTables.push(s)}else{const s={target:e.target||e.name,propertyName:r,name:i.joinTable.name,database:i.joinTable.database,schema:i.joinTable.schema,joinColumns:i.joinTable.joinColumn?[i.joinTable.joinColumn]:i.joinTable.joinColumns,inverseJoinColumns:i.joinTable.inverseJoinColumn?[i.joinTable.inverseJoinColumn]:i.joinTable.inverseJoinColumns};t.joinTables.push(s)}}),e.relationIds&&Object.keys(e.relationIds).forEach(r=>{const i=e.relationIds[r],a={propertyName:r,relation:i.relationName,target:e.target||e.name,alias:i.alias,queryBuilderFactory:i.queryBuilderFactory};t.relationIds.push(a)}),e.indices&&e.indices.forEach(r=>{const i={target:e.target||e.name,name:r.name,unique:r.unique===!0,spatial:r.spatial===!0,fulltext:r.fulltext===!0,nullFiltered:r.nullFiltered===!0,parser:r.parser,synchronize:r.synchronize!==!1,where:r.where,sparse:r.sparse,columns:r.columns};t.indices.push(i)}),e.uniques&&e.uniques.forEach(r=>{const i={target:e.target||e.name,name:r.name,columns:r.columns,deferrable:r.deferrable};t.uniques.push(i)}),e.checks&&e.checks.forEach(r=>{const i={target:e.target||e.name,name:r.name,expression:r.expression};t.checks.push(i)}),e.exclusions&&e.exclusions.forEach(r=>{const i={target:e.target||e.name,name:r.name,expression:r.expression};t.exclusions.push(i)}),e.embeddeds&&Object.keys(e.embeddeds).forEach(r=>{const i=e.embeddeds[r];if(!i.schema)throw gd.createEntitySchemaIsRequiredException(r);const a=i.schema.options;t.embeddeds.push({target:e.target||e.name,propertyName:r,isArray:i.array===!0,prefix:i.prefix!==void 0?i.prefix:void 0,type:()=>(a==null?void 0:a.target)||a.name}),this.transformColumnsRecursive(a,t)})}}class TP{constructor(e){this.connection=e}async buildMigrations(e){const[t,r]=be.splitClassesAndStrings(e);return[...t,...await wf(this.connection.logger)].map(a=>EE(a))}async buildSubscribers(e){const[t,r]=be.splitClassesAndStrings(e||[]),i=[...t,...await wf(this.connection.logger)];return Wt().filterSubscribers(i).map(a=>EE(a.target))}async buildEntityMetadatas(e){const[t,r]=be.splitClassesAndStrings(e||[]),i=t.filter(c=>!U.isEntitySchema(c)),a=t.filter(c=>U.isEntitySchema(c)),s=[...i,...await wf(this.connection.logger)];s.forEach(c=>{U.isEntitySchema(c)&&a.push(c)});const o=new CE(this.connection,Wt()).build(s),l=new wP().transform(a),u=new CE(this.connection,l).build();return[...o,...u]}}class bP{constructor(e,t,r,i,a){this.expressionMap=e,this.driver=t,this.rawRelationIdResults=r,this.rawRelationCountResults=i,this.queryRunner=a}transform(e,t){const r=this.group(e,t),i=[];return r.forEach(a=>{const s=this.transformRawResultsGroup(a,t);s!==void 0&&!Object.values(s).every(o=>o===null)&&i.push(s)}),i}group(e,t){const r=new Map,i=[];return t.metadata.tableType==="view"?i.push(...t.metadata.columns.map(a=>me.buildAlias(this.driver,void 0,t.name,a.databaseName))):i.push(...t.metadata.primaryColumns.map(a=>me.buildAlias(this.driver,void 0,t.name,a.databaseName))),e.forEach(a=>{const s=i.map(l=>{const u=a[l];return Buffer.isBuffer(u)?u.toString("hex"):Ue.isObject(u)?JSON.stringify(u):u}).join("_"),o=r.get(s);o?o.push(a):r.set(s,[a])}),r}transformRawResultsGroup(e,t){let r=t.metadata;if(r.discriminatorColumn){const c=e.map(h=>h[me.buildAlias(this.driver,void 0,t.name,t.metadata.discriminatorColumn.databaseName)]),d=r.childEntityMetadatas.find(h=>typeof c.find(p=>p===h.discriminatorValue)<"u");d&&(r=d)}let i=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const a=this.transformColumns(e,t,i,r),s=this.transformJoins(e,i,t,r),o=this.transformRelationIds(e,t,i,r),l=this.transformRelationCounts(e,t,i);if(a||r.primaryColumns.filter(c=>c.isVirtual===!1).length===0&&(s||o||l))return i}transformColumns(e,t,r,i){let a=!1;return i.columns.forEach(s=>{if(i.childEntityMetadatas.length>0&&i.childEntityMetadatas.findIndex(l=>l.target===s.target)!==-1)return;const o=e[0][me.buildAlias(this.driver,void 0,t.name,s.databaseName)];o===void 0||s.isVirtual||this.expressionMap.selects.find(l=>l.selection===t.name||l.selection===t.name+"."+s.propertyPath)&&(s.setEntityValue(r,this.driver.prepareHydratedValue(o,s)),o!==null&&(a=!0))}),a}transformJoins(e,t,r,i){let a=!1;return this.expressionMap.joinAttributes.forEach(s=>{if(!s.metadata||!s.isSelected||s.relation&&!i.relations.find(l=>l===s.relation))return;if(s.mapToProperty){if(s.mapToPropertyParentAlias!==r.name)return}else if(!s.relation||s.parentAlias!==r.name||s.relationPropertyPath!==s.relation.propertyPath)return;let o=this.transform(e,s.alias);o=s.isMany?o:o[0],o=!s.isMany&&o===void 0?null:o,o!==void 0&&(s.mapToPropertyPropertyName?t[s.mapToPropertyPropertyName]=o:s.relation.setEntityValue(t,o),a=!0)}),a}transformRelationIds(e,t,r,i){let a=!1;return this.rawRelationIdResults.forEach((s,o)=>{if(s.relationIdAttribute.parentAlias!==t.name)return;const l=s.relationIdAttribute.relation,u=this.createValueMapFromJoinColumns(l,s.relationIdAttribute.parentAlias,e);if(u==null)return;this.prepareDataForTransformRelationIds();const c=this.hashEntityIds(l,u),d=this.relationIdMaps[o][c]||[],h=s.relationIdAttribute.mapToPropertyPropertyPath.split("."),p=(g,E,A)=>{const b=g.shift();if(b&&g.length===0)return E[b]=A,E;if(b&&g.length>0)p(g,E[b],A);else return E};l.isOneToOne||l.isManyToOne?d[0]!==void 0&&(p(h,r,d[0]),a=!0):(p(h,r,d),a=a||d.length>0)}),a}transformRelationCounts(e,t,r){let i=!1;return this.rawRelationCountResults.filter(a=>a.relationCountAttribute.parentAlias===t.name).forEach(a=>{const s=a.relationCountAttribute.relation;let o;s.isOneToMany?o=s.inverseRelation.joinColumns[0].referencedColumn.databaseName:o=s.isOwning?s.joinColumns[0].referencedColumn.databaseName:s.inverseRelation.joinColumns[0].referencedColumn.databaseName;const l=e[0][me.buildAlias(this.driver,void 0,t.name,o)];l!=null&&(r[a.relationCountAttribute.mapToPropertyPropertyName]=0,a.results.filter(u=>u.parentId===l).forEach(u=>{r[a.relationCountAttribute.mapToPropertyPropertyName]=parseInt(u.cnt),i=!0}))}),i}createValueMapFromJoinColumns(e,t,r){let i;return e.isManyToOne||e.isOneToOneOwner?i=e.entityMetadata.primaryColumns.map(a=>a):e.isOneToMany||e.isOneToOneNotOwner?i=e.inverseRelation.joinColumns.map(a=>a):e.isOwning?i=e.joinColumns.map(a=>a):i=e.inverseRelation.inverseJoinColumns.map(a=>a),i.reduce((a,s)=>(r.forEach(o=>{e.isManyToOne||e.isOneToOneOwner?a[s.databaseName]=this.driver.prepareHydratedValue(o[me.buildAlias(this.driver,void 0,t,s.databaseName)],s):a[s.databaseName]=this.driver.prepareHydratedValue(o[me.buildAlias(this.driver,void 0,t,s.referencedColumn.databaseName)],s.referencedColumn)}),a),{})}extractEntityPrimaryIds(e,t){let r;return e.isManyToOne||e.isOneToOneOwner?r=e.entityMetadata.primaryColumns.map(i=>i):e.isOneToMany||e.isOneToOneNotOwner?r=e.inverseRelation.joinColumns.map(i=>i):e.isOwning?r=e.joinColumns.map(i=>i):r=e.inverseRelation.inverseJoinColumns.map(i=>i),r.reduce((i,a)=>(i[a.databaseName]=t[a.databaseName],i),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(e=>{const t=e.relationIdAttribute.relation;let r;return t.isManyToOne||t.isOneToOneOwner?r=t.joinColumns:t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseEntityMetadata.primaryColumns:t.isOwning?r=t.inverseJoinColumns:r=t.inverseRelation.joinColumns,e.results.reduce((i,a)=>{let s=r.reduce((o,l)=>{let u=a[l.databaseName];return t.isOneToMany||t.isOneToOneNotOwner?(l.isVirtual&&l.referencedColumn&&l.referencedColumn.propertyName!==l.propertyName&&(u=l.referencedColumn.createValueMap(u)),be.mergeDeep(o,l.createValueMap(u))):(!l.isPrimary&&l.referencedColumn.referencedColumn&&(u=l.referencedColumn.referencedColumn.createValueMap(u)),be.mergeDeep(o,l.referencedColumn.createValueMap(u)))},{});if(r.length===1&&!e.relationIdAttribute.disableMixedMap&&(t.isOneToMany||t.isOneToOneNotOwner?s=r[0].getEntityValue(s):s=r[0].referencedColumn.getEntityValue(s)),s!==void 0){const o=this.hashEntityIds(t,a);i[o]?i[o].push(s):i[o]=[s]}return i},{})}))}hashEntityIds(e,t){const r=this.extractEntityPrimaryIds(e,t);return JSON.stringify(r)}}class Vr{static isAliasProperty(e){if(typeof e!="string"||e.indexOf(".")===-1)return!1;const[t,r]=e.split(".");return!(!t||!r||e.indexOf("(")!==-1||e.indexOf(")")!==-1)}}class zb{constructor(e,t,r){this.connection=e,this.queryExpressionMap=t,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&Ue.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let e=()=>{for(const t of this.queryExpressionMap.selects)if(t.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>t.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=e(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Vr.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Vr.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let e=()=>{if(!Vr.isAliasProperty(this.entityOrProperty))return;const t=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=t.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||t.metadata.parentEntityMetadata&&(r=t.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new L(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=e.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new L("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new L("Junction property is not defined.");const e=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?me.buildAlias(this.connection.driver,void 0,e,this.alias.name):me.buildAlias(this.connection.driver,void 0,this.alias.name,e)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class ey{constructor(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,Ue.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new L(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class ty{constructor(e,t){this.expressionMap=e,Ue.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rc"}get relation(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value is a string representation of alias property");const[e,t]=this.relationName.split("."),i=this.expressionMap.findAliasByName(e).metadata.findRelationWithPropertyPath(t);if(!i)throw new L(`Relation with property path ${t} in entity was not found.`);return i}get metadata(){if(!Vr.isAliasProperty(this.relationName))throw new L("Given value is a string representation of alias property");const e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}let NP=class{constructor(e,t,r){this.connection=e,this.queryRunner=t,this.relationIdAttributes=r}async load(e){const t=this.relationIdAttributes.map(async r=>{if(r.relation.isManyToOne||r.relation.isOneToOneOwner){if(r.queryBuilderFactory)throw new L("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const i={},a=e.map(s=>{const o={},l=[];r.relation.joinColumns.forEach(c=>{o[c.databaseName]=this.connection.driver.prepareHydratedValue(s[me.buildAlias(this.connection.driver,void 0,r.parentAlias,c.databaseName)],c.referencedColumn);const d=`${c.databaseName}:${o[c.databaseName]}`;l.indexOf(d)===-1&&l.push(d)}),r.relation.entityMetadata.primaryColumns.forEach(c=>{o[c.databaseName]=this.connection.driver.prepareHydratedValue(s[me.buildAlias(this.connection.driver,void 0,r.parentAlias,c.databaseName)],c);const d=`${c.databaseName}:${o[c.databaseName]}`;l.indexOf(d)===-1&&l.push(d)}),l.sort();const u=l.join("::");return i[u]?null:(i[u]=!0,o)}).filter(s=>s);return{relationIdAttribute:r,results:a}}else if(r.relation.isOneToMany||r.relation.isOneToOneNotOwner){const i=r.relation,a=i.isOwning?i.joinColumns:i.inverseRelation.joinColumns,s=i.inverseEntityMetadata.target,o=i.inverseEntityMetadata.tableName,l=r.alias||o,u={},c={},d=e.map((E,A)=>{const b=[],T={},C=a.map(D=>{const F=D.databaseName+A,Q=E[me.buildAlias(this.connection.driver,void 0,r.parentAlias,D.referencedColumn.databaseName)],W=`${l}:${D.propertyPath}:${Q}`;return b.indexOf(W)!==-1?"":(b.push(W),T[F]=Q,l+"."+D.propertyPath+" = :"+F)}).filter(D=>D).join(" AND ");b.sort();const P=b.join("::");return u[P]?"":(u[P]=!0,Object.assign(c,T),C)}).filter(E=>E).map(E=>"("+E+")").join(" OR ");if(!d)return{relationIdAttribute:r,results:[]};const h=this.connection.createQueryBuilder(this.queryRunner);be.uniq([...a,...i.inverseRelation.entityMetadata.primaryColumns],E=>E.propertyPath).forEach(E=>{h.addSelect(l+"."+E.propertyPath,E.databaseName)}),h.from(s,l).where("("+d+")").setParameters(c),r.queryBuilderFactory&&r.queryBuilderFactory(h);const g=await h.getRawMany();return g.forEach(E=>{a.forEach(A=>{E[A.databaseName]=this.connection.driver.prepareHydratedValue(E[A.databaseName],A.referencedColumn)}),i.inverseRelation.entityMetadata.primaryColumns.forEach(A=>{E[A.databaseName]=this.connection.driver.prepareHydratedValue(E[A.databaseName],A)})}),{relationIdAttribute:r,results:g}}else{const i=r.relation,a=i.isOwning?i.joinColumns:i.inverseRelation.inverseJoinColumns,s=i.isOwning?i.inverseJoinColumns:i.inverseRelation.joinColumns,o=r.junctionAlias,l=r.joinInverseSideMetadata.tableName,u=r.alias||l,c=i.isOwning?i.junctionEntityMetadata.tableName:i.inverseRelation.junctionEntityMetadata.tableName,d=e.map(C=>a.reduce((P,D)=>(P[D.propertyPath]=C[me.buildAlias(this.connection.driver,void 0,r.parentAlias,D.referencedColumn.databaseName)],P),{}));if(d.length===0)return{relationIdAttribute:r,results:[]};const h={},p={},g=d.map((C,P)=>{const D=[],F={},Q=Object.keys(C).map(B=>{const K=B+P,M=C[B],Z=`${o}:${B}:${M}`;return D.indexOf(Z)!==-1?"":(D.push(Z),F[K]=M,o+"."+B+" = :"+K)}).filter(B=>B).join(" AND ");D.sort();const W=D.join("::");return p[W]?"":(p[W]=!0,Object.assign(h,F),Q)}).filter(C=>C),E=s.map(C=>o+"."+C.propertyPath+" = "+u+"."+C.referencedColumn.propertyPath).join(" AND "),A=g.map(C=>"("+C+" AND "+E+")").join(" OR "),b=this.connection.createQueryBuilder(this.queryRunner);s.forEach(C=>{b.addSelect(o+"."+C.propertyPath,C.databaseName).addOrderBy(o+"."+C.propertyPath)}),a.forEach(C=>{b.addSelect(o+"."+C.propertyPath,C.databaseName).addOrderBy(o+"."+C.propertyPath)}),b.from(l,u).innerJoin(c,o,A).setParameters(h),r.queryBuilderFactory&&r.queryBuilderFactory(b);const T=await b.getRawMany();return T.forEach(C=>{[...a,...s].forEach(P=>{C[P.databaseName]=this.connection.driver.prepareHydratedValue(C[P.databaseName],P.referencedColumn)})}),{relationIdAttribute:r,results:T}}});return Promise.all(t)}};class Wb{constructor(e,t){this.connection=e,this.queryRunner=t}load(e,t,r){const i=Array.isArray(t)?t:[t],a=Array.isArray(r)?r:r?[r]:void 0;return e.isManyToMany?this.loadForManyToMany(e,i,a):e.isManyToOne||e.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(e,i,a):this.loadForOneToManyAndOneToOneNotOwner(e,i,a)}async loadManyToManyRelationIdsAndGroup(e,t,r,i){const a=e.isManyToMany||e.isOneToMany,s=Array.isArray(t)?t:[t];if(!r&&(r=await this.connection.relationLoader.load(e,t,this.queryRunner,i),!r.length))return s.map(d=>({entity:d,related:a?[]:void 0}));const o=await this.load(e,t,r),l=Array.isArray(r)?r:[r];let u=[],c=[];return e.isManyToManyOwner?(u=e.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),c=e.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):e.isManyToManyNotOwner?(u=e.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),c=e.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):e.isManyToOne||e.isOneToOneOwner?(u=e.joinColumns.map(d=>d.referencedColumn),c=e.entityMetadata.primaryColumns):(e.isOneToMany||e.isOneToOneNotOwner)&&(u=e.inverseRelation.entityMetadata.primaryColumns,c=e.inverseRelation.joinColumns.map(d=>d.referencedColumn)),s.map(d=>{const h={entity:d,related:a?[]:void 0},p=o.filter(g=>c.every(E=>E.compareEntityValue(d,g[E.entityMetadata.name+"_"+E.propertyAliasName])));return p.length&&l.forEach(g=>{p.forEach(E=>{u.every(b=>b.compareEntityValue(g,E[me.buildAlias(this.connection.driver,void 0,b.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+b.propertyPath.replace(".","_"))]))&&(a?h.related.push(g):h.related=g)})}),h})}loadForManyToMany(e,t,r){const i=e.junctionEntityMetadata,a=i.name,s=e.isOwning?i.ownerColumns:i.inverseColumns,o=e.isOwning?i.inverseColumns:i.ownerColumns,l=this.connection.createQueryBuilder(this.queryRunner);s.forEach(h=>{const p=me.buildAlias(this.connection.driver,void 0,h.referencedColumn.entityMetadata.name+"_"+h.referencedColumn.propertyPath.replace(".","_"));l.addSelect(a+"."+h.propertyPath,p)}),o.forEach(h=>{const p=me.buildAlias(this.connection.driver,void 0,h.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+h.referencedColumn.propertyPath.replace(".","_"));l.addSelect(a+"."+h.propertyPath,p)});let u="";if(s.length===1){const h=t.map(g=>s[0].referencedColumn.getEntityValue(g));h.every(g=>typeof g=="number")?u=`${a}.${s[0].propertyPath} IN (${h.join(", ")})`:(l.setParameter("values1",h),u=a+"."+s[0].propertyPath+" IN (:...values1)")}else u="("+t.map((h,p)=>s.map(g=>{const E="entity1_"+p+"_"+g.propertyName;return l.setParameter(E,g.referencedColumn.getEntityValue(h)),a+"."+g.propertyPath+" = :"+E}).join(" AND ")).map(h=>"("+h+")").join(" OR ")+")";let c="";if(r)if(o.length===1){const h=r.map(g=>o[0].referencedColumn.getEntityValue(g));h.every(g=>typeof g=="number")?c=`${a}.${o[0].propertyPath} IN (${h.join(", ")})`:(l.setParameter("values2",h),c=a+"."+o[0].propertyPath+" IN (:...values2)")}else c="("+r.map((h,p)=>o.map(g=>{const E="entity2_"+p+"_"+g.propertyName;return l.setParameter(E,g.referencedColumn.getEntityValue(h)),a+"."+g.propertyPath+" = :"+E}).join(" AND ")).map(h=>"("+h+")").join(" OR ")+")";const d=[u,c].filter(h=>h.length>0).join(" AND ");return l.from(i.target,a).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(e,t,r){const i=e.entityMetadata.targetName,a=e.joinColumns.every(l=>!!e.entityMetadata.nonVirtualColumns.find(u=>u===l));if(r&&a){let l=[];if(t.forEach(u=>{let c={};e.entityMetadata.primaryColumns.forEach(d=>{const h=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");c[h]=d.getEntityValue(u)}),r.forEach(d=>{e.joinColumns.forEach(h=>{const p=h.getEntityValue(u),g=h.referencedColumn.getEntityValue(d);if(!(p===void 0||g===void 0)&&p===g){const E=h.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+h.referencedColumn.propertyPath.replace(".","_");c[E]=g}})}),Object.keys(c).length===e.entityMetadata.primaryColumns.length+e.joinColumns.length&&l.push(c)}),l.length===t.length)return Promise.resolve(l)}const s=this.connection.createQueryBuilder(this.queryRunner);e.entityMetadata.primaryColumns.forEach(l=>{const u=me.buildAlias(this.connection.driver,void 0,l.entityMetadata.name+"_"+l.propertyPath.replace(".","_"));s.addSelect(i+"."+l.propertyPath,u)}),e.joinColumns.forEach(l=>{const u=me.buildAlias(this.connection.driver,void 0,l.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+l.referencedColumn.propertyPath.replace(".","_"));s.addSelect(i+"."+l.propertyPath,u)});let o="";if(e.entityMetadata.primaryColumns.length===1){const l=t.map(c=>e.entityMetadata.primaryColumns[0].getEntityValue(c));l.every(c=>typeof c=="number")?o=`${i}.${e.entityMetadata.primaryColumns[0].propertyPath} IN (${l.join(", ")})`:(s.setParameter("values",l),o=i+"."+e.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else o=t.map((l,u)=>e.entityMetadata.primaryColumns.map((c,d)=>{const h="entity"+u+"_"+d;return s.setParameter(h,c.getEntityValue(l)),i+"."+c.propertyPath+" = :"+h}).join(" AND ")).map(l=>"("+l+")").join(" OR ");return s.from(e.entityMetadata.target,i).where(o).getRawMany()}loadForOneToManyAndOneToOneNotOwner(e,t,r){if(e=e.inverseRelation,e.entityMetadata.primaryColumns.length===e.joinColumns.length&&e.entityMetadata.primaryColumns.every(l=>e.joinColumns.indexOf(l)!==-1))return Promise.resolve(t.map(l=>{const u={};return e.joinColumns.forEach(function(c){const d=c.referencedColumn.getEntityValue(l),h=c.referencedColumn.entityMetadata.name+"_"+c.referencedColumn.propertyPath.replace(".","_"),p=c.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+c.propertyPath.replace(".","_");u[h]=d,u[p]=d}),u}));const i=e.entityMetadata.targetName,a=this.connection.createQueryBuilder(this.queryRunner);e.entityMetadata.primaryColumns.forEach(o=>{const l=me.buildAlias(this.connection.driver,void 0,o.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+o.propertyPath.replace(".","_"));a.addSelect(i+"."+o.propertyPath,l)}),e.joinColumns.forEach(o=>{const l=me.buildAlias(this.connection.driver,void 0,o.referencedColumn.entityMetadata.name+"_"+o.referencedColumn.propertyPath.replace(".","_"));a.addSelect(i+"."+o.propertyPath,l)});let s="";if(e.joinColumns.length===1){const o=t.map(u=>e.joinColumns[0].referencedColumn.getEntityValue(u));o.every(u=>typeof u=="number")?s=`${i}.${e.joinColumns[0].propertyPath} IN (${o.join(", ")})`:(a.setParameter("values",o),s=i+"."+e.joinColumns[0].propertyPath+" IN (:...values)")}else s=t.map((o,l)=>e.joinColumns.map((u,c)=>{const d="entity"+l+"_"+c;return a.setParameter(d,u.referencedColumn.getEntityValue(o)),i+"."+u.propertyPath+" = :"+d}).join(" AND ")).map(o=>"("+o+")").join(" OR ");return a.from(e.entityMetadata.target,i).where(s).getRawMany()}}class CP{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationIdAttributes.push(t)}),this.expressionMap.joinAttributes.forEach(e=>{!e.metadata||e.metadata.isJunction||e.metadata.relationIds.forEach(t=>{const r=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(e,t){return new ey(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class SP{constructor(e,t,r){this.connection=e,this.queryRunner=t,this.relationCountAttributes=r}async load(e){const t=(i,a,s)=>s.indexOf(i)===a,r=this.relationCountAttributes.map(async i=>{if(i.relation.isOneToMany){const a=i.relation,s=a.inverseRelation,o=s.joinColumns[0].referencedColumn.propertyName,l=a.inverseEntityMetadata.target,u=a.inverseEntityMetadata.tableName,c=i.alias||u,d=s.propertyName;let h=e.map(g=>g[i.parentAlias+"_"+o]).filter(g=>!!g);if(h=h.filter(t),h.length===0)return{relationCountAttribute:i,results:[]};const p=this.connection.createQueryBuilder(this.queryRunner);return p.select(c+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(l,c).where(c+"."+d+" IN (:...ids)").addGroupBy(c+"."+d).setParameter("ids",h),i.queryBuilderFactory&&i.queryBuilderFactory(p),{relationCountAttribute:i,results:await p.getRawMany()}}else{let a,s,o,l;i.relation.isOwning?(a=i.relation.joinColumns[0].referencedColumn.databaseName,s=i.relation.inverseJoinColumns[0].referencedColumn.databaseName,o=i.relation.junctionEntityMetadata.columns[0],l=i.relation.junctionEntityMetadata.columns[1]):(a=i.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,s=i.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,o=i.relation.junctionEntityMetadata.columns[1],l=i.relation.junctionEntityMetadata.columns[0]);let u=e.map(A=>A[i.parentAlias+"_"+a]).filter(A=>!!A);if(u=u.filter(t),u.length===0)return{relationCountAttribute:i,results:[]};const c=i.junctionAlias,d=i.joinInverseSideMetadata.tableName,h=i.alias||d,p=i.relation.junctionEntityMetadata.tableName,g=c+"."+o.propertyName+" IN ("+u.map(A=>isNaN(A)?"'"+A+"'":A)+") AND "+c+"."+l.propertyName+" = "+h+"."+s,E=this.connection.createQueryBuilder(this.queryRunner);return E.select(c+"."+o.propertyName,"parentId").addSelect("COUNT("+E.escape(h)+"."+E.escape(s)+")","cnt").from(d,h).innerJoin(p,c,g).addGroupBy(c+"."+o.propertyName),i.queryBuilderFactory&&i.queryBuilderFactory(E),{relationCountAttribute:i,results:await E.getRawMany()}}});return Promise.all(r)}}class AP{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationCountAttributes.push(t)}),this.expressionMap.joinAttributes.forEach(e=>{!e.metadata||e.metadata.isJunction||e.metadata.relationCounts.forEach(t=>{const r=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(e,t){return new ty(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class SE{constructor(e){Ue.assign(this,e||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(e){this._metadata=e}get metadata(){if(!this._metadata)throw new L(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class ny{constructor(e){var t;this.connection=e,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.cache=!1,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],e.options.relationLoadStrategy&&(this.relationLoadStrategy=e.options.relationLoadStrategy),this.timeTravel=((t=e.options)===null||t===void 0?void 0:t.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const e=this.mainAlias.metadata.orderBy||{};return Object.keys(e).reduce((t,r)=>(t[this.mainAlias.name+"."+r]=e[r],t),{})}return this.orderBys}setMainAlias(e){return this.mainAlias=e,e}createAlias(e){let t=e.name;!t&&e.tablePath&&(t=e.tablePath),!t&&typeof e.target=="function"&&(t=e.target.name),!t&&typeof e.target=="string"&&(t=e.target);const r=new SE;return r.type=e.type,t&&(r.name=t),e.metadata&&(r.metadata=e.metadata),e.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(e.target)),e.tablePath&&(r.tablePath=e.tablePath),e.subQuery&&(r.subQuery=e.subQuery),this.aliases.push(r),r}findAliasByName(e){const t=this.aliases.find(r=>r.name===e);if(!t)throw new L(`"${e}" alias was not found. Maybe you forgot to join it?`);return t}findColumnByAliasExpression(e){const[t,r]=e.split(".");return this.findAliasByName(t).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new L("Entity to work with is not specified!");const e=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new L(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return e}clone(){const e=new ny(this.connection);return e.queryType=this.queryType,e.selects=this.selects.map(t=>t),e.maxExecutionTime=this.maxExecutionTime,e.selectDistinct=this.selectDistinct,e.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(t=>e.aliases.push(new SE(t))),e.relationLoadStrategy=this.relationLoadStrategy,e.mainAlias=this.mainAlias,e.valuesSet=this.valuesSet,e.returning=this.returning,e.onConflict=this.onConflict,e.onIgnore=this.onIgnore,e.onUpdate=this.onUpdate,e.joinAttributes=this.joinAttributes.map(t=>new zb(this.connection,this,t)),e.relationIdAttributes=this.relationIdAttributes.map(t=>new ey(this,t)),e.relationCountAttributes=this.relationCountAttributes.map(t=>new ty(this,t)),e.wheres=this.wheres.map(t=>({...t})),e.havings=this.havings.map(t=>({...t})),e.orderBys=Object.assign({},this.orderBys),e.groupBys=this.groupBys.map(t=>t),e.limit=this.limit,e.offset=this.offset,e.skip=this.skip,e.take=this.take,e.lockMode=this.lockMode,e.onLocked=this.onLocked,e.lockVersion=this.lockVersion,e.lockTables=this.lockTables,e.withDeleted=this.withDeleted,e.parameters=Object.assign({},this.parameters),e.disableEscaping=this.disableEscaping,e.enableRelationIdValues=this.enableRelationIdValues,e.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,e.subQuery=this.subQuery,e.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,e.cache=this.cache,e.cacheId=this.cacheId,e.cacheDuration=this.cacheDuration,e.relationPropertyPath=this.relationPropertyPath,e.of=this.of,e.insertColumns=this.insertColumns,e.whereEntities=this.whereEntities,e.updateEntity=this.updateEntity,e.callListeners=this.callListeners,e.useTransaction=this.useTransaction,e.timeTravel=this.timeTravel,e.nativeParameters=Object.assign({},this.nativeParameters),e.comment=this.comment,e.commonTableExpressions=this.commonTableExpressions.map(t=>({alias:t.alias,queryBuilder:typeof t.queryBuilder=="string"?t.queryBuilder:t.queryBuilder.clone(),options:t.options})),e}}class Su{constructor(e,t,r=!0,i=!1,a,s){this["@instanceof"]=Symbol.for("FindOperator"),this._type=e,this._value=t,this._useParameter=r,this._multipleParameters=i,this._getSql=a,this._objectLiteralParameters=s}get useParameter(){return U.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return U.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return U.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return U.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(U.isFindOperator(this._value))return this._value}get getSql(){return U.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(e){this._value instanceof Su?this._value.transformValue(e):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(t=>e&&Ft.transformTo(e,t)):Ft.transformTo(e,this._value)}}function RP(n){return new Su("in",n,!0,!0)}const xP=/[.*+\-?^${}()|[\]\\]/g,_P=n=>n.replace(xP,"\\$&");class PP{constructor(e,t){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,U.isDataSource(e)?(this.connection=e,this.queryRunner=t,this.expressionMap=new ny(this.connection)):(this.connection=e.connection,this.queryRunner=e.queryRunner,this.expressionMap=e.expressionMap.clone())}get alias(){if(!this.expressionMap.mainAlias)throw new L("Main alias is not set");return this.expressionMap.mainAlias.name}select(e,t){this.expressionMap.queryType="select",Array.isArray(e)?this.expressionMap.selects=e.map(i=>({selection:i})):e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);const r=require("./SelectQueryBuilder").SelectQueryBuilder;return U.isSelectQueryBuilder(this)?this:new r(this)}insert(){this.expressionMap.queryType="insert";const e=require("./InsertQueryBuilder").InsertQueryBuilder;return U.isInsertQueryBuilder(this)?this:new e(this)}update(e,t){const r=t||e;if(e=U.isEntitySchema(e)?e.options.name:e,typeof e=="function"||typeof e=="string"){const a=this.createFromAlias(e);this.expressionMap.setMainAlias(a)}this.expressionMap.queryType="update",this.expressionMap.valuesSet=r;const i=require("./UpdateQueryBuilder").UpdateQueryBuilder;return U.isUpdateQueryBuilder(this)?this:new i(this)}delete(){this.expressionMap.queryType="delete";const e=require("./DeleteQueryBuilder").DeleteQueryBuilder;return U.isDeleteQueryBuilder(this)?this:new e(this)}softDelete(){this.expressionMap.queryType="soft-delete";const e=require("./SoftDeleteQueryBuilder").SoftDeleteQueryBuilder;return U.isSoftDeleteQueryBuilder(this)?this:new e(this)}restore(){this.expressionMap.queryType="restore";const e=require("./SoftDeleteQueryBuilder").SoftDeleteQueryBuilder;return U.isSoftDeleteQueryBuilder(this)?this:new e(this)}relation(e,t){const r=arguments.length===2?e:void 0,i=arguments.length===2?t:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=i,r){const s=this.createFromAlias(r);this.expressionMap.setMainAlias(s)}const a=require("./RelationQueryBuilder").RelationQueryBuilder;return U.isRelationQueryBuilder(this)?this:new a(this)}hasRelation(e,t){const r=this.connection.getMetadata(e);return(Array.isArray(t)?t:[t]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(e){var t;return((t=this.parentQueryBuilder)===null||t===void 0?void 0:t.hasParameter(e))||e in this.expressionMap.parameters}setParameter(e,t){if(typeof t=="function")throw new L(`Function parameter isn't supported in the parameters. Please check "${e}" parameter.`);if(!e.match(/^([A-Za-z0-9_.]+)$/))throw new L("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(e,t),this.expressionMap.parameters[e]=t,this}setParameters(e){for(const[t,r]of Object.entries(e))this.setParameter(t,r);return this}createParameter(e){let t;do t=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(t));return this.setParameter(t,e),`:${t}`}setNativeParameters(e){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach(t=>{this.expressionMap.nativeParameters[t]=e[t]}),this}getParameters(){const e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const t=this.expressionMap.mainAlias.metadata;if(t.discriminatorColumn&&t.parentEntityMetadata){const r=t.childEntityMetadatas.filter(i=>i.discriminatorColumn).map(i=>i.discriminatorValue);r.push(t.discriminatorValue),e.discriminatorColumnValues=r}}return e}printSql(){const[e,t]=this.getQueryAndParameters();return this.connection.logger.logQuery(e,t),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const e=this.getQuery(),t=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,t,this.expressionMap.nativeParameters)}async execute(){const[e,t]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(e,t)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(){return new this.constructor(this.connection,this.queryRunner)}clone(){return new this.constructor(this)}comment(e){return this.expressionMap.comment=e,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e}setQueryRunner(e){return this.queryRunner=e,this}callListeners(e){return this.expressionMap.callListeners=e,this}useTransaction(e){return this.expressionMap.useTransaction=e,this}addCommonTableExpression(e,t,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:e,alias:t,options:r||{}}),this}getTableName(e){return e.split(".").map(t=>t===""?t:this.escape(t)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new L('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(e,t){if(this.connection.hasMetadata(e)){const r=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:t,metadata:this.connection.getMetadata(e),tablePath:r.tablePath})}else{if(typeof e=="string"){const a=e.substr(0,1)==="("&&e.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:t,tablePath:a?void 0:e,subQuery:a?e:void 0})}const r=e(this.subQuery());this.setParameters(r.getParameters());const i=r.getQuery();return this.expressionMap.createAlias({type:"from",name:t,subQuery:i})}}replacePropertyNames(e){return e}replacePropertyNamesForTheWholeQuery(e){const t={};for(const a of this.expressionMap.aliases){if(!a.hasMetadata)continue;const s=this.expressionMap.aliasNamePrefixingEnabled&&a.name?`${a.name}.`:"";t[s]||(t[s]={});for(const o of a.metadata.relations)o.joinColumns.length>0&&(t[s][o.propertyPath]=o.joinColumns[0].databaseName);for(const o of a.metadata.relations){const l=[...o.joinColumns,...o.inverseJoinColumns];for(const u of l){const c=`${o.propertyPath}.${u.referencedColumn.propertyPath}`;t[s][c]=u.databaseName}}for(const o of a.metadata.columns)t[s][o.databaseName]=o.databaseName;for(const o of a.metadata.columns)t[s][o.propertyName]=o.databaseName;for(const o of a.metadata.columns)t[s][o.propertyPath]=o.databaseName}const r=Object.keys(t),i=r.map(a=>_P(a)).join("|");return r.length>0&&(e=e.replace(new RegExp(`([ =(]|^.{0})${i?"("+i+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...a)=>{let s,o,l;if(i){if(s=a[0],o=a[1],l=a[3],t[a[2]][l])return`${o}${this.escape(a[2].substring(0,a[2].length-1))}.${this.escape(t[a[2]][l])}`}else if(s=a[0],o=a[1],l=a[2],t[""][l])return`${o}${this.escape(t[""][l])}`;return s})),e}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace("*/","")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const e=[],t=this.createWhereClausesExpression(this.expressionMap.wheres);if(t.length>0&&t!=="1=1"&&e.push(this.replacePropertyNames(t)),this.expressionMap.mainAlias.hasMetadata){const i=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&i.deleteDateColumn){const a=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+i.deleteDateColumn.propertyName:i.deleteDateColumn.propertyName,s=`${this.replacePropertyNames(a)} IS NULL`;e.push(s)}if(i.discriminatorColumn&&i.parentEntityMetadata){const a=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+i.discriminatorColumn.databaseName:i.discriminatorColumn.databaseName,s=`${this.replacePropertyNames(a)} IN (:...discriminatorColumnValues)`;e.push(s)}}if(this.expressionMap.extraAppendedAndWhereCondition){const i=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);e.push(i)}let r="";return r+=this.createTimeTravelQuery(),e.length?e.length===1?r+=` WHERE ${e[0]}`:r+=` WHERE ( ${e.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(e){const t=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(e)&&t.push(...this.expressionMap.extraReturningColumns.filter(i=>t.indexOf(i)===-1)),t.length){let i=t.map(a=>{const s=this.escape(a.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+s:this.escape(this.getMainTableName())+"."+s:s}).join(", ");return r.options.type==="oracle"&&(i+=" INTO "+t.map(a=>this.createParameter({type:r.columnTypeToNativeParameter(a.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(i+=" INTO @OutputTable"),i}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const e=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(t=>{this.expressionMap.mainAlias.hasMetadata&&e.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(t))}),e}createWhereClausesExpression(e){return e.map((t,r)=>{const i=this.createWhereConditionExpression(t.condition);switch(t.type){case"and":return(r>0?"AND ":"")+i;case"or":return(r>0?"OR ":"")+i}return i}).join(" ").trim()}createWhereConditionExpression(e,t=!1){if(typeof e=="string")return e;if(Array.isArray(e))return e.length===0?"1=1":e.length===1&&!t?this.createWhereClausesExpression(e):"("+this.createWhereClausesExpression(e)+")";const{driver:r}=this.connection;switch(e.operator){case"lessThan":return`${e.parameters[0]} < ${e.parameters[1]}`;case"lessThanOrEqual":return`${e.parameters[0]} <= ${e.parameters[1]}`;case"arrayContains":return`${e.parameters[0]} @> ${e.parameters[1]}`;case"jsonContains":return`${e.parameters[0]} ::jsonb @> ${e.parameters[1]}`;case"arrayContainedBy":return`${e.parameters[0]} <@ ${e.parameters[1]}`;case"arrayOverlap":return`${e.parameters[0]} && ${e.parameters[1]}`;case"moreThan":return`${e.parameters[0]} > ${e.parameters[1]}`;case"moreThanOrEqual":return`${e.parameters[0]} >= ${e.parameters[1]}`;case"notEqual":return`${e.parameters[0]} != ${e.parameters[1]}`;case"equal":return`${e.parameters[0]} = ${e.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${e.parameters[0]} ILIKE ${e.parameters[1]}`:`UPPER(${e.parameters[0]}) LIKE UPPER(${e.parameters[1]})`;case"like":return`${e.parameters[0]} LIKE ${e.parameters[1]}`;case"between":return`${e.parameters[0]} BETWEEN ${e.parameters[1]} AND ${e.parameters[2]}`;case"in":return e.parameters.length<=1?"0=1":`${e.parameters[0]} IN (${e.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${e.parameters[0]}::STRING = ANY(${e.parameters[1]}::STRING[])`:`${e.parameters[0]} = ANY(${e.parameters[1]})`;case"isNull":return`${e.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(e.condition)})`;case"brackets":return`${this.createWhereConditionExpression(e.condition,!0)}`;case"and":return e.parameters.join(" AND ")}throw new TypeError(`Unsupported FindOperator ${Su.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const e=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(r=>{const i=typeof r.queryBuilder=="string"?r.queryBuilder:r.queryBuilder.getQuery();if(typeof r.queryBuilder!="string"){if(r.queryBuilder.hasCommonTableExpressions())throw new L(`Nested CTEs aren't supported (CTE: ${r.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!U.isSelectQueryBuilder(r.queryBuilder))throw new L(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${r.alias})`);this.setParameters(r.queryBuilder.getParameters())}let a=this.escape(r.alias);if(r.options.columnNames){const l=r.options.columnNames.map(u=>this.escape(u));if(U.isSelectQueryBuilder(r.queryBuilder)&&r.queryBuilder.expressionMap.selects.length&&r.options.columnNames.length!==r.queryBuilder.expressionMap.selects.length)throw new L(`cte.options.columnNames length (${r.options.columnNames.length}) doesn't match subquery select list length ${r.queryBuilder.expressionMap.selects.length} (CTE: ${r.alias})`);a+=`(${l.join(", ")})`}const s=r.options.recursive&&e?"RECURSIVE":"";let o="";return this.connection.driver.cteCapabilities.materializedHint&&r.options.materialized!==void 0&&(o=r.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[s,a,"AS",o,`(${i})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(e){const t=this.expressionMap.mainAlias.metadata,r=(Array.isArray(e)?e:[e]).map(i=>t.ensureEntityIdMap(i));if(!t.hasMultiplePrimaryKeys){const i=t.primaryColumns[0];if(!i.transformer&&!i.relationMetadata&&!i.embeddedMetadata)return{[i.propertyName]:RP(r.map(a=>i.getEntityValue(a,!1)))}}return new yd(i=>{for(const a of r)i.orWhere(new yd(s=>s.where(a)))})}getExistsCondition(e){const t=e.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${t.getQuery()})`,t.getParameters()]}findColumnsForPropertyPath(e){let t=this.expressionMap.mainAlias;const r=[],i=e.split(".");for(;i.length>1;){const o=i[0];if(!(t!=null&&t.hasMetadata))break;if(t.metadata.hasEmbeddedWithPropertyPath(o)){i.unshift(`${i.shift()}.${i.shift()}`);continue}if(t.metadata.hasRelationWithPropertyPath(o)){const l=this.expressionMap.joinAttributes.find(u=>u.relationPropertyPath===o);if(!(l!=null&&l.alias)){const u=r.length>0?`${r.join(".")}.${o}`:o;throw new Error(`Cannot find alias for relation at ${u}`)}t=l.alias,r.push(...o.split(".")),i.shift();continue}break}if(!t)throw new Error(`Cannot find alias for property ${e}`);const a=i.join("."),s=t.metadata.findColumnsWithPropertyPath(a);if(!s.length)throw new Qr(e,t.metadata);return[t,r,s]}createPropertyPath(e,t,r=""){const i=[];for(const a of Object.keys(t)){const s=r?`${r}.${a}`:a;if(t[a]===null||typeof t[a]!="object"||U.isFindOperator(t[a])){i.push(s);continue}if(e.hasEmbeddedWithPropertyPath(s)){const o=this.createPropertyPath(e,t[a],s);i.push(...o);continue}if(e.hasRelationWithPropertyPath(s)){const o=e.findRelationWithPropertyPath(s);if(o.relationType==="one-to-one"||o.relationType==="many-to-one"){const d=o.joinColumns.map(p=>p.referencedColumn).filter(p=>!!p);if(d.length>0&&d.every(p=>p.getEntityValue(t[a],!1))){i.push(s);continue}}if(o.relationType==="one-to-many"||o.relationType==="many-to-many")throw new Error(`Cannot query across ${o.relationType} for property ${s}`);const l=o.inverseEntityMetadata.primaryColumns;if(l.length>0&&l.every(d=>d.getEntityValue(t[a],!1))){const d=l.map(h=>`${s}.${h.propertyPath}`);i.push(...d);continue}const c=this.createPropertyPath(o.inverseEntityMetadata,t[a]).map(d=>`${s}.${d}`);i.push(...c);continue}i.push(s)}return i}*getPredicates(e){if(this.expressionMap.mainAlias.hasMetadata){const t=this.createPropertyPath(this.expressionMap.mainAlias.metadata,e);for(const r of t){const[i,a,s]=this.findColumnsForPropertyPath(r);for(const o of s){let l=e;for(const d of a){if(!l||!(d in l)){l={};break}l=l[d]}const u=this.expressionMap.aliasNamePrefixingEnabled?`${i.name}.${o.propertyPath}`:o.propertyPath,c=o.getEntityValue(l,!0);yield[u,c]}}}else for(const t of Object.keys(e)){const r=e[t];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${t}`:t,r]}}getWherePredicateCondition(e,t){if(U.isFindOperator(t)){let r=[];if(t.useParameter)if(t.objectLiteralParameters)this.setParameters(t.objectLiteralParameters);else if(t.multipleParameters)for(const i of t.value)r.push(this.createParameter(i));else r.push(this.createParameter(t.value));if(t.type==="raw")return t.getSql?t.getSql(e):{operator:"equal",parameters:[e,t.value]};if(t.type==="not")return t.child?{operator:t.type,condition:this.getWherePredicateCondition(e,t.child)}:{operator:"notEqual",parameters:[e,...r]};if(t.type==="and"){const i=t.value;return{operator:t.type,parameters:i.map(a=>this.createWhereConditionExpression(this.getWherePredicateCondition(e,a)))}}else return{operator:t.type,parameters:[e,...r]}}else return{operator:"equal",parameters:[e,this.createParameter(t)]}}getWhereCondition(e){if(typeof e=="string")return e;if(U.isBrackets(e)){const i=this.createQueryBuilder();return i.parentQueryBuilder=this,i.expressionMap.mainAlias=this.expressionMap.mainAlias,i.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,i.expressionMap.parameters=this.expressionMap.parameters,i.expressionMap.nativeParameters=this.expressionMap.nativeParameters,i.expressionMap.wheres=[],e.whereFactory(i),{operator:U.isNotBrackets(e)?"not":"brackets",condition:i.expressionMap.wheres}}if(typeof e=="function")return e(this);const t=Array.isArray(e)?e:[e],r=[];for(const i of t){const a=[];for(const[s,o]of this.getPredicates(i))a.push({type:"and",condition:this.getWherePredicateCondition(s,o)});r.push({type:"or",condition:a})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}class vd extends PP{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createSelectExpression(),e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e+=this.createLockExpression(),e=e.trim(),this.expressionMap.subQuery&&(e="("+e+")"),this.replacePropertyNamesForTheWholeQuery(e)}setFindOptions(e){return this.findOptions=e,this.applyFindOptions(),this}subQuery(){const e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.parentQueryBuilder=this,e}select(e,t){if(this.expressionMap.queryType="select",Array.isArray(e))this.expressionMap.selects=e.map(r=>({selection:r}));else if(typeof e=="function"){const r=e(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this}addSelect(e,t){if(!e)return this;if(Array.isArray(e))this.expressionMap.selects=this.expressionMap.selects.concat(e.map(r=>({selection:r})));else if(typeof e=="function"){const r=e(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this}maxExecutionTime(e){return this.expressionMap.maxExecutionTime=e,this}distinct(e=!0){return this.expressionMap.selectDistinct=e,this}distinctOn(e){return this.expressionMap.selectDistinctOn=e,this}fromDummy(){var e;return this.from((e=this.connection.driver.dummyTableName)!==null&&e!==void 0?e:"(SELECT 1 AS dummy_column)","dummy_table")}from(e,t){const r=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(r),this}addFrom(e,t){const r=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(e,t,r,i){return this.join("INNER",e,t,r,i),this}leftJoin(e,t,r,i){return this.join("LEFT",e,t,r,i),this}innerJoinAndSelect(e,t,r,i){return this.addSelect(t),this.innerJoin(e,t,r,i),this}leftJoinAndSelect(e,t,r,i){return this.addSelect(t),this.leftJoin(e,t,r,i),this}innerJoinAndMapMany(e,t,r,i,a){return this.addSelect(r),this.join("INNER",t,r,i,a,e,!0),this}innerJoinAndMapOne(e,t,r,i,a,s){return this.addSelect(r),this.join("INNER",t,r,i,a,e,!1,s),this}leftJoinAndMapMany(e,t,r,i,a){return this.addSelect(r),this.join("LEFT",t,r,i,a,e,!0),this}leftJoinAndMapOne(e,t,r,i,a,s){return this.addSelect(r),this.join("LEFT",t,r,i,a,e,!1,s),this}loadRelationIdAndMap(e,t,r,i){const a=new ey(this.expressionMap);return a.mapToProperty=e,a.relationName=t,typeof r=="string"&&(a.alias=r),typeof r=="object"&&r.disableMixedMap&&(a.disableMixedMap=!0),a.queryBuilderFactory=i,this.expressionMap.relationIdAttributes.push(a),a.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:a.junctionAlias,metadata:a.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(e,t,r,i){const a=new ty(this.expressionMap);return a.mapToProperty=e,a.relationName=t,a.alias=r,a.queryBuilderFactory=i,this.expressionMap.relationCountAttributes.push(a),this.expressionMap.createAlias({type:"other",name:a.junctionAlias}),a.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:a.junctionAlias,metadata:a.relation.junctionEntityMetadata}),this}loadAllRelationIds(e){return this.expressionMap.mainAlias.metadata.relations.forEach(t=>{e!==void 0&&e.relations!==void 0&&e.relations.indexOf(t.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+t.propertyPath,this.expressionMap.mainAlias.name+"."+t.propertyPath,e)}),this}where(e,t){this.expressionMap.wheres=[];const r=this.getWhereCondition(e);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereExists(e){return this.where(...this.getExistsCondition(e))}andWhereExists(e){return this.andWhere(...this.getExistsCondition(e))}orWhereExists(e){return this.orWhere(...this.getExistsCondition(e))}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}having(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this}andHaving(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this}orHaving(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this}groupBy(e){return e?this.expressionMap.groupBys=[e]:this.expressionMap.groupBys=[],this}addGroupBy(e){return this.expressionMap.groupBys.push(e),this}timeTravelQuery(e){return this.connection.driver.options.type==="cockroachdb"&&(e===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=e),this}orderBy(e,t="ASC",r){if(t!==void 0&&t!=="ASC"&&t!=="DESC")throw new L('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new L('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return e?typeof e=="object"?this.expressionMap.orderBys=e:r?this.expressionMap.orderBys={[e]:{order:t,nulls:r}}:this.expressionMap.orderBys={[e]:t}:this.expressionMap.orderBys={},this}addOrderBy(e,t="ASC",r){if(t!==void 0&&t!=="ASC"&&t!=="DESC")throw new L('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new L('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[e]={order:t,nulls:r}:this.expressionMap.orderBys[e]=t,this}limit(e){if(this.expressionMap.limit=this.normalizeNumber(e),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new L('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(e){if(this.expressionMap.offset=this.normalizeNumber(e),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new L('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(e){if(this.expressionMap.take=this.normalizeNumber(e),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new L('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(e){if(this.expressionMap.skip=this.normalizeNumber(e),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new L('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(e){return this.expressionMap.useIndex=e,this}setLock(e,t,r){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this.expressionMap.lockTables=r,this}setOnLocked(e){return this.expressionMap.onLocked=e,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new Yo;this.expressionMap.queryEntity=!1;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0);const r=await this.loadRawResults(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getRawAndEntities(){const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const r=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const i=r.updateDateColumn.getEntityValue(t);if(i.getTime()!==this.expressionMap.lockVersion.getTime())throw new lE(r.name,this.expressionMap.lockVersion,i)}else{const i=r.versionColumn.getEntityValue(t);if(i!==this.expressionMap.lockVersion)throw new lE(r.name,this.expressionMap.lockVersion,i)}}return t===void 0?null:t}async getOneOrFail(){const e=await this.getOne();if(!e)throw new Op(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return e}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new Yo;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new Yo;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new Yo;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new Yo;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(e);this.expressionMap.queryEntity=!1;const i=this.expressionMap.cacheId;this.expressionMap.cacheId=i&&`${i}-count`;const a=await this.executeCountQuery(e),s=[r.entities,a];return t&&await e.commitTransaction(),s}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async stream(){this.expressionMap.queryEntity=!1;const[e,t]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let i=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),i=!0);const a=()=>{if(r!==this.queryRunner)return r.release()},s=r.stream(e,t,a,a);return i&&await r.commitTransaction(),s}catch(a){if(i)try{await r.rollbackTransaction()}catch{}throw a}}cache(e,t){return typeof e=="boolean"?this.expressionMap.cache=e:typeof e=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):(typeof e=="string"||typeof e=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this}setOption(e){return this.expressionMap.options.push(e),this}join(e,t,r,i,a,s,o,l){a&&this.setParameters(a);const u=new zb(this.connection,this.expressionMap);u.direction=e,u.mapAsEntity=l,u.mapToProperty=s,u.isMappingMany=o,u.entityOrProperty=t,u.condition=i,this.expressionMap.joinAttributes.push(u);const c=u.metadata;if(c){if(c.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${c.deleteDateColumn.propertyName} IS NULL`;u.condition=u.condition?` ${u.condition} AND ${d}`:`${d}`}u.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:c}),u.relation&&u.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:u.junctionAlias,metadata:u.relation.junctionEntityMetadata})}else{let d="";if(typeof t=="function"){const p=t(this.subQuery());this.setParameters(p.getParameters()),d=p.getQuery()}else d=t;const h=typeof t=="function"||t.substr(0,1)==="("&&t.substr(-1)===")";u.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:h===!1?t:void 0,subQuery:h===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new L("Cannot build query because main alias is not set (call qb#from method)");const e=[],t=[];if(this.expressionMap.mainAlias.hasMetadata){const o=this.expressionMap.mainAlias.metadata;e.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,o)),t.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,o))}this.expressionMap.joinAttributes.forEach(o=>{if(o.metadata)e.push(...this.buildEscapedEntityColumnSelects(o.alias.name,o.metadata)),t.push(...this.findEntityColumnSelects(o.alias.name,o.metadata));else if(this.expressionMap.selects.some(u=>u.selection===o.alias.name)){e.push({selection:this.escape(o.alias.name)+".*"});const u=this.expressionMap.selects.find(c=>c.selection===o.alias.name);t.push(u)}}),this.expressionMap.selects.filter(o=>t.indexOf(o)===-1).forEach(o=>e.push({selection:this.replacePropertyNames(o.selection),aliasName:o.aliasName})),e.length===0&&e.push({selection:"*"});let r="";this.expressionMap.useIndex&&me.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const i=this.expressionMap.aliases.filter(o=>o.type==="from"&&(o.tablePath||o.subQuery)).map(o=>o.subQuery?o.subQuery+" "+this.escape(o.name):this.getTableName(o.tablePath)+" "+this.escape(o.name)),a=this.createSelectDistinctExpression(),s=e.map(o=>o.selection+(o.aliasName?" AS "+this.escape(o.aliasName):"")).join(", ");return a+s+" FROM "+i.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:e,selectDistinctOn:t,maxExecutionTime:r}=this.expressionMap,{driver:i}=this.connection;let a="SELECT ";return r>0&&me.isMySQLFamily(i)&&(a+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),me.isPostgresFamily(i)&&t.length>0?a=`SELECT DISTINCT ON (${t.map(o=>this.replacePropertyNames(o)).join(", ")}) `:e&&(a="SELECT DISTINCT "),a}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const r=t.relation,i=t.tablePath,a=t.alias.name;let s=t.condition?" AND ("+t.condition+")":"";const o=t.parentAlias;if(!o||!r){const l=t.alias.subQuery?t.alias.subQuery:this.getTableName(i);return" "+t.direction+" JOIN "+l+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(r.isManyToOne||r.isOneToOneOwner){const l=r.joinColumns.map(u=>a+"."+u.referencedColumn.propertyPath+"="+o+"."+r.propertyPath+"."+u.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(i)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l+s)}else if(r.isOneToMany||r.isOneToOneNotOwner){const l=r.inverseRelation.joinColumns.map(u=>(r.inverseEntityMetadata.tableType==="entity-child"&&r.inverseEntityMetadata.discriminatorColumn&&(s+=" AND "+a+"."+r.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+r.inverseEntityMetadata.discriminatorValue+"'"),a+"."+r.inverseRelation.propertyPath+"."+u.referencedColumn.propertyPath+"="+o+"."+u.referencedColumn.propertyPath)).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(i)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l+s)}else{const l=r.junctionEntityMetadata.tablePath,u=t.junctionAlias;let c="",d="";return r.isOwning?(c=r.joinColumns.map(h=>u+"."+h.propertyPath+"="+o+"."+h.referencedColumn.propertyPath).join(" AND "),d=r.inverseJoinColumns.map(h=>a+"."+h.referencedColumn.propertyPath+"="+u+"."+h.propertyPath).join(" AND ")):(c=r.inverseRelation.inverseJoinColumns.map(h=>u+"."+h.propertyPath+"="+o+"."+h.referencedColumn.propertyPath).join(" AND "),d=r.inverseRelation.joinColumns.map(h=>a+"."+h.referencedColumn.propertyPath+"="+u+"."+h.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(l)+" "+this.escape(u)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(c)+" "+t.direction+" JOIN "+this.getTableName(i)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(d+s)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const e=this.expressionMap.allOrderBys;return Object.keys(e).length===0?"":" ORDER BY "+Object.keys(e).map(t=>{const r=typeof e[t]=="string"?e[t]:e[t].order+" "+e[t].nulls,i=this.expressionMap.selects.find(a=>a.selection===t);if(i&&!i.aliasName&&t.indexOf(".")!==-1){const a=t.split("."),s=a[0],o=a.slice(1).join("."),l=this.expressionMap.aliases.find(u=>u.name===s);if(l){const u=l.metadata.findColumnWithPropertyPath(o);if(u){const c=me.buildAlias(this.connection.driver,void 0,s,u.databaseName);return this.escape(c)+" "+r}}}return this.replacePropertyNames(t)+" "+r}).join(", ")}createLimitOffsetExpression(){let e=this.expressionMap.offset,t=this.expressionMap.limit;if(!e&&!t&&this.expressionMap.joinAttributes.length===0&&(e=this.expressionMap.skip,t=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((t||e)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),t&&e)return r+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return r+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(e)return r+" OFFSET "+e+" ROWS"}else if(me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)throw new K_}else if(me.isSQLiteFamily(this.connection.driver)){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" LIMIT -1 OFFSET "+e}else if(this.connection.driver.options.type==="oracle"){if(t&&e)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return" FETCH NEXT "+t+" ROWS ONLY";if(e)return" OFFSET "+e+" ROWS"}else{if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" OFFSET "+e}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const e=this.connection.driver;let t="";if(this.expressionMap.lockTables){if(!(me.isPostgresFamily(e)||e.options.type==="cockroachdb"))throw new L("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new L("lockTables cannot be an empty array");t=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(e.options.type==="mysql"||e.options.type==="aurora-mysql")return me.isReleaseVersionOrGreater(e,"8.0.0")?" FOR SHARE"+t+r:" LOCK IN SHARE MODE";if(e.options.type==="mariadb")return" LOCK IN SHARE MODE";if(me.isPostgresFamily(e))return" FOR SHARE"+t+r;if(e.options.type==="oracle")return" FOR UPDATE";if(e.options.type==="mssql")return"";throw new Cs;case"pessimistic_write":if(me.isMySQLFamily(e)||e.options.type==="aurora-mysql"||e.options.type==="oracle")return" FOR UPDATE"+r;if(me.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR UPDATE"+t+r;if(e.options.type==="mssql")return"";throw new Cs;case"pessimistic_partial_write":if(me.isPostgresFamily(e))return" FOR UPDATE"+t+" SKIP LOCKED";if(me.isMySQLFamily(e))return" FOR UPDATE SKIP LOCKED";throw new Cs;case"pessimistic_write_or_fail":if(me.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR UPDATE"+t+" NOWAIT";if(me.isMySQLFamily(e))return" FOR UPDATE NOWAIT";throw new Cs;case"for_no_key_update":if(me.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+t+r;throw new Cs;case"for_key_share":if(me.isPostgresFamily(e))return" FOR KEY SHARE"+t+r;throw new Cs;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const e=this.expressionMap.havings.map((t,r)=>{switch(t.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(t.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(t.condition);default:return this.replacePropertyNames(t.condition)}}).join(" ");return e.length?" HAVING "+e:""}buildEscapedEntityColumnSelects(e,t){const r=this.expressionMap.selects.some(u=>u.selection===e),i=[];if(r&&i.push(...t.columns.filter(u=>u.isSelect===!0)),i.push(...t.columns.filter(u=>this.expressionMap.selects.some(c=>c.selection===e+"."+u.propertyPath))),i.length===0)return[];const a=this.expressionMap.queryEntity?t.primaryColumns.filter(u=>i.indexOf(u)===-1):[],s=[...i,...a],o=[],l=this.escape(e);return s.forEach(u=>{let c=l+"."+this.escape(u.databaseName);u.isVirtualProperty&&u.query&&(c=`(${u.query(l)})`),this.connection.driver.spatialTypes.indexOf(u.type)!==-1&&((me.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(c=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${c})`),me.isPostgresFamily(this.connection.driver)&&(u.precision?c=`ST_AsGeoJSON(${c}, ${u.precision})::json`:c=`ST_AsGeoJSON(${c})::json`),this.connection.driver.options.type==="mssql"&&(c=`${c}.ToString()`));const d=this.expressionMap.selects.filter(h=>h.selection===e+"."+u.propertyPath);d.length?d.forEach(h=>{o.push({selection:c,aliasName:h.aliasName?h.aliasName:me.buildAlias(this.connection.driver,void 0,e,u.databaseName),virtual:h.virtual})}):o.push({selection:c,aliasName:me.buildAlias(this.connection.driver,void 0,e,u.databaseName),virtual:r})}),o}findEntityColumnSelects(e,t){const r=this.expressionMap.selects.find(i=>i.selection===e);return r?[r]:this.expressionMap.selects.filter(i=>t.columns.some(a=>i.selection===e+"."+a.propertyPath))}computeCountExpression(){const e=this.expressionMap.mainAlias.name,r=this.expressionMap.mainAlias.metadata.primaryColumns,i=this.escape(e);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||me.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+r.map(a=>`${i}.${this.escape(a.databaseName)}`).join(", ")+"))";if(me.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+r.map(a=>`${i}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=r.map(s=>`${i}.${this.escape(s.databaseName)}`).join(", '|;|', ");return r.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?r.length===1?`COUNT(DISTINCT(${i}.${this.escape(r[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${r.map(s=>`CAST(${i}.${this.escape(s.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+r.map(a=>`${i}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(e){const t=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(t,"cnt").setOption("disable-global-order").loadRawResults(e);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(e){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(e)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const e=Array.isArray(this.findOptions.select)?be.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(e,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const e=Array.isArray(this.findOptions.relations)?be.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(e,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(e,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(e=>{e.select&&!e.selection?e.type==="inner"?this.innerJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):e.type==="inner"?this.innerJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(e=>{this.leftJoin(this.findOptions.join.leftJoin[e],e)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(e=>{this.innerJoin(this.findOptions.join.innerJoin[e],e)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(e=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[e],e)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(e=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[e],e)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const e=this.findOptions.lock.tables?this.findOptions.lock.tables.map(t=>{const r=this.expressionMap.aliases.find(i=>i.metadata.tableNameWithoutPrefix===t);if(!r)throw new L(`"${t}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,e),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&ln.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(e){this.relationMetadatas.push(e)}async executeEntitiesAndRawResults(e){if(!this.expressionMap.mainAlias)throw new L('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!e.isTransactionActive)throw new V_;if(this.expressionMap.lockMode==="optimistic"){const l=this.expressionMap.mainAlias.metadata;if(!l.versionColumn&&!l.updateDateColumn)throw new U_(l.name)}const t=new NP(this.connection,e,this.expressionMap.relationIdAttributes),r=new SP(this.connection,e,this.expressionMap.relationCountAttributes);new CP(this.expressionMap).transform(),new AP(this.expressionMap).transform();let s=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[l,u]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,d=this.expressionMap.mainAlias.name,h=c.primaryColumns.map(E=>{const A=this.escape("distinctAlias"),b=this.escape(me.buildAlias(this.connection.driver,void 0,d,E.databaseName));u[b]||(u[b]="ASC");const T=me.buildAlias(this.connection.driver,void 0,"ids_"+d,E.databaseName);return`${A}.${b} AS ${this.escape(T)}`}),p=this.clone(),g=p.expressionMap.timeTravel;if(s=await new vd(this.connection,e).select(`DISTINCT ${h.join(", ")}`).addSelect(l).from(`(${p.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(g).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(u).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),s.length>0){let E="";const A={};if(c.hasMultiplePrimaryKeys)E=s.map((b,T)=>c.primaryColumns.map(C=>{const P=`orm_distinct_ids_${T}_${C.databaseName}`,D=me.buildAlias(this.connection.driver,void 0,"ids_"+d,C.databaseName);return A[P]=b[D],`${d}.${C.propertyPath}=:${P}`}).join(" AND ")).join(" OR ");else{const b=me.buildAlias(this.connection.driver,void 0,"ids_"+d,c.primaryColumns[0].databaseName),T=s.map(P=>P[b]);T.every(P=>typeof P=="number")?E=`${d}.${c.primaryColumns[0].propertyPath} IN (${T.join(", ")})`:(A.orm_distinct_ids=T,E=d+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}s=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:E}).setParameters(A).loadRawResults(e)}}else s=await this.loadRawResults(e);if(s.length>0){const l=await t.load(s),u=await r.load(s);o=new bP(this.expressionMap,this.connection.driver,l,u,this.queryRunner).transform(s,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await e.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const l=new Wb(this.connection,e);await Promise.all(this.relationMetadatas.map(async u=>{const c=u.inverseEntityMetadata.target,d=u.inverseEntityMetadata.targetName,h=Array.isArray(this.findOptions.select)?be.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,p=Array.isArray(this.findOptions.relations)?be.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,g=this.createQueryBuilder().select(d).from(c,d).setFindOptions({select:h?be.deepValue(h,u.propertyPath):void 0,order:this.findOptions.order?be.deepValue(this.findOptions.order,u.propertyPath):void 0,relations:p?be.deepValue(p,u.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const E=await l.loadManyToManyRelationIdsAndGroup(u,o,void 0,g);o.forEach(A=>{const b=E.find(T=>T.entity===A);if(b){const T=b.related===void 0?null:b.related;u.setEntityValue(A,T)}})}}))}return{raw:s,entities:o}}createOrderByCombinedWithSelectExpression(e){const t=this.expressionMap.allOrderBys,r=Object.keys(t).map(a=>{if(a.indexOf(".")!==-1){const s=a.split("."),o=s[0],l=s.slice(1).join("."),c=this.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyPath(l);return this.escape(e)+"."+this.escape(me.buildAlias(this.connection.driver,void 0,o,c.databaseName))}else return this.expressionMap.selects.find(s=>s.selection===a||s.aliasName===a)?this.escape(e)+"."+this.escape(a):""}).join(", "),i={};return Object.keys(t).forEach(a=>{if(a.indexOf(".")!==-1){const s=a.split("."),o=s[0],l=s.slice(1).join("."),c=this.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyPath(l);i[this.escape(e)+"."+this.escape(me.buildAlias(this.connection.driver,void 0,o,c.databaseName))]=t[a]}else this.expressionMap.selects.find(s=>s.selection===a||s.aliasName===a)?i[this.escape(e)+"."+this.escape(a)]=t[a]:i[a]=t[a]}),[r,i]}async loadRawResults(e){const[t,r]=this.getQueryAndParameters(),i=t+" -- PARAMETERS: "+JSON.stringify(r),a=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let s;const o=a.alwaysEnabled&&this.expressionMap.cache||this.expressionMap.cache;let l=!1;if(this.connection.queryResultCache&&o)try{if(s=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:i,duration:this.expressionMap.cacheDuration||a.duration||1e3},e),s&&!this.connection.queryResultCache.isExpired(s))return JSON.parse(s.result)}catch(c){if(!a.ignoreErrors)throw c;l=!0}const u=await e.query(t,r,!0);if(!l&&this.connection.queryResultCache&&o)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:i,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||a.duration||1e3,result:JSON.stringify(u.records)},s,e)}catch(c){if(!a.ignoreErrors)throw c}return u.records}mergeExpressionMap(e){return Ue.assign(this.expressionMap,e),this}normalizeNumber(e){return typeof e=="number"||e===void 0||e===null?e:Number(e)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner("slave")}buildSelect(e,t,r,i){for(let a in e){if(e[a]===void 0||e[a]===!1)continue;const s=i?i+"."+a:a,o=t.findColumnWithPropertyPathStrict(s),l=t.findEmbeddedWithPropertyPath(s),u=t.findRelationWithPropertyPath(s);if(!l&&!o&&!u)throw new Qr(s,t);o?this.selects.push(r+"."+s):l&&this.buildSelect(e[a],t,r,s)}}buildRelations(e,t,r,i,a){e&&Object.keys(e).forEach(s=>{const o=e[s],l=a?a+"."+s:s,u=r.findEmbeddedWithPropertyPath(l),c=r.findRelationWithPropertyPath(l);if(!u&&!c)throw new Qr(l,r);if(u)this.buildRelations(o,typeof t=="object"?be.deepValue(t,u.propertyPath):void 0,r,i,l);else if(c){let d=i+"_"+l.replace(".","_");d=me.buildAlias(this.connection.driver,{joiner:"__"},i,d),(o===!0||typeof o=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(c):(this.joins.push({type:"left",select:!0,selection:t&&typeof t[s]=="object"?t[s]:void 0,alias:d,parentAlias:i,relationMetadata:c}),t&&typeof t[s]=="object"&&this.buildSelect(t[s],c.inverseEntityMetadata,d))),typeof o=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(o,typeof t=="object"?be.deepValue(t,c.propertyPath):void 0,c.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(e,t,r,i,a){e&&Object.keys(e).forEach(s=>{const o=e[s],l=a?a+"."+s:s,u=r.findEmbeddedWithPropertyPath(l),c=r.findRelationWithPropertyPath(l);if(!u&&!c)throw new Qr(l,r);if(u)this.buildEagerRelations(o,typeof t=="object"?be.deepValue(t,u.propertyPath):void 0,r,i,l);else if(c){let d=i+"_"+l.replace(".","_");d=me.buildAlias(this.connection.driver,{joiner:"__"},i,d),(o===!0||typeof o=="object")&&c.inverseEntityMetadata.eagerRelations.forEach(h=>{let p=d+"_"+h.propertyPath.replace(".","_");p=me.buildAlias(this.connection.driver,{joiner:"__"},d,p),this.joins.find(E=>E.alias===p)||this.joins.push({type:"left",select:!0,alias:p,parentAlias:d,selection:void 0,relationMetadata:h}),t&&typeof t[s]=="object"&&this.buildSelect(t[s],c.inverseEntityMetadata,d)}),typeof o=="object"&&this.buildEagerRelations(o,typeof t=="object"?be.deepValue(t,c.propertyPath):void 0,c.inverseEntityMetadata,d,void 0)}})}buildOrder(e,t,r,i){for(let a in e){if(e[a]===void 0)continue;const s=i?i+"."+a:a,o=t.findColumnWithPropertyPathStrict(s),l=t.findEmbeddedWithPropertyPath(s),u=t.findRelationWithPropertyPath(s);if(!l&&!o&&!u)throw new Qr(s,t);if(o){let c=typeof e[a]=="object"?e[a].direction:e[a];c=c==="DESC"||c==="desc"||c===-1?"DESC":"ASC";let d=typeof e[a]=="object"?e[a].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let h=`${r}.${s}`;this.addOrderBy(h,c,d)}else if(l)this.buildOrder(e[a],t,r,s);else if(u){let c=r+"_"+s.replace(".","_");c=me.buildAlias(this.connection.driver,{joiner:"__"},r,c),this.joins.find(h=>h.alias===c)||this.joins.push({type:"left",select:!1,alias:c,parentAlias:r,selection:void 0,relationMetadata:u}),this.buildOrder(e[a],u.inverseEntityMetadata,c)}}}buildWhere(e,t,r,i){let a="";if(Array.isArray(e)&&e.length)a="("+e.map(s=>this.buildWhere(s,t,r,i)).filter(s=>!!s).map(s=>"("+s+")").join(" OR ")+")";else{let s=[];for(let o in e){if(e[o]===void 0||e[o]===null)continue;const l=i?i+"."+o:o,u=t.findColumnWithPropertyPathStrict(l),c=t.findEmbeddedWithPropertyPath(l),d=t.findRelationWithPropertyPath(l);if(!c&&!u&&!d)throw new Qr(l,t);if(u){let h=`${r}.${l}`;u.isVirtualProperty&&u.query&&(h=`(${u.query(r)})`);let p=e[o];U.isEqualOperator(e[o])&&(p=e[o].value),u.transformer&&(p instanceof Su?p.transformValue(u.transformer):p=Ft.transformTo(u.transformer,p)),s.push(this.createWhereConditionExpression(this.getWherePredicateCondition(h,p)))}else if(c){const h=this.buildWhere(e[o],t,r,l);h&&s.push(h)}else if(d){if(typeof e[o]=="object"&&Object.keys(e[o]).every(p=>e[o][p]===void 0))continue;if(U.isFindOperator(e[o]))if(e[o].type==="moreThan"||e[o].type==="lessThan"||e[o].type==="moreThanOrEqual"||e[o].type==="lessThanOrEqual"){let h="";e[o].type==="moreThan"?h=">":e[o].type==="lessThan"?h="<":e[o].type==="moreThanOrEqual"?h=">=":e[o].type==="lessThanOrEqual"&&(h="<=");const p=this.subQuery();if(d.isManyToManyOwner)p.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(g=>`${d.joinTableName}.${g.propertyName} = ${r}.${g.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)p.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(g=>`${d.inverseRelation.joinTableName}.${g.propertyName} = ${r}.${g.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)p.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(g=>`${d.inverseEntityMetadata.tableName}.${g.propertyName} = ${r}.${g.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(p.getSql()+" "+h+" "+parseInt(e[o].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const h=`${r}.${l}`;s.push(this.createWhereConditionExpression(this.getWherePredicateCondition(h,e[o])))}else throw new Error("This relation isn't supported by given find operator");else{let h=r+"_"+d.propertyPath.replace(".","_");h=me.buildAlias(this.connection.driver,{joiner:"__"},r,h),this.joins.find(E=>E.alias===h)||this.joins.push({type:"left",select:!1,selection:void 0,alias:h,parentAlias:r,relationMetadata:d});const g=this.buildWhere(e[o],d.inverseEntityMetadata,h);g&&s.push(g)}}}a=s.join(" AND ")}return a}}class ry{constructor(e){this.options=e}logQuery(e,t,r){this.isLogEnabledFor("query")&&this.writeLog("query",{type:"query",prefix:"query",message:e,format:"sql",parameters:t},r)}logQueryError(e,t,r,i){this.isLogEnabledFor("query-error")&&this.writeLog("warn",[{type:"query-error",prefix:"query failed",message:t,format:"sql",parameters:r},{type:"query-error",prefix:"error",message:e}],i)}logQuerySlow(e,t,r,i){this.isLogEnabledFor("query-slow")&&this.writeLog("warn",[{type:"query-slow",prefix:"query is slow",message:t,format:"sql",parameters:r,additionalInfo:{time:e}},{type:"query-slow",prefix:"execution time",message:e}],i)}logSchemaBuild(e,t){this.isLogEnabledFor("schema-build")&&this.writeLog("schema",{type:"schema-build",message:e},t)}logMigration(e,t){this.isLogEnabledFor("migration")||this.writeLog("log",{type:"migration",message:e},t)}log(e,t,r){switch(e){case"log":if(!this.isLogEnabledFor("log"))return;this.writeLog("log",{type:"log",message:t},r);break;case"info":if(!this.isLogEnabledFor("info"))return;this.writeLog("info",{type:"info",prefix:"info",message:t},r);break;case"warn":if(!this.isLogEnabledFor("warn"))return;this.writeLog("warn",{type:"warn",message:t},r);break}}isLogEnabledFor(e){switch(e){case"query":return this.options==="all"||this.options===!0||Array.isArray(this.options)&&this.options.indexOf("query")!==-1;case"error":case"query-error":return this.options==="all"||this.options===!0||Array.isArray(this.options)&&this.options.indexOf("error")!==-1;case"query-slow":return!0;case"schema":case"schema-build":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("schema")!==-1;case"migration":return!0;case"log":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("log")!==-1;case"info":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("info")!==-1;case"warn":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("warn")!==-1;default:return!1}}prepareLogMessages(e,t){t={addColonToPrefix:!0,appendParameterAsComment:!0,highlightSql:!0,...t};const r=Array.isArray(e)?e:[e];for(let i of r){if(typeof i!="object"&&(i={message:i}),i.format==="sql"){let a=String(i.message);t.appendParameterAsComment&&i.parameters&&i.parameters.length&&(a+=` -- PARAMETERS: ${this.stringifyParams(i.parameters)}`),t.highlightSql&&(a=ft.highlightSql(a)),i.message=a}t.addColonToPrefix&&i.prefix&&(i.prefix+=":")}return r}stringifyParams(e){try{return JSON.stringify(e)}catch{return e}}}class MP extends ry{writeLog(e,t,r){var i;const a=this.prepareLogMessages(t,{highlightSql:!1});for(let s of a)switch((i=s.type)!==null&&i!==void 0?i:e){case"log":case"schema-build":case"migration":console.log(s.message);break;case"info":case"query":s.prefix?console.info(s.prefix,s.message):console.info(s.message);break;case"warn":case"query-slow":s.prefix?console.warn(s.prefix,s.message):console.warn(s.message);break;case"error":case"query-error":s.prefix?console.error(s.prefix,s.message):console.error(s.message);break}}}class AE extends ry{writeLog(e,t,r){var i;const a=this.prepareLogMessages(t);for(let s of a)switch((i=s.type)!==null&&i!==void 0?i:e){case"log":case"schema-build":case"migration":ft.log(String(s.message));break;case"info":case"query":s.prefix?ft.logInfo(s.prefix,s.message):ft.log(String(s.message));break;case"warn":case"query-slow":s.prefix?ft.logWarn(s.prefix,s.message):console.warn(ft.warn(String(s.message)));break;case"error":case"query-error":s.prefix?ft.logError(s.prefix,String(s.message)):console.error(ft.error(String(s.message)));break}}}class OP{logQuery(){throw new Error("This logger is not applicable in a browser context")}logQueryError(){throw new Error("This logger is not applicable in a browser context")}logQuerySlow(){throw new Error("This logger is not applicable in a browser context")}logSchemaBuild(){throw new Error("This logger is not applicable in a browser context")}logMigration(){throw new Error("This logger is not applicable in a browser context")}log(){throw new Error("This logger is not applicable in a browser context")}}class IP extends OP{}var Lp={exports:{}},Tf,RE;function DP(){if(RE)return Tf;RE=1;var n=1e3,e=n*60,t=e*60,r=t*24,i=r*7,a=r*365.25;Tf=function(c,d){d=d||{};var h=typeof c;if(h==="string"&&c.length>0)return s(c);if(h==="number"&&isFinite(c))return d.long?l(c):o(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function s(c){if(c=String(c),!(c.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(d){var h=parseFloat(d[1]),p=(d[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return h*a;case"weeks":case"week":case"w":return h*i;case"days":case"day":case"d":return h*r;case"hours":case"hour":case"hrs":case"hr":case"h":return h*t;case"minutes":case"minute":case"mins":case"min":case"m":return h*e;case"seconds":case"second":case"secs":case"sec":case"s":return h*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function o(c){var d=Math.abs(c);return d>=r?Math.round(c/r)+"d":d>=t?Math.round(c/t)+"h":d>=e?Math.round(c/e)+"m":d>=n?Math.round(c/n)+"s":c+"ms"}function l(c){var d=Math.abs(c);return d>=r?u(c,d,r,"day"):d>=t?u(c,d,t,"hour"):d>=e?u(c,d,e,"minute"):d>=n?u(c,d,n,"second"):c+" ms"}function u(c,d,h,p){var g=d>=h*1.5;return Math.round(c/h)+" "+p+(g?"s":"")}return Tf}function $P(n){t.debug=t,t.default=t,t.coerce=l,t.disable=a,t.enable=i,t.enabled=s,t.humanize=DP(),t.destroy=u,Object.keys(n).forEach(c=>{t[c]=n[c]}),t.names=[],t.skips=[],t.formatters={};function e(c){let d=0;for(let h=0;h<c.length;h++)d=(d<<5)-d+c.charCodeAt(h),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(c){let d,h=null,p,g;function E(...A){if(!E.enabled)return;const b=E,T=Number(new Date),C=T-(d||T);b.diff=C,b.prev=d,b.curr=T,d=T,A[0]=t.coerce(A[0]),typeof A[0]!="string"&&A.unshift("%O");let P=0;A[0]=A[0].replace(/%([a-zA-Z%])/g,(F,Q)=>{if(F==="%%")return"%";P++;const W=t.formatters[Q];if(typeof W=="function"){const B=A[P];F=W.call(b,B),A.splice(P,1),P--}return F}),t.formatArgs.call(b,A),(b.log||t.log).apply(b,A)}return E.namespace=c,E.useColors=t.useColors(),E.color=t.selectColor(c),E.extend=r,E.destroy=t.destroy,Object.defineProperty(E,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==t.namespaces&&(p=t.namespaces,g=t.enabled(c)),g),set:A=>{h=A}}),typeof t.init=="function"&&t.init(E),E}function r(c,d){const h=t(this.namespace+(typeof d>"u"?":":d)+c);return h.log=this.log,h}function i(c){t.save(c),t.namespaces=c,t.names=[],t.skips=[];let d;const h=(typeof c=="string"?c:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)h[d]&&(c=h[d].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^"+c.slice(1)+"$")):t.names.push(new RegExp("^"+c+"$")))}function a(){const c=[...t.names.map(o),...t.skips.map(o).map(d=>"-"+d)].join(",");return t.enable(""),c}function s(c){if(c[c.length-1]==="*")return!0;let d,h;for(d=0,h=t.skips.length;d<h;d++)if(t.skips[d].test(c))return!1;for(d=0,h=t.names.length;d<h;d++)if(t.names[d].test(c))return!0;return!1}function o(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var LP=$P;(function(n,e){var t={};e.formatArgs=i,e.save=a,e.load=s,e.useColors=r,e.storage=o(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;u.splice(1,0,c,"color: inherit");let d=0,h=0;u[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(h=d))}),u.splice(h,0,c)}e.log=console.debug||console.log||(()=>{});function a(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function s(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=t.DEBUG),u}function o(){try{return localStorage}catch{}}n.exports=LP(e);const{formatters:l}=n.exports;l.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(Lp,Lp.exports);var oi=Lp.exports;class qP extends ry{constructor(){super(...arguments),this.logger={log:oi.debug("typeorm:log"),info:oi.debug("typeorm:info"),warn:oi.debug("typeorm:warn"),error:oi.debug("typeorm:error"),query:oi.debug("typeorm:query:log"),"query-error":oi.debug("typeorm:query:error"),"query-slow":oi.debug("typeorm:query:slow"),"schema-build":oi.debug("typeorm:schema"),migration:oi.debug("typeorm:migration")}}isLogEnabledFor(e){switch(e){case"query":return this.logger.query.enabled;case"query-error":return this.logger["query-error"].enabled;case"query-slow":return!0;case"schema":case"schema-build":return this.logger["schema-build"].enabled;case"migration":return this.logger.migration.enabled;case"log":return this.logger.log.enabled;case"info":return this.logger.info.enabled;case"warn":return this.logger.warn.enabled;default:return!1}}writeLog(e,t,r){var i;const a=this.prepareLogMessages(t,{appendParameterAsComment:!1});for(let s of a){const o=(i=s.type)!==null&&i!==void 0?i:e;o in this.logger&&(s.prefix?this.logger[o](s.prefix,s.message):this.logger[o](s.message),s.parameters&&s.parameters.length&&this.logger[o]("parameters:",s.parameters))}}}class xE{create(e,t){if(Ue.isObject(e))return e;if(e)switch(e){case"simple-console":return new MP(t);case"file":return new IP(t);case"advanced-console":return new AE(t);case"debug":return new qP}return new AE(t)}}class BP{constructor(e,t){this.connection=e,this.clientType=t,this.redis=this.loadRedis()}async connect(){const e=this.connection.options.cache;if(this.clientType==="redis")this.client=this.redis.createClient({...e==null?void 0:e.options,legacyMode:!0}),typeof this.connection.options.cache=="object"&&this.connection.options.cache.ignoreErrors&&this.client.on("error",t=>{this.connection.logger.log("warn",t)}),"connect"in this.client&&await this.client.connect();else if(this.clientType==="ioredis")e&&e.port?e.options?this.client=new this.redis(e.port,e.options):this.client=new this.redis(e.port):e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if(this.clientType==="ioredis/cluster")if(e&&e.options&&Array.isArray(e.options))this.client=new this.redis.Cluster(e.options);else if(e&&e.options&&e.options.startupNodes)this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options);else throw new L(`options.startupNodes required for ${this.clientType}.`)}async disconnect(){return new Promise((e,t)=>{this.client.quit((r,i)=>{if(r)return t(r);e(),this.client=void 0})})}async synchronize(e){}getFromCache(e,t){return new Promise((r,i)=>{e.identifier?this.client.get(e.identifier,(a,s)=>{if(a)return i(a);r(JSON.parse(s))}):e.query?this.client.get(e.query,(a,s)=>{if(a)return i(a);r(JSON.parse(s))}):r(void 0)})}isExpired(e){return e.time+e.duration<new Date().getTime()}async storeInCache(e,t,r){return new Promise((i,a)=>{e.identifier?this.client.set(e.identifier,JSON.stringify(e),"PX",e.duration,(s,o)=>{if(s)return a(s);i()}):e.query&&this.client.set(e.query,JSON.stringify(e),"PX",e.duration,(s,o)=>{if(s)return a(s);i()})})}async clear(e){return new Promise((t,r)=>{this.client.flushdb((i,a)=>{if(i)return r(i);t()})})}async remove(e,t){await Promise.all(e.map(r=>this.deleteKey(r)))}deleteKey(e){return new Promise((t,r)=>{this.client.del(e,(i,a)=>{if(i)return r(i);t()})})}loadRedis(){try{return this.clientType==="ioredis/cluster"?ft.load("ioredis"):ft.load(this.clientType)}catch{throw new L(`Cannot use cache because ${this.clientType} is not installed. Please run "npm i ${this.clientType} --save".`)}}}let wc;const FP=new Uint8Array(16);function kP(){if(!wc&&(wc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!wc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return wc(FP)}const Jt=[];for(let n=0;n<256;++n)Jt.push((n+256).toString(16).slice(1));function UP(n,e=0){return Jt[n[e+0]]+Jt[n[e+1]]+Jt[n[e+2]]+Jt[n[e+3]]+"-"+Jt[n[e+4]]+Jt[n[e+5]]+"-"+Jt[n[e+6]]+Jt[n[e+7]]+"-"+Jt[n[e+8]]+Jt[n[e+9]]+"-"+Jt[n[e+10]]+Jt[n[e+11]]+Jt[n[e+12]]+Jt[n[e+13]]+Jt[n[e+14]]+Jt[n[e+15]]}const jP=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_E={randomUUID:jP};function QP(n,e,t){if(_E.randomUUID&&!e&&!n)return _E.randomUUID();n=n||{};const r=n.random||(n.rng||kP)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let i=0;i<16;++i)e[t+i]=r[i];return e}return UP(r)}class VP{constructor(e){this.connection=e;const{schema:t}=this.connection.driver.options,r=this.connection.driver.database,a=(typeof this.connection.options.cache=="object"?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheDatabase=r,this.queryResultCacheSchema=t,this.queryResultCacheTable=this.connection.driver.buildTableName(a,t,r)}async connect(){}async disconnect(){}async synchronize(e){e=this.getQueryRunner(e);const t=this.connection.driver;await e.hasTable(this.queryResultCacheTable)||await e.createTable(new xt({database:this.queryResultCacheDatabase,schema:this.queryResultCacheSchema,name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:t.normalizeType({type:t.mappedDataTypes.cacheId}),generationStrategy:t.options.type==="spanner"?"uuid":"increment",isGenerated:!0},{name:"identifier",type:t.normalizeType({type:t.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:t.normalizeType({type:t.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:t.normalizeType({type:t.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:t.normalizeType({type:t.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:t.normalizeType({type:t.mappedDataTypes.cacheResult}),isNullable:!1}]}))}getFromCache(e,t){t=this.getQueryRunner(t);const r=this.connection.createQueryBuilder(t).select().from(this.queryResultCacheTable,"cache");return e.identifier?r.where(`${r.escape("cache")}.${r.escape("identifier")} = :identifier`).setParameters({identifier:this.connection.driver.options.type==="mssql"?new Cr(e.identifier,"nvarchar"):e.identifier}).getRawOne():e.query?this.connection.driver.options.type==="oracle"?r.where(`dbms_lob.compare(${r.escape("cache")}.${r.escape("query")}, :query) = 0`,{query:e.query}).getRawOne():r.where(`${r.escape("cache")}.${r.escape("query")} = :query`).setParameters({query:this.connection.driver.options.type==="mssql"?new Cr(e.query,"nvarchar"):e.query}).getRawOne():Promise.resolve(void 0)}isExpired(e){const t=typeof e.duration=="string"?parseInt(e.duration):e.duration;return(typeof e.time=="string"?parseInt(e.time):e.time)+t<new Date().getTime()}async storeInCache(e,t,r){const i=r===void 0||(r==null?void 0:r.getReplicationMode())==="slave";(r===void 0||i)&&(r=this.connection.createQueryRunner("master"));let a=e;if(this.connection.driver.options.type==="mssql"&&(a={identifier:new Cr(e.identifier,"nvarchar"),time:new Cr(e.time,"bigint"),duration:new Cr(e.duration,"int"),query:new Cr(e.query,"nvarchar"),result:new Cr(e.result,"nvarchar")}),t&&t.identifier){const s=r.manager.createQueryBuilder().update(this.queryResultCacheTable).set(a);s.where(`${s.escape("identifier")} = :condition`,{condition:a.identifier}),await s.execute()}else if(t&&t.query){const s=r.manager.createQueryBuilder().update(this.queryResultCacheTable).set(a);this.connection.driver.options.type==="oracle"?s.where('dbms_lob.compare("query", :condition) = 0',{condition:a.query}):s.where(`${s.escape("query")} = :condition`,{condition:a.query}),await s.execute()}else this.connection.driver.options.type==="spanner"&&!a.id&&(a.id=QP()),await r.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(a).execute();i&&await r.release()}async clear(e){return this.getQueryRunner(e).clearTable(this.queryResultCacheTable)}async remove(e,t){let r=t||this.getQueryRunner();await Promise.all(e.map(i=>{const a=r.manager.createQueryBuilder();return a.delete().from(this.queryResultCacheTable).where(`${a.escape("identifier")} = :identifier`,{identifier:i}).execute()})),t||await r.release()}getQueryRunner(e){return e||this.connection.createQueryRunner()}}class PE{constructor(e){this.connection=e}create(){if(!this.connection.options.cache)throw new L("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");const e=this.connection.options.cache;return e.provider&&typeof e.provider=="function"?e.provider(this.connection):e.type==="redis"||e.type==="ioredis"||e.type==="ioredis/cluster"?new BP(this.connection,e.type):new VP(this.connection)}}class zP{constructor(e){this.connection=e}load(e,t,r,i){return r&&r.isReleased&&(r=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,t,r,i):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,t,r,i):e.isManyToManyOwner?this.loadManyToManyOwner(e,t,r,i):this.loadManyToManyNotOwner(e,t,r,i)}loadManyToOneOrOneToOneOwner(e,t,r,i){const a=Array.isArray(t)?t:[t],s=e.entityMetadata.name,o=i||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.type,e.propertyName),l=o.expressionMap.mainAlias.name,u=e.entityMetadata.primaryColumns,d=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map(h=>`${e.entityMetadata.name}.${h.propertyName} = ${l}.${h.referencedColumn.propertyName}`).join(" AND ");if(o.innerJoin(e.entityMetadata.target,s,d),u.length===1)o.where(`${s}.${u[0].propertyPath} IN (:...${s+"_"+u[0].propertyName})`),o.setParameter(s+"_"+u[0].propertyName,a.map(h=>u[0].getEntityValue(h,!0)));else{const h=a.map((p,g)=>u.map((E,A)=>{const b=s+"_entity_"+g+"_"+A;return o.setParameter(b,E.getEntityValue(p,!0)),s+"."+E.propertyPath+" = :"+b}).join(" AND ")).map(p=>"("+p+")").join(" OR ");o.where(h)}return ln.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadOneToManyOrOneToOneNotOwner(e,t,r,i){const a=Array.isArray(t)?t:[t],s=e.inverseRelation.joinColumns,o=i||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.inverseRelation.entityMetadata.target,e.propertyName),l=o.expressionMap.mainAlias.name;if(s.length===1)o.where(`${l}.${s[0].propertyPath} IN (:...${l+"_"+s[0].propertyName})`),o.setParameter(l+"_"+s[0].propertyName,a.map(u=>s[0].referencedColumn.getEntityValue(u,!0)));else{const u=a.map((c,d)=>s.map((h,p)=>{const g=l+"_entity_"+d+"_"+p;return o.setParameter(g,h.referencedColumn.getEntityValue(c,!0)),l+"."+h.propertyPath+" = :"+g}).join(" AND ")).map(c=>"("+c+")").join(" OR ");o.where(u)}return ln.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadManyToManyOwner(e,t,r,i){const a=Array.isArray(t)?t:[t],s=e.joinColumns.reduce((h,p)=>(h[p.propertyName]=a.map(g=>p.referencedColumn.getEntityValue(g,!0)),h),{}),o=i||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.type,e.propertyName),l=o.expressionMap.mainAlias.name,u=e.junctionEntityMetadata.tableName,c=e.joinColumns.map(h=>`${u}.${h.propertyName} IN (:...${h.propertyName})`),d=e.inverseJoinColumns.map(h=>`${u}.${h.propertyName}=${l}.${h.referencedColumn.propertyName}`);return o.innerJoin(u,u,[...c,...d].join(" AND ")).setParameters(s),ln.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadManyToManyNotOwner(e,t,r,i){const a=Array.isArray(t)?t:[t],s=i||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.type,e.propertyName),o=s.expressionMap.mainAlias.name,l=e.junctionEntityMetadata.tableName,u=e.inverseRelation.joinColumns.map(h=>`${l}.${h.propertyName} = ${o}.${h.referencedColumn.propertyName}`),c=e.inverseRelation.inverseJoinColumns.map(h=>`${l}.${h.propertyName} IN (:...${h.propertyName})`),d=e.inverseRelation.inverseJoinColumns.reduce((h,p)=>(h[p.propertyName]=a.map(g=>p.referencedColumn.getEntityValue(g,!0)),h),{});return s.innerJoin(l,l,[...u,...c].join(" AND ")).setParameters(d),ln.joinEagerRelations(s,s.alias,s.expressionMap.mainAlias.metadata),s.getMany()}enableLazyLoad(e,t,r){const i=this,a="__"+e.propertyName+"__",s="__promise_"+e.propertyName+"__",o="__has_"+e.propertyName+"__",l=(c,d)=>(c[a]=d,c[o]=!0,delete c[s],d),u=(c,d)=>(delete c[o],delete c[a],c[s]=d,d.then(h=>c[s]===d?l(c,h):h),d);Object.defineProperty(t,e.propertyName,{get:function(){if(this[o]===!0||this[a]!==void 0)return Promise.resolve(this[a]);if(this[s])return this[s];const c=i.load(e,this,r).then(d=>e.isOneToOne||e.isManyToOne?d.length===0?null:d[0]:d);return u(this,c)},set:function(c){c instanceof Promise?u(this,c):l(this,c)},configurable:!0,enumerable:!1})}}class WP{constructor(e){this["@instanceof"]=Symbol.for("DataSource"),this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.entityMetadatasMap=new Map,this.name=e.name||"default",this.options=e,this.logger=new xE().create(this.options.logger,this.options.logging),this.driver=new hP().create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new __,this.metadataTableName=e.metadataTableName||"typeorm_metadata",this.queryResultCache=e.cache?new PE(this).create():void 0,this.relationLoader=new zP(this),this.relationIdLoader=new Wb(this),this.isInitialized=!1}get isConnected(){return this.isInitialized}get mongoManager(){if(!U.isMongoEntityManager(this.manager))throw new L("MongoEntityManager is only available for MongoDB databases.");return this.manager}get sqljsManager(){if(!U.isSqljsEntityManager(this.manager))throw new L("SqljsEntityManager is only available for Sqljs databases.");return this.manager}setOptions(e){return Object.assign(this.options,e),(e.logger||e.logging)&&(this.logger=new xE().create(e.logger||this.options.logger,e.logging||this.options.logging)),e.namingStrategy&&(this.namingStrategy=e.namingStrategy),e.cache&&(this.queryResultCache=new PE(this).create()),e.database&&(this.driver.database=me.buildDriverOptions(this.options).database),this}async initialize(){if(this.isInitialized)throw new P_(this.name);await this.driver.connect(),this.queryResultCache&&await this.queryResultCache.connect(),Ue.assign(this,{isInitialized:!0});try{await this.buildMetadatas(),await this.driver.afterConnect(),this.options.dropSchema&&await this.dropDatabase(),this.options.migrationsRun&&await this.runMigrations({transaction:this.options.migrationsTransactionMode}),this.options.synchronize&&await this.synchronize()}catch(e){throw await this.destroy(),e}return this}async connect(){return this.initialize()}async destroy(){if(!this.isInitialized)throw new Xo(this.name);await this.driver.disconnect(),this.queryResultCache&&await this.queryResultCache.disconnect(),Ue.assign(this,{isInitialized:!1})}async close(){return this.destroy()}async synchronize(e=!1){if(!this.isInitialized)throw new Xo(this.name);e&&await this.dropDatabase(),await this.driver.createSchemaBuilder().build()}async dropDatabase(){const e=this.createQueryRunner();try{if(this.driver.options.type==="mssql"||me.isMySQLFamily(this.driver)||this.driver.options.type==="aurora-mysql"||me.isSQLiteFamily(this.driver)){const t=[];if(this.entityMetadatas.forEach(r=>{r.database&&t.indexOf(r.database)===-1&&t.push(r.database)}),t.length===0&&this.driver.database&&t.push(this.driver.database),t.length===0)await e.clearDatabase();else for(const r of t)await e.clearDatabase(r)}else await e.clearDatabase()}finally{await e.release()}}async runMigrations(e){if(!this.isInitialized)throw new Xo(this.name);const t=new yf(this);return t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1,await t.executePendingMigrations()}async undoLastMigration(e){if(!this.isInitialized)throw new Xo(this.name);const t=new yf(this);t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1,await t.undoLastMigration()}async showMigrations(){if(!this.isInitialized)throw new Xo(this.name);return await new yf(this).showMigrations()}hasMetadata(e){return!!this.findMetadata(e)}getMetadata(e){const t=this.findMetadata(e);if(!t)throw new $_(e);return t}getRepository(e){return this.manager.getRepository(e)}getTreeRepository(e){return this.manager.getTreeRepository(e)}getMongoRepository(e){if(this.driver.options.type!=="mongodb")throw new L("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)}getCustomRepository(e){return this.manager.getCustomRepository(e)}async transaction(e,t){return this.manager.transaction(e,t)}async query(e,t,r){if(U.isMongoEntityManager(this.manager))throw new L("Queries aren't supported by MongoDB.");if(r&&r.isReleased)throw new Lb;const i=r||this.createQueryRunner();try{return await i.query(e,t)}finally{r||await i.release()}}createQueryBuilder(e,t,r){if(U.isMongoEntityManager(this.manager))throw new L("Query Builder is not supported by MongoDB.");if(t){t=me.buildAlias(this.driver,void 0,t);const i=this.getMetadata(e);return new vd(this,r).select(t).from(i.target,t)}else return new vd(this,e)}createQueryRunner(e="master"){const t=this.driver.createQueryRunner(e),r=this.createEntityManager(t);return Object.assign(t,{manager:r}),t}getManyToManyMetadata(e,t){const r=this.getMetadata(e).findRelationWithPropertyPath(t);if(!r)throw new L(`Relation "${t}" was not found in ${e} entity.`);if(!r.isManyToMany)throw new L(`Relation "${e}#${t}" does not have a many-to-many relationship.You can use this method only on many-to-many relations.`);return r.junctionEntityMetadata}createEntityManager(e){return new V1().create(this,e)}findMetadata(e){const t=this.entityMetadatasMap.get(e);if(t)return t;for(let[r,i]of this.entityMetadatasMap){if(U.isEntitySchema(e)&&i.name===e.options.name)return i;if(typeof e=="string"){if(e.indexOf(".")!==-1){if(i.tablePath===e)return i}else if(i.name===e||i.tableName===e)return i}if(Ue.isObjectWithName(e)&&typeof e.name=="string"){if(e.name.indexOf(".")!==-1){if(i.tablePath===e.name)return i}else if(i.name===e.name||i.tableName===e.name)return i}}}async buildMetadatas(){const e=new TP(this),t=new Z_,r=Ue.mixedListToArray(this.options.subscribers||[]),i=await e.buildSubscribers(r);Ue.assign(this,{subscribers:i});const a=Ue.mixedListToArray(this.options.entities||[]),s=await e.buildEntityMetadatas(a);Ue.assign(this,{entityMetadatas:s,entityMetadatasMap:new Map(s.map(u=>[u.target,u]))});const o=Ue.mixedListToArray(this.options.migrations||[]),l=await e.buildMigrations(o);Ue.assign(this,{migrations:l}),t.validateMany(this.entityMetadatas.filter(u=>u.tableType!=="view"),this.driver);for(let u of s)U.isBaseEntityConstructor(u.target)&&u.target.useDataSource(this)}}function Wt(){const n=ft.getGlobalVariable();return n.typeormMetadataArgsStorage||(n.typeormMetadataArgsStorage=new Nb),n.typeormMetadataArgsStorage}function Et(n,e){return function(t,r){let i;typeof n=="string"||typeof n=="function"?i=n:n&&(e=n,i=n.type),e||(e={});const a=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,r):void 0;if(!i&&a&&(i=a),!e.type&&i&&(e.type=i),e.type==="hstore"&&!e.hstoreType&&(e.hstoreType=a===Object?"object":"string"),typeof n=="function")Wt().embeddeds.push({target:t.constructor,propertyName:r,isArray:a===Array||e.array===!0,prefix:e.prefix!==void 0?e.prefix:void 0,type:n});else{if(!e.type)throw new qb(t,r);e.unique===!0&&Wt().uniques.push({target:t.constructor,columns:[r]}),Wt().columns.push({target:t.constructor,propertyName:r,mode:"regular",options:e}),e.generated&&Wt().generations.push({target:t.constructor,propertyName:r,strategy:typeof e.generated=="string"?e.generated:"increment"})}}}function Lr(n,e){const t={};let r;return n?(typeof n=="string"&&(r=n),Ue.isObject(n)&&(r="increment",Object.assign(t,n))):r="increment",Ue.isObject(e)&&Object.assign(t,e),function(i,a){t.type||(r==="increment"||r==="identity"?t.type=Number:r==="uuid"?t.type="uuid":r==="rowid"&&(t.type="int")),t.primary=!0,Wt().columns.push({target:i.constructor,propertyName:a,mode:"regular",options:t}),Wt().generations.push({target:i.constructor,propertyName:a,strategy:r})}}function Li(n,e){return function(t,r){let i;if(typeof n=="string"?i=n:(e=n,i=e.type),!(e!=null&&e.query))throw new Error("Column options must be defined for calculated columns.");const a=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,r):void 0;if(!i&&a&&(i=a),i&&(e.type=i),e.type==="hstore"&&!e.hstoreType&&(e.hstoreType=a===Object?"object":"string"),!e.type)throw new qb(t,r);Wt().columns.push({target:t.constructor,propertyName:r,mode:"virtual-property",options:e||{}})}}function So(n){return function(e,t){(Array.isArray(n)?n:[n||{}]).forEach(i=>{Wt().joinColumns.push({target:e.constructor,propertyName:t,name:i.name,referencedColumnName:i.referencedColumnName,foreignKeyConstraintName:i.foreignKeyConstraintName})})}}function ri(n){return function(e,t){n=n||{},Wt().joinTables.push({target:e.constructor,propertyName:t,name:n.name,joinColumns:n&&n.joinColumn?[n.joinColumn]:n.joinColumns,inverseJoinColumns:n&&n.inverseJoinColumn?[n.inverseJoinColumn]:n.inverseJoinColumns,schema:n&&n.schema?n.schema:void 0,database:n&&n.database?n.database:void 0,synchronize:!(n&&n.synchronize===!1)})}}function ii(n,e,t){let r;return Ue.isObject(e)?t=e:r=e,function(i,a){t||(t={});let s=t.lazy===!0;if(!s&&Reflect&&Reflect.getMetadata){const o=Reflect.getMetadata("design:type",i,a);o&&typeof o.name=="string"&&o.name.toLowerCase()==="promise"&&(s=!0)}Wt().relations.push({target:i.constructor,propertyName:a,relationType:"many-to-many",isLazy:s,type:n,inverseSideProperty:r,options:t})}}function Ao(n,e,t){let r;return Ue.isObject(e)?t=e:r=e,function(i,a){t||(t={});let s=t&&t.lazy===!0;if(!s&&Reflect&&Reflect.getMetadata){const o=Reflect.getMetadata("design:type",i,a);o&&typeof o.name=="string"&&o.name.toLowerCase()==="promise"&&(s=!0)}Wt().relations.push({target:i.constructor,propertyName:a,relationType:"many-to-one",isLazy:s,type:n,inverseSideProperty:r,options:t})}}function Ro(n,e,t){return function(r,i){t||(t={});let a=t&&t.lazy===!0;if(!a&&Reflect&&Reflect.getMetadata){const s=Reflect.getMetadata("design:type",r,i);s&&typeof s.name=="string"&&s.name.toLowerCase()==="promise"&&(a=!0)}Wt().relations.push({target:r.constructor,propertyName:i,isLazy:a,relationType:"one-to-many",type:n,inverseSideProperty:e,options:t})}}function iy(n,e,t){return function(r,i){Wt().relationIds.push({target:r.constructor,propertyName:i,relation:n,alias:e,queryBuilderFactory:t})}}function qr(n,e){const t=(Ue.isObject(n)?n:e)||{},r=typeof n=="string"?n:t.name;return function(i){Wt().tables.push({target:i,name:r,type:"regular",orderBy:t.orderBy?t.orderBy:void 0,engine:t.engine?t.engine:void 0,database:t.database?t.database:void 0,schema:t.schema?t.schema:void 0,synchronize:t.synchronize,withoutRowid:t.withoutRowid})}}var Hb={exports:{}};const HP={},GP=Object.freeze(Object.defineProperty({__proto__:null,default:HP},Symbol.toStringTag,{value:"Module"})),bf=_S(GP);(function(n,e){var t=void 0,r=function(i){return t||(t=new Promise(function(a,s){var o=typeof i<"u"?i:{},l=o.onAbort;o.onAbort=function(f){s(new Error(f)),l&&l(f)},o.postRun=o.postRun||[],o.postRun.push(function(){a(o)}),n=void 0;var u;u||(u=typeof o<"u"?o:{}),u.onRuntimeInitialized=function(){function f(z,se){switch(typeof se){case"boolean":NS(z,se?1:0);break;case"number":wS(z,se);break;case"string":TS(z,se,-1,-1);break;case"object":if(se===null)Fg(z);else if(se.length!=null){var _e=Wu(se,zu);bS(z,_e,se.length,-1),Ku(_e)}else Yu(z,"Wrong API use : tried to return a value of an unknown type ("+se+").",-1);break;default:Fg(z)}}function y(z,se){for(var _e=[],ke=0;ke<z;ke+=1){var We=Dt(se+4*ke,"i32"),ot=mS(We);if(ot===1||ot===2)We=ES(We);else if(ot===3)We=gS(We);else if(ot===4){ot=We,We=yS(ot),ot=vS(ot);for(var vr=new Uint8Array(We),Kn=0;Kn<We;Kn+=1)vr[Kn]=K[ot+Kn];We=vr}else We=null;_e.push(We)}return _e}function w(z,se){this.La=z,this.db=se,this.Ja=1,this.fb=[]}function _(z,se){if(this.db=se,se=v(z)+1,this.Ya=Gu(se),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");x(z,M,this.Ya,se),this.eb=this.Ya,this.Ua=this.ib=null}function $(z){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),z!=null){var se=this.filename,_e="/",ke=se;if(_e&&(_e=typeof _e=="string"?_e:xa(_e),ke=se?it(_e+"/"+se):_e),se=ge(!0,!0),ke=Fu(ke,(se!==void 0?se:438)&4095|32768,0),z){if(typeof z=="string"){_e=Array(z.length);for(var We=0,ot=z.length;We<ot;++We)_e[We]=z.charCodeAt(We);z=_e}Uu(ke,se|146),_e=ws(ke,577),Cg(_e,z,0,z.length,0),Ih(_e),Uu(ke,se)}}this.handleError(qe(this.filename,J)),this.db=Dt(J,"i32"),CS(this.db),this.Za={},this.Na={}}var J=ki(4),ne=u.cwrap,qe=ne("sqlite3_open","number",["string","number"]),Ye=ne("sqlite3_close_v2","number",["number"]),Qe=ne("sqlite3_exec","number",["number","string","number","number","number"]),Ot=ne("sqlite3_changes","number",["number"]),Qt=ne("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Dg=ne("sqlite3_sql","string",["number"]),XC=ne("sqlite3_normalized_sql","string",["number"]),$g=ne("sqlite3_prepare_v2","number",["number","number","number","number","number"]),ZC=ne("sqlite3_bind_text","number",["number","number","number","number","number"]),Lg=ne("sqlite3_bind_blob","number",["number","number","number","number","number"]),eS=ne("sqlite3_bind_double","number",["number","number","number"]),tS=ne("sqlite3_bind_int","number",["number","number","number"]),nS=ne("sqlite3_bind_parameter_index","number",["number","string"]),rS=ne("sqlite3_step","number",["number"]),iS=ne("sqlite3_errmsg","string",["number"]),aS=ne("sqlite3_column_count","number",["number"]),sS=ne("sqlite3_data_count","number",["number"]),oS=ne("sqlite3_column_double","number",["number","number"]),qg=ne("sqlite3_column_text","string",["number","number"]),lS=ne("sqlite3_column_blob","number",["number","number"]),uS=ne("sqlite3_column_bytes","number",["number","number"]),cS=ne("sqlite3_column_type","number",["number","number"]),dS=ne("sqlite3_column_name","string",["number","number"]),hS=ne("sqlite3_reset","number",["number"]),fS=ne("sqlite3_clear_bindings","number",["number"]),pS=ne("sqlite3_finalize","number",["number"]),Bg=ne("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),mS=ne("sqlite3_value_type","number",["number"]),yS=ne("sqlite3_value_bytes","number",["number"]),gS=ne("sqlite3_value_text","string",["number"]),vS=ne("sqlite3_value_blob","number",["number"]),ES=ne("sqlite3_value_double","number",["number"]),wS=ne("sqlite3_result_double","",["number","number"]),Fg=ne("sqlite3_result_null","",["number"]),TS=ne("sqlite3_result_text","",["number","string","number","number"]),bS=ne("sqlite3_result_blob","",["number","number","number","number"]),NS=ne("sqlite3_result_int","",["number","number"]),Yu=ne("sqlite3_result_error","",["number","string","number"]),kg=ne("sqlite3_aggregate_context","number",["number","number"]),CS=ne("RegisterExtensionFunctions","number",["number"]);w.prototype.bind=function(z){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(z)?this.wb(z):z!=null&&typeof z=="object"?this.xb(z):!0},w.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var z=rS(this.La);switch(z){case 100:return!0;case 101:return!1;default:throw this.db.handleError(z)}},w.prototype.rb=function(z){return z==null&&(z=this.Ja,this.Ja+=1),oS(this.La,z)},w.prototype.Ab=function(z){if(z==null&&(z=this.Ja,this.Ja+=1),z=qg(this.La,z),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(z)},w.prototype.Bb=function(z){return z==null&&(z=this.Ja,this.Ja+=1),qg(this.La,z)},w.prototype.getBlob=function(z){z==null&&(z=this.Ja,this.Ja+=1);var se=uS(this.La,z);z=lS(this.La,z);for(var _e=new Uint8Array(se),ke=0;ke<se;ke+=1)_e[ke]=K[z+ke];return _e},w.prototype.get=function(z,se){se=se||{},z!=null&&this.bind(z)&&this.step(),z=[];for(var _e=sS(this.La),ke=0;ke<_e;ke+=1)switch(cS(this.La,ke)){case 1:var We=se.useBigInt?this.Ab(ke):this.rb(ke);z.push(We);break;case 2:z.push(this.rb(ke));break;case 3:z.push(this.Bb(ke));break;case 4:z.push(this.getBlob(ke));break;default:z.push(null)}return z},w.prototype.getColumnNames=function(){for(var z=[],se=aS(this.La),_e=0;_e<se;_e+=1)z.push(dS(this.La,_e));return z},w.prototype.getAsObject=function(z,se){z=this.get(z,se),se=this.getColumnNames();for(var _e={},ke=0;ke<se.length;ke+=1)_e[se[ke]]=z[ke];return _e},w.prototype.getSQL=function(){return Dg(this.La)},w.prototype.getNormalizedSQL=function(){return XC(this.La)},w.prototype.run=function(z){return z!=null&&this.bind(z),this.step(),this.reset()},w.prototype.nb=function(z,se){se==null&&(se=this.Ja,this.Ja+=1),z=S(z);var _e=Wu(z,zu);this.fb.push(_e),this.db.handleError(ZC(this.La,se,_e,z.length-1,0))},w.prototype.vb=function(z,se){se==null&&(se=this.Ja,this.Ja+=1);var _e=Wu(z,zu);this.fb.push(_e),this.db.handleError(Lg(this.La,se,_e,z.length,0))},w.prototype.mb=function(z,se){se==null&&(se=this.Ja,this.Ja+=1),this.db.handleError((z===(z|0)?tS:eS)(this.La,se,z))},w.prototype.yb=function(z){z==null&&(z=this.Ja,this.Ja+=1),Lg(this.La,z,0,0,0)},w.prototype.ob=function(z,se){switch(se==null&&(se=this.Ja,this.Ja+=1),typeof z){case"string":this.nb(z,se);return;case"number":this.mb(z,se);return;case"bigint":this.nb(z.toString(),se);return;case"boolean":this.mb(z+0,se);return;case"object":if(z===null){this.yb(se);return}if(z.length!=null){this.vb(z,se);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+z+")."},w.prototype.xb=function(z){var se=this;return Object.keys(z).forEach(function(_e){var ke=nS(se.La,_e);ke!==0&&se.ob(z[_e],ke)}),!0},w.prototype.wb=function(z){for(var se=0;se<z.length;se+=1)this.ob(z[se],se+1);return!0},w.prototype.reset=function(){return this.freemem(),fS(this.La)===0&&hS(this.La)===0},w.prototype.freemem=function(){for(var z;(z=this.fb.pop())!==void 0;)Ku(z)},w.prototype.free=function(){this.freemem();var z=pS(this.La)===0;return delete this.db.Za[this.La],this.La=0,z},_.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var z=Uo(),se=ki(4);Kt(J),Kt(se);try{this.db.handleError($g(this.db.db,this.eb,-1,J,se)),this.eb=Dt(se,"i32");var _e=Dt(J,"i32");return _e===0?(this.gb(),{done:!0}):(this.Ua=new w(_e,this.db),this.db.Za[_e]=this.Ua,{value:this.Ua,done:!1})}catch(ke){throw this.ib=$t(this.eb),this.gb(),ke}finally{jo(z)}},_.prototype.gb=function(){Ku(this.Ya),this.Ya=null},_.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:$t(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(_.prototype[Symbol.iterator]=function(){return this}),$.prototype.run=function(z,se){if(!this.db)throw"Database closed";if(se){z=this.prepare(z,se);try{z.step()}finally{z.free()}}else this.handleError(Qe(this.db,z,0,0,J));return this},$.prototype.exec=function(z,se,_e){if(!this.db)throw"Database closed";var ke=Uo(),We=null;try{var ot=qh(z),vr=ki(4);for(z=[];Dt(ot,"i8")!==0;){Kt(J),Kt(vr),this.handleError($g(this.db,ot,-1,J,vr));var Kn=Dt(J,"i32");if(ot=Dt(vr,"i32"),Kn!==0){var Mn=null;for(We=new w(Kn,this),se!=null&&We.bind(se);We.step();)Mn===null&&(Mn={columns:We.getColumnNames(),values:[]},z.push(Mn)),Mn.values.push(We.get(null,_e));We.free()}}return z}catch(Er){throw We&&We.free(),Er}finally{jo(ke)}},$.prototype.each=function(z,se,_e,ke,We){typeof se=="function"&&(ke=_e,_e=se,se=void 0),z=this.prepare(z,se);try{for(;z.step();)_e(z.getAsObject(null,We))}finally{z.free()}if(typeof ke=="function")return ke()},$.prototype.prepare=function(z,se){if(Kt(J),this.handleError(Qt(this.db,z,-1,J,0)),z=Dt(J,"i32"),z===0)throw"Nothing to prepare";var _e=new w(z,this);return se!=null&&_e.bind(se),this.Za[z]=_e},$.prototype.iterateStatements=function(z){return new _(z,this)},$.prototype.export=function(){Object.values(this.Za).forEach(function(se){se.free()}),Object.values(this.Na).forEach(Ts),this.Na={},this.handleError(Ye(this.db));var z=HC(this.filename);return this.handleError(qe(this.filename,J)),this.db=Dt(J,"i32"),z},$.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(z){z.free()}),Object.values(this.Na).forEach(Ts),this.Na={},this.handleError(Ye(this.db)),vg("/"+this.filename),this.db=null)},$.prototype.handleError=function(z){if(z===0)return null;throw z=iS(this.db),Error(z)},$.prototype.getRowsModified=function(){return Ot(this.db)},$.prototype.create_function=function(z,se){Object.prototype.hasOwnProperty.call(this.Na,z)&&(Ts(this.Na[z]),delete this.Na[z]);var _e=Hu(function(ke,We,ot){We=y(We,ot);try{var vr=se.apply(null,We)}catch(Kn){Yu(ke,Kn,-1);return}f(ke,vr)},"viii");return this.Na[z]=_e,this.handleError(Bg(this.db,z,se.length,1,0,_e,0,0,0)),this},$.prototype.create_aggregate=function(z,se){var _e=se.init||function(){return null},ke=se.finalize||function(Mn){return Mn},We=se.step;if(!We)throw"An aggregate function must have a step function in "+z;var ot={};Object.hasOwnProperty.call(this.Na,z)&&(Ts(this.Na[z]),delete this.Na[z]),se=z+"__finalize",Object.hasOwnProperty.call(this.Na,se)&&(Ts(this.Na[se]),delete this.Na[se]);var vr=Hu(function(Mn,Er,Fh){var Oa=kg(Mn,1);Object.hasOwnProperty.call(ot,Oa)||(ot[Oa]=_e()),Er=y(Er,Fh),Er=[ot[Oa]].concat(Er);try{ot[Oa]=We.apply(null,Er)}catch(SS){delete ot[Oa],Yu(Mn,SS,-1)}},"viii"),Kn=Hu(function(Mn){var Er=kg(Mn,1);try{var Fh=ke(ot[Er])}catch(Oa){delete ot[Er],Yu(Mn,Oa,-1);return}f(Mn,Fh),delete ot[Er]},"vi");return this.Na[z]=vr,this.Na[se]=Kn,this.handleError(Bg(this.db,z,We.length-1,1,0,0,vr,Kn,0)),this},u.Database=$};var c=Object.assign({},u),d="./this.program",h=typeof window=="object",p=typeof importScripts=="function",g=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",E="",A,b,T;if(g){var C=bf,P=bf;E=p?P.dirname(E)+"/":__dirname+"/",A=(f,y)=>(f=Ve(f)?new URL(f):P.normalize(f),C.readFileSync(f,y?void 0:"utf8")),T=f=>(f=A(f,!0),f.buffer||(f=new Uint8Array(f)),f),b=(f,y,w,_=!0)=>{f=Ve(f)?new URL(f):P.normalize(f),C.readFile(f,_?void 0:"utf8",($,J)=>{$?w($):y(_?J.buffer:J)})},!u.thisProgram&&1<process.argv.length&&(d=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.exports=u,u.inspect=()=>"[Emscripten Module object]"}else(h||p)&&(p?E=self.location.href:typeof document<"u"&&document.currentScript&&(E=document.currentScript.src),E=E.indexOf("blob:")!==0?E.substr(0,E.replace(/[?#].*/,"").lastIndexOf("/")+1):"",A=f=>{var y=new XMLHttpRequest;return y.open("GET",f,!1),y.send(null),y.responseText},p&&(T=f=>{var y=new XMLHttpRequest;return y.open("GET",f,!1),y.responseType="arraybuffer",y.send(null),new Uint8Array(y.response)}),b=(f,y,w)=>{var _=new XMLHttpRequest;_.open("GET",f,!0),_.responseType="arraybuffer",_.onload=()=>{_.status==200||_.status==0&&_.response?y(_.response):w()},_.onerror=w,_.send(null)});var D=u.print||console.log.bind(console),F=u.printErr||console.error.bind(console);Object.assign(u,c),c=null,u.thisProgram&&(d=u.thisProgram);var Q;u.wasmBinary&&(Q=u.wasmBinary),typeof WebAssembly!="object"&&Pe("no native wasm support detected");var W,B=!1,K,M,Z,q,G,oe,he;function pe(){var f=W.buffer;u.HEAP8=K=new Int8Array(f),u.HEAP16=Z=new Int16Array(f),u.HEAPU8=M=new Uint8Array(f),u.HEAPU16=new Uint16Array(f),u.HEAP32=q=new Int32Array(f),u.HEAPU32=G=new Uint32Array(f),u.HEAPF32=oe=new Float32Array(f),u.HEAPF64=he=new Float64Array(f)}var ee=[],de=[],Ee=[];function ye(){var f=u.preRun.shift();ee.unshift(f)}var re=0,Ze=null;function Pe(f){throw u.onAbort&&u.onAbort(f),f="Aborted("+f+")",F(f),B=!0,new WebAssembly.RuntimeError(f+". Build with -sASSERTIONS for more info.")}var Le=f=>f.startsWith("data:application/octet-stream;base64,"),Ve=f=>f.startsWith("file://"),et;if(et="sql-wasm.wasm",!Le(et)){var ut=et;et=u.locateFile?u.locateFile(ut,E):E+ut}function mt(f){if(f==et&&Q)return new Uint8Array(Q);if(T)return T(f);throw"both async and sync fetching of the wasm failed"}function Mt(f){if(!Q&&(h||p)){if(typeof fetch=="function"&&!Ve(f))return fetch(f,{credentials:"same-origin"}).then(y=>{if(!y.ok)throw"failed to load wasm binary file at '"+f+"'";return y.arrayBuffer()}).catch(()=>mt(f));if(b)return new Promise((y,w)=>{b(f,_=>y(new Uint8Array(_)),w)})}return Promise.resolve().then(()=>mt(f))}function Ut(f,y,w){return Mt(f).then(_=>WebAssembly.instantiate(_,y)).then(_=>_).then(w,_=>{F(`failed to asynchronously prepare wasm: ${_}`),Pe(_)})}function nn(f,y){var w=et;Q||typeof WebAssembly.instantiateStreaming!="function"||Le(w)||Ve(w)||g||typeof fetch!="function"?Ut(w,f,y):fetch(w,{credentials:"same-origin"}).then(_=>WebAssembly.instantiateStreaming(_,f).then(y,function($){return F(`wasm streaming compile failed: ${$}`),F("falling back to ArrayBuffer instantiation"),Ut(w,f,y)}))}var Re,He,Pn=f=>{for(;0<f.length;)f.shift()(u)};function Dt(f,y="i8"){switch(y.endsWith("*")&&(y="*"),y){case"i1":return K[f>>0];case"i8":return K[f>>0];case"i16":return Z[f>>1];case"i32":return q[f>>2];case"i64":Pe("to do getValue(i64) use WASM_BIGINT");case"float":return oe[f>>2];case"double":return he[f>>3];case"*":return G[f>>2];default:Pe(`invalid type for getValue: ${y}`)}}function Kt(f){var y="i32";switch(y.endsWith("*")&&(y="*"),y){case"i1":K[f>>0]=0;break;case"i8":K[f>>0]=0;break;case"i16":Z[f>>1]=0;break;case"i32":q[f>>2]=0;break;case"i64":Pe("to do setValue(i64) use WASM_BIGINT");case"float":oe[f>>2]=0;break;case"double":he[f>>3]=0;break;case"*":G[f>>2]=0;break;default:Pe(`invalid type for setValue: ${y}`)}}var gr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,tt=(f,y,w)=>{var _=y+w;for(w=y;f[w]&&!(w>=_);)++w;if(16<w-y&&f.buffer&&gr)return gr.decode(f.subarray(y,w));for(_="";y<w;){var $=f[y++];if($&128){var J=f[y++]&63;if(($&224)==192)_+=String.fromCharCode(($&31)<<6|J);else{var ne=f[y++]&63;$=($&240)==224?($&15)<<12|J<<6|ne:($&7)<<18|J<<12|ne<<6|f[y++]&63,65536>$?_+=String.fromCharCode($):($-=65536,_+=String.fromCharCode(55296|$>>10,56320|$&1023))}}else _+=String.fromCharCode($)}return _},$t=(f,y)=>f?tt(M,f,y):"",jt=(f,y)=>{for(var w=0,_=f.length-1;0<=_;_--){var $=f[_];$==="."?f.splice(_,1):$===".."?(f.splice(_,1),w++):w&&(f.splice(_,1),w--)}if(y)for(;w;w--)f.unshift("..");return f},it=f=>{var y=f.charAt(0)==="/",w=f.substr(-1)==="/";return(f=jt(f.split("/").filter(_=>!!_),!y).join("/"))||y||(f="."),f&&w&&(f+="/"),(y?"/":"")+f},En=f=>{var y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(f).slice(1);return f=y[0],y=y[1],!f&&!y?".":(y&&(y=y.substr(0,y.length-1)),f+y)},j=f=>{if(f==="/")return"/";f=it(f),f=f.replace(/\/$/,"");var y=f.lastIndexOf("/");return y===-1?f:f.substr(y+1)},X=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return w=>crypto.getRandomValues(w);if(g)try{var f=bf;if(f.randomFillSync)return w=>f.randomFillSync(w);var y=f.randomBytes;return w=>(w.set(y(w.byteLength)),w)}catch{}Pe("initRandomDevice")},ie=f=>(ie=X())(f);function N(){for(var f="",y=!1,w=arguments.length-1;-1<=w&&!y;w--){if(y=0<=w?arguments[w]:"/",typeof y!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!y)return"";f=y+"/"+f,y=y.charAt(0)==="/"}return f=jt(f.split("/").filter(_=>!!_),!y).join("/"),(y?"/":"")+f||"."}var m=[],v=f=>{for(var y=0,w=0;w<f.length;++w){var _=f.charCodeAt(w);127>=_?y++:2047>=_?y+=2:55296<=_&&57343>=_?(y+=4,++w):y+=3}return y},x=(f,y,w,_)=>{if(!(0<_))return 0;var $=w;_=w+_-1;for(var J=0;J<f.length;++J){var ne=f.charCodeAt(J);if(55296<=ne&&57343>=ne){var qe=f.charCodeAt(++J);ne=65536+((ne&1023)<<10)|qe&1023}if(127>=ne){if(w>=_)break;y[w++]=ne}else{if(2047>=ne){if(w+1>=_)break;y[w++]=192|ne>>6}else{if(65535>=ne){if(w+2>=_)break;y[w++]=224|ne>>12}else{if(w+3>=_)break;y[w++]=240|ne>>18,y[w++]=128|ne>>12&63}y[w++]=128|ne>>6&63}y[w++]=128|ne&63}}return y[w]=0,w-$};function S(f,y){var w=Array(v(f)+1);return f=x(f,w,0,w.length),y&&(w.length=f),w}var R=[];function O(f,y){R[f]={input:[],output:[],Xa:y},Mh(f,H)}var H={open(f){var y=R[f.node.rdev];if(!y)throw new le(43);f.tty=y,f.seekable=!1},close(f){f.tty.Xa.fsync(f.tty)},fsync(f){f.tty.Xa.fsync(f.tty)},read(f,y,w,_){if(!f.tty||!f.tty.Xa.sb)throw new le(60);for(var $=0,J=0;J<_;J++){try{var ne=f.tty.Xa.sb(f.tty)}catch{throw new le(29)}if(ne===void 0&&$===0)throw new le(6);if(ne==null)break;$++,y[w+J]=ne}return $&&(f.node.timestamp=Date.now()),$},write(f,y,w,_){if(!f.tty||!f.tty.Xa.jb)throw new le(60);try{for(var $=0;$<_;$++)f.tty.Xa.jb(f.tty,y[w+$])}catch{throw new le(29)}return _&&(f.node.timestamp=Date.now()),$}},ce={sb(){e:{if(!m.length){var f=null;if(g){var y=Buffer.alloc(256),w=0,_=process.stdin.fd;try{w=C.readSync(_,y)}catch($){if($.toString().includes("EOF"))w=0;else throw $}0<w?f=y.slice(0,w).toString("utf-8"):f=null}else typeof window<"u"&&typeof window.prompt=="function"?(f=window.prompt("Input: "),f!==null&&(f+=`
`)):typeof readline=="function"&&(f=readline(),f!==null&&(f+=`
`));if(!f){f=null;break e}m=S(f,!0)}f=m.shift()}return f},jb(f,y){y===null||y===10?(D(tt(f.output,0)),f.output=[]):y!=0&&f.output.push(y)},fsync(f){f.output&&0<f.output.length&&(D(tt(f.output,0)),f.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},$e={jb(f,y){y===null||y===10?(F(tt(f.output,0)),f.output=[]):y!=0&&f.output.push(y)},fsync(f){f.output&&0<f.output.length&&(F(tt(f.output,0)),f.output=[])}};function Fe(f,y){var w=f.Ia?f.Ia.length:0;w>=y||(y=Math.max(y,w*(1048576>w?2:1.125)>>>0),w!=0&&(y=Math.max(y,256)),w=f.Ia,f.Ia=new Uint8Array(y),0<f.Ma&&f.Ia.set(w.subarray(0,f.Ma),0))}var ae={Qa:null,Ra(){return ae.createNode(null,"/",16895,0)},createNode(f,y,w,_){if((w&61440)===24576||(w&61440)===4096)throw new le(63);return ae.Qa||(ae.Qa={dir:{node:{Pa:ae.Ga.Pa,Oa:ae.Ga.Oa,lookup:ae.Ga.lookup,ab:ae.Ga.ab,rename:ae.Ga.rename,unlink:ae.Ga.unlink,rmdir:ae.Ga.rmdir,readdir:ae.Ga.readdir,symlink:ae.Ga.symlink},stream:{Ta:ae.Ha.Ta}},file:{node:{Pa:ae.Ga.Pa,Oa:ae.Ga.Oa},stream:{Ta:ae.Ha.Ta,read:ae.Ha.read,write:ae.Ha.write,lb:ae.Ha.lb,bb:ae.Ha.bb,cb:ae.Ha.cb}},link:{node:{Pa:ae.Ga.Pa,Oa:ae.Ga.Oa,readlink:ae.Ga.readlink},stream:{}},pb:{node:{Pa:ae.Ga.Pa,Oa:ae.Ga.Oa},stream:WC}}),w=dg(f,y,w,_),Gn(w.mode)?(w.Ga=ae.Qa.dir.node,w.Ha=ae.Qa.dir.stream,w.Ia={}):(w.mode&61440)===32768?(w.Ga=ae.Qa.file.node,w.Ha=ae.Qa.file.stream,w.Ma=0,w.Ia=null):(w.mode&61440)===40960?(w.Ga=ae.Qa.link.node,w.Ha=ae.Qa.link.stream):(w.mode&61440)===8192&&(w.Ga=ae.Qa.pb.node,w.Ha=ae.Qa.pb.stream),w.timestamp=Date.now(),f&&(f.Ia[y]=w,f.timestamp=w.timestamp),w},Lb(f){return f.Ia?f.Ia.subarray?f.Ia.subarray(0,f.Ma):new Uint8Array(f.Ia):new Uint8Array(0)},Ga:{Pa(f){var y={};return y.dev=(f.mode&61440)===8192?f.id:1,y.ino=f.id,y.mode=f.mode,y.nlink=1,y.uid=0,y.gid=0,y.rdev=f.rdev,Gn(f.mode)?y.size=4096:(f.mode&61440)===32768?y.size=f.Ma:(f.mode&61440)===40960?y.size=f.link.length:y.size=0,y.atime=new Date(f.timestamp),y.mtime=new Date(f.timestamp),y.ctime=new Date(f.timestamp),y.zb=4096,y.blocks=Math.ceil(y.size/y.zb),y},Oa(f,y){if(y.mode!==void 0&&(f.mode=y.mode),y.timestamp!==void 0&&(f.timestamp=y.timestamp),y.size!==void 0&&(y=y.size,f.Ma!=y))if(y==0)f.Ia=null,f.Ma=0;else{var w=f.Ia;f.Ia=new Uint8Array(y),w&&f.Ia.set(w.subarray(0,Math.min(y,f.Ma))),f.Ma=y}},lookup(){throw vs[44]},ab(f,y,w,_){return ae.createNode(f,y,w,_)},rename(f,y,w){if(Gn(f.mode)){try{var _=_a(y,w)}catch{}if(_)for(var $ in _.Ia)throw new le(55)}delete f.parent.Ia[f.name],f.parent.timestamp=Date.now(),f.name=w,y.Ia[w]=f,y.timestamp=f.parent.timestamp,f.parent=y},unlink(f,y){delete f.Ia[y],f.timestamp=Date.now()},rmdir(f,y){var w=_a(f,y),_;for(_ in w.Ia)throw new le(55);delete f.Ia[y],f.timestamp=Date.now()},readdir(f){var y=[".",".."],w;for(w in f.Ia)f.Ia.hasOwnProperty(w)&&y.push(w);return y},symlink(f,y,w){return f=ae.createNode(f,y,41471,0),f.link=w,f},readlink(f){if((f.mode&61440)!==40960)throw new le(28);return f.link}},Ha:{read(f,y,w,_,$){var J=f.node.Ia;if($>=f.node.Ma)return 0;if(f=Math.min(f.node.Ma-$,_),8<f&&J.subarray)y.set(J.subarray($,$+f),w);else for(_=0;_<f;_++)y[w+_]=J[$+_];return f},write(f,y,w,_,$,J){if(y.buffer===K.buffer&&(J=!1),!_)return 0;if(f=f.node,f.timestamp=Date.now(),y.subarray&&(!f.Ia||f.Ia.subarray)){if(J)return f.Ia=y.subarray(w,w+_),f.Ma=_;if(f.Ma===0&&$===0)return f.Ia=y.slice(w,w+_),f.Ma=_;if($+_<=f.Ma)return f.Ia.set(y.subarray(w,w+_),$),_}if(Fe(f,$+_),f.Ia.subarray&&y.subarray)f.Ia.set(y.subarray(w,w+_),$);else for(J=0;J<_;J++)f.Ia[$+J]=y[w+J];return f.Ma=Math.max(f.Ma,$+_),_},Ta(f,y,w){if(w===1?y+=f.position:w===2&&(f.node.mode&61440)===32768&&(y+=f.node.Ma),0>y)throw new le(28);return y},lb(f,y,w){Fe(f.node,y+w),f.node.Ma=Math.max(f.node.Ma,y+w)},bb(f,y,w,_,$){if((f.node.mode&61440)!==32768)throw new le(43);if(f=f.node.Ia,$&2||f.buffer!==K.buffer){if((0<w||w+y<f.length)&&(f.subarray?f=f.subarray(w,w+y):f=Array.prototype.slice.call(f,w,w+y)),w=!0,y=65536*Math.ceil(y/65536),($=Og(65536,y))?(M.fill(0,$,$+y),y=$):y=0,!y)throw new le(48);K.set(f,y)}else w=!1,y=f.byteOffset;return{Db:y,ub:w}},cb(f,y,w,_){return ae.Ha.write(f,y,0,_,w,!1),0}}},ge=(f,y)=>{var w=0;return f&&(w|=365),y&&(w|=146),w},Ae=null,Ne={},Ce=[],ze=1,Ke=null,yt=!0,le=null,vs={};function rn(f,y={}){if(f=N(f),!f)return{path:"",node:null};if(y=Object.assign({qb:!0,kb:0},y),8<y.kb)throw new le(32);f=f.split("/").filter(ne=>!!ne);for(var w=Ae,_="/",$=0;$<f.length;$++){var J=$===f.length-1;if(J&&y.parent)break;if(w=_a(w,f[$]),_=it(_+"/"+f[$]),w.Va&&(!J||J&&y.qb)&&(w=w.Va.root),!J||y.Sa){for(J=0;(w.mode&61440)===40960;)if(w=Eg(_),_=N(En(_),w),w=rn(_,{kb:y.kb+1}).node,40<J++)throw new le(32)}}return{path:_,node:w}}function xa(f){for(var y;;){if(f===f.parent)return f=f.Ra.tb,y?f[f.length-1]!=="/"?`${f}/${y}`:f+y:f;y=y?`${f.name}/${y}`:f.name,f=f.parent}}function Ph(f,y){for(var w=0,_=0;_<y.length;_++)w=(w<<5)-w+y.charCodeAt(_)|0;return(f+w>>>0)%Ke.length}function cg(f){var y=Ph(f.parent.id,f.name);if(Ke[y]===f)Ke[y]=f.Wa;else for(y=Ke[y];y;){if(y.Wa===f){y.Wa=f.Wa;break}y=y.Wa}}function _a(f,y){var w;if(w=(w=Es(f,"x"))?w:f.Ga.lookup?0:2)throw new le(w,f);for(w=Ke[Ph(f.id,y)];w;w=w.Wa){var _=w.name;if(w.parent.id===f.id&&_===y)return w}return f.Ga.lookup(f,y)}function dg(f,y,w,_){return f=new Pg(f,y,w,_),y=Ph(f.parent.id,f.name),f.Wa=Ke[y],Ke[y]=f}function Gn(f){return(f&61440)===16384}function hg(f){var y=["r","w","rw"][f&3];return f&512&&(y+="w"),y}function Es(f,y){if(yt)return 0;if(!y.includes("r")||f.mode&292){if(y.includes("w")&&!(f.mode&146)||y.includes("x")&&!(f.mode&73))return 2}else return 2;return 0}function fg(f,y){try{return _a(f,y),20}catch{}return Es(f,"wx")}function pg(f,y,w){try{var _=_a(f,y)}catch($){return $.Ka}if(f=Es(f,"wx"))return f;if(w){if(!Gn(_.mode))return 54;if(_===_.parent||xa(_)==="/")return 10}else if(Gn(_.mode))return 31;return 0}function zC(){for(var f=0;4096>=f;f++)if(!Ce[f])return f;throw new le(33)}function hn(f){if(f=Ce[f],!f)throw new le(8);return f}function mg(f,y=-1){return Fo||(Fo=function(){this.$a={}},Fo.prototype={},Object.defineProperties(Fo.prototype,{object:{get(){return this.node},set(w){this.node=w}},flags:{get(){return this.$a.flags},set(w){this.$a.flags=w}},position:{get(){return this.$a.position},set(w){this.$a.position=w}}})),f=Object.assign(new Fo,f),y==-1&&(y=zC()),f.fd=y,Ce[y]=f}var WC={open(f){f.Ha=Ne[f.node.rdev].Ha,f.Ha.open&&f.Ha.open(f)},Ta(){throw new le(70)}};function Mh(f,y){Ne[f]={Ha:y}}function yg(f,y){var w=y==="/",_=!y;if(w&&Ae)throw new le(10);if(!w&&!_){var $=rn(y,{qb:!1});if(y=$.path,$=$.node,$.Va)throw new le(10);if(!Gn($.mode))throw new le(54)}y={type:f,Pb:{},tb:y,Cb:[]},f=f.Ra(y),f.Ra=y,y.root=f,w?Ae=f:$&&($.Va=y,$.Ra&&$.Ra.Cb.push(y))}function Fu(f,y,w){var _=rn(f,{parent:!0}).node;if(f=j(f),!f||f==="."||f==="..")throw new le(28);var $=fg(_,f);if($)throw new le($);if(!_.Ga.ab)throw new le(63);return _.Ga.ab(_,f,y,w)}function Br(f,y){return Fu(f,(y!==void 0?y:511)&1023|16384,0)}function ku(f,y,w){typeof w>"u"&&(w=y,y=438),Fu(f,y|8192,w)}function Oh(f,y){if(!N(f))throw new le(44);var w=rn(y,{parent:!0}).node;if(!w)throw new le(44);y=j(y);var _=fg(w,y);if(_)throw new le(_);if(!w.Ga.symlink)throw new le(63);w.Ga.symlink(w,y,f)}function gg(f){var y=rn(f,{parent:!0}).node;f=j(f);var w=_a(y,f),_=pg(y,f,!0);if(_)throw new le(_);if(!y.Ga.rmdir)throw new le(63);if(w.Va)throw new le(10);y.Ga.rmdir(y,f),cg(w)}function vg(f){var y=rn(f,{parent:!0}).node;if(!y)throw new le(44);f=j(f);var w=_a(y,f),_=pg(y,f,!1);if(_)throw new le(_);if(!y.Ga.unlink)throw new le(63);if(w.Va)throw new le(10);y.Ga.unlink(y,f),cg(w)}function Eg(f){if(f=rn(f).node,!f)throw new le(44);if(!f.Ga.readlink)throw new le(28);return N(xa(f.parent),f.Ga.readlink(f))}function qo(f,y){if(f=rn(f,{Sa:!y}).node,!f)throw new le(44);if(!f.Ga.Pa)throw new le(63);return f.Ga.Pa(f)}function wg(f){return qo(f,!0)}function Uu(f,y){if(f=typeof f=="string"?rn(f,{Sa:!0}).node:f,!f.Ga.Oa)throw new le(63);f.Ga.Oa(f,{mode:y&4095|f.mode&-4096,timestamp:Date.now()})}function Tg(f,y){if(0>y)throw new le(28);if(f=typeof f=="string"?rn(f,{Sa:!0}).node:f,!f.Ga.Oa)throw new le(63);if(Gn(f.mode))throw new le(31);if((f.mode&61440)!==32768)throw new le(28);var w=Es(f,"w");if(w)throw new le(w);f.Ga.Oa(f,{size:y,timestamp:Date.now()})}function ws(f,y,w){if(f==="")throw new le(44);if(typeof y=="string"){var _={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[y];if(typeof _>"u")throw Error(`Unknown file open mode: ${y}`);y=_}if(w=y&64?(typeof w>"u"?438:w)&4095|32768:0,typeof f=="object")var $=f;else{f=it(f);try{$=rn(f,{Sa:!(y&131072)}).node}catch{}}if(_=!1,y&64)if($){if(y&128)throw new le(20)}else $=Fu(f,w,0),_=!0;if(!$)throw new le(44);if(($.mode&61440)===8192&&(y&=-513),y&65536&&!Gn($.mode))throw new le(54);if(!_&&(w=$?($.mode&61440)===40960?32:Gn($.mode)&&(hg(y)!=="r"||y&512)?31:Es($,hg(y)):44))throw new le(w);return y&512&&!_&&Tg($,0),y&=-131713,$=mg({node:$,path:xa($),flags:y,seekable:!0,position:0,Ha:$.Ha,Fb:[],error:!1}),$.Ha.open&&$.Ha.open($),!u.logReadFiles||y&1||(Dh||(Dh={}),f in Dh||(Dh[f]=1)),$}function Ih(f){if(f.fd===null)throw new le(8);f.hb&&(f.hb=null);try{f.Ha.close&&f.Ha.close(f)}catch(y){throw y}finally{Ce[f.fd]=null}f.fd=null}function bg(f,y,w){if(f.fd===null)throw new le(8);if(!f.seekable||!f.Ha.Ta)throw new le(70);if(w!=0&&w!=1&&w!=2)throw new le(28);f.position=f.Ha.Ta(f,y,w),f.Fb=[]}function Ng(f,y,w,_,$){if(0>_||0>$)throw new le(28);if(f.fd===null)throw new le(8);if((f.flags&2097155)===1)throw new le(8);if(Gn(f.node.mode))throw new le(31);if(!f.Ha.read)throw new le(28);var J=typeof $<"u";if(!J)$=f.position;else if(!f.seekable)throw new le(70);return y=f.Ha.read(f,y,w,_,$),J||(f.position+=y),y}function Cg(f,y,w,_,$){if(0>_||0>$)throw new le(28);if(f.fd===null)throw new le(8);if(!(f.flags&2097155))throw new le(8);if(Gn(f.node.mode))throw new le(31);if(!f.Ha.write)throw new le(28);f.seekable&&f.flags&1024&&bg(f,0,2);var J=typeof $<"u";if(!J)$=f.position;else if(!f.seekable)throw new le(70);return y=f.Ha.write(f,y,w,_,$,void 0),J||(f.position+=y),y}function HC(f){var y,w=ws(f,w||0);f=qo(f).size;var _=new Uint8Array(f);return Ng(w,_,0,f,0),y=_,Ih(w),y}function Sg(){le||(le=function(f,y){this.name="ErrnoError",this.node=y,this.Eb=function(w){this.Ka=w},this.Eb(f),this.message="FS error"},le.prototype=Error(),le.prototype.constructor=le,[44].forEach(f=>{vs[f]=new le(f),vs[f].stack="<generic error, no stack>"}))}var Ag;function Bo(f,y,w){f=it("/dev/"+f);var _=ge(!!y,!!w);Rg||(Rg=64);var $=Rg++<<8|0;Mh($,{open(J){J.seekable=!1},close(){w&&w.buffer&&w.buffer.length&&w(10)},read(J,ne,qe,Ye){for(var Qe=0,Ot=0;Ot<Ye;Ot++){try{var Qt=y()}catch{throw new le(29)}if(Qt===void 0&&Qe===0)throw new le(6);if(Qt==null)break;Qe++,ne[qe+Ot]=Qt}return Qe&&(J.node.timestamp=Date.now()),Qe},write(J,ne,qe,Ye){for(var Qe=0;Qe<Ye;Qe++)try{w(ne[qe+Qe])}catch{throw new le(29)}return Ye&&(J.node.timestamp=Date.now()),Qe}}),ku(f,_,$)}var Rg,ct={},Fo,Dh;function Pa(f,y,w){if(y.charAt(0)==="/")return y;if(f=f===-100?"/":hn(f).path,y.length==0){if(!w)throw new le(44);return f}return it(f+"/"+y)}function ju(f,y,w){try{var _=f(y)}catch(J){if(J&&J.node&&it(y)!==it(xa(J.node)))return-54;throw J}q[w>>2]=_.dev,q[w+4>>2]=_.mode,G[w+8>>2]=_.nlink,q[w+12>>2]=_.uid,q[w+16>>2]=_.gid,q[w+20>>2]=_.rdev,He=[_.size>>>0,(Re=_.size,1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[w+24>>2]=He[0],q[w+28>>2]=He[1],q[w+32>>2]=4096,q[w+36>>2]=_.blocks,f=_.atime.getTime(),y=_.mtime.getTime();var $=_.ctime.getTime();return He=[Math.floor(f/1e3)>>>0,(Re=Math.floor(f/1e3),1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[w+40>>2]=He[0],q[w+44>>2]=He[1],G[w+48>>2]=f%1e3*1e3,He=[Math.floor(y/1e3)>>>0,(Re=Math.floor(y/1e3),1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[w+56>>2]=He[0],q[w+60>>2]=He[1],G[w+64>>2]=y%1e3*1e3,He=[Math.floor($/1e3)>>>0,(Re=Math.floor($/1e3),1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[w+72>>2]=He[0],q[w+76>>2]=He[1],G[w+80>>2]=$%1e3*1e3,He=[_.ino>>>0,(Re=_.ino,1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[w+88>>2]=He[0],q[w+92>>2]=He[1],0}var Qu=void 0;function Vu(){var f=q[+Qu>>2];return Qu+=4,f}var ko=(f,y)=>y+2097152>>>0<4194305-!!f?(f>>>0)+4294967296*y:NaN,GC=[0,31,60,91,121,152,182,213,244,274,305,335],KC=[0,31,59,90,120,151,181,212,243,273,304,334],xg=f=>{var y=v(f)+1,w=Gu(y);return w&&x(f,M,w,y),w},$h={},_g=()=>{if(!Lh){var f={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:d||"./this.program"},y;for(y in $h)$h[y]===void 0?delete f[y]:f[y]=$h[y];var w=[];for(y in f)w.push(`${y}=${f[y]}`);Lh=w}return Lh},Lh,qh=f=>{var y=v(f)+1,w=ki(y);return x(f,M,w,y),w},JC=(f,y,w,_)=>{var $={string:Qe=>{var Ot=0;return Qe!=null&&Qe!==0&&(Ot=qh(Qe)),Ot},array:Qe=>{var Ot=ki(Qe.length);return K.set(Qe,Ot),Ot}};f=u["_"+f];var J=[],ne=0;if(_)for(var qe=0;qe<_.length;qe++){var Ye=$[w[qe]];Ye?(ne===0&&(ne=Uo()),J[qe]=Ye(_[qe])):J[qe]=_[qe]}return w=f.apply(null,J),w=function(Qe){return ne!==0&&jo(ne),y==="string"?Qe?tt(M,Qe):"":y==="boolean"?!!Qe:Qe}(w)},zu=0,Wu=(f,y)=>(y=y==1?ki(f.length):Gu(f.length),f.subarray||f.slice||(f=new Uint8Array(f)),M.set(f,y),y),Ma,Bh=[],si,Ts=f=>{Ma.delete(si.get(f)),si.set(f,null),Bh.push(f)},Hu=(f,y)=>{if(!Ma){Ma=new WeakMap;var w=si.length;if(Ma)for(var _=0;_<0+w;_++){var $=si.get(_);$&&Ma.set($,_)}}if(w=Ma.get(f)||0)return w;if(Bh.length)w=Bh.pop();else{try{si.grow(1)}catch(qe){throw qe instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":qe}w=si.length-1}try{si.set(w,f)}catch(qe){if(!(qe instanceof TypeError))throw qe;if(typeof WebAssembly.Function=="function"){_=WebAssembly.Function,$={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var J={parameters:[],results:y[0]=="v"?[]:[$[y[0]]]},ne=1;ne<y.length;++ne)J.parameters.push($[y[ne]]);y=new _(J,f)}else{for(_=[1],$=y.slice(0,1),y=y.slice(1),J={i:127,p:127,j:126,f:125,d:124,e:111},_.push(96),ne=y.length,128>ne?_.push(ne):_.push(ne%128|128,ne>>7),ne=0;ne<y.length;++ne)_.push(J[y[ne]]);$=="v"?_.push(0):_.push(1,J[$]),y=[0,97,115,109,1,0,0,0,1],$=_.length,128>$?y.push($):y.push($%128|128,$>>7),y.push.apply(y,_),y.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),y=new WebAssembly.Module(new Uint8Array(y)),y=new WebAssembly.Instance(y,{e:{f}}).exports.f}si.set(w,y)}return Ma.set(f,w),w};function Pg(f,y,w,_){f||(f=this),this.parent=f,this.Ra=f.Ra,this.Va=null,this.id=ze++,this.name=y,this.mode=w,this.Ga={},this.Ha={},this.rdev=_}Object.defineProperties(Pg.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(f){f?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(f){f?this.mode|=146:this.mode&=-147}}}),Sg(),Ke=Array(4096),yg(ae,"/"),Br("/tmp"),Br("/home"),Br("/home/web_user"),function(){Br("/dev"),Mh(259,{read:()=>0,write:(_,$,J,ne)=>ne}),ku("/dev/null",259),O(1280,ce),O(1536,$e),ku("/dev/tty",1280),ku("/dev/tty1",1536);var f=new Uint8Array(1024),y=0,w=()=>(y===0&&(y=ie(f).byteLength),f[--y]);Bo("random",w),Bo("urandom",w),Br("/dev/shm"),Br("/dev/shm/tmp")}(),function(){Br("/proc");var f=Br("/proc/self");Br("/proc/self/fd"),yg({Ra(){var y=dg(f,"fd",16895,73);return y.Ga={lookup(w,_){var $=hn(+_);return w={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>$.path}},w.parent=w}},y}},"/proc/self/fd")}();var YC={a:(f,y,w,_)=>{Pe(`Assertion failed: ${f?tt(M,f):""}, at: `+[y?y?tt(M,y):"":"unknown filename",w,_?_?tt(M,_):"":"unknown function"])},h:function(f,y){try{return f=f?tt(M,f):"",Uu(f,y),0}catch(w){if(typeof ct>"u"||w.name!=="ErrnoError")throw w;return-w.Ka}},H:function(f,y,w){try{if(y=y?tt(M,y):"",y=Pa(f,y),w&-8)return-28;var _=rn(y,{Sa:!0}).node;return _?(f="",w&4&&(f+="r"),w&2&&(f+="w"),w&1&&(f+="x"),f&&Es(_,f)?-2:0):-44}catch($){if(typeof ct>"u"||$.name!=="ErrnoError")throw $;return-$.Ka}},i:function(f,y){try{var w=hn(f);return Uu(w.node,y),0}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return-_.Ka}},g:function(f){try{var y=hn(f).node,w=typeof y=="string"?rn(y,{Sa:!0}).node:y;if(!w.Ga.Oa)throw new le(63);return w.Ga.Oa(w,{timestamp:Date.now()}),0}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return-_.Ka}},b:function(f,y,w){Qu=w;try{var _=hn(f);switch(y){case 0:var $=Vu();if(0>$)return-28;for(;Ce[$];)$++;return mg(_,$).fd;case 1:case 2:return 0;case 3:return _.flags;case 4:return $=Vu(),_.flags|=$,0;case 5:return $=Vu(),Z[$+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return q[Mg()>>2]=28,-1;default:return-28}}catch(J){if(typeof ct>"u"||J.name!=="ErrnoError")throw J;return-J.Ka}},f:function(f,y){try{var w=hn(f);return ju(qo,w.path,y)}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return-_.Ka}},n:function(f,y,w){y=ko(y,w);try{if(isNaN(y))return 61;var _=hn(f);if(!(_.flags&2097155))throw new le(28);return Tg(_.node,y),0}catch($){if(typeof ct>"u"||$.name!=="ErrnoError")throw $;return-$.Ka}},C:function(f,y){try{if(y===0)return-28;var w=v("/")+1;return y<w?-68:(x("/",M,f,y),w)}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return-_.Ka}},F:function(f,y){try{return f=f?tt(M,f):"",ju(wg,f,y)}catch(w){if(typeof ct>"u"||w.name!=="ErrnoError")throw w;return-w.Ka}},z:function(f,y,w){try{return y=y?tt(M,y):"",y=Pa(f,y),y=it(y),y[y.length-1]==="/"&&(y=y.substr(0,y.length-1)),Br(y,w),0}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return-_.Ka}},E:function(f,y,w,_){try{y=y?tt(M,y):"";var $=_&256;return y=Pa(f,y,_&4096),ju($?wg:qo,y,w)}catch(J){if(typeof ct>"u"||J.name!=="ErrnoError")throw J;return-J.Ka}},y:function(f,y,w,_){Qu=_;try{y=y?tt(M,y):"",y=Pa(f,y);var $=_?Vu():0;return ws(y,w,$).fd}catch(J){if(typeof ct>"u"||J.name!=="ErrnoError")throw J;return-J.Ka}},w:function(f,y,w,_){try{if(y=y?tt(M,y):"",y=Pa(f,y),0>=_)return-28;var $=Eg(y),J=Math.min(_,v($)),ne=K[w+J];return x($,M,w,_+1),K[w+J]=ne,J}catch(qe){if(typeof ct>"u"||qe.name!=="ErrnoError")throw qe;return-qe.Ka}},v:function(f){try{return f=f?tt(M,f):"",gg(f),0}catch(y){if(typeof ct>"u"||y.name!=="ErrnoError")throw y;return-y.Ka}},G:function(f,y){try{return f=f?tt(M,f):"",ju(qo,f,y)}catch(w){if(typeof ct>"u"||w.name!=="ErrnoError")throw w;return-w.Ka}},r:function(f,y,w){try{return y=y?tt(M,y):"",y=Pa(f,y),w===0?vg(y):w===512?gg(y):Pe("Invalid flags passed to unlinkat"),0}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return-_.Ka}},q:function(f,y,w){try{if(y=y?tt(M,y):"",y=Pa(f,y,!0),w){var _=G[w>>2]+4294967296*q[w+4>>2],$=q[w+8>>2];J=1e3*_+$/1e6,w+=16,_=G[w>>2]+4294967296*q[w+4>>2],$=q[w+8>>2],ne=1e3*_+$/1e6}else var J=Date.now(),ne=J;f=J;var qe=rn(y,{Sa:!0}).node;return qe.Ga.Oa(qe,{timestamp:Math.max(f,ne)}),0}catch(Ye){if(typeof ct>"u"||Ye.name!=="ErrnoError")throw Ye;return-Ye.Ka}},l:function(f,y,w){f=new Date(1e3*ko(f,y)),q[w>>2]=f.getSeconds(),q[w+4>>2]=f.getMinutes(),q[w+8>>2]=f.getHours(),q[w+12>>2]=f.getDate(),q[w+16>>2]=f.getMonth(),q[w+20>>2]=f.getFullYear()-1900,q[w+24>>2]=f.getDay(),y=f.getFullYear(),q[w+28>>2]=(y%4!==0||y%100===0&&y%400!==0?KC:GC)[f.getMonth()]+f.getDate()-1|0,q[w+36>>2]=-(60*f.getTimezoneOffset()),y=new Date(f.getFullYear(),6,1).getTimezoneOffset();var _=new Date(f.getFullYear(),0,1).getTimezoneOffset();q[w+32>>2]=(y!=_&&f.getTimezoneOffset()==Math.min(_,y))|0},j:function(f,y,w,_,$,J,ne,qe){$=ko($,J);try{if(isNaN($))return 61;var Ye=hn(_);if(y&2&&!(w&2)&&(Ye.flags&2097155)!==2)throw new le(2);if((Ye.flags&2097155)===1)throw new le(2);if(!Ye.Ha.bb)throw new le(43);var Qe=Ye.Ha.bb(Ye,f,$,y,w),Ot=Qe.Db;return q[ne>>2]=Qe.ub,G[qe>>2]=Ot,0}catch(Qt){if(typeof ct>"u"||Qt.name!=="ErrnoError")throw Qt;return-Qt.Ka}},k:function(f,y,w,_,$,J,ne){J=ko(J,ne);try{if(isNaN(J))return 61;var qe=hn($);if(w&2){if((qe.node.mode&61440)!==32768)throw new le(43);if(!(_&2)){var Ye=M.slice(f,f+y);qe.Ha.cb&&qe.Ha.cb(qe,Ye,J,y,_)}}}catch(Qe){if(typeof ct>"u"||Qe.name!=="ErrnoError")throw Qe;return-Qe.Ka}},s:(f,y,w)=>{function _(Ye){return(Ye=Ye.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Ye[1]:"GMT"}var $=new Date().getFullYear(),J=new Date($,0,1),ne=new Date($,6,1);$=J.getTimezoneOffset();var qe=ne.getTimezoneOffset();G[f>>2]=60*Math.max($,qe),q[y>>2]=+($!=qe),f=_(J),y=_(ne),f=xg(f),y=xg(y),qe<$?(G[w>>2]=f,G[w+4>>2]=y):(G[w>>2]=y,G[w+4>>2]=f)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:f=>{var y=M.length;if(f>>>=0,2147483648<f)return!1;for(var w=1;4>=w;w*=2){var _=y*(1+.2/w);_=Math.min(_,f+100663296);var $=Math;_=Math.max(f,_);e:{$=($.min.call($,2147483648,_+(65536-_%65536)%65536)-W.buffer.byteLength+65535)/65536;try{W.grow($),pe();var J=1;break e}catch{}J=void 0}if(J)return!0}return!1},A:(f,y)=>{var w=0;return _g().forEach((_,$)=>{var J=y+w;for($=G[f+4*$>>2]=J,J=0;J<_.length;++J)K[$++>>0]=_.charCodeAt(J);K[$>>0]=0,w+=_.length+1}),0},B:(f,y)=>{var w=_g();G[f>>2]=w.length;var _=0;return w.forEach($=>_+=$.length+1),G[y>>2]=_,0},e:function(f){try{var y=hn(f);return Ih(y),0}catch(w){if(typeof ct>"u"||w.name!=="ErrnoError")throw w;return w.Ka}},p:function(f,y){try{var w=hn(f);return K[y>>0]=w.tty?2:Gn(w.mode)?3:(w.mode&61440)===40960?7:4,Z[y+2>>1]=0,He=[0,(Re=0,1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[y+8>>2]=He[0],q[y+12>>2]=He[1],He=[0,(Re=0,1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[y+16>>2]=He[0],q[y+20>>2]=He[1],0}catch(_){if(typeof ct>"u"||_.name!=="ErrnoError")throw _;return _.Ka}},x:function(f,y,w,_){try{e:{var $=hn(f);f=y;for(var J,ne=y=0;ne<w;ne++){var qe=G[f>>2],Ye=G[f+4>>2];f+=8;var Qe=Ng($,K,qe,Ye,J);if(0>Qe){var Ot=-1;break e}if(y+=Qe,Qe<Ye)break;typeof J<"u"&&(J+=Qe)}Ot=y}return G[_>>2]=Ot,0}catch(Qt){if(typeof ct>"u"||Qt.name!=="ErrnoError")throw Qt;return Qt.Ka}},m:function(f,y,w,_,$){y=ko(y,w);try{if(isNaN(y))return 61;var J=hn(f);return bg(J,y,_),He=[J.position>>>0,(Re=J.position,1<=+Math.abs(Re)?0<Re?+Math.floor(Re/4294967296)>>>0:~~+Math.ceil((Re-+(~~Re>>>0))/4294967296)>>>0:0)],q[$>>2]=He[0],q[$+4>>2]=He[1],J.hb&&y===0&&_===0&&(J.hb=null),0}catch(ne){if(typeof ct>"u"||ne.name!=="ErrnoError")throw ne;return ne.Ka}},D:function(f){try{var y=hn(f);return y.Ha&&y.Ha.fsync?y.Ha.fsync(y):0}catch(w){if(typeof ct>"u"||w.name!=="ErrnoError")throw w;return w.Ka}},u:function(f,y,w,_){try{e:{var $=hn(f);f=y;for(var J,ne=y=0;ne<w;ne++){var qe=G[f>>2],Ye=G[f+4>>2];f+=8;var Qe=Cg($,K,qe,Ye,J);if(0>Qe){var Ot=-1;break e}y+=Qe,typeof J<"u"&&(J+=Qe)}Ot=y}return G[_>>2]=Ot,0}catch(Qt){if(typeof ct>"u"||Qt.name!=="ErrnoError")throw Qt;return Qt.Ka}}},Me=function(){function f(w){return Me=w.exports,W=Me.I,pe(),si=Me.Aa,de.unshift(Me.J),re--,u.monitorRunDependencies&&u.monitorRunDependencies(re),re==0&&Ze&&(w=Ze,Ze=null,w()),Me}var y={a:YC};if(re++,u.monitorRunDependencies&&u.monitorRunDependencies(re),u.instantiateWasm)try{return u.instantiateWasm(y,f)}catch(w){return F(`Module.instantiateWasm callback failed with error: ${w}`),!1}return nn(y,function(w){f(w.instance)}),{}}();u._sqlite3_free=f=>(u._sqlite3_free=Me.K)(f),u._sqlite3_value_text=f=>(u._sqlite3_value_text=Me.L)(f);var Mg=()=>(Mg=Me.M)();u._sqlite3_prepare_v2=(f,y,w,_,$)=>(u._sqlite3_prepare_v2=Me.N)(f,y,w,_,$),u._sqlite3_step=f=>(u._sqlite3_step=Me.O)(f),u._sqlite3_finalize=f=>(u._sqlite3_finalize=Me.P)(f),u._sqlite3_reset=f=>(u._sqlite3_reset=Me.Q)(f),u._sqlite3_clear_bindings=f=>(u._sqlite3_clear_bindings=Me.R)(f),u._sqlite3_value_blob=f=>(u._sqlite3_value_blob=Me.S)(f),u._sqlite3_value_bytes=f=>(u._sqlite3_value_bytes=Me.T)(f),u._sqlite3_value_double=f=>(u._sqlite3_value_double=Me.U)(f),u._sqlite3_value_int=f=>(u._sqlite3_value_int=Me.V)(f),u._sqlite3_value_type=f=>(u._sqlite3_value_type=Me.W)(f),u._sqlite3_result_blob=(f,y,w,_)=>(u._sqlite3_result_blob=Me.X)(f,y,w,_),u._sqlite3_result_double=(f,y)=>(u._sqlite3_result_double=Me.Y)(f,y),u._sqlite3_result_error=(f,y,w)=>(u._sqlite3_result_error=Me.Z)(f,y,w),u._sqlite3_result_int=(f,y)=>(u._sqlite3_result_int=Me._)(f,y),u._sqlite3_result_int64=(f,y,w)=>(u._sqlite3_result_int64=Me.$)(f,y,w),u._sqlite3_result_null=f=>(u._sqlite3_result_null=Me.aa)(f),u._sqlite3_result_text=(f,y,w,_)=>(u._sqlite3_result_text=Me.ba)(f,y,w,_),u._sqlite3_aggregate_context=(f,y)=>(u._sqlite3_aggregate_context=Me.ca)(f,y),u._sqlite3_column_count=f=>(u._sqlite3_column_count=Me.da)(f),u._sqlite3_data_count=f=>(u._sqlite3_data_count=Me.ea)(f),u._sqlite3_column_blob=(f,y)=>(u._sqlite3_column_blob=Me.fa)(f,y),u._sqlite3_column_bytes=(f,y)=>(u._sqlite3_column_bytes=Me.ga)(f,y),u._sqlite3_column_double=(f,y)=>(u._sqlite3_column_double=Me.ha)(f,y),u._sqlite3_column_text=(f,y)=>(u._sqlite3_column_text=Me.ia)(f,y),u._sqlite3_column_type=(f,y)=>(u._sqlite3_column_type=Me.ja)(f,y),u._sqlite3_column_name=(f,y)=>(u._sqlite3_column_name=Me.ka)(f,y),u._sqlite3_bind_blob=(f,y,w,_,$)=>(u._sqlite3_bind_blob=Me.la)(f,y,w,_,$),u._sqlite3_bind_double=(f,y,w)=>(u._sqlite3_bind_double=Me.ma)(f,y,w),u._sqlite3_bind_int=(f,y,w)=>(u._sqlite3_bind_int=Me.na)(f,y,w),u._sqlite3_bind_text=(f,y,w,_,$)=>(u._sqlite3_bind_text=Me.oa)(f,y,w,_,$),u._sqlite3_bind_parameter_index=(f,y)=>(u._sqlite3_bind_parameter_index=Me.pa)(f,y),u._sqlite3_sql=f=>(u._sqlite3_sql=Me.qa)(f),u._sqlite3_normalized_sql=f=>(u._sqlite3_normalized_sql=Me.ra)(f),u._sqlite3_errmsg=f=>(u._sqlite3_errmsg=Me.sa)(f),u._sqlite3_exec=(f,y,w,_,$)=>(u._sqlite3_exec=Me.ta)(f,y,w,_,$),u._sqlite3_changes=f=>(u._sqlite3_changes=Me.ua)(f),u._sqlite3_close_v2=f=>(u._sqlite3_close_v2=Me.va)(f),u._sqlite3_create_function_v2=(f,y,w,_,$,J,ne,qe,Ye)=>(u._sqlite3_create_function_v2=Me.wa)(f,y,w,_,$,J,ne,qe,Ye),u._sqlite3_open=(f,y)=>(u._sqlite3_open=Me.xa)(f,y);var Gu=u._malloc=f=>(Gu=u._malloc=Me.ya)(f),Ku=u._free=f=>(Ku=u._free=Me.za)(f);u._RegisterExtensionFunctions=f=>(u._RegisterExtensionFunctions=Me.Ba)(f);var Og=(f,y)=>(Og=Me.Ca)(f,y),Uo=()=>(Uo=Me.Da)(),jo=f=>(jo=Me.Ea)(f),ki=f=>(ki=Me.Fa)(f);u.stackAlloc=ki,u.stackSave=Uo,u.stackRestore=jo,u.cwrap=(f,y,w,_)=>{var $=!w||w.every(J=>J==="number"||J==="boolean");return y!=="string"&&$&&!_?u["_"+f]:function(){return JC(f,y,w,arguments)}},u.addFunction=Hu,u.removeFunction=Ts,u.UTF8ToString=$t,u.ALLOC_NORMAL=zu,u.allocate=Wu,u.allocateUTF8OnStack=qh;var Ju;Ze=function f(){Ju||Ig(),Ju||(Ze=f)};function Ig(){function f(){if(!Ju&&(Ju=!0,u.calledRun=!0,!B)){if(u.noFSInit||Ag||(Ag=!0,Sg(),u.stdin=u.stdin,u.stdout=u.stdout,u.stderr=u.stderr,u.stdin?Bo("stdin",u.stdin):Oh("/dev/tty","/dev/stdin"),u.stdout?Bo("stdout",null,u.stdout):Oh("/dev/tty","/dev/stdout"),u.stderr?Bo("stderr",null,u.stderr):Oh("/dev/tty1","/dev/stderr"),ws("/dev/stdin",0),ws("/dev/stdout",1),ws("/dev/stderr",1)),yt=!1,Pn(de),u.onRuntimeInitialized&&u.onRuntimeInitialized(),u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;){var y=u.postRun.shift();Ee.unshift(y)}Pn(Ee)}}if(!(0<re)){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)ye();Pn(ee),0<re||(u.setStatus?(u.setStatus("Running..."),setTimeout(function(){setTimeout(function(){u.setStatus("")},1),f()},1)):f())}}if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);0<u.preInit.length;)u.preInit.pop()();return Ig(),o}),t)};n.exports=r,n.exports.default=r})(Hb);var Gb=Hb.exports;const KP=ss(Gb),JP=iT({__proto__:null,default:KP},[Gb]);var YP=Object.defineProperty,XP=Object.getOwnPropertyDescriptor,Ta=(n,e,t,r)=>{for(var i=r>1?void 0:r?XP(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&YP(e,t,i),i};let ur=class{constructor(){we(this,"id");we(this,"origName");we(this,"loclName");we(this,"engine");we(this,"aliases");we(this,"__songs");we(this,"numSongs")}};Ta([Lr()],ur.prototype,"id",2);Ta([Et({type:"varchar",name:"original_name"})],ur.prototype,"origName",2);Ta([Et({type:"varchar",name:"localized_name"})],ur.prototype,"loclName",2);Ta([Li({type:"string",query:n=>`SELECT "engine" FROM "SynthEngines" WHERE "id" = ${n}.engine_id`})],ur.prototype,"engine",2);Ta([Li({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "SynthAlias" WHERE "synth_id" = ${n}.id`})],ur.prototype,"aliases",2);Ta([ii(()=>cr),ri({name:"TranslationSingers",joinColumn:{name:"synth_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],ur.prototype,"__songs",2);Ta([Li({type:"int",query:()=>'COUNT("song"."id")'})],ur.prototype,"numSongs",2);ur=Ta([qr("Synths")],ur);var ZP=Object.defineProperty,eM=Object.getOwnPropertyDescriptor,ba=(n,e,t,r)=>{for(var i=r>1?void 0:r?eM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&ZP(e,t,i),i};let xn=class{constructor(){we(this,"id");we(this,"origName");we(this,"loclName");we(this,"aliases");we(this,"__songsMade");we(this,"__songsSung");we(this,"numSongs")}};ba([Lr()],xn.prototype,"id",2);ba([Et({type:"varchar",name:"original_name"})],xn.prototype,"origName",2);ba([Et({type:"varchar",name:"localized_name"})],xn.prototype,"loclName",2);ba([Li({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "ProducerAlias" WHERE "producer_id" = ${n}.id`})],xn.prototype,"aliases",2);ba([ii(()=>cr),ri({name:"TranslationProducers",joinColumn:{name:"producer_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],xn.prototype,"__songsMade",2);ba([ii(()=>cr),ri({name:"TranslationSingers",joinColumn:{name:"vocalist_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],xn.prototype,"__songsSung",2);ba([Li({type:"int",query:()=>'COUNT("song"."id")'})],xn.prototype,"numSongs",2);xn=ba([qr("Producers")],xn);var tM=Object.defineProperty,nM=Object.getOwnPropertyDescriptor,xo=(n,e,t,r)=>{for(var i=r>1?void 0:r?nM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&tM(e,t,i),i};let cr=class{constructor(){we(this,"id");we(this,"synths");we(this,"vocalists");we(this,"producers");we(this,"circles")}};xo([Lr()],cr.prototype,"id",2);xo([ii(()=>ur),ri({name:"TranslationSingers",joinColumn:{name:"synth_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],cr.prototype,"synths",2);xo([ii(()=>xn),ri({name:"TranslationSingers",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"vocalist_id"}})],cr.prototype,"vocalists",2);xo([ii(()=>xn),ri({name:"TranslationProducers",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"producer_id"}})],cr.prototype,"producers",2);xo([ii(()=>Jr),ri({name:"TranslationCircles",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"circle_id"}})],cr.prototype,"circles",2);cr=xo([qr("Translations")],cr);var rM=Object.defineProperty,iM=Object.getOwnPropertyDescriptor,_o=(n,e,t,r)=>{for(var i=r>1?void 0:r?iM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&rM(e,t,i),i};let Jr=class{constructor(){we(this,"id");we(this,"origName");we(this,"loclName");we(this,"__songs");we(this,"numSongs")}};_o([Lr()],Jr.prototype,"id",2);_o([Et({type:"varchar",name:"original_name"})],Jr.prototype,"origName",2);_o([Et({type:"varchar",name:"localized_name"})],Jr.prototype,"loclName",2);_o([ii(()=>cr),ri({name:"TranslationCircles",joinColumn:{name:"circle_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],Jr.prototype,"__songs",2);_o([Li({type:"int",query:()=>'COUNT("song"."id")'})],Jr.prototype,"numSongs",2);Jr=_o([qr("Circles")],Jr);var aM=Object.defineProperty,sM=Object.getOwnPropertyDescriptor,ds=(n,e,t,r)=>{for(var i=r>1?void 0:r?sM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&aM(e,t,i),i};let Yr=class{constructor(){we(this,"id");we(this,"origName");we(this,"loclName");we(this,"engine");we(this,"aliases");we(this,"__songToSynths")}};ds([Lr()],Yr.prototype,"id",2);ds([Et({type:"varchar",name:"original_name"})],Yr.prototype,"origName",2);ds([Et({type:"varchar",name:"localized_name"})],Yr.prototype,"loclName",2);ds([Li({type:"string",query:n=>`SELECT "engine" FROM "SynthEngines" WHERE "id" = ${n}.engine_id`})],Yr.prototype,"engine",2);ds([Li({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "SynthAlias" WHERE "synth_id" = ${n}.id`})],Yr.prototype,"aliases",2);ds([Ro(()=>Fn,n=>n.__synthProps)],Yr.prototype,"__songToSynths",2);Yr=ds([qr("Synths")],Yr);var oM=Object.defineProperty,lM=Object.getOwnPropertyDescriptor,Au=(n,e,t,r)=>{for(var i=r>1?void 0:r?lM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&oM(e,t,i),i};let Si=class{constructor(){we(this,"__jnId");we(this,"__song");we(this,"__props");we(this,"role")}};Au([Lr({name:"id"})],Si.prototype,"__jnId",2);Au([Ao(()=>Rt,n=>n.producers),So({name:"translation_id"})],Si.prototype,"__song",2);Au([Ao(()=>$r,n=>n.__songToProducers),So({name:"producer_id"})],Si.prototype,"__props",2);Au([Et({type:"varchar",name:"role"})],Si.prototype,"role",2);Si=Au([qr("TranslationProducers")],Si);var uM=Object.defineProperty,cM=Object.getOwnPropertyDescriptor,hs=(n,e,t,r)=>{for(var i=r>1?void 0:r?cM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&uM(e,t,i),i};let $r=class{constructor(){we(this,"id");we(this,"origName");we(this,"loclName");we(this,"aliases");we(this,"__songToVocalists");we(this,"__songToProducers")}};hs([Lr()],$r.prototype,"id",2);hs([Et({type:"varchar",name:"original_name"})],$r.prototype,"origName",2);hs([Et({type:"varchar",name:"localized_name"})],$r.prototype,"loclName",2);hs([Li({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "ProducerAlias" WHERE "producer_id" = ${n}.id`})],$r.prototype,"aliases",2);hs([Ro(()=>Fn,n=>n.__vocalistProps)],$r.prototype,"__songToVocalists",2);hs([Ro(()=>Si,n=>n.__props)],$r.prototype,"__songToProducers",2);$r=hs([qr("Producers")],$r);var dM=Object.defineProperty,hM=Object.getOwnPropertyDescriptor,Na=(n,e,t,r)=>{for(var i=r>1?void 0:r?hM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&dM(e,t,i),i};let Fn=class{constructor(){we(this,"__jnId");we(this,"__songId");we(this,"__synthId");we(this,"__song");we(this,"__synthProps");we(this,"__vocalistProps");we(this,"ver")}};Na([Lr({name:"id"})],Fn.prototype,"__jnId",2);Na([iy(n=>n.__song)],Fn.prototype,"__songId",2);Na([iy(n=>n.__synthProps)],Fn.prototype,"__synthId",2);Na([Ao(()=>Rt,n=>n.singers),So({name:"translation_id"})],Fn.prototype,"__song",2);Na([Ao(()=>Yr,n=>n.__songToSynths),So({name:"synth_id"})],Fn.prototype,"__synthProps",2);Na([Ao(()=>$r,n=>n.__songToVocalists),So({name:"vocalist_id"})],Fn.prototype,"__vocalistProps",2);Na([Et({type:"int",name:"ver"})],Fn.prototype,"ver",2);Fn=Na([qr("TranslationSingers")],Fn);var fM=Object.defineProperty,pM=Object.getOwnPropertyDescriptor,Ru=(n,e,t,r)=>{for(var i=r>1?void 0:r?pM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&fM(e,t,i),i};let oa=class{constructor(){we(this,"id");we(this,"origName");we(this,"loclName");we(this,"__songs")}};Ru([Lr()],oa.prototype,"id",2);Ru([Et({type:"varchar",name:"original_name"})],oa.prototype,"origName",2);Ru([Et({type:"varchar",name:"localized_name"})],oa.prototype,"loclName",2);Ru([ii(()=>Rt),ri({name:"TranslationCircles",joinColumn:{name:"circle_id"},inverseJoinColumn:{name:"translation_id"}})],oa.prototype,"__songs",2);oa=Ru([qr("Circles")],oa);var mM=Object.defineProperty,yM=Object.getOwnPropertyDescriptor,Po=(n,e,t,r)=>{for(var i=r>1?void 0:r?yM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&mM(e,t,i),i};let Ai=class{constructor(){we(this,"id");we(this,"__translation_id");we(this,"__song");we(this,"subUrl");we(this,"description")}};Po([Lr()],Ai.prototype,"id",2);Po([iy(n=>n.__song)],Ai.prototype,"__translation_id",2);Po([Ao(()=>Rt,n=>n.subs),So({name:"translation_id"})],Ai.prototype,"__song",2);Po([Et({type:"varchar",name:"sub_url"})],Ai.prototype,"subUrl",2);Po([Et({type:"varchar",name:"description"})],Ai.prototype,"description",2);Ai=Po([qr("TranslationSubs")],Ai);var gM=Object.defineProperty,vM=Object.getOwnPropertyDescriptor,_n=(n,e,t,r)=>{for(var i=r>1?void 0:r?vM(e,t):e,a=n.length-1,s;a>=0;a--)(s=n[a])&&(i=(r?s(e,t,i):s(i))||i);return r&&i&&gM(e,t,i),i};let Rt=class{constructor(){we(this,"id");we(this,"orgTitle");we(this,"romTitle");we(this,"engTitle");we(this,"lang");we(this,"series");we(this,"pageUrl");we(this,"singers");we(this,"producers");we(this,"circles");we(this,"subs");we(this,"translatedDate");we(this,"releasedDate")}};_n([Lr()],Rt.prototype,"id",2);_n([Et({type:"varchar",name:"original_title"})],Rt.prototype,"orgTitle",2);_n([Et({type:"varchar",name:"romanized_title"})],Rt.prototype,"romTitle",2);_n([Et({type:"varchar",name:"english_title"})],Rt.prototype,"engTitle",2);_n([Et({type:"varchar"})],Rt.prototype,"lang",2);_n([Et({type:"varchar"})],Rt.prototype,"series",2);_n([Et({type:"varchar",name:"pageurl"})],Rt.prototype,"pageUrl",2);_n([Ro(()=>Fn,n=>n.__song)],Rt.prototype,"singers",2);_n([Ro(()=>Si,n=>n.__song)],Rt.prototype,"producers",2);_n([ii(()=>oa),ri({name:"TranslationCircles",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"circle_id"}})],Rt.prototype,"circles",2);_n([Ro(()=>Ai,n=>n.__song)],Rt.prototype,"subs",2);_n([Et({type:"text",name:"translated_date"})],Rt.prototype,"translatedDate",2);_n([Et({type:"text",name:"released_date"})],Rt.prototype,"releasedDate",2);Rt=_n([qr("Translations")],Rt);window.SQL=JP;function EM(){const[n,e]=Te.useState(null),[t,r]=Te.useState(null);return Te.useEffect(()=>{(async()=>{try{const i=await fetch(Cx).then(o=>o.arrayBuffer()),a=new Uint8Array(i),s=new WP({type:"sqljs",database:a,sqlJsConfig:{locateFile:()=>Nx},entities:[Jr,xn,ur,cr,Rt,Ai,Fn,Si,oa,Yr,$r],autoSave:!1,cache:!0});await s.initialize(),s.driver.databaseConnection.create_function("MATCHES",(o,l)=>{o=o||"",o=o.normalize("NFD").replace(/[\u0300-\u036f]/g,""),l=l.replace(/([\\\.\+\*\?\^\$\(\)\[\]\{\}\|\/])/g,"\\$1");const u=new RegExp("\\b"+l,"i");return o.match(u)!==null}),r(s),console.log("Successfully setup DB connection")}catch(i){console.error(i),e(i)}})()},[]),{dataSource:t,error:n}}const wM="database/setupSuccess",TM="database/setupFailure",bM="database/setupLoading",ay="synthsWithCount/fetchSuccess",sy="synthsWithCount/fetchFailure",oy="synthsWithCount/fetchLoading",ly="producersWithCount/fetchSuccess",uy="producersWithCount/fetchFailure",cy="producersWithCount/fetchLoading",dy="vocalistsWithCount/fetchSuccess",hy="vocalistsWithCount/fetchFailure",fy="vocalistsWithCount/fetchLoading",py="circlesWithCount/fetchSuccess",my="circlesWithCount/fetchFailure",yy="circlesWithCount/fetchLoading",gy="songs/fetchSuccess",vy="songs/fetchFailure",Ey="songs/fetchLoading",wy="songs/searchSuccess",Ty="songs/searchFailure",by="songs/searchLoading",Ed=10;function xu(n,e){e.synths&&e.synths.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationSingers" 
        WHERE "synth_id" IN (${e.synths.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("synth_id") = ${e.synths.length}
      )`),e.producers&&e.producers.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationProducers" 
        WHERE "producer_id" IN (${e.producers.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("producer_id") = ${e.producers.length}
      )`),e.vocalists&&e.vocalists.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationSingers" 
        WHERE "vocalist_id" IN (${e.vocalists.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("vocalist_id") = ${e.vocalists.length}
      )`),e.circles&&e.circles.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationCircles" 
        WHERE "circle_id" IN (${e.circles.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("circle_id") = ${e.circles.length}
      )`)}function NM(n,e){const t=n.getRepository(ur).createQueryBuilder("synth").innerJoin("synth.__songs","song",e.lang?`song.lang = '${e.lang}'`:void 0);return xu(t,e),t.groupBy("synth_id").orderBy("synth_numSongs","DESC").addOrderBy("LOWER(synth_localized_name)","ASC"),t.getMany()}function CM(n,e){const t=n.getRepository(xn).createQueryBuilder("producer").innerJoin("producer.__songsMade","song",e.lang?`song.lang = '${e.lang}'`:void 0);return xu(t,e),t.groupBy("producer_id").orderBy("producer_numSongs","DESC").addOrderBy("LOWER(producer_localized_name)","ASC"),t.getMany()}function SM(n,e){const t=n.getRepository(xn).createQueryBuilder("producer").innerJoin("producer.__songsSung","song",e.lang?`song.lang = '${e.lang}'`:void 0);return xu(t,e),t.groupBy("producer_id").orderBy("producer_numSongs","DESC").addOrderBy("LOWER(producer_localized_name)","ASC"),t.getMany()}function AM(n,e){const t=n.getRepository(Jr).createQueryBuilder("circle").innerJoin("circle.__songs","song",e.lang?`lang = '${e.lang}'`:void 0);return xu(t,e),t.groupBy("circle_id").orderBy("circle_numSongs","DESC").addOrderBy("LOWER(circle_localized_name)","ASC"),t.getMany()}function RM(n,e){var a,s;const t=n.getRepository(Rt).createQueryBuilder("song").leftJoinAndSelect("song.singers","singer").leftJoinAndSelect("singer.__synthProps","jnSynth").leftJoinAndSelect("singer.__vocalistProps","jnVocalist").leftJoinAndSelect("song.producers","producer").leftJoinAndSelect("producer.__props","jnProducer").leftJoinAndSelect("song.circles","circle").leftJoinAndSelect("song.subs","sub").where(e.lang?"song.lang=:lang":"TRUE",{lang:e.lang});e.ids?t.andWhere(`"song"."id" IN (${e.ids})`):xu(t,e);let r=((a=e.sort)==null?void 0:a.field)||null;switch(r){case"song_id":break;case"song_romanized_title":r=`LOWER("${r}")`;break;case"song_english_title":r=`LOWER(COALESCE("${r}", "song_original_title"))`;break;case"song_released_date":r='DATE("song_released_date")';break;case"song_translated_date":default:r='DATE("song_translated_date")'}let i=r?((s=e.sort)==null?void 0:s.order)||"ASC":"DESC";return t.orderBy(r,i).take(Ed).skip(((e.page||1)-1)*Ed),t.getManyAndCount()}function xM(n,e){return n.getRepository(Rt).createQueryBuilder("song").select(["song.id","song.orgTitle","song.romTitle","song.engTitle"]).where("MATCHES(song_original_title, :query)").orWhere("MATCHES(song_romanized_title, :query)").orWhere("MATCHES(song_english_title, :query)").setParameter("query",e).getMany()}const _M=n=>({type:ay,payload:n}),PM=()=>({type:sy}),ME=n=>({type:oy,payload:n}),MM=(n,e)=>async t=>{t(ME(!0));try{const r=await NM(n,e);t(_M(r))}catch(r){t(PM()),console.error(r)}finally{t(ME(!1))}},OM=n=>({type:dy,payload:n}),IM=()=>({type:hy}),OE=n=>({type:fy,payload:n}),DM=(n,e)=>async t=>{t(OE(!0));try{const r=await SM(n,e);t(OM(r))}catch(r){t(IM()),console.error(r)}finally{t(OE(!1))}},$M=n=>({type:ly,payload:n}),LM=()=>({type:uy}),IE=n=>({type:cy,payload:n}),qM=(n,e)=>async t=>{t(IE(!0));try{const r=await CM(n,e);t($M(r))}catch(r){t(LM()),console.error(r)}finally{t(IE(!1))}},BM=n=>({type:py,payload:n}),FM=()=>({type:my}),DE=n=>({type:yy,payload:n}),kM=(n,e)=>async t=>{t(DE(!0));try{const r=await AM(n,e);t(BM(r))}catch(r){t(FM()),console.error(r)}finally{t(DE(!1))}},UM=n=>({type:gy,payload:n}),jM=()=>({type:vy}),$E=n=>({type:Ey,payload:n}),QM=(n,e)=>async t=>{t($E(!0));try{const[r,i]=await RM(n,e);t(UM({songs:r,count:i}))}catch(r){t(jM()),console.error(r)}finally{t($E(!1))}},VM=n=>({type:wy,payload:n}),zM=()=>({type:Ty}),LE=n=>({type:by,payload:n}),WM=(n,e)=>async t=>{t(LE(!0));try{const r=await xM(n,e);console.log(r),t(VM(r))}catch(r){t(zM()),console.error(r)}finally{t(LE(!1))}};function qp(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,a;for(a=0;a<r.length;a++)i=r[a],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}var Kb={exports:{}},rt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gt=typeof Symbol=="function"&&Symbol.for,Ny=Gt?Symbol.for("react.element"):60103,Cy=Gt?Symbol.for("react.portal"):60106,rh=Gt?Symbol.for("react.fragment"):60107,ih=Gt?Symbol.for("react.strict_mode"):60108,ah=Gt?Symbol.for("react.profiler"):60114,sh=Gt?Symbol.for("react.provider"):60109,oh=Gt?Symbol.for("react.context"):60110,Sy=Gt?Symbol.for("react.async_mode"):60111,lh=Gt?Symbol.for("react.concurrent_mode"):60111,uh=Gt?Symbol.for("react.forward_ref"):60112,ch=Gt?Symbol.for("react.suspense"):60113,HM=Gt?Symbol.for("react.suspense_list"):60120,dh=Gt?Symbol.for("react.memo"):60115,hh=Gt?Symbol.for("react.lazy"):60116,GM=Gt?Symbol.for("react.block"):60121,KM=Gt?Symbol.for("react.fundamental"):60117,JM=Gt?Symbol.for("react.responder"):60118,YM=Gt?Symbol.for("react.scope"):60119;function Wn(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case Ny:switch(n=n.type,n){case Sy:case lh:case rh:case ah:case ih:case ch:return n;default:switch(n=n&&n.$$typeof,n){case oh:case uh:case hh:case dh:case sh:return n;default:return e}}case Cy:return e}}}function Jb(n){return Wn(n)===lh}rt.AsyncMode=Sy;rt.ConcurrentMode=lh;rt.ContextConsumer=oh;rt.ContextProvider=sh;rt.Element=Ny;rt.ForwardRef=uh;rt.Fragment=rh;rt.Lazy=hh;rt.Memo=dh;rt.Portal=Cy;rt.Profiler=ah;rt.StrictMode=ih;rt.Suspense=ch;rt.isAsyncMode=function(n){return Jb(n)||Wn(n)===Sy};rt.isConcurrentMode=Jb;rt.isContextConsumer=function(n){return Wn(n)===oh};rt.isContextProvider=function(n){return Wn(n)===sh};rt.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===Ny};rt.isForwardRef=function(n){return Wn(n)===uh};rt.isFragment=function(n){return Wn(n)===rh};rt.isLazy=function(n){return Wn(n)===hh};rt.isMemo=function(n){return Wn(n)===dh};rt.isPortal=function(n){return Wn(n)===Cy};rt.isProfiler=function(n){return Wn(n)===ah};rt.isStrictMode=function(n){return Wn(n)===ih};rt.isSuspense=function(n){return Wn(n)===ch};rt.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===rh||n===lh||n===ah||n===ih||n===ch||n===HM||typeof n=="object"&&n!==null&&(n.$$typeof===hh||n.$$typeof===dh||n.$$typeof===sh||n.$$typeof===oh||n.$$typeof===uh||n.$$typeof===KM||n.$$typeof===JM||n.$$typeof===YM||n.$$typeof===GM)};rt.typeOf=Wn;Kb.exports=rt;var XM=Kb.exports;function wt(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Dp(n,e)}var zr=function(e,t){if(typeof e=="function"){e(t);return}e!==null&&typeof e=="object"&&(e.current=t)},ZM=function(e){return e!==null&&typeof e=="object"&&e.hasOwnProperty("current")},eO=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.prevNode=void 0,r}var t=e.prototype;return t.componentDidMount=function(){var i=jl.findDOMNode(this);this.prevNode=i,zr(this.props.innerRef,i)},t.componentDidUpdate=function(i){var a=jl.findDOMNode(this);this.prevNode!==a&&(this.prevNode=a,zr(this.props.innerRef,a)),i.innerRef!==this.props.innerRef&&zr(this.props.innerRef,a)},t.componentWillUnmount=function(){zr(this.props.innerRef,null),delete this.prevNode},t.render=function(){var i=this.props.children;return i},e}(Te.Component),tO=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.currentNode=void 0,r.handleRefOverride=function(o){var l=r.props,u=l.children,c=l.innerRef;zr(u.ref,o),zr(c,o),r.currentNode=o},r}var t=e.prototype;return t.componentDidUpdate=function(i){i.innerRef!==this.props.innerRef&&zr(this.props.innerRef,this.currentNode)},t.componentWillUnmount=function(){delete this.currentNode},t.render=function(){var i=this.props.children;return Te.cloneElement(i,{ref:this.handleRefOverride})},e}(Te.Component),nO=["children","innerRef"],Ri=function(e){var t=e.children,r=e.innerRef,i=qp(e,nO),a=Te.Children.only(t),s=XM.isForwardRef(a)?tO:eO,o=a&&i&&Object.keys(i).length>0?Te.cloneElement(a,i):a;return Te.createElement(s,{innerRef:r},o)};function te(){return te=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},te.apply(this,arguments)}var Pt=Array.isArray,Yb=typeof global=="object"&&global&&global.Object===Object&&global,rO=typeof self=="object"&&self&&self.Object===Object&&self,Hn=Yb||rO||Function("return this")(),Xr=Hn.Symbol,Xb=Object.prototype,iO=Xb.hasOwnProperty,aO=Xb.toString,el=Xr?Xr.toStringTag:void 0;function sO(n){var e=iO.call(n,el),t=n[el];try{n[el]=void 0;var r=!0}catch{}var i=aO.call(n);return r&&(e?n[el]=t:delete n[el]),i}var oO=Object.prototype,lO=oO.toString;function uO(n){return lO.call(n)}var cO="[object Null]",dO="[object Undefined]",qE=Xr?Xr.toStringTag:void 0;function ai(n){return n==null?n===void 0?dO:cO:qE&&qE in Object(n)?sO(n):uO(n)}function kn(n){return n!=null&&typeof n=="object"}var hO="[object Symbol]";function fh(n){return typeof n=="symbol"||kn(n)&&ai(n)==hO}var fO=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pO=/^\w*$/;function Ay(n,e){if(Pt(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||fh(n)?!0:pO.test(n)||!fO.test(n)||e!=null&&n in Object(e)}function Zr(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var mO="[object AsyncFunction]",yO="[object Function]",gO="[object GeneratorFunction]",vO="[object Proxy]";function to(n){if(!Zr(n))return!1;var e=ai(n);return e==yO||e==gO||e==mO||e==vO}var Nf=Hn["__core-js_shared__"],BE=function(){var n=/[^.]+$/.exec(Nf&&Nf.keys&&Nf.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function EO(n){return!!BE&&BE in n}var wO=Function.prototype,TO=wO.toString;function fs(n){if(n!=null){try{return TO.call(n)}catch{}try{return n+""}catch{}}return""}var bO=/[\\^$.*+?()[\]{}|]/g,NO=/^\[object .+?Constructor\]$/,CO=Function.prototype,SO=Object.prototype,AO=CO.toString,RO=SO.hasOwnProperty,xO=RegExp("^"+AO.call(RO).replace(bO,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _O(n){if(!Zr(n)||EO(n))return!1;var e=to(n)?xO:NO;return e.test(fs(n))}function PO(n,e){return n==null?void 0:n[e]}function ps(n,e){var t=PO(n,e);return _O(t)?t:void 0}var zl=ps(Object,"create");function MO(){this.__data__=zl?zl(null):{},this.size=0}function OO(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var IO="__lodash_hash_undefined__",DO=Object.prototype,$O=DO.hasOwnProperty;function LO(n){var e=this.__data__;if(zl){var t=e[n];return t===IO?void 0:t}return $O.call(e,n)?e[n]:void 0}var qO=Object.prototype,BO=qO.hasOwnProperty;function FO(n){var e=this.__data__;return zl?e[n]!==void 0:BO.call(e,n)}var kO="__lodash_hash_undefined__";function UO(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=zl&&e===void 0?kO:e,this}function Ya(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ya.prototype.clear=MO;Ya.prototype.delete=OO;Ya.prototype.get=LO;Ya.prototype.has=FO;Ya.prototype.set=UO;function jO(){this.__data__=[],this.size=0}function ph(n,e){return n===e||n!==n&&e!==e}function mh(n,e){for(var t=n.length;t--;)if(ph(n[t][0],e))return t;return-1}var QO=Array.prototype,VO=QO.splice;function zO(n){var e=this.__data__,t=mh(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():VO.call(e,t,1),--this.size,!0}function WO(n){var e=this.__data__,t=mh(e,n);return t<0?void 0:e[t][1]}function HO(n){return mh(this.__data__,n)>-1}function GO(n,e){var t=this.__data__,r=mh(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function qi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}qi.prototype.clear=jO;qi.prototype.delete=zO;qi.prototype.get=WO;qi.prototype.has=HO;qi.prototype.set=GO;var Wl=ps(Hn,"Map");function KO(){this.size=0,this.__data__={hash:new Ya,map:new(Wl||qi),string:new Ya}}function JO(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function yh(n,e){var t=n.__data__;return JO(e)?t[typeof e=="string"?"string":"hash"]:t.map}function YO(n){var e=yh(this,n).delete(n);return this.size-=e?1:0,e}function XO(n){return yh(this,n).get(n)}function ZO(n){return yh(this,n).has(n)}function eI(n,e){var t=yh(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function Bi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Bi.prototype.clear=KO;Bi.prototype.delete=YO;Bi.prototype.get=XO;Bi.prototype.has=ZO;Bi.prototype.set=eI;var tI="Expected a function";function gh(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(tI);var t=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=t.cache;if(a.has(i))return a.get(i);var s=n.apply(this,r);return t.cache=a.set(i,s)||a,s};return t.cache=new(gh.Cache||Bi),t}gh.Cache=Bi;var nI=500;function rI(n){var e=gh(n,function(r){return t.size===nI&&t.clear(),r}),t=e.cache;return e}var iI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,aI=/\\(\\)?/g,sI=rI(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(iI,function(t,r,i,a){e.push(i?a.replace(aI,"$1"):r||t)}),e});function vh(n,e){for(var t=-1,r=n==null?0:n.length,i=Array(r);++t<r;)i[t]=e(n[t],t,n);return i}var oI=1/0,FE=Xr?Xr.prototype:void 0,kE=FE?FE.toString:void 0;function Zb(n){if(typeof n=="string")return n;if(Pt(n))return vh(n,Zb)+"";if(fh(n))return kE?kE.call(n):"";var e=n+"";return e=="0"&&1/n==-oI?"-0":e}function _u(n){return n==null?"":Zb(n)}function Pu(n,e){return Pt(n)?n:Ay(n,e)?[n]:sI(_u(n))}var lI="[object Arguments]";function UE(n){return kn(n)&&ai(n)==lI}var eN=Object.prototype,uI=eN.hasOwnProperty,cI=eN.propertyIsEnumerable,dI=UE(function(){return arguments}())?UE:function(n){return kn(n)&&uI.call(n,"callee")&&!cI.call(n,"callee")};const Eh=dI;var hI=9007199254740991,fI=/^(?:0|[1-9]\d*)$/;function Mu(n,e){var t=typeof n;return e=e??hI,!!e&&(t=="number"||t!="symbol"&&fI.test(n))&&n>-1&&n%1==0&&n<e}var pI=9007199254740991;function Ry(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=pI}var mI=1/0;function Mo(n){if(typeof n=="string"||fh(n))return n;var e=n+"";return e=="0"&&1/n==-mI?"-0":e}function yI(n,e,t){e=Pu(e,n);for(var r=-1,i=e.length,a=!1;++r<i;){var s=Mo(e[r]);if(!(a=n!=null&&t(n,s)))break;n=n[s]}return a||++r!=i?a:(i=n==null?0:n.length,!!i&&Ry(i)&&Mu(s,i)&&(Pt(n)||Eh(n)))}function wh(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function gI(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}function Th(n,e){e=Pu(e,n);for(var t=0,r=e.length;n!=null&&t<r;)n=n[Mo(e[t++])];return t&&t==r?n:void 0}function xy(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var a=Array(i);++r<i;)a[r]=n[r+e];return a}function vI(n,e){return e.length<2?n:Th(n,xy(e,0,-1))}function EI(n,e,t){e=Pu(e,n),n=vI(n,e);var r=n==null?n:n[Mo(gI(e))];return r==null?void 0:wh(r,n,t)}function Oo(n){return n}var jE=Math.max;function tN(n,e,t){return e=jE(e===void 0?n.length-1:e,0),function(){for(var r=arguments,i=-1,a=jE(r.length-e,0),s=Array(a);++i<a;)s[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=t(s),wh(n,this,o)}}function nN(n){return function(){return n}}var wd=function(){try{var n=ps(Object,"defineProperty");return n({},"",{}),n}catch{}}(),wI=wd?function(n,e){return wd(n,"toString",{configurable:!0,enumerable:!1,value:nN(e),writable:!0})}:Oo;const TI=wI;var bI=800,NI=16,CI=Date.now;function rN(n){var e=0,t=0;return function(){var r=CI(),i=NI-(r-t);if(t=r,i>0){if(++e>=bI)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}var _y=rN(TI);function Ou(n,e){return _y(tN(n,e,Oo),n+"")}var SI=Ou(EI);const ve=SI;function Iu(n){return n===void 0}var AI=/\s/;function RI(n){for(var e=n.length;e--&&AI.test(n.charAt(e)););return e}var xI=/^\s+/;function _I(n){return n&&n.slice(0,RI(n)+1).replace(xI,"")}var QE=NaN,PI=/^[-+]0x[0-9a-f]+$/i,MI=/^0b[01]+$/i,OI=/^0o[0-7]+$/i,II=parseInt;function iN(n){if(typeof n=="number")return n;if(fh(n))return QE;if(Zr(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Zr(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=_I(n);var t=MI.test(n);return t||OI.test(n)?II(n.slice(2),t?2:8):PI.test(n)?QE:+n}var VE=1/0,DI=17976931348623157e292;function Ws(n){if(!n)return n===0?n:0;if(n=iN(n),n===VE||n===-VE){var e=n<0?-1:1;return e*DI}return n===n?n:0}function Hl(n){var e=Ws(n),t=e%1;return e===e?t?e-t:e:0}function aN(n,e){for(var t=-1,r=n==null?0:n.length,i=0,a=[];++t<r;){var s=n[t];e(s,t,n)&&(a[i++]=s)}return a}function $I(n){return function(e,t,r){for(var i=-1,a=Object(e),s=r(e),o=s.length;o--;){var l=s[n?o:++i];if(t(a[l],l,a)===!1)break}return e}}var LI=$I();const qI=LI;function BI(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}function FI(){return!1}var sN=typeof pi=="object"&&pi&&!pi.nodeType&&pi,zE=sN&&typeof mi=="object"&&mi&&!mi.nodeType&&mi,kI=zE&&zE.exports===sN,WE=kI?Hn.Buffer:void 0,UI=WE?WE.isBuffer:void 0,jI=UI||FI;const Td=jI;var QI="[object Arguments]",VI="[object Array]",zI="[object Boolean]",WI="[object Date]",HI="[object Error]",GI="[object Function]",KI="[object Map]",JI="[object Number]",YI="[object Object]",XI="[object RegExp]",ZI="[object Set]",eD="[object String]",tD="[object WeakMap]",nD="[object ArrayBuffer]",rD="[object DataView]",iD="[object Float32Array]",aD="[object Float64Array]",sD="[object Int8Array]",oD="[object Int16Array]",lD="[object Int32Array]",uD="[object Uint8Array]",cD="[object Uint8ClampedArray]",dD="[object Uint16Array]",hD="[object Uint32Array]",ht={};ht[iD]=ht[aD]=ht[sD]=ht[oD]=ht[lD]=ht[uD]=ht[cD]=ht[dD]=ht[hD]=!0;ht[QI]=ht[VI]=ht[nD]=ht[zI]=ht[rD]=ht[WI]=ht[HI]=ht[GI]=ht[KI]=ht[JI]=ht[YI]=ht[XI]=ht[ZI]=ht[eD]=ht[tD]=!1;function fD(n){return kn(n)&&Ry(n.length)&&!!ht[ai(n)]}function oN(n){return function(e){return n(e)}}var lN=typeof pi=="object"&&pi&&!pi.nodeType&&pi,wl=lN&&typeof mi=="object"&&mi&&!mi.nodeType&&mi,pD=wl&&wl.exports===lN,Cf=pD&&Yb.process,HE=function(){try{var n=wl&&wl.require&&wl.require("util").types;return n||Cf&&Cf.binding&&Cf.binding("util")}catch{}}(),GE=HE&&HE.isTypedArray,mD=GE?oN(GE):fD;const Py=mD;var yD=Object.prototype,gD=yD.hasOwnProperty;function vD(n,e){var t=Pt(n),r=!t&&Eh(n),i=!t&&!r&&Td(n),a=!t&&!r&&!i&&Py(n),s=t||r||i||a,o=s?BI(n.length,String):[],l=o.length;for(var u in n)(e||gD.call(n,u))&&!(s&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Mu(u,l)))&&o.push(u);return o}var ED=Object.prototype;function uN(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||ED;return n===t}function cN(n,e){return function(t){return n(e(t))}}var wD=cN(Object.keys,Object),TD=Object.prototype,bD=TD.hasOwnProperty;function My(n){if(!uN(n))return wD(n);var e=[];for(var t in Object(n))bD.call(n,t)&&t!="constructor"&&e.push(t);return e}function Fi(n){return n!=null&&Ry(n.length)&&!to(n)}function Io(n){return Fi(n)?vD(n):My(n)}function dN(n,e){return n&&qI(n,e,Io)}function ND(n,e){return function(t,r){if(t==null)return t;if(!Fi(t))return n(t,r);for(var i=t.length,a=e?i:-1,s=Object(t);(e?a--:++a<i)&&r(s[a],a,s)!==!1;);return t}}var CD=ND(dN);const Do=CD;function SD(n,e){var t=[];return Do(n,function(r,i,a){e(r,i,a)&&t.push(r)}),t}function AD(){this.__data__=new qi,this.size=0}function RD(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function xD(n){return this.__data__.get(n)}function _D(n){return this.__data__.has(n)}var PD=200;function MD(n,e){var t=this.__data__;if(t instanceof qi){var r=t.__data__;if(!Wl||r.length<PD-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Bi(r)}return t.set(n,e),this.size=t.size,this}function vi(n){var e=this.__data__=new qi(n);this.size=e.size}vi.prototype.clear=AD;vi.prototype.delete=RD;vi.prototype.get=xD;vi.prototype.has=_D;vi.prototype.set=MD;var OD="__lodash_hash_undefined__";function ID(n){return this.__data__.set(n,OD),this}function DD(n){return this.__data__.has(n)}function no(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Bi;++e<t;)this.add(n[e])}no.prototype.add=no.prototype.push=ID;no.prototype.has=DD;function hN(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}function Oy(n,e){return n.has(e)}var $D=1,LD=2;function fN(n,e,t,r,i,a){var s=t&$D,o=n.length,l=e.length;if(o!=l&&!(s&&l>o))return!1;var u=a.get(n),c=a.get(e);if(u&&c)return u==e&&c==n;var d=-1,h=!0,p=t&LD?new no:void 0;for(a.set(n,e),a.set(e,n);++d<o;){var g=n[d],E=e[d];if(r)var A=s?r(E,g,d,e,n,a):r(g,E,d,n,e,a);if(A!==void 0){if(A)continue;h=!1;break}if(p){if(!hN(e,function(b,T){if(!Oy(p,T)&&(g===b||i(g,b,t,r,a)))return p.push(T)})){h=!1;break}}else if(!(g===E||i(g,E,t,r,a))){h=!1;break}}return a.delete(n),a.delete(e),h}var qD=Hn.Uint8Array;const KE=qD;function BD(n){var e=-1,t=Array(n.size);return n.forEach(function(r,i){t[++e]=[i,r]}),t}function Iy(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var FD=1,kD=2,UD="[object Boolean]",jD="[object Date]",QD="[object Error]",VD="[object Map]",zD="[object Number]",WD="[object RegExp]",HD="[object Set]",GD="[object String]",KD="[object Symbol]",JD="[object ArrayBuffer]",YD="[object DataView]",JE=Xr?Xr.prototype:void 0,Sf=JE?JE.valueOf:void 0;function XD(n,e,t,r,i,a,s){switch(t){case YD:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case JD:return!(n.byteLength!=e.byteLength||!a(new KE(n),new KE(e)));case UD:case jD:case zD:return ph(+n,+e);case QD:return n.name==e.name&&n.message==e.message;case WD:case GD:return n==e+"";case VD:var o=BD;case HD:var l=r&FD;if(o||(o=Iy),n.size!=e.size&&!l)return!1;var u=s.get(n);if(u)return u==e;r|=kD,s.set(n,e);var c=fN(o(n),o(e),r,i,a,s);return s.delete(n),c;case KD:if(Sf)return Sf.call(n)==Sf.call(e)}return!1}function pN(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}function ZD(n,e,t){var r=e(n);return Pt(n)?r:pN(r,t(n))}function e$(){return[]}var t$=Object.prototype,n$=t$.propertyIsEnumerable,YE=Object.getOwnPropertySymbols,r$=YE?function(n){return n==null?[]:(n=Object(n),aN(YE(n),function(e){return n$.call(n,e)}))}:e$;const i$=r$;function XE(n){return ZD(n,Io,i$)}var a$=1,s$=Object.prototype,o$=s$.hasOwnProperty;function l$(n,e,t,r,i,a){var s=t&a$,o=XE(n),l=o.length,u=XE(e),c=u.length;if(l!=c&&!s)return!1;for(var d=l;d--;){var h=o[d];if(!(s?h in e:o$.call(e,h)))return!1}var p=a.get(n),g=a.get(e);if(p&&g)return p==e&&g==n;var E=!0;a.set(n,e),a.set(e,n);for(var A=s;++d<l;){h=o[d];var b=n[h],T=e[h];if(r)var C=s?r(T,b,h,e,n,a):r(b,T,h,n,e,a);if(!(C===void 0?b===T||i(b,T,t,r,a):C)){E=!1;break}A||(A=h=="constructor")}if(E&&!A){var P=n.constructor,D=e.constructor;P!=D&&"constructor"in n&&"constructor"in e&&!(typeof P=="function"&&P instanceof P&&typeof D=="function"&&D instanceof D)&&(E=!1)}return a.delete(n),a.delete(e),E}var Bp=ps(Hn,"DataView"),Fp=ps(Hn,"Promise"),Hs=ps(Hn,"Set"),Gl=ps(Hn,"WeakMap"),ZE="[object Map]",u$="[object Object]",ew="[object Promise]",tw="[object Set]",nw="[object WeakMap]",rw="[object DataView]",c$=fs(Bp),d$=fs(Wl),h$=fs(Fp),f$=fs(Hs),p$=fs(Gl),$a=ai;(Bp&&$a(new Bp(new ArrayBuffer(1)))!=rw||Wl&&$a(new Wl)!=ZE||Fp&&$a(Fp.resolve())!=ew||Hs&&$a(new Hs)!=tw||Gl&&$a(new Gl)!=nw)&&($a=function(n){var e=ai(n),t=e==u$?n.constructor:void 0,r=t?fs(t):"";if(r)switch(r){case c$:return rw;case d$:return ZE;case h$:return ew;case f$:return tw;case p$:return nw}return e});const bd=$a;var m$=1,iw="[object Arguments]",aw="[object Array]",Tc="[object Object]",y$=Object.prototype,sw=y$.hasOwnProperty;function g$(n,e,t,r,i,a){var s=Pt(n),o=Pt(e),l=s?aw:bd(n),u=o?aw:bd(e);l=l==iw?Tc:l,u=u==iw?Tc:u;var c=l==Tc,d=u==Tc,h=l==u;if(h&&Td(n)){if(!Td(e))return!1;s=!0,c=!1}if(h&&!c)return a||(a=new vi),s||Py(n)?fN(n,e,t,r,i,a):XD(n,e,l,t,r,i,a);if(!(t&m$)){var p=c&&sw.call(n,"__wrapped__"),g=d&&sw.call(e,"__wrapped__");if(p||g){var E=p?n.value():n,A=g?e.value():e;return a||(a=new vi),i(E,A,t,r,a)}}return h?(a||(a=new vi),l$(n,e,t,r,i,a)):!1}function bh(n,e,t,r,i){return n===e?!0:n==null||e==null||!kn(n)&&!kn(e)?n!==n&&e!==e:g$(n,e,t,r,bh,i)}var v$=1,E$=2;function w$(n,e,t,r){var i=t.length,a=i,s=!r;if(n==null)return!a;for(n=Object(n);i--;){var o=t[i];if(s&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return!1}for(;++i<a;){o=t[i];var l=o[0],u=n[l],c=o[1];if(s&&o[2]){if(u===void 0&&!(l in n))return!1}else{var d=new vi;if(r)var h=r(u,c,l,n,e,d);if(!(h===void 0?bh(c,u,v$|E$,r,d):h))return!1}}return!0}function mN(n){return n===n&&!Zr(n)}function T$(n){for(var e=Io(n),t=e.length;t--;){var r=e[t],i=n[r];e[t]=[r,i,mN(i)]}return e}function yN(n,e){return function(t){return t==null?!1:t[n]===e&&(e!==void 0||n in Object(t))}}function b$(n){var e=T$(n);return e.length==1&&e[0][2]?yN(e[0][0],e[0][1]):function(t){return t===n||w$(t,n,e)}}function Ki(n,e,t){var r=n==null?void 0:Th(n,e);return r===void 0?t:r}function N$(n,e){return n!=null&&e in Object(n)}function gN(n,e){return n!=null&&yI(n,e,N$)}var C$=1,S$=2;function A$(n,e){return Ay(n)&&mN(e)?yN(Mo(n),e):function(t){var r=Ki(t,n);return r===void 0&&r===e?gN(t,n):bh(e,r,C$|S$)}}function vN(n){return function(e){return e==null?void 0:e[n]}}function R$(n){return function(e){return Th(e,n)}}function x$(n){return Ay(n)?vN(Mo(n)):R$(n)}function ms(n){return typeof n=="function"?n:n==null?Oo:typeof n=="object"?Pt(n)?A$(n[0],n[1]):b$(n):x$(n)}function ow(n,e){var t=Pt(n)?aN:SD;return t(n,ms(e))}var _$="[object Map]",P$="[object Set]",M$=Object.prototype,O$=M$.hasOwnProperty;function ul(n){if(n==null)return!0;if(Fi(n)&&(Pt(n)||typeof n=="string"||typeof n.splice=="function"||Td(n)||Py(n)||Eh(n)))return!n.length;var e=bd(n);if(e==_$||e==P$)return!n.size;if(uN(n))return!My(n).length;for(var t in n)if(O$.call(n,t))return!1;return!0}function EN(n,e,t,r){for(var i=n.length,a=t+(r?1:-1);r?a--:++a<i;)if(e(n[a],a,n))return a;return-1}function I$(n){return n!==n}function D$(n,e,t){for(var r=t-1,i=n.length;++r<i;)if(n[r]===e)return r;return-1}function wN(n,e,t){return e===e?D$(n,e,t):EN(n,I$,t)}function Dy(n,e){var t=n==null?0:n.length;return!!t&&wN(n,e,0)>-1}function TN(n,e,t){for(var r=-1,i=n==null?0:n.length;++r<i;)if(t(e,n[r]))return!0;return!1}function Nd(n){return kn(n)&&Fi(n)}function bN(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}function $$(n){return typeof n=="function"?n:Oo}function NN(n,e){var t=Pt(n)?bN:Do;return t(n,$$(e))}var L$=function(e){return"default"+(e[0].toUpperCase()+e.slice(1))},q$=function(e,t,r,i){i===void 0&&(i=!1);var a=t[e];if(a!==void 0)return a;if(i){var s=t[L$(e)];if(s!==void 0)return s;if(r){var o=r[e];if(o!==void 0)return o}}if(e==="checked")return!1;if(e==="value")return t.multiple?[]:""},$o=function(n){wt(e,n);function e(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=n.call.apply(n,[this].concat(i))||this;var s=t.constructor,o=s.autoControlledProps,l=s.getAutoControlledStateFromProps,u=ve(g1(t),"getInitialAutoControlledState",t.props)||{},c=o.reduce(function(d,h){return d[h]=q$(h,t.props,u,!0),d},{});return t.state=te({},u,c,{autoControlledProps:o,getAutoControlledStateFromProps:l}),t}return e.getDerivedStateFromProps=function(r,i){var a=i.autoControlledProps,s=i.getAutoControlledStateFromProps,o=a.reduce(function(u,c){var d=!Iu(r[c]);return d&&(u[c]=r[c]),u},{});if(s){var l=s(r,te({},i,o),i);return te({},o,l)}return o},e.getAutoControlledStateFromProps=function(){return null},e}(Y.Component);function B$(n){return function(e,t,r){var i=Object(e);if(!Fi(e)){var a=ms(t);e=Io(e),t=function(o){return a(i[o],o,i)}}var s=n(e,t,r);return s>-1?i[a?e[s]:s]:void 0}}var F$=Math.max;function kp(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var i=t==null?0:Hl(t);return i<0&&(i=F$(r+i,0)),EN(n,ms(e),i)}var CN=B$(kp);function k$(n,e){var t;return Do(n,function(r,i,a){return t=e(r,i,a),!t}),!!t}function $y(n,e,t){if(!Zr(t))return!1;var r=typeof e;return(r=="number"?Fi(t)&&Mu(e,t.length):r=="string"&&e in t)?ph(t[e],n):!1}function Tl(n,e,t){var r=Pt(n)?hN:k$;return t&&$y(n,e,t)&&(e=void 0),r(n,ms(e))}var U$=function(e,t){return Tl(Te.Children.toArray(e),{type:t})},je=function(e){return e==null||Array.isArray(e)&&e.length===0},j$={1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine",10:"ten",11:"eleven",12:"twelve",13:"thirteen",14:"fourteen",15:"fifteen",16:"sixteen"};function lw(n){var e=typeof n;return e==="string"||e==="number"?j$[n]||n:""}var k=function(e,t){return e&&t},cn=function(e,t){return e&&e!==!0&&e+" "+t},vt=function(e,t){return e&&(e===!0?t:e+" "+t)},Cd=function(e,t){return!e||e===!0?null:e.replace("large screen","large-screen").replace(/ vertically/g,"-vertically").split(" ").map(function(r){return r.replace("-"," ")+" "+t}).join(" ")},ys=function(e){return e==="justified"?"justified":cn(e,"aligned")},Ca=function(e){return cn(e,"aligned")},er=function(e,t,r){if(t===void 0&&(t=""),r===void 0&&(r=!1),r&&e==="equal")return"equal width";var i=typeof e;return(i==="string"||i==="number")&&t?lw(e)+" "+t:lw(e)},Q$=200;function SN(n,e,t,r){var i=-1,a=Dy,s=!0,o=n.length,l=[],u=e.length;if(!o)return l;t&&(e=vh(e,oN(t))),r?(a=TN,s=!1):e.length>=Q$&&(a=Oy,s=!1,e=new no(e));e:for(;++i<o;){var c=n[i],d=t==null?c:t(c);if(c=r||c!==0?c:0,s&&d===d){for(var h=u;h--;)if(e[h]===d)continue e;l.push(c)}else a(e,d,r)||l.push(c)}return l}var uw=Xr?Xr.isConcatSpreadable:void 0;function V$(n){return Pt(n)||Eh(n)||!!(uw&&n&&n[uw])}function Nh(n,e,t,r,i){var a=-1,s=n.length;for(t||(t=V$),i||(i=[]);++a<s;){var o=n[a];e>0&&t(o)?e>1?Nh(o,e-1,t,r,i):pN(i,o):r||(i[i.length]=o)}return i}var cw=Ou(function(n,e){return Nd(n)?SN(n,Nh(e,1,Nd,!0)):[]});function z$(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:xy(n,e,t)}function W$(n){return n.split("")}var H$="\\ud800-\\udfff",G$="\\u0300-\\u036f",K$="\\ufe20-\\ufe2f",J$="\\u20d0-\\u20ff",Y$=G$+K$+J$,X$="\\ufe0e\\ufe0f",Z$="\\u200d",eL=RegExp("["+Z$+H$+Y$+X$+"]");function Ly(n){return eL.test(n)}var AN="\\ud800-\\udfff",tL="\\u0300-\\u036f",nL="\\ufe20-\\ufe2f",rL="\\u20d0-\\u20ff",iL=tL+nL+rL,aL="\\ufe0e\\ufe0f",sL="["+AN+"]",Up="["+iL+"]",jp="\\ud83c[\\udffb-\\udfff]",oL="(?:"+Up+"|"+jp+")",RN="[^"+AN+"]",xN="(?:\\ud83c[\\udde6-\\uddff]){2}",_N="[\\ud800-\\udbff][\\udc00-\\udfff]",lL="\\u200d",PN=oL+"?",MN="["+aL+"]?",uL="(?:"+lL+"(?:"+[RN,xN,_N].join("|")+")"+MN+PN+")*",cL=MN+PN+uL,dL="(?:"+[RN+Up+"?",Up,xN,_N,sL].join("|")+")",hL=RegExp(jp+"(?="+jp+")|"+dL+cL,"g");function fL(n){return n.match(hL)||[]}function pL(n){return Ly(n)?fL(n):W$(n)}function mL(n,e,t){e=="__proto__"&&wd?wd(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}var yL=Object.prototype,gL=yL.hasOwnProperty;function vL(n,e,t){var r=n[e];(!(gL.call(n,e)&&ph(r,t))||t===void 0&&!(e in n))&&mL(n,e,t)}function ON(n,e,t,r){if(!Zr(n))return n;e=Pu(e,n);for(var i=-1,a=e.length,s=a-1,o=n;o!=null&&++i<a;){var l=Mo(e[i]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(i!=s){var c=o[l];u=r?r(c,l,o):void 0,u===void 0&&(u=Zr(c)?c:Mu(e[i+1])?[]:{})}vL(o,l,u),o=o[l]}return n}function EL(n,e,t){for(var r=-1,i=e.length,a={};++r<i;){var s=e[r],o=Th(n,s);t(o,s)&&ON(a,Pu(s,n),o)}return a}function wL(n,e){return EL(n,e,function(t,r){return gN(n,r)})}function TL(n){var e=n==null?0:n.length;return e?Nh(n,1):[]}function bL(n){return _y(tN(n,void 0,TL),n+"")}var IN=bL(function(n,e){return n==null?{}:wL(n,e)}),NL=cN(Object.getPrototypeOf,Object),CL="[object Object]",SL=Function.prototype,AL=Object.prototype,DN=SL.toString,RL=AL.hasOwnProperty,xL=DN.call(Object);function qy(n){if(!kn(n)||ai(n)!=CL)return!1;var e=NL(n);if(e===null)return!0;var t=RL.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&DN.call(t)==xL}function Je(n){return n==null}function _L(n,e){var t=-1,r=Fi(n)?Array(n.length):[];return Do(n,function(i,a,s){r[++t]=e(i,a,s)}),r}function qn(n,e){var t=Pt(n)?vh:_L;return t(n,ms(e))}var By={exports:{}},Sd={},$N={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(n){(function(){var e=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:e,canUseWorkers:typeof Worker<"u",canUseEventListeners:e&&!!(window.addEventListener||window.attachEvent),canUseViewport:e&&!!window.screen};n.exports?n.exports=t:window.ExecutionEnvironment=t})()})($N);var PL=$N.exports;Object.defineProperty(Sd,"__esModule",{value:!0});var dw=PL,ML=Te;function LN(n){return(LN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function Du(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function hw(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function $u(n,e,t){return e&&hw(n.prototype,e),t&&hw(n,t),n}function nr(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function OL(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&BN(n,e)}function qN(n){return(qN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(n)}function BN(n,e){return(BN=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(n,e)}function IL(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function DL(n,e){return!e||typeof e!="object"&&typeof e!="function"?IL(n):e}var FN=function(){function n(e){Du(this,n),nr(this,"handlers",void 0),this.handlers=e.slice(0)}return $u(n,[{key:"addHandlers",value:function(e){for(var t=this.handlers.slice(0),r=e.length,i=0;i<r;i+=1)t.push(e[i]);return new n(t)}},{key:"dispatchEvent",value:function(e,t){var r=this.handlers.length-1;if(t){for(var i=r;i>=0;i-=1)this.handlers[i].called||(this.handlers[i].called=!0,this.handlers[i](e));for(var a=r;a>=0;a-=1)this.handlers[a].called=!1}else(0,this.handlers[r])(e)}},{key:"hasHandlers",value:function(){return this.handlers.length>0}},{key:"removeHandlers",value:function(e){for(var t=[],r=this.handlers.length,i=0;i<r;i+=1){var a=this.handlers[i];e.indexOf(a)===-1&&t.push(a)}return new n(t)}}]),n}();function fw(n){var e=new Map;return n.forEach(function(t,r){e.set(r,t)}),e}function pw(n){return Array.isArray(n)?n:[n]}var $L=function(n){return n!==null&&LN(n)==="object"&&n.hasOwnProperty("current")};function mw(n){return n==="document"?document:n==="window"?window:$L(n)?n.current||document:n||document}var Qp=function(){function n(e,t){Du(this,n),nr(this,"handlerSets",void 0),nr(this,"poolName",void 0),this.handlerSets=t,this.poolName=e}return $u(n,[{key:"addHandlers",value:function(e,t){var r=fw(this.handlerSets);if(r.has(e)){var i=r.get(e);r.set(e,i.addHandlers(t))}else r.set(e,new FN(t));return new n(this.poolName,r)}},{key:"dispatchEvent",value:function(e,t){var r=this.handlerSets.get(e),i=this.poolName==="default";r&&r.dispatchEvent(t,i)}},{key:"hasHandlers",value:function(e){if(!e)return this.handlerSets.size>0;var t=this.handlerSets.get(e);return!!t&&t.hasHandlers()}},{key:"removeHandlers",value:function(e,t){var r=fw(this.handlerSets);if(!r.has(e))return new n(this.poolName,r);var i=r.get(e).removeHandlers(t);return i.hasHandlers()?r.set(e,i):r.delete(e),new n(this.poolName,r)}}]),n}();nr(Qp,"createByType",function(n,e,t){var r=new Map;return r.set(e,new FN(t)),new Qp(n,r)});var LL=function(){function n(e){var t=this;Du(this,n),nr(this,"handlers",new Map),nr(this,"pools",new Map),nr(this,"target",void 0),nr(this,"createEmitter",function(r){return function(i){t.pools.forEach(function(a){a.dispatchEvent(r,i)})}}),this.target=e}return $u(n,[{key:"addHandlers",value:function(e,t,r){if(this.pools.has(e)){var i=this.pools.get(e);this.pools.set(e,i.addHandlers(t,r))}else this.pools.set(e,Qp.createByType(e,t,r));this.handlers.has(t)||this.addTargetHandler(t)}},{key:"hasHandlers",value:function(){return this.handlers.size>0}},{key:"removeHandlers",value:function(e,t,r){if(this.pools.has(e)){var i=this.pools.get(e).removeHandlers(t,r);i.hasHandlers()?this.pools.set(e,i):this.pools.delete(e);var a=!1;this.pools.forEach(function(s){return a=a||s.hasHandlers(t)}),a||this.removeTargetHandler(t)}}},{key:"addTargetHandler",value:function(e){var t=this.createEmitter(e);this.handlers.set(e,t),this.target.addEventListener(e,t,!0)}},{key:"removeTargetHandler",value:function(e){this.handlers.has(e)&&(this.target.removeEventListener(e,this.handlers.get(e),!0),this.handlers.delete(e))}}]),n}(),qL=function(){function n(){var e=this;Du(this,n),nr(this,"targets",new Map),nr(this,"getTarget",function(t){var r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=mw(t);if(e.targets.has(i))return e.targets.get(i);if(!r)return null;var a=new LL(i);return e.targets.set(i,a),a}),nr(this,"removeTarget",function(t){e.targets.delete(mw(t))})}return $u(n,[{key:"sub",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(dw.canUseDOM){var i=r.target,a=i===void 0?document:i,s=r.pool,o=s===void 0?"default":s;this.getTarget(a).addHandlers(o,e,pw(t))}}},{key:"unsub",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(dw.canUseDOM){var i=r.target,a=i===void 0?document:i,s=r.pool,o=s===void 0?"default":s,l=this.getTarget(a,!1);l&&(l.removeHandlers(o,e,pw(t)),l.hasHandlers()||this.removeTarget(a))}}}]),n}(),Vp=new qL,Af=function(n){function e(){return Du(this,e),DL(this,qN(e).apply(this,arguments))}return OL(e,ML.PureComponent),$u(e,[{key:"componentDidMount",value:function(){this.subscribe(this.props)}},{key:"componentDidUpdate",value:function(t){this.unsubscribe(t),this.subscribe(this.props)}},{key:"componentWillUnmount",value:function(){this.unsubscribe(this.props)}},{key:"subscribe",value:function(t){var r=t.name,i=t.on,a=t.pool,s=t.target;Vp.sub(r,i,{pool:a,target:s})}},{key:"unsubscribe",value:function(t){var r=t.name,i=t.on,a=t.pool,s=t.target;Vp.unsub(r,i,{pool:a,target:s})}},{key:"render",value:function(){return null}}]),e}();nr(Af,"defaultProps",{pool:"default",target:"document"}),Af.propTypes={},Sd.instance=Vp,Sd.default=Af;var Fy;Fy=Sd;By.exports=Fy.default;var Tr=By.exports.instance=Fy.instance,BL=By.exports;const ci=ss(BL);function ky(){}var FL=1/0,kL=Hs&&1/Iy(new Hs([,-0]))[1]==FL?function(n){return new Hs(n)}:ky,UL=200;function kN(n,e,t){var r=-1,i=Dy,a=n.length,s=!0,o=[],l=o;if(t)s=!1,i=TN;else if(a>=UL){var u=e?null:kL(n);if(u)return Iy(u);s=!1,i=Oy,l=new no}else l=e?[]:o;e:for(;++r<a;){var c=n[r],d=e?e(c):c;if(c=t||c!==0?c:0,s&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;e&&l.push(d),o.push(c)}else i(l,d,t)||(l!==o&&l.push(d),o.push(c))}return o}function jL(n){return n&&n.length?kN(n):[]}var QL="[object Number]";function VL(n){return typeof n=="number"||kn(n)&&ai(n)==QL}var zL="[object String]";function Uy(n){return typeof n=="string"||!Pt(n)&&kn(n)&&ai(n)==zL}var WL="[object Boolean]";function HL(n){return n===!0||n===!1||kn(n)&&ai(n)==WL}function UN(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(t=UN(n[e]))&&(r&&(r+=" "),r+=t);else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function xe(){for(var n,e,t=0,r="";t<arguments.length;)(n=arguments[t++])&&(e=UN(n))&&(r&&(r+=" "),r+=e);return r}function zp(n,e,t,r){if(r===void 0&&(r={}),typeof n!="function"&&typeof n!="string")throw new Error("createShorthand() Component must be a string or function.");if(Je(t)||HL(t))return null;var i=Uy(t),a=VL(t),s=to(t),o=Te.isValidElement(t),l=qy(t),u=i||a||Pt(t);if(!s&&!o&&!l&&!u)return null;var c=r,d=c.defaultProps,h=d===void 0?{}:d,p=o&&t.props||l&&t||u&&e(t),g=r,E=g.overrideProps,A=E===void 0?{}:E;A=to(A)?A(te({},h,p)):A;var b=te({},h,p,A);if(h.className||A.className||p.className){var T=xe(h.className,A.className,p.className);b.className=jL(T.split(" ")).join(" ")}if((h.style||A.style||p.style)&&(b.style=te({},h.style,p.style,A.style)),Je(b.key)){var C=b.childKey,P=r,D=P.autoGenerateKey,F=D===void 0?!0:D;Je(C)?F&&(i||a)&&(b.key=t):(b.key=typeof C=="function"?C(b):C,delete b.childKey)}if(o)return Te.cloneElement(t,b);if(typeof b.children=="function")return b.children(n,te({},b,{children:void 0}));if(u||l)return Te.createElement(n,b);if(s)return t(n,b,b.children)}function st(n,e){if(typeof n!="function"&&typeof n!="string")throw new Error("createShorthandFactory() Component must be a string or function.");return function(t,r){return zp(n,e,t,r)}}var GL=st("div",function(n){return{children:n}}),KL=st("img",function(n){return{src:n}}),JL=st("input",function(n){return{type:n}}),YL=st("label",function(n){return{children:n}}),XL=function(e,t){var r=e.handledProps,i=r===void 0?[]:r;return Object.keys(t).reduce(function(a,s){return s==="childKey"||i.indexOf(s)===-1&&(a[s]=t[s]),a},{})};const De=XL;function Be(n,e,t){var r=n.defaultProps,i=r===void 0?{}:r;if(e.as&&e.as!==i.as)return e.as;if(t){var a=t();if(a)return a}return e.href?"a":i.as||"div"}function ZL(n,e){return vh(e,function(t){return n[t]})}function eq(n){return n==null?[]:ZL(n,Io(n))}var tq=Math.max;function fi(n,e,t,r){n=Fi(n)?n:eq(n),t=t&&!r?Hl(t):0;var i=n.length;return t<0&&(t=tq(i+t,0)),Uy(n)?t<=i&&n.indexOf(e,t)>-1:!!i&&wN(n,e,t)>-1}var jy=["selected","defaultValue","defaultChecked","accept","autoCapitalize","autoComplete","autoCorrect","autoFocus","checked","disabled","enterKeyHint","form","id","inputMode","lang","list","max","maxLength","min","minLength","multiple","name","pattern","placeholder","readOnly","required","step","title","type","value"],nq=["onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onClick","onContextMenu","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],rq=[].concat(jy,nq),iq=["alt","height","src","srcSet","width","loading"],Ch=function(e,t){t===void 0&&(t={});var r=t,i=r.htmlProps,a=i===void 0?rq:i,s=r.includeAria,o=s===void 0?!0:s,l={},u={};return NN(e,function(c,d){var h=o&&(/^aria-.*$/.test(d)||d==="role"),p=fi(a,d)||h?l:u;p[d]=c}),[l,u]},aq=typeof document=="object"&&document!==null,sq=typeof window=="object"&&window!==null&&window.self===window,Ad=function n(){return Je(n.override)?aq&&sq:n.override},oq=Math.max,lq=Math.min;function uq(n,e,t){return n>=lq(e,t)&&n<oq(e,t)}function Wp(n,e,t){return e=Ws(e),t===void 0?(t=e,e=0):t=Ws(t),n=iN(n),uq(n,e,t)}function cq(n){return n&&n.length?n[0]:void 0}var dq=function(e,t){if(Tl([t,e],Je))return!1;if(t.target&&(ve(t.target,"setAttribute","data-suir-click-target",!0),document.querySelector("[data-suir-click-target=true]")))return ve(t.target,"removeAttribute","data-suir-click-target"),e.contains(t.target);var r=t.clientX,i=t.clientY;if(Tl([r,i],Je))return!1;var a=e.getClientRects();if(!e.offsetWidth||!e.offsetHeight||!a||!a.length)return!1;var s=cq(a),o=s.top,l=s.bottom,u=s.left,c=s.right;return Tl([o,l,u,c],Je)?!1:Wp(i,o,l+.001)&&Wp(r,u,c+.001)};const bl=dq;var jN=function(e){return{active:!1,type:"ellipsisItem",value:e}},hq=function(){return{active:!1,type:"firstItem",value:1}},fq=function(e){return{active:!1,type:"prevItem",value:Math.max(1,e-1)}},pq=function(e){return function(t){return{active:e===t,type:"pageItem",value:t}}},mq=function(e,t){return{active:!1,type:"nextItem",value:Math.min(e+1,t)}},yq=function(e){return{active:!1,type:"lastItem",value:e}},gq=Math.ceil,vq=Math.max;function Eq(n,e,t,r){for(var i=-1,a=vq(gq((e-n)/(t||1)),0),s=Array(a);a--;)s[r?a:++i]=n,n+=t;return s}function wq(n){return function(e,t,r){return r&&typeof r!="number"&&$y(e,t,r)&&(t=r=void 0),e=Ws(e),t===void 0?(t=e,e=0):t=Ws(t),r=r===void 0?e<t?1:-1:Ws(r),Eq(e,t,r,n)}}var Tq=wq(),bq=function(e,t,r){var i=t-1,a=i!==e+1,s=a?jN:r;return s(i)},Nq=function(e,t,r){var i=e+1,a=i!==t-1,s=a?jN:r;return s(i)},jc=function(e,t,r){return qn(Tq(e,t+1),r)},Cq=function(e,t){var r=e.activePage,i=e.boundaryRange,a=e.hideEllipsis,s=e.siblingRange,o=e.totalPages,l=a?0:1,u=i,c=jc(1,u,t),d=o+1-i,h=jc(d,o,t),p=Math.min(Math.max(r-s,u+l+1),d-l-2*s-1),g=p+2*s,E=jc(p,g,t);return[].concat(c,[!a&&bq(u,p,t)],E,[!a&&Nq(g,d,t)],h).filter(Boolean)},Sq=function(e){var t=e.boundaryRange,r=e.hideEllipsis,i=e.siblingRange,a=e.totalPages,s=2*t,o=r?0:2,l=2*i;return 1+o+l+s>=a},Aq=function(e){var t=e.activePage,r=e.boundaryRange,i=e.hideEllipsis,a=e.siblingRange,s=e.totalPages;return{activePage:+t,boundaryRange:+r,hideEllipsis:!!i,siblingRange:+a,totalPages:+s}},Rq=function(e){var t=Aq(e),r=t.activePage,i=t.totalPages,a=pq(r),s=Sq(t)?jc(1,i,a):Cq(t,a);return[hq(),fq(r)].concat(s,[mq(r,i),yq(i)])};function xq(n,e){return bh(n,e)}var yw=Object.create,Qy=function(){function n(){}return function(e){if(!Zr(e))return{};if(yw)return yw(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),_q=Ou(function(n,e){return Nd(n)?SN(n,e):[]});const Pq=_q;function ro(n){var e=n.children,t=n.className,r=n.content,i=n.size,a=xe(i,"icons",t),s=De(ro,n),o=Be(ro,n);return Y.createElement(o,te({},s,{className:a}),je(e)?r:e)}ro.handledProps=["as","children","className","content","size"];ro.propTypes={};ro.defaultProps={as:"i"};var kt=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleClick=function(o){var l=r.props.disabled;if(l){o.preventDefault();return}ve(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.getIconAriaOptions=function(){var i={},a=this.props,s=a["aria-label"],o=a["aria-hidden"];return Je(s)?i["aria-hidden"]="true":i["aria-label"]=s,Je(o)||(i["aria-hidden"]=o),i},t.render=function(){var i=this.props,a=i.bordered,s=i.circular,o=i.className,l=i.color,u=i.corner,c=i.disabled,d=i.fitted,h=i.flipped,p=i.inverted,g=i.link,E=i.loading,A=i.name,b=i.rotated,T=i.size,C=xe(l,A,T,k(a,"bordered"),k(s,"circular"),k(c,"disabled"),k(d,"fitted"),k(p,"inverted"),k(g,"link"),k(E,"loading"),vt(u,"corner"),cn(h,"flipped"),cn(b,"rotated"),"icon",o),P=De(e,this.props),D=Be(e,this.props),F=this.getIconAriaOptions();return Y.createElement(D,te({},P,F,{className:C,onClick:this.handleClick}))},e}(Te.PureComponent);kt.handledProps=["aria-hidden","aria-label","as","bordered","circular","className","color","corner","disabled","fitted","flipped","inverted","link","loading","name","rotated","size"];kt.propTypes={};kt.defaultProps={as:"i"};kt.Group=ro;kt.create=st(kt,function(n){return{name:n}});var gw=function(e){return e!==null&&!Array.isArray(e)&&typeof e=="object"},Rd={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"};for(var bc=0;bc<24;bc+=1)Rd[112+bc]="F"+(bc+1);for(var Rf=0;Rf<26;Rf+=1){var xf=Rf+65;Rd[xf]=[String.fromCharCode(xf+32),String.fromCharCode(xf)]}var fe={codes:Rd,getCode:function(e){return gw(e)?e.keyCode||e.which||this[e.key]:this[e]},getKey:function(e){var t=gw(e);if(t&&e.key)return e.key;var r=Rd[t?e.keyCode||e.which:e];return Array.isArray(r)&&(t?r=r[e.shiftKey?1:0]:r=r[0]),r},Cancel:3,Help:6,Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Convert:28,NonConvert:29,Accept:30,ModeChange:31," ":32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Select:41,Print:42,Execute:43,PrintScreen:44,Insert:45,Delete:46,0:48,")":48,1:49,"!":49,2:50,"@":50,3:51,"#":51,4:52,$:52,5:53,"%":53,6:54,"^":54,7:55,"&":55,8:56,"*":56,9:57,"(":57,a:65,A:65,b:66,B:66,c:67,C:67,d:68,D:68,e:69,E:69,f:70,F:70,g:71,G:71,h:72,H:72,i:73,I:73,j:74,J:74,k:75,K:75,l:76,L:76,m:77,M:77,n:78,N:78,o:79,O:79,p:80,P:80,q:81,Q:81,r:82,R:82,s:83,S:83,t:84,T:84,u:85,U:85,v:86,V:86,w:87,W:87,x:88,X:88,y:89,Y:89,z:90,Z:90,OS:91,ContextMenu:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,F20:131,F21:132,F22:133,F23:134,F24:135,NumLock:144,ScrollLock:145,VolumeMute:181,VolumeDown:182,VolumeUp:183,";":186,":":186,"=":187,"+":187,",":188,"<":188,"-":189,_:189,".":190,">":190,"/":191,"?":191,"`":192,"~":192,"[":219,"{":219,"\\":220,"|":220,"]":221,"}":221,"'":222,'"':222,Meta:224,AltGraph:225,Attn:246,CrSel:247,ExSel:248,EraseEof:249,Play:250,ZoomOut:251};fe.Spacebar=fe[" "];fe.Digit0=fe[0];fe.Digit1=fe[1];fe.Digit2=fe[2];fe.Digit3=fe[3];fe.Digit4=fe[4];fe.Digit5=fe[5];fe.Digit6=fe[6];fe.Digit7=fe[7];fe.Digit8=fe[8];fe.Digit9=fe[9];fe.Tilde=fe["~"];fe.GraveAccent=fe["`"];fe.ExclamationPoint=fe["!"];fe.AtSign=fe["@"];fe.PoundSign=fe["#"];fe.PercentSign=fe["%"];fe.Caret=fe["^"];fe.Ampersand=fe["&"];fe.PlusSign=fe["+"];fe.MinusSign=fe["-"];fe.EqualsSign=fe["="];fe.DivisionSign=fe["/"];fe.MultiplicationSign=fe["*"];fe.Comma=fe[","];fe.Decimal=fe["."];fe.Colon=fe[":"];fe.Semicolon=fe[";"];fe.Pipe=fe["|"];fe.BackSlash=fe["\\"];fe.QuestionMark=fe["?"];fe.SingleQuote=fe["'"];fe.DoubleQuote=fe['"'];fe.LeftCurlyBrace=fe["{"];fe.RightCurlyBrace=fe["}"];fe.LeftParenthesis=fe["("];fe.RightParenthesis=fe[")"];fe.LeftAngleBracket=fe["<"];fe.RightAngleBracket=fe[">"];fe.LeftSquareBracket=fe["["];fe.RightSquareBracket=fe["]"];var Mq=fe;const at=ss(Mq);var Vy=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleRef=function(o){zr(r.props.innerRef,o)},r}var t=e.prototype;return t.componentDidMount=function(){ve(this.props,"onMount",null,this.props)},t.componentWillUnmount=function(){ve(this.props,"onUnmount",null,this.props)},t.render=function(){if(!Ad())return null;var i=this.props,a=i.children,s=i.mountNode,o=s===void 0?document.body:s;return jl.createPortal(Y.createElement(Ri,{innerRef:this.handleRef},a),o)},e}(Te.Component);Vy.handledProps=["children","innerRef","mountNode","onMount","onUnmount"];Vy.propTypes={};const QN=Vy;var Ei=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.contentRef=Y.createRef(),r.triggerRef=Y.createRef(),r.latestDocumentMouseDownEvent=null,r.handleDocumentMouseDown=function(o){r.latestDocumentMouseDownEvent=o},r.handleDocumentClick=function(o){var l=r.props.closeOnDocumentClick,u=r.latestDocumentMouseDownEvent;r.latestDocumentMouseDownEvent=null,!(!r.contentRef.current||bl(r.triggerRef.current,o)||u&&bl(r.contentRef.current,u)||bl(r.contentRef.current,o))&&l&&r.close(o)},r.handleEscape=function(o){r.props.closeOnEscape&&at.getCode(o)===at.Escape&&r.close(o)},r.handlePortalMouseLeave=function(o){var l=r.props,u=l.closeOnPortalMouseLeave,c=l.mouseLeaveDelay;u&&o.target===r.contentRef.current&&(r.mouseLeaveTimer=r.closeWithTimeout(o,c))},r.handlePortalMouseEnter=function(){var o=r.props.closeOnPortalMouseLeave;o&&clearTimeout(r.mouseLeaveTimer)},r.handleTriggerBlur=function(o){for(var l=r.props,u=l.trigger,c=l.closeOnTriggerBlur,d=arguments.length,h=new Array(d>1?d-1:0),p=1;p<d;p++)h[p-1]=arguments[p];ve.apply(void 0,[u,"props.onBlur",o].concat(h));var g=o.relatedTarget||document.activeElement,E=ve(r.contentRef.current,"contains",g);!c||E||r.close(o)},r.handleTriggerClick=function(o){for(var l=r.props,u=l.trigger,c=l.closeOnTriggerClick,d=l.openOnTriggerClick,h=r.state.open,p=arguments.length,g=new Array(p>1?p-1:0),E=1;E<p;E++)g[E-1]=arguments[E];ve.apply(void 0,[u,"props.onClick",o].concat(g)),h&&c?r.close(o):!h&&d&&r.open(o)},r.handleTriggerFocus=function(o){for(var l=r.props,u=l.trigger,c=l.openOnTriggerFocus,d=arguments.length,h=new Array(d>1?d-1:0),p=1;p<d;p++)h[p-1]=arguments[p];ve.apply(void 0,[u,"props.onFocus",o].concat(h)),c&&r.open(o)},r.handleTriggerMouseLeave=function(o){clearTimeout(r.mouseEnterTimer);for(var l=r.props,u=l.trigger,c=l.closeOnTriggerMouseLeave,d=l.mouseLeaveDelay,h=arguments.length,p=new Array(h>1?h-1:0),g=1;g<h;g++)p[g-1]=arguments[g];ve.apply(void 0,[u,"props.onMouseLeave",o].concat(p)),c&&(r.mouseLeaveTimer=r.closeWithTimeout(o,d))},r.handleTriggerMouseEnter=function(o){clearTimeout(r.mouseLeaveTimer);for(var l=r.props,u=l.trigger,c=l.mouseEnterDelay,d=l.openOnTriggerMouseEnter,h=arguments.length,p=new Array(h>1?h-1:0),g=1;g<h;g++)p[g-1]=arguments[g];ve.apply(void 0,[u,"props.onMouseEnter",o].concat(p)),d&&(r.mouseEnterTimer=r.openWithTimeout(o,c))},r.open=function(o){ve(r.props,"onOpen",o,te({},r.props,{open:!0})),r.setState({open:!0})},r.openWithTimeout=function(o,l){var u=te({},o);return setTimeout(function(){return r.open(u)},l||0)},r.close=function(o){r.setState({open:!1}),ve(r.props,"onClose",o,te({},r.props,{open:!1}))},r.closeWithTimeout=function(o,l){var u=te({},o);return setTimeout(function(){return r.close(u)},l||0)},r.handleMount=function(){ve(r.props,"onMount",null,r.props)},r.handleUnmount=function(){ve(r.props,"onUnmount",null,r.props)},r.handleTriggerRef=function(o){r.triggerRef.current=o,zr(r.props.triggerRef,o)},r}var t=e.prototype;return t.componentWillUnmount=function(){clearTimeout(this.mouseEnterTimer),clearTimeout(this.mouseLeaveTimer)},t.render=function(){var i=this.props,a=i.children,s=i.eventPool,o=i.mountNode,l=i.trigger,u=this.state.open;return Y.createElement(Y.Fragment,null,u&&Y.createElement(Y.Fragment,null,Y.createElement(QN,{innerRef:this.contentRef,mountNode:o,onMount:this.handleMount,onUnmount:this.handleUnmount},a),Y.createElement(ci,{name:"mouseleave",on:this.handlePortalMouseLeave,pool:s,target:this.contentRef}),Y.createElement(ci,{name:"mouseenter",on:this.handlePortalMouseEnter,pool:s,target:this.contentRef}),Y.createElement(ci,{name:"mousedown",on:this.handleDocumentMouseDown,pool:s}),Y.createElement(ci,{name:"click",on:this.handleDocumentClick,pool:s}),Y.createElement(ci,{name:"keydown",on:this.handleEscape,pool:s})),l&&Y.createElement(Ri,{innerRef:this.handleTriggerRef},Y.cloneElement(l,{onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onMouseLeave:this.handleTriggerMouseLeave,onMouseEnter:this.handleTriggerMouseEnter})))},e}($o);Ei.handledProps=["children","closeOnDocumentClick","closeOnEscape","closeOnPortalMouseLeave","closeOnTriggerBlur","closeOnTriggerClick","closeOnTriggerMouseLeave","defaultOpen","eventPool","mountNode","mouseEnterDelay","mouseLeaveDelay","onClose","onMount","onOpen","onUnmount","open","openOnTriggerClick","openOnTriggerFocus","openOnTriggerMouseEnter","trigger","triggerRef"];Ei.propTypes={};Ei.defaultProps={closeOnDocumentClick:!0,closeOnEscape:!0,eventPool:"default",openOnTriggerClick:!0};Ei.autoControlledProps=["open"];Ei.Inner=QN;function Kl(n){var e=n.blurring,t=n.className,r=n.children,i=n.content,a=n.dimmed,s=xe(k(e,"blurring"),k(a,"dimmed"),"dimmable",t),o=De(Kl,n),l=Be(Kl,n);return Y.createElement(l,te({},o,{className:s}),je(r)?i:r)}Kl.handledProps=["as","blurring","children","className","content","dimmed"];Kl.propTypes={};var Jl=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.containerRef=Te.createRef(),r.contentRef=Te.createRef(),r.handleClick=function(o){var l=r.contentRef.current;ve(r.props,"onClick",o,r.props),!(l&&l!==o.target&&bl(l,o))&&ve(r.props,"onClickOutside",o,r.props)},r}var t=e.prototype;return t.componentDidMount=function(){var i=this.props.active;this.toggleStyles(i)},t.componentDidUpdate=function(i){var a=this.props.active,s=i.active;s!==a&&this.toggleStyles(a)},t.toggleStyles=function(i){var a=this.containerRef.current;!a||!a.style||(i?a.style.setProperty("display","flex","important"):a.style.removeProperty("display"))},t.render=function(){var i=this.props,a=i.active,s=i.children,o=i.className,l=i.content,u=i.disabled,c=i.inverted,d=i.page,h=i.simple,p=i.verticalAlign,g=xe("ui",k(a,"active transition visible"),k(u,"disabled"),k(c,"inverted"),k(d,"page"),k(h,"simple"),Ca(p),"dimmer",o),E=De(e,this.props),A=Be(e,this.props),b=je(s)?l:s;return Y.createElement(Ri,{innerRef:this.containerRef},Y.createElement(A,te({},E,{className:g,onClick:this.handleClick}),b&&Y.createElement("div",{className:"content",ref:this.contentRef},b)))},e}(Te.Component);Jl.handledProps=["active","as","children","className","content","disabled","inverted","onClick","onClickOutside","page","simple","verticalAlign"];Jl.propTypes={};var Xa=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handlePortalMount=function(){Ad()&&(document.body.classList.add("dimmed"),document.body.classList.add("dimmable"))},r.handlePortalUnmount=function(){Ad()&&(document.body.classList.remove("dimmed"),document.body.classList.remove("dimmable"))},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.page,o=De(e,this.props);return s?Y.createElement(Ei,{closeOnEscape:!1,closeOnDocumentClick:!1,onMount:this.handlePortalMount,onUnmount:this.handlePortalUnmount,open:a,openOnTriggerClick:!1},Y.createElement(Jl,te({},o,{active:a,page:s}))):Y.createElement(Jl,te({},o,{active:a,page:s}))},e}(Te.Component);Xa.handledProps=["active","page"];Xa.propTypes={};Xa.Dimmable=Kl;Xa.Inner=Jl;Xa.create=st(Xa,function(n){return{content:n}});function Yl(n){var e=n.children,t=n.className,r=n.content,i=n.size,a=xe("ui",i,t,"images"),s=De(Yl,n),o=Be(Yl,n);return Y.createElement(o,te({},s,{className:a}),je(e)?r:e)}Yl.handledProps=["as","children","className","content","size"];Yl.propTypes={};function dr(n){var e=n.avatar,t=n.bordered,r=n.centered,i=n.children,a=n.circular,s=n.className,o=n.content,l=n.dimmer,u=n.disabled,c=n.floated,d=n.fluid,h=n.hidden,p=n.href,g=n.inline,E=n.label,A=n.rounded,b=n.size,T=n.spaced,C=n.verticalAlign,P=n.wrapped,D=n.ui,F=xe(k(D,"ui"),b,k(e,"avatar"),k(t,"bordered"),k(a,"circular"),k(r,"centered"),k(u,"disabled"),k(d,"fluid"),k(h,"hidden"),k(g,"inline"),k(A,"rounded"),vt(T,"spaced"),cn(c,"floated"),Ca(C),"image",s),Q=De(dr,n),W=Ch(Q,{htmlProps:iq}),B=W[0],K=W[1],M=Be(dr,n,function(){if(!Je(l)||!Je(E)||!Je(P)||!je(i))return"div"});return je(i)?je(o)?M==="img"?Y.createElement(M,te({},K,B,{className:F})):Y.createElement(M,te({},K,{className:F,href:p}),Xa.create(l,{autoGenerateKey:!1}),hr.create(E,{autoGenerateKey:!1}),Y.createElement("img",B)):Y.createElement(M,te({},Q,{className:F}),o):Y.createElement(M,te({},Q,{className:F}),i)}dr.handledProps=["as","avatar","bordered","centered","children","circular","className","content","dimmer","disabled","floated","fluid","hidden","href","inline","label","rounded","size","spaced","ui","verticalAlign","wrapped"];dr.Group=Yl;dr.propTypes={};dr.defaultProps={as:"img",ui:!0};dr.create=st(dr,function(n){return{src:n}});function la(n){var e=n.children,t=n.className,r=n.content,i=xe("detail",t),a=De(la,n),s=Be(la,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}la.handledProps=["as","children","className","content"];la.propTypes={};la.create=st(la,function(n){return{content:n}});function Xl(n){var e=n.children,t=n.circular,r=n.className,i=n.color,a=n.content,s=n.size,o=n.tag,l=xe("ui",i,s,k(t,"circular"),k(o,"tag"),"labels",r),u=De(Xl,n),c=Be(Xl,n);return Y.createElement(c,te({},u,{className:l}),je(e)?a:e)}Xl.handledProps=["as","children","circular","className","color","content","size","tag"];Xl.propTypes={};var hr=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleClick=function(o){var l=r.props.onClick;l&&l(o,r.props)},r.handleIconOverrides=function(o){return{onClick:function(u){ve(o,"onClick",u),ve(r.props,"onRemove",u,r.props)}}},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.attached,o=i.basic,l=i.children,u=i.circular,c=i.className,d=i.color,h=i.content,p=i.corner,g=i.detail,E=i.empty,A=i.floating,b=i.horizontal,T=i.icon,C=i.image,P=i.onRemove,D=i.pointing,F=i.prompt,Q=i.removeIcon,W=i.ribbon,B=i.size,K=i.tag,M=D===!0&&"pointing"||(D==="left"||D==="right")&&D+" pointing"||(D==="above"||D==="below")&&"pointing "+D,Z=xe("ui",d,M,B,k(a,"active"),k(o,"basic"),k(u,"circular"),k(E,"empty"),k(A,"floating"),k(b,"horizontal"),k(C===!0,"image"),k(F,"prompt"),k(K,"tag"),vt(p,"corner"),vt(W,"ribbon"),cn(s,"attached"),"label",c),q=De(e,this.props),G=Be(e,this.props);if(!je(l))return Y.createElement(G,te({},q,{className:Z,onClick:this.handleClick}),l);var oe=Iu(Q)?"delete":Q;return Y.createElement(G,te({className:Z,onClick:this.handleClick},q),kt.create(T,{autoGenerateKey:!1}),typeof C!="boolean"&&dr.create(C,{autoGenerateKey:!1}),h,la.create(g,{autoGenerateKey:!1}),P&&kt.create(oe,{autoGenerateKey:!1,overrideProps:this.handleIconOverrides}))},e}(Te.Component);hr.handledProps=["active","as","attached","basic","children","circular","className","color","content","corner","detail","empty","floating","horizontal","icon","image","onClick","onRemove","pointing","prompt","removeIcon","ribbon","size","tag"];hr.propTypes={};hr.Detail=la;hr.Group=Xl;hr.create=st(hr,function(n){return{content:n}});function Zl(n){var e=n.children,t=n.className,r=n.content,i=n.hidden,a=n.visible,s=xe(k(a,"visible"),k(i,"hidden"),"content",t),o=De(Zl,n),l=Be(Zl,n);return Y.createElement(l,te({},o,{className:s}),je(e)?r:e)}Zl.handledProps=["as","children","className","content","hidden","visible"];Zl.propTypes={};function eu(n){var e=n.attached,t=n.basic,r=n.buttons,i=n.children,a=n.className,s=n.color,o=n.compact,l=n.content,u=n.floated,c=n.fluid,d=n.icon,h=n.inverted,p=n.labeled,g=n.negative,E=n.positive,A=n.primary,b=n.secondary,T=n.size,C=n.toggle,P=n.vertical,D=n.widths,F=xe("ui",s,T,k(t,"basic"),k(o,"compact"),k(c,"fluid"),k(d,"icon"),k(h,"inverted"),k(p,"labeled"),k(g,"negative"),k(E,"positive"),k(A,"primary"),k(b,"secondary"),k(C,"toggle"),k(P,"vertical"),vt(e,"attached"),cn(u,"floated"),er(D),"buttons",a),Q=De(eu,n),W=Be(eu,n);return Je(r)?Y.createElement(W,te({},Q,{className:F}),je(i)?l:i):Y.createElement(W,te({},Q,{className:F}),qn(r,function(B){return ei.create(B)}))}eu.handledProps=["as","attached","basic","buttons","children","className","color","compact","content","floated","fluid","icon","inverted","labeled","negative","positive","primary","secondary","size","toggle","vertical","widths"];eu.propTypes={};function tu(n){var e=n.className,t=n.text,r=xe("or",e),i=De(tu,n),a=Be(tu,n);return Y.createElement(a,te({},i,{className:r,"data-text":t}))}tu.handledProps=["as","className","text"];tu.propTypes={};var ei=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.ref=Te.createRef(),r.computeElementType=function(){var o=r.props,l=o.attached,u=o.label;if(!Je(l)||!Je(u))return"div"},r.computeTabIndex=function(o){var l=r.props,u=l.disabled,c=l.tabIndex;if(!Je(c))return c;if(u)return-1;if(o==="div")return 0},r.focus=function(o){return ve(r.ref.current,"focus",o)},r.handleClick=function(o){var l=r.props.disabled;if(l){o.preventDefault();return}ve(r.props,"onClick",o,r.props)},r.hasIconClass=function(){var o=r.props,l=o.labelPosition,u=o.children,c=o.content,d=o.icon;return d===!0?!0:d&&(l||je(u)&&Je(c))},r}var t=e.prototype;return t.computeButtonAriaRole=function(i){var a=this.props.role;if(!Je(a))return a;if(i!=="button")return"button"},t.render=function(){var i=this.props,a=i.active,s=i.animated,o=i.attached,l=i.basic,u=i.children,c=i.circular,d=i.className,h=i.color,p=i.compact,g=i.content,E=i.disabled,A=i.floated,b=i.fluid,T=i.icon,C=i.inverted,P=i.label,D=i.labelPosition,F=i.loading,Q=i.negative,W=i.positive,B=i.primary,K=i.secondary,M=i.size,Z=i.toggle,q=i.type,G=xe(h,M,k(a,"active"),k(l,"basic"),k(c,"circular"),k(p,"compact"),k(b,"fluid"),k(this.hasIconClass(),"icon"),k(C,"inverted"),k(F,"loading"),k(Q,"negative"),k(W,"positive"),k(B,"primary"),k(K,"secondary"),k(Z,"toggle"),vt(s,"animated"),vt(o,"attached")),oe=xe(vt(D||!!P,"labeled")),he=xe(k(E,"disabled"),cn(A,"floated")),pe=De(e,this.props),ee=Be(e,this.props,this.computeElementType),de=this.computeTabIndex(ee);if(!Je(P)){var Ee=xe("ui",G,"button",d),ye=xe("ui",oe,"button",d,he),re=hr.create(P,{defaultProps:{basic:!0,pointing:D==="left"?"right":"left"},autoGenerateKey:!1});return Y.createElement(ee,te({},pe,{className:ye,onClick:this.handleClick}),D==="left"&&re,Y.createElement(Ri,{innerRef:this.ref},Y.createElement("button",{className:Ee,"aria-pressed":Z?!!a:void 0,disabled:E,type:q,tabIndex:de},kt.create(T,{autoGenerateKey:!1})," ",g)),(D==="right"||!D)&&re)}var Ze=xe("ui",G,he,oe,"button",d),Pe=!je(u),Le=this.computeButtonAriaRole(ee);return Y.createElement(Ri,{innerRef:this.ref},Y.createElement(ee,te({},pe,{className:Ze,"aria-pressed":Z?!!a:void 0,disabled:E&&ee==="button"||void 0,onClick:this.handleClick,role:Le,type:q,tabIndex:de}),Pe&&u,!Pe&&kt.create(T,{autoGenerateKey:!1}),!Pe&&g))},e}(Te.Component);ei.handledProps=["active","animated","as","attached","basic","children","circular","className","color","compact","content","disabled","floated","fluid","icon","inverted","label","labelPosition","loading","negative","onClick","positive","primary","role","secondary","size","tabIndex","toggle","type"];ei.propTypes={};ei.defaultProps={as:"button"};ei.Content=Zl;ei.Group=eu;ei.Or=tu;ei.create=st(ei,function(n){return{content:n}});function VN(n,e,t,r){var i=-1,a=n==null?0:n.length;for(r&&a&&(t=n[++i]);++i<a;)t=e(t,n[i],i,n);return t}function Oq(n,e,t,r,i){return i(n,function(a,s,o){t=r?(r=!1,a):e(t,a,s,o)}),t}function zy(n,e,t){var r=Pt(n)?VN:Oq,i=arguments.length<3;return r(n,ms(e),t,i,Do)}var Iq=function(e,t,r,i){var a=r?r.call(i,e,t):void 0;if(a!==void 0)return!!a;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;var s=Object.keys(e),o=Object.keys(t);if(s.length!==o.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),u=0;u<s.length;u++){var c=s[u];if(!l(c))return!1;var d=e[c],h=t[c];if(a=r?r.call(i,d,h,c):void 0,a===!1||a===void 0&&d!==h)return!1}return!0};const Qa=ss(Iq);function nu(n){var e=n.children,t=n.className,r=n.content,i=xe("header",t),a=De(nu,n),s=Be(nu,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}nu.handledProps=["as","children","className","content"];nu.propTypes={};function Dq(n){return function(e){return n==null?void 0:n[e]}}var $q={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Lq=Dq($q);const qq=Lq;var Bq=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Fq="\\u0300-\\u036f",kq="\\ufe20-\\ufe2f",Uq="\\u20d0-\\u20ff",jq=Fq+kq+Uq,Qq="["+jq+"]",Vq=RegExp(Qq,"g");function Hp(n){return n=_u(n),n&&n.replace(Bq,qq).replace(Vq,"")}var zq=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Wq(n){return n.match(zq)||[]}var Hq=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Gq(n){return Hq.test(n)}var zN="\\ud800-\\udfff",Kq="\\u0300-\\u036f",Jq="\\ufe20-\\ufe2f",Yq="\\u20d0-\\u20ff",Xq=Kq+Jq+Yq,WN="\\u2700-\\u27bf",HN="a-z\\xdf-\\xf6\\xf8-\\xff",Zq="\\xac\\xb1\\xd7\\xf7",e2="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",t2="\\u2000-\\u206f",n2=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",GN="A-Z\\xc0-\\xd6\\xd8-\\xde",r2="\\ufe0e\\ufe0f",KN=Zq+e2+t2+n2,JN="[']",vw="["+KN+"]",i2="["+Xq+"]",YN="\\d+",a2="["+WN+"]",XN="["+HN+"]",ZN="[^"+zN+KN+YN+WN+HN+GN+"]",s2="\\ud83c[\\udffb-\\udfff]",o2="(?:"+i2+"|"+s2+")",l2="[^"+zN+"]",eC="(?:\\ud83c[\\udde6-\\uddff]){2}",tC="[\\ud800-\\udbff][\\udc00-\\udfff]",As="["+GN+"]",u2="\\u200d",Ew="(?:"+XN+"|"+ZN+")",c2="(?:"+As+"|"+ZN+")",ww="(?:"+JN+"(?:d|ll|m|re|s|t|ve))?",Tw="(?:"+JN+"(?:D|LL|M|RE|S|T|VE))?",nC=o2+"?",rC="["+r2+"]?",d2="(?:"+u2+"(?:"+[l2,eC,tC].join("|")+")"+rC+nC+")*",h2="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",f2="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",p2=rC+nC+d2,m2="(?:"+[a2,eC,tC].join("|")+")"+p2,y2=RegExp([As+"?"+XN+"+"+ww+"(?="+[vw,As,"$"].join("|")+")",c2+"+"+Tw+"(?="+[vw,As+Ew,"$"].join("|")+")",As+"?"+Ew+"+"+ww,As+"+"+Tw,f2,h2,YN,m2].join("|"),"g");function g2(n){return n.match(y2)||[]}function v2(n,e,t){return n=_u(n),e=t?void 0:e,e===void 0?Gq(n)?g2(n):Wq(n):n.match(e)||[]}var E2="[']",w2=RegExp(E2,"g");function T2(n){return function(e){return VN(v2(Hp(e).replace(w2,"")),n,"")}}function b2(n){return function(e){e=_u(e);var t=Ly(e)?pL(e):void 0,r=t?t[0]:e.charAt(0),i=t?z$(t,1).join(""):e.slice(1);return r[n]()+i}}var N2=b2("toUpperCase"),C2=T2(function(n,e,t){return n+(t?" ":"")+N2(e)}),Za=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleClick=function(o){var l=r.props.disabled;l||ve(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.children,o=i.className,l=i.color,u=i.content,c=i.disabled,d=i.fitted,h=i.header,p=i.icon,g=i.link,E=i.name,A=i.onClick,b=i.position,T=xe(l,b,k(a,"active"),k(c,"disabled"),k(p===!0||p&&!(E||u),"icon"),k(h,"header"),k(g,"link"),vt(d,"fitted"),"item",o),C=Be(e,this.props,function(){if(A)return"a"}),P=De(e,this.props);return je(s)?Y.createElement(C,te({},P,{className:T,onClick:this.handleClick}),kt.create(p,{autoGenerateKey:!1}),je(u)?C2(E):u):Y.createElement(C,te({},P,{className:T,onClick:this.handleClick}),s)},e}(Te.Component);Za.handledProps=["active","as","children","className","color","content","disabled","fitted","header","icon","index","link","name","onClick","position"];Za.propTypes={};Za.create=st(Za,function(n){return{content:n,name:n}});function ru(n){var e=n.children,t=n.className,r=n.content,i=n.position,a=xe(i,"menu",t),s=De(ru,n),o=Be(ru,n);return Y.createElement(o,te({},s,{className:a}),je(e)?r:e)}ru.handledProps=["as","children","className","content","position"];ru.propTypes={};var xi=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleItemOverrides=function(o){return{onClick:function(u,c){var d=c.index;r.setState({activeIndex:d}),ve(o,"onClick",u,c),ve(r.props,"onItemClick",u,c)}}},r}var t=e.prototype;return t.renderItems=function(){var i=this,a=this.props.items,s=this.state.activeIndex;return qn(a,function(o,l){return Za.create(o,{defaultProps:{active:parseInt(s,10)===l,index:l},overrideProps:i.handleItemOverrides})})},t.render=function(){var i=this.props,a=i.attached,s=i.borderless,o=i.children,l=i.className,u=i.color,c=i.compact,d=i.fixed,h=i.floated,p=i.fluid,g=i.icon,E=i.inverted,A=i.pagination,b=i.pointing,T=i.secondary,C=i.size,P=i.stackable,D=i.tabular,F=i.text,Q=i.vertical,W=i.widths,B=xe("ui",u,C,k(s,"borderless"),k(c,"compact"),k(p,"fluid"),k(E,"inverted"),k(A,"pagination"),k(b,"pointing"),k(T,"secondary"),k(P,"stackable"),k(F,"text"),k(Q,"vertical"),vt(a,"attached"),vt(h,"floated"),vt(g,"icon"),vt(D,"tabular"),cn(d,"fixed"),er(W,"item"),l,"menu"),K=De(e,this.props),M=Be(e,this.props);return Y.createElement(M,te({},K,{className:B}),je(o)?this.renderItems():o)},e}($o);xi.handledProps=["activeIndex","as","attached","borderless","children","className","color","compact","defaultActiveIndex","fixed","floated","fluid","icon","inverted","items","onItemClick","pagination","pointing","secondary","size","stackable","tabular","text","vertical","widths"];xi.propTypes={};xi.autoControlledProps=["activeIndex"];xi.Header=nu;xi.Item=Za;xi.Menu=ru;xi.create=st(xi,function(n){return{items:n}});const S2=xi;var iu=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleClick=function(o){ve(r.props,"onClick",o,r.props)},r.handleKeyDown=function(o){ve(r.props,"onKeyDown",o,r.props),at.getCode(o)===at.Enter&&ve(r.props,"onClick",o,r.props)},r.handleOverrides=function(){return{onClick:r.handleClick,onKeyDown:r.handleKeyDown}},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.type,o=this.props.disabled||s==="ellipsisItem";return Za.create(this.props,{defaultProps:{active:a,"aria-current":a,"aria-disabled":o,disabled:o,onClick:this.handleClick,onKeyDown:this.handleKeyDown,tabIndex:o?-1:0},overrideProps:this.handleOverrides})},e}(Te.Component);iu.handledProps=["active","disabled","onClick","onKeyDown","type"];iu.propTypes={};iu.create=st(iu,function(n){return{content:n}});const iC=iu;var Lo=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleItemClick=function(o,l){var u=l.value,c=r.state.activePage;+c!=+u&&(r.setState({activePage:u}),ve(r.props,"onPageChange",o,te({},r.props,{activePage:u})))},r.handleItemOverrides=function(o,l,u){return function(c){return{active:o,type:l,key:l+"-"+u,onClick:function(h,p){ve(c,"onClick",h,p),p.type!=="ellipsisItem"&&r.handleItemClick(h,p)}}}},r}var t=e.prototype;return t.getInitialAutoControlledState=function(){return{activePage:1}},t.render=function(){var i=this,a=this.props,s=a["aria-label"],o=a.boundaryRange,l=a.disabled,u=a.ellipsisItem,c=a.siblingRange,d=a.totalPages,h=this.state.activePage,p=Rq({activePage:h,boundaryRange:o,hideEllipsis:Je(u),siblingRange:c,totalPages:d}),g=De(e,this.props);return Y.createElement(S2,te({},g,{"aria-label":s,pagination:!0,role:"navigation"}),qn(p,function(E){var A=E.active,b=E.type,T=E.value;return iC.create(i.props[b],{defaultProps:{content:T,disabled:l,value:T},overrideProps:i.handleItemOverrides(A,b,T)})}))},e}($o);Lo.handledProps=["activePage","aria-label","boundaryRange","defaultActivePage","disabled","ellipsisItem","firstItem","lastItem","nextItem","onPageChange","pageItem","prevItem","siblingRange","totalPages"];Lo.propTypes={};Lo.autoControlledProps=["activePage"];Lo.defaultProps={"aria-label":"Pagination Navigation",boundaryRange:1,ellipsisItem:"...",firstItem:{"aria-label":"First item",content:""},lastItem:{"aria-label":"Last item",content:""},nextItem:{"aria-label":"Next item",content:""},pageItem:{},prevItem:{"aria-label":"Previous item",content:""},siblingRange:1};Lo.Item=iC;function A2(n,e,t){return n==null?n:ON(n,e,t)}var io=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.inputRef=Te.createRef(),r.labelRef=Te.createRef(),r.canToggle=function(){var o=r.props,l=o.disabled,u=o.radio,c=o.readOnly,d=r.state.checked;return!l&&!c&&!(u&&d)},r.computeTabIndex=function(){var o=r.props,l=o.disabled,u=o.tabIndex;return Je(u)?l?-1:0:u},r.handleClick=function(o){var l=r.props.id,u=r.state,c=u.checked,d=u.indeterminate,h=ve(r.inputRef.current,"contains",o.target),p=ve(r.labelRef.current,"contains",o.target),g=!p&&!h,E=!Je(l),A=p&&E;A||ve(r.props,"onClick",o,te({},r.props,{checked:!c,indeterminate:!!d})),r.isClickFromMouse&&(r.isClickFromMouse=!1,p&&!E&&r.handleChange(o),g&&r.handleChange(o),p&&E&&o.stopPropagation())},r.handleChange=function(o){var l=r.state.checked;r.canToggle()&&(ve(r.props,"onChange",o,te({},r.props,{checked:!l,indeterminate:!1})),r.setState({checked:!l,indeterminate:!1}))},r.handleMouseDown=function(o){var l=r.state,u=l.checked,c=l.indeterminate;ve(r.props,"onMouseDown",o,te({},r.props,{checked:!!u,indeterminate:!!c})),o.defaultPrevented||ve(r.inputRef.current,"focus"),o.preventDefault()},r.handleMouseUp=function(o){var l=r.state,u=l.checked,c=l.indeterminate;r.isClickFromMouse=!0,ve(r.props,"onMouseUp",o,te({},r.props,{checked:!!u,indeterminate:!!c}))},r.setIndeterminate=function(){var o=r.state.indeterminate;A2(r.inputRef,"current.indeterminate",!!o)},r}var t=e.prototype;return t.componentDidMount=function(){this.setIndeterminate()},t.componentDidUpdate=function(){this.setIndeterminate()},t.render=function(){var i=this.props,a=i.className,s=i.disabled,o=i.label,l=i.id,u=i.name,c=i.radio,d=i.readOnly,h=i.slider,p=i.toggle,g=i.type,E=i.value,A=this.state,b=A.checked,T=A.indeterminate,C=xe("ui",k(b,"checked"),k(s,"disabled"),k(T,"indeterminate"),k(Je(o),"fitted"),k(c,"radio"),k(d,"read-only"),k(h,"slider"),k(p,"toggle"),"checkbox",a),P=De(e,this.props),D=Be(e,this.props),F=Ch(P,{htmlProps:jy}),Q=F[0],W=F[1],B=YL(o,{defaultProps:{htmlFor:l},autoGenerateKey:!1})||Y.createElement("label",{htmlFor:l});return Y.createElement(D,te({},W,{className:C,onClick:this.handleClick,onChange:this.handleChange,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp}),Y.createElement(Ri,{innerRef:this.inputRef},Y.createElement("input",te({},Q,{checked:b,className:"hidden",disabled:s,id:l,name:u,readOnly:!0,tabIndex:this.computeTabIndex(),type:g,value:E}))),Y.createElement(Ri,{innerRef:this.labelRef},B))},e}($o);io.handledProps=["as","checked","className","defaultChecked","defaultIndeterminate","disabled","fitted","id","indeterminate","label","name","onChange","onClick","onMouseDown","onMouseUp","radio","readOnly","slider","tabIndex","toggle","type","value"];io.propTypes={};io.defaultProps={type:"checkbox"};io.autoControlledProps=["checked","indeterminate"];function R2(n){for(var e=-1,t=n==null?0:n.length,r=0,i=[];++e<t;){var a=n[e];a&&(i[r++]=a)}return i}function x2(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(!e(n[t],t,n))return!1;return!0}function _2(n,e){var t=!0;return Do(n,function(r,i,a){return t=!!e(r,i,a),t}),t}function P2(n,e,t){var r=Pt(n)?x2:_2;return t&&$y(n,e,t)&&(e=void 0),r(n,ms(e))}function M2(n,e,t){var r=n==null?0:n.length;return r?(e=t||e===void 0?1:Hl(e),e=r-e,xy(n,0,e<0?0:e)):[]}var O2=vN("length"),aC="\\ud800-\\udfff",I2="\\u0300-\\u036f",D2="\\ufe20-\\ufe2f",$2="\\u20d0-\\u20ff",L2=I2+D2+$2,q2="\\ufe0e\\ufe0f",B2="["+aC+"]",Gp="["+L2+"]",Kp="\\ud83c[\\udffb-\\udfff]",F2="(?:"+Gp+"|"+Kp+")",sC="[^"+aC+"]",oC="(?:\\ud83c[\\udde6-\\uddff]){2}",lC="[\\ud800-\\udbff][\\udc00-\\udfff]",k2="\\u200d",uC=F2+"?",cC="["+q2+"]?",U2="(?:"+k2+"(?:"+[sC,oC,lC].join("|")+")"+cC+uC+")*",j2=cC+uC+U2,Q2="(?:"+[sC+Gp+"?",Gp,oC,lC,B2].join("|")+")",bw=RegExp(Kp+"(?="+Kp+")|"+Q2+j2,"g");function V2(n){for(var e=bw.lastIndex=0;bw.test(n);)++e;return e}function z2(n){return Ly(n)?V2(n):O2(n)}var W2="[object Map]",H2="[object Set]";function G2(n){if(n==null)return 0;if(Fi(n))return Uy(n)?z2(n):n.length;var e=bd(n);return e==W2||e==H2?n.size:My(n).length}var Nw=Ou(function(n){return kN(Nh(n,1,Nd,!0))}),es=function(n){wt(e,n);function e(){return n.apply(this,arguments)||this}var t=e.prototype;return t.render=function(){var i=this.props,a=i.className,s=i.name,o=xe(s,"flag",a),l=De(e,this.props),u=Be(e,this.props);return Y.createElement(u,te({},l,{className:o}))},e}(Te.PureComponent);es.handledProps=["as","className","name"];es.propTypes={};es.defaultProps={as:"i"};es.create=st(es,function(n){return{name:n}});function au(n){var e=n.className,t=xe("divider",e),r=De(au,n),i=Be(au,n);return Y.createElement(i,te({},r,{className:t}))}au.handledProps=["as","className"];au.propTypes={};var ao=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleClick=function(o){ve(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.children,o=i.className,l=i.content,u=i.disabled,c=i.description,d=i.flag,h=i.icon,p=i.image,g=i.label,E=i.selected,A=i.text,b=xe(k(a,"active"),k(u,"disabled"),k(E,"selected"),"item",o),T=Je(h)?U$(s,"DropdownMenu")&&"dropdown":h,C=De(e,this.props),P=Be(e,this.props),D={role:"option","aria-disabled":u,"aria-checked":a,"aria-selected":E};if(!je(s))return Y.createElement(P,te({},C,D,{className:b,onClick:this.handleClick}),s);var F=es.create(d,{autoGenerateKey:!1}),Q=kt.create(T,{autoGenerateKey:!1}),W=dr.create(p,{autoGenerateKey:!1}),B=hr.create(g,{autoGenerateKey:!1}),K=zp("span",function(Z){return{children:Z}},c,{defaultProps:{className:"description"},autoGenerateKey:!1}),M=zp("span",function(Z){return{children:Z}},je(l)?A:l,{defaultProps:{className:"text"},autoGenerateKey:!1});return Y.createElement(P,te({},C,D,{className:b,onClick:this.handleClick}),W,Q,F,B,K,M)},e}(Te.Component);ao.handledProps=["active","as","children","className","content","description","disabled","flag","icon","image","label","onClick","selected","text","value"];ao.propTypes={};ao.create=st(ao,function(n){return n});function ua(n){var e=n.children,t=n.className,r=n.content,i=n.icon,a=xe("header",t),s=De(ua,n),o=Be(ua,n);return je(e)?Y.createElement(o,te({},s,{className:a}),kt.create(i,{autoGenerateKey:!1}),r):Y.createElement(o,te({},s,{className:a}),e)}ua.handledProps=["as","children","className","content","icon"];ua.propTypes={};ua.create=st(ua,function(n){return{content:n}});function so(n){var e=n.children,t=n.className,r=n.content,i=n.direction,a=n.open,s=n.scrolling,o=xe(i,k(a,"visible"),k(s,"scrolling"),"menu transition",t),l=De(so,n),u=Be(so,n);return Y.createElement(u,te({},l,{className:o}),je(e)?r:e)}so.handledProps=["as","children","className","content","direction","open","scrolling"];so.propTypes={};var ts=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleChange=function(o){var l=Ki(o,"target.value");ve(r.props,"onChange",o,te({},r.props,{value:l}))},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.autoComplete,s=i.className,o=i.tabIndex,l=i.type,u=i.value,c=xe("search",s),d=De(e,this.props);return Y.createElement("input",te({},d,{"aria-autocomplete":"list",autoComplete:a,className:c,onChange:this.handleChange,tabIndex:o,type:l,value:u}))},e}(Te.Component);ts.handledProps=["as","autoComplete","className","tabIndex","type","value"];ts.propTypes={};ts.defaultProps={autoComplete:"off",type:"text"};ts.create=st(ts,function(n){return{type:n}});function ca(n){var e=n.children,t=n.className,r=n.content,i=xe("divider",t),a=De(ca,n),s=Be(ca,n);return Y.createElement(s,te({"aria-atomic":!0,"aria-live":"polite",role:"alert"},a,{className:i}),je(e)?r:e)}ca.handledProps=["as","children","className","content"];ca.propTypes={};ca.create=st(ca,function(n){return{content:n}});var dC=/[\\^$.*+?()[\]{}|]/g,K2=RegExp(dC.source);function J2(n){return n=_u(n),n&&K2.test(n)?n.replace(dC,"\\$&"):n}function Fs(n){var e=n.additionLabel,t=n.additionPosition,r=n.allowAdditions,i=n.deburr,a=n.multiple,s=n.options,o=n.search,l=n.searchQuery,u=n.value,c=s;if(a&&(c=ow(c,function(E){return!fi(u,E.value)})),o&&l)if(to(o))c=o(c,l);else{var d=i?Hp(l):l,h=new RegExp(J2(d),"i");c=ow(c,function(E){return h.test(i?Hp(E.text):E.text)})}if(r&&o&&l&&!Tl(c,{text:l})){var p=Y.isValidElement(e)?Y.cloneElement(e,{key:"addition-label"}):e||"",g={key:"addition",text:[p,Y.createElement("b",{key:"addition-query"},l)],value:l,className:"addition","data-additional":!0};t==="top"?c.unshift(g):c.push(g)}return c}Fs.handledProps=[];function Cw(n){var e=n.additionLabel,t=n.additionPosition,r=n.allowAdditions,i=n.deburr,a=n.multiple,s=n.options,o=n.search,l=n.searchQuery,u=n.selectedIndex,c=n.value,d=Fs({value:c,options:s,searchQuery:l,additionLabel:e,additionPosition:t,allowAdditions:r,deburr:i,multiple:a,search:o}),h=zy(d,function(A,b,T){return b.disabled||A.push(T),A},[]),p;if(!u||u<0){var g=h[0];p=a?g:kp(d,["value",c])||h[0]}else if(a)p=CN(h,function(A){return A>=u}),u>=d.length-1&&(p=h[h.length-1]);else{var E=kp(d,["value",c]);p=fi(h,E)?E:void 0}return(!p||p<0)&&(p=h[0]),p}var Sw=function(e,t){return Je(e)?t:e},Aw=function(e){return e&&e.map(function(t){return IN(t,["key","value"])})};function hC(n){var e=n.flag,t=n.image,r=n.text;return to(r)?r:{content:Y.createElement(Y.Fragment,null,es.create(e),dr.create(t),r)}}var yr=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.searchRef=Te.createRef(),r.sizerRef=Te.createRef(),r.ref=Te.createRef(),r.handleChange=function(o,l){ve(r.props,"onChange",o,te({},r.props,{value:l}))},r.closeOnChange=function(o){var l=r.props,u=l.closeOnChange,c=l.multiple,d=Iu(u)?!c:u;d&&r.close(o,ky)},r.closeOnEscape=function(o){r.props.closeOnEscape&&at.getCode(o)===at.Escape&&(o.preventDefault(),r.close(o))},r.moveSelectionOnKeyDown=function(o){var l,u=r.props,c=u.multiple,d=u.selectOnNavigation,h=r.state.open;if(h){var p=(l={},l[at.ArrowDown]=1,l[at.ArrowUp]=-1,l),g=p[at.getCode(o)];if(g!==void 0){o.preventDefault();var E=r.getSelectedIndexAfterMove(g);!c&&d&&r.makeSelectedItemActive(o,E),r.setState({selectedIndex:E})}}},r.openOnSpace=function(o){var l,u,c,d=r.state.focus&&!r.state.open&&at.getCode(o)===at.Spacebar,h=((l=o.target)==null?void 0:l.tagName)!=="INPUT"&&((u=o.target)==null?void 0:u.tagName)!=="TEXTAREA"&&((c=o.target)==null?void 0:c.isContentEditable)!==!0;d&&(h&&o.preventDefault(),r.open(o))},r.openOnArrow=function(o){var l=r.state,u=l.focus,c=l.open;if(u&&!c){var d=at.getCode(o);(d===at.ArrowDown||d===at.ArrowUp)&&(o.preventDefault(),r.open(o))}},r.makeSelectedItemActive=function(o,l){var u=r.state,c=u.open,d=u.value,h=r.props.multiple,p=r.getSelectedItem(l),g=Ki(p,"value"),E=Ki(p,"disabled");if(Je(g)||!c||E)return d;var A=h?Nw(d,[g]):g,b=h?!!cw(A,d).length:A!==d;return b&&(r.setState({value:A}),r.handleChange(o,A),p["data-additional"]&&ve(r.props,"onAddItem",o,te({},r.props,{value:g}))),d},r.selectItemOnEnter=function(o){var l=r.props.search,u=r.state,c=u.open,d=u.selectedIndex;if(c){var h=at.getCode(o)===at.Enter||!l&&at.getCode(o)===at.Spacebar;if(h){o.preventDefault();var p=G2(Fs({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search}));if(!(l&&p===0)){var g=r.makeSelectedItemActive(o,d);r.setState({selectedIndex:Cw({additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search,selectedIndex:d,value:g,options:r.props.options,searchQuery:""})}),r.closeOnChange(o),r.clearSearchQuery(),l&&ve(r.searchRef.current,"focus")}}}},r.removeItemOnBackspace=function(o){var l=r.props,u=l.multiple,c=l.search,d=r.state,h=d.searchQuery,p=d.value;if(at.getCode(o)===at.Backspace&&!(h||!c||!u||ul(p))){o.preventDefault();var g=M2(p);r.setState({value:g}),r.handleChange(o,g)}},r.closeOnDocumentClick=function(o){r.props.closeOnBlur&&(r.ref.current&&bl(r.ref.current,o)||r.close())},r.handleMouseDown=function(o){r.isMouseDown=!0,ve(r.props,"onMouseDown",o,r.props),document.addEventListener("mouseup",r.handleDocumentMouseUp)},r.handleDocumentMouseUp=function(){r.isMouseDown=!1,document.removeEventListener("mouseup",r.handleDocumentMouseUp)},r.handleClick=function(o){var l=r.props,u=l.minCharacters,c=l.search,d=r.state,h=d.open,p=d.searchQuery;if(ve(r.props,"onClick",o,r.props),o.stopPropagation(),!c)return r.toggle(o);if(h){ve(r.searchRef.current,"focus");return}if(p.length>=u||u===1){r.open(o);return}ve(r.searchRef.current,"focus")},r.handleIconClick=function(o){var l=r.props.clearable,u=r.hasValue();ve(r.props,"onClick",o,r.props),o.stopPropagation(),l&&u?r.clearValue(o):r.toggle(o)},r.handleItemClick=function(o,l){var u=r.props,c=u.multiple,d=u.search,h=r.state.value,p=l.value;if(o.stopPropagation(),(c||l.disabled)&&o.nativeEvent.stopImmediatePropagation(),!l.disabled){var g=l["data-additional"],E=c?Nw(r.state.value,[p]):p,A=c?!!cw(E,h).length:E!==h;A&&(r.setState({value:E}),r.handleChange(o,E)),r.clearSearchQuery(),ve(d?r.searchRef.current:r.ref.current,"focus"),r.closeOnChange(o),g&&ve(r.props,"onAddItem",o,te({},r.props,{value:p}))}},r.handleFocus=function(o){var l=r.state.focus;l||(ve(r.props,"onFocus",o,r.props),r.setState({focus:!0}))},r.handleBlur=function(o){var l=Ki(o,"currentTarget");if(!(l&&l.contains(document.activeElement))){var u=r.props,c=u.closeOnBlur,d=u.multiple,h=u.selectOnBlur;r.isMouseDown||(ve(r.props,"onBlur",o,r.props),h&&!d&&(r.makeSelectedItemActive(o,r.state.selectedIndex),c&&r.close()),r.setState({focus:!1}),r.clearSearchQuery())}},r.handleSearchChange=function(o,l){var u=l.value;o.stopPropagation();var c=r.props.minCharacters,d=r.state.open,h=u;if(ve(r.props,"onSearchChange",o,te({},r.props,{searchQuery:h})),r.setState({searchQuery:h,selectedIndex:0}),!d&&h.length>=c){r.open();return}d&&c!==1&&h.length<c&&r.close()},r.handleKeyDown=function(o){r.moveSelectionOnKeyDown(o),r.openOnArrow(o),r.openOnSpace(o),r.selectItemOnEnter(o),ve(r.props,"onKeyDown",o)},r.getSelectedItem=function(o){var l=Fs({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search});return Ki(l,"["+o+"]")},r.getItemByValue=function(o){var l=r.props.options;return CN(l,{value:o})},r.getDropdownAriaOptions=function(){var o=r.props,l=o.loading,u=o.disabled,c=o.search,d=o.multiple,h=r.state.open,p={role:c?"combobox":"listbox","aria-busy":l,"aria-disabled":u,"aria-expanded":!!h};return p.role==="listbox"&&(p["aria-multiselectable"]=d),p},r.clearSearchQuery=function(){var o=r.state.searchQuery;o===void 0||o===""||r.setState({searchQuery:""})},r.handleLabelClick=function(o,l){o.stopPropagation(),r.setState({selectedLabel:l.value}),ve(r.props,"onLabelClick",o,l)},r.handleLabelRemove=function(o,l){o.stopPropagation();var u=r.state.value,c=Pq(u,l.value);r.setState({value:c}),r.handleChange(o,c)},r.getSelectedIndexAfterMove=function(o,l){l===void 0&&(l=r.state.selectedIndex);var u=Fs({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search});if(!(u===void 0||P2(u,"disabled"))){var c=u.length-1,d=r.props.wrapSelection,h=l+o;return!d&&(h>c||h<0)?h=l:h>c?h=0:h<0&&(h=c),u[h].disabled?r.getSelectedIndexAfterMove(o,h):h}},r.handleIconOverrides=function(o){var l=r.props.clearable,u=xe(l&&r.hasValue()&&"clear",o.className);return{className:u,onClick:function(d){ve(o,"onClick",d,o),r.handleIconClick(d)}}},r.clearValue=function(o){var l=r.props.multiple,u=l?[]:"";r.setState({value:u}),r.handleChange(o,u)},r.computeSearchInputTabIndex=function(){var o=r.props,l=o.disabled,u=o.tabIndex;return Je(u)?l?-1:0:u},r.computeSearchInputWidth=function(){var o=r.state.searchQuery;if(r.sizerRef.current&&o){r.sizerRef.current.style.display="inline",r.sizerRef.current.textContent=o;var l=Math.ceil(r.sizerRef.current.getBoundingClientRect().width);return r.sizerRef.current.style.removeProperty("display"),l}},r.computeTabIndex=function(){var o=r.props,l=o.disabled,u=o.search,c=o.tabIndex;if(!u)return l?-1:Je(c)?0:c},r.handleSearchInputOverrides=function(o){return{onChange:function(u,c){ve(o,"onChange",u,c),r.handleSearchChange(u,c)}}},r.hasValue=function(){var o=r.props.multiple,l=r.state.value;return o?!ul(l):!Je(l)&&l!==""},r.scrollSelectedItemIntoView=function(){if(r.ref.current){var o=r.ref.current.querySelector(".menu.visible");if(o){var l=o.querySelector(".item.selected");if(l){var u=l.offsetTop<o.scrollTop,c=l.offsetTop+l.clientHeight>o.scrollTop+o.clientHeight;u?o.scrollTop=l.offsetTop:c&&(o.scrollTop=l.offsetTop+l.clientHeight-o.clientHeight)}}}},r.setOpenDirection=function(){if(r.ref.current){var o=r.ref.current.querySelector(".menu.visible");if(o){var l=r.ref.current.getBoundingClientRect(),u=o.clientHeight,c=document.documentElement.clientHeight-l.top-l.height-u,d=l.top-u,h=c<0&&d>c;!h!=!r.state.upward&&r.setState({upward:h})}}},r.open=function(o,l){o===void 0&&(o=null),l===void 0&&(l=!0);var u=r.props,c=u.disabled,d=u.search;c||(d&&ve(r.searchRef.current,"focus"),ve(r.props,"onOpen",o,r.props),l&&r.setState({open:!0}),r.scrollSelectedItemIntoView())},r.close=function(o,l){l===void 0&&(l=r.handleClose),r.state.open&&(ve(r.props,"onClose",o,r.props),r.setState({open:!1},l))},r.handleClose=function(){var o=document.activeElement===r.searchRef.current;!o&&r.ref.current&&r.ref.current.blur();var l=document.activeElement===r.ref.current,u=o||l;r.setState({focus:u})},r.toggle=function(o){return r.state.open?r.close(o):r.open(o)},r.renderText=function(){var o=r.props,l=o.multiple,u=o.placeholder,c=o.search,d=o.text,h=r.state,p=h.searchQuery,g=h.selectedIndex,E=h.value,A=h.open,b=r.hasValue(),T=xe(u&&!b&&"default","text",c&&p&&"filtered"),C=u,P;return d?C=d:A&&!l?P=r.getSelectedItem(g):b&&(P=r.getItemByValue(E)),ca.create(P?hC(P):C,{defaultProps:{className:T}})},r.renderSearchInput=function(){var o=r.props,l=o.search,u=o.searchInput,c=r.state.searchQuery;return l&&Y.createElement(Ri,{innerRef:r.searchRef},ts.create(u,{defaultProps:{style:{width:r.computeSearchInputWidth()},tabIndex:r.computeSearchInputTabIndex(),value:c},overrideProps:r.handleSearchInputOverrides}))},r.renderSearchSizer=function(){var o=r.props,l=o.search,u=o.multiple;return l&&u&&Y.createElement("span",{className:"sizer",ref:r.sizerRef})},r.renderLabels=function(){var o=r.props,l=o.multiple,u=o.renderLabel,c=r.state,d=c.selectedLabel,h=c.value;if(!(!l||ul(h))){var p=qn(h,r.getItemByValue);return qn(R2(p),function(g,E){var A={active:g.value===d,as:"a",key:Sw(g.key,g.value),onClick:r.handleLabelClick,onRemove:r.handleLabelRemove,value:g.value};return hr.create(u(g,E,A),{defaultProps:A})})}},r.renderOptions=function(){var o=r.props,l=o.lazyLoad,u=o.multiple,c=o.search,d=o.noResultsMessage,h=r.state,p=h.open,g=h.selectedIndex,E=h.value;if(l&&!p)return null;var A=Fs({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search});if(d!==null&&c&&ul(A))return Y.createElement("div",{className:"message"},d);var b=u?function(T){return fi(E,T)}:function(T){return T===E};return qn(A,function(T,C){return ao.create(te({active:b(T.value),selected:g===C},T,{key:Sw(T.key,T.value),style:te({},T.style,{pointerEvents:"all"})}),{generateKey:!1,overrideProps:function(D){return{onClick:function(Q,W){D.onClick==null||D.onClick(Q,W),r.handleItemClick(Q,W)}}}})})},r.renderMenu=function(){var o=r.props,l=o.children,u=o.direction,c=o.header,d=r.state.open,h=r.getDropdownMenuAriaOptions();if(!je(l)){var p=Te.Children.only(l),g=xe(u,k(d,"visible"),p.props.className);return Te.cloneElement(p,te({className:g},h))}return Y.createElement(so,te({},h,{direction:u,open:d}),ua.create(c,{autoGenerateKey:!1}),r.renderOptions())},r}var t=e.prototype;return t.getInitialAutoControlledState=function(){return{focus:!1,searchQuery:""}},e.getAutoControlledStateFromProps=function(i,a,s){var o={__options:i.options,__value:a.value},l=!Qa(s.__value,a.value)||!xq(Aw(i.options),Aw(s.__options));return l&&(o.selectedIndex=Cw({additionLabel:i.additionLabel,additionPosition:i.additionPosition,allowAdditions:i.allowAdditions,deburr:i.deburr,multiple:i.multiple,search:i.search,selectedIndex:a.selectedIndex,value:a.value,options:i.options,searchQuery:a.searchQuery})),o},t.componentDidMount=function(){var i=this.state.open;i&&this.open(null,!1)},t.shouldComponentUpdate=function(i,a){return!Qa(i,this.props)||!Qa(a,this.state)},t.componentDidUpdate=function(i,a){var s=this.props,o=s.closeOnBlur,l=s.minCharacters,u=s.openOnFocus,c=s.search;if(!a.focus&&this.state.focus){if(!this.isMouseDown){var d=!c||c&&l===1&&!this.state.open;u&&d&&this.open()}}else a.focus&&!this.state.focus&&!this.isMouseDown&&o&&this.close();!a.open&&this.state.open?(this.setOpenDirection(),this.scrollSelectedItemIntoView()):a.open&&this.state.open,a.selectedIndex!==this.state.selectedIndex&&this.scrollSelectedItemIntoView()},t.getDropdownMenuAriaOptions=function(){var i=this.props,a=i.search,s=i.multiple,o={};return a&&(o["aria-multiselectable"]=s,o.role="listbox"),o},t.render=function(){var i=this.props,a=i.basic,s=i.button,o=i.className,l=i.compact,u=i.disabled,c=i.error,d=i.fluid,h=i.floating,p=i.icon,g=i.inline,E=i.item,A=i.labeled,b=i.loading,T=i.multiple,C=i.pointing,P=i.search,D=i.selection,F=i.scrolling,Q=i.simple,W=i.trigger,B=this.state,K=B.focus,M=B.open,Z=B.upward,q=xe("ui",k(M,"active visible"),k(u,"disabled"),k(c,"error"),k(b,"loading"),k(a,"basic"),k(s,"button"),k(l,"compact"),k(d,"fluid"),k(h,"floating"),k(g,"inline"),k(A,"labeled"),k(E,"item"),k(T,"multiple"),k(P,"search"),k(D,"selection"),k(Q,"simple"),k(F,"scrolling"),k(Z,"upward"),vt(C,"pointing"),"dropdown",o),G=De(e,this.props),oe=Be(e,this.props),he=this.getDropdownAriaOptions(oe,this.props);return Y.createElement(Ri,{innerRef:this.ref},Y.createElement(oe,te({},G,he,{className:q,onBlur:this.handleBlur,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onChange:this.handleChange,tabIndex:this.computeTabIndex()}),this.renderLabels(),this.renderSearchInput(),this.renderSearchSizer(),W||this.renderText(),kt.create(p,{overrideProps:this.handleIconOverrides,autoGenerateKey:!1}),this.renderMenu(),M&&Y.createElement(ci,{name:"keydown",on:this.closeOnEscape}),M&&Y.createElement(ci,{name:"click",on:this.closeOnDocumentClick}),K&&Y.createElement(ci,{name:"keydown",on:this.removeItemOnBackspace})))},e}($o);yr.handledProps=["additionLabel","additionPosition","allowAdditions","as","basic","button","children","className","clearable","closeOnBlur","closeOnChange","closeOnEscape","compact","deburr","defaultOpen","defaultSearchQuery","defaultSelectedLabel","defaultUpward","defaultValue","direction","disabled","error","floating","fluid","header","icon","inline","item","labeled","lazyLoad","loading","minCharacters","multiple","noResultsMessage","onAddItem","onBlur","onChange","onClick","onClose","onFocus","onLabelClick","onMouseDown","onOpen","onSearchChange","open","openOnFocus","options","placeholder","pointing","renderLabel","scrolling","search","searchInput","searchQuery","selectOnBlur","selectOnNavigation","selectedLabel","selection","simple","tabIndex","text","trigger","upward","value","wrapSelection"];yr.propTypes={};yr.defaultProps={additionLabel:"Add ",additionPosition:"top",closeOnBlur:!0,closeOnEscape:!0,deburr:!1,icon:"dropdown",minCharacters:1,noResultsMessage:"No results found.",openOnFocus:!0,renderLabel:hC,searchInput:"text",selectOnBlur:!0,selectOnNavigation:!0,wrapSelection:!0};yr.autoControlledProps=["open","searchQuery","selectedLabel","value","upward"];yr.Divider=au;yr.Header=ua;yr.Item=ao;yr.Menu=so;yr.SearchInput=ts;yr.Text=ca;function _i(n){var e=n.children,t=n.className,r=n.content,i=n.icon,a=xe("divider",t),s=De(_i,n),o=Be(_i,n);return Je(i)?Je(r)?Y.createElement(o,te({},s,{className:a}),je(e)?"/":e):Y.createElement(o,te({},s,{className:a}),r):kt.create(i,{defaultProps:te({},s,{className:a}),autoGenerateKey:!1})}_i.handledProps=["as","children","className","content","icon"];_i.propTypes={};_i.create=st(_i,function(n){return{icon:n}});var da=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.computeElementType=function(){var o=r.props,l=o.link,u=o.onClick;if(l||u)return"a"},r.handleClick=function(o){return ve(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.children,o=i.className,l=i.content,u=i.href,c=xe(k(a,"active"),"section",o),d=De(e,this.props),h=Be(e,this.props,this.computeElementType);return Y.createElement(h,te({},d,{className:c,href:u,onClick:this.handleClick}),je(s)?l:s)},e}(Te.Component);da.handledProps=["active","as","children","className","content","href","link","onClick"];da.propTypes={};da.create=st(da,function(n){return{content:n,link:!0}});function ns(n){var e=n.children,t=n.className,r=n.divider,i=n.icon,a=n.sections,s=n.size,o=xe("ui",s,"breadcrumb",t),l=De(ns,n),u=Be(ns,n);if(!je(e))return Y.createElement(u,te({},l,{className:o}),e);var c=[];return NN(a,function(d,h){var p=da.create(d);if(c.push(p),h!==a.length-1){var g=p.key+"_divider"||JSON.stringify(d);c.push(_i.create({content:r,icon:i,key:g}))}}),Y.createElement(u,te({},l,{className:o}),c)}ns.handledProps=["as","children","className","divider","icon","sections","size"];ns.propTypes={};ns.Divider=_i;ns.Section=da;var oo=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.inputRef=Te.createRef(),r.computeIcon=function(){var o=r.props,l=o.loading,u=o.icon;if(!Je(u))return u;if(l)return"spinner"},r.computeTabIndex=function(){var o=r.props,l=o.disabled,u=o.tabIndex;if(!Je(u))return u;if(l)return-1},r.focus=function(o){return r.inputRef.current.focus(o)},r.select=function(){return r.inputRef.current.select()},r.handleChange=function(o){var l=Ki(o,"target.value");ve(r.props,"onChange",o,te({},r.props,{value:l}))},r.handleChildOverrides=function(o,l){return te({},l,o.props,{ref:function(c){zr(o.ref,c),r.inputRef.current=c}})},r.partitionProps=function(){var o=r.props,l=o.disabled,u=o.type,c=r.computeTabIndex(),d=De(e,r.props),h=Ch(d),p=h[0],g=h[1];return[te({},p,{disabled:l,type:u,tabIndex:c,onChange:r.handleChange,ref:r.inputRef}),g]},r}var t=e.prototype;return t.render=function(){var i=this,a=this.props,s=a.action,o=a.actionPosition,l=a.children,u=a.className,c=a.disabled,d=a.error,h=a.fluid,p=a.focus,g=a.icon,E=a.iconPosition,A=a.input,b=a.inverted,T=a.label,C=a.labelPosition,P=a.loading,D=a.size,F=a.transparent,Q=a.type,W=xe("ui",D,k(c,"disabled"),k(d,"error"),k(h,"fluid"),k(p,"focus"),k(b,"inverted"),k(P,"loading"),k(F,"transparent"),cn(o,"action")||k(s,"action"),cn(E,"icon")||k(g||P,"icon"),cn(C,"labeled")||k(T,"labeled"),"input",u),B=Be(e,this.props),K=this.partitionProps(),M=K[0],Z=K[1];if(!je(l)){var q=qn(Te.Children.toArray(l),function(he){return he.type!=="input"?he:Te.cloneElement(he,i.handleChildOverrides(he,M))});return Y.createElement(B,te({},Z,{className:W}),q)}var G=ei.create(s,{autoGenerateKey:!1}),oe=hr.create(T,{defaultProps:{className:xe("label",fi(C,"corner")&&C)},autoGenerateKey:!1});return Y.createElement(B,te({},Z,{className:W}),o==="left"&&G,C!=="right"&&oe,JL(A||Q,{defaultProps:M,autoGenerateKey:!1}),kt.create(this.computeIcon(),{autoGenerateKey:!1}),o!=="left"&&G,C==="right"&&oe)},e}(Te.Component);oo.handledProps=["action","actionPosition","as","children","className","disabled","error","fluid","focus","icon","iconPosition","input","inverted","label","labelPosition","loading","onChange","size","tabIndex","transparent","type"];oo.propTypes={};oo.defaultProps={type:"text"};oo.create=st(oo,function(n){return{type:n}});function Lt(n){var e=n.children,t=n.className,r=n.computer,i=n.color,a=n.floated,s=n.largeScreen,o=n.mobile,l=n.only,u=n.stretched,c=n.tablet,d=n.textAlign,h=n.verticalAlign,p=n.widescreen,g=n.width,E=xe(i,k(u,"stretched"),Cd(l,"only"),ys(d),cn(a,"floated"),Ca(h),er(r,"wide computer"),er(s,"wide large screen"),er(o,"wide mobile"),er(c,"wide tablet"),er(p,"wide widescreen"),er(g,"wide"),"column",t),A=De(Lt,n),b=Be(Lt,n);return Y.createElement(b,te({},A,{className:E}),e)}Lt.handledProps=["as","children","className","color","computer","floated","largeScreen","mobile","only","stretched","tablet","textAlign","verticalAlign","widescreen","width"];Lt.propTypes={};Lt.create=st(Lt,function(n){return{children:n}});function Rr(n){var e=n.centered,t=n.children,r=n.className,i=n.color,a=n.columns,s=n.divided,o=n.only,l=n.reversed,u=n.stretched,c=n.textAlign,d=n.verticalAlign,h=xe(i,k(e,"centered"),k(s,"divided"),k(u,"stretched"),Cd(o,"only"),Cd(l,"reversed"),ys(c),Ca(d),er(a,"column",!0),"row",r),p=De(Rr,n),g=Be(Rr,n);return Y.createElement(g,te({},p,{className:h}),t)}Rr.handledProps=["as","centered","children","className","color","columns","divided","only","reversed","stretched","textAlign","verticalAlign"];Rr.propTypes={};function ha(n){var e=n.celled,t=n.centered,r=n.children,i=n.className,a=n.columns,s=n.container,o=n.divided,l=n.doubling,u=n.inverted,c=n.padded,d=n.relaxed,h=n.reversed,p=n.stackable,g=n.stretched,E=n.textAlign,A=n.verticalAlign,b=xe("ui",k(t,"centered"),k(s,"container"),k(l,"doubling"),k(u,"inverted"),k(p,"stackable"),k(g,"stretched"),vt(e,"celled"),vt(o,"divided"),vt(c,"padded"),vt(d,"relaxed"),Cd(h,"reversed"),ys(E),Ca(A),er(a,"column",!0),"grid",i),T=De(ha,n),C=Be(ha,n);return Y.createElement(C,te({},T,{className:b}),r)}ha.handledProps=["as","celled","centered","children","className","columns","container","divided","doubling","inverted","padded","relaxed","reversed","stackable","stretched","textAlign","verticalAlign"];ha.Column=Lt;ha.Row=Rr;ha.propTypes={};function fa(n){var e=n.children,t=n.className,r=xe(t),i=De(fa,n),a=Be(fa,n);return Y.createElement(a,te({},i,{className:r}),e)}fa.handledProps=["as","children","className"];fa.defaultProps={as:"tbody"};fa.propTypes={};function Zt(n){var e=n.active,t=n.children,r=n.className,i=n.collapsing,a=n.content,s=n.disabled,o=n.error,l=n.icon,u=n.negative,c=n.positive,d=n.selectable,h=n.singleLine,p=n.textAlign,g=n.verticalAlign,E=n.warning,A=n.width,b=xe(k(e,"active"),k(i,"collapsing"),k(s,"disabled"),k(o,"error"),k(u,"negative"),k(c,"positive"),k(d,"selectable"),k(h,"single line"),k(E,"warning"),ys(p),Ca(g),er(A,"wide"),r),T=De(Zt,n),C=Be(Zt,n);return je(t)?Y.createElement(C,te({},T,{className:b}),kt.create(l),a):Y.createElement(C,te({},T,{className:b}),t)}Zt.handledProps=["active","as","children","className","collapsing","content","disabled","error","icon","negative","positive","selectable","singleLine","textAlign","verticalAlign","warning","width"];Zt.defaultProps={as:"td"};Zt.propTypes={};Zt.create=st(Zt,function(n){return{content:n}});function Pi(n){var e=n.children,t=n.className,r=n.content,i=n.fullWidth,a=xe(k(i,"full-width"),t),s=De(Pi,n),o=Be(Pi,n);return Y.createElement(o,te({},s,{className:a}),je(e)?r:e)}Pi.handledProps=["as","children","className","content","fullWidth"];Pi.defaultProps={as:"thead"};Pi.propTypes={};function gs(n){var e=n.as,t=De(gs,n);return Y.createElement(Pi,te({},t,{as:e}))}gs.handledProps=["as"];gs.propTypes={};gs.defaultProps={as:"tfoot"};function In(n){var e=n.as,t=n.className,r=n.sorted,i=xe(cn(r,"sorted"),t),a=De(In,n);return Y.createElement(Zt,te({},a,{as:e,className:i}))}In.handledProps=["as","className","sorted"];In.propTypes={};In.defaultProps={as:"th"};function pn(n){var e=n.active,t=n.cellAs,r=n.cells,i=n.children,a=n.className,s=n.disabled,o=n.error,l=n.negative,u=n.positive,c=n.textAlign,d=n.verticalAlign,h=n.warning,p=xe(k(e,"active"),k(s,"disabled"),k(o,"error"),k(l,"negative"),k(u,"positive"),k(h,"warning"),ys(c),Ca(d),a),g=De(pn,n),E=Be(pn,n);return je(i)?Y.createElement(E,te({},g,{className:p}),qn(r,function(A){return Zt.create(A,{defaultProps:{as:t}})})):Y.createElement(E,te({},g,{className:p}),i)}pn.handledProps=["active","as","cellAs","cells","children","className","disabled","error","negative","positive","textAlign","verticalAlign","warning"];pn.defaultProps={as:"tr",cellAs:"td"};pn.propTypes={};pn.create=st(pn,function(n){return{cells:n}});function fr(n){var e=n.attached,t=n.basic,r=n.celled,i=n.children,a=n.className,s=n.collapsing,o=n.color,l=n.columns,u=n.compact,c=n.definition,d=n.fixed,h=n.footerRow,p=n.headerRow,g=n.headerRows,E=n.inverted,A=n.padded,b=n.renderBodyRow,T=n.selectable,C=n.singleLine,P=n.size,D=n.sortable,F=n.stackable,Q=n.striped,W=n.structured,B=n.tableData,K=n.textAlign,M=n.unstackable,Z=n.verticalAlign,q=xe("ui",o,P,k(r,"celled"),k(s,"collapsing"),k(c,"definition"),k(d,"fixed"),k(E,"inverted"),k(T,"selectable"),k(C,"single line"),k(D,"sortable"),k(F,"stackable"),k(Q,"striped"),k(W,"structured"),k(M,"unstackable"),vt(e,"attached"),vt(t,"basic"),vt(u,"compact"),vt(A,"padded"),ys(K),Ca(Z),er(l,"column"),"table",a),G=De(fr,n),oe=Be(fr,n);if(!je(i))return Y.createElement(oe,te({},G,{className:q}),i);var he=p||g,pe={defaultProps:{cellAs:"th"}},ee=he&&Y.createElement(Pi,null,pn.create(p,pe),qn(g,function(de){return pn.create(de,pe)}));return Y.createElement(oe,te({},G,{className:q}),ee,Y.createElement(fa,null,b&&qn(B,function(de,Ee){return pn.create(b(de,Ee))})),h&&Y.createElement(gs,null,pn.create(h)))}fr.handledProps=["as","attached","basic","celled","children","className","collapsing","color","columns","compact","definition","fixed","footerRow","headerRow","headerRows","inverted","padded","renderBodyRow","selectable","singleLine","size","sortable","stackable","striped","structured","tableData","textAlign","unstackable","verticalAlign"];fr.defaultProps={as:"table"};fr.propTypes={};fr.Body=fa;fr.Cell=Zt;fr.Footer=gs;fr.Header=Pi;fr.HeaderCell=In;fr.Row=pn;function pa(n){var e=n.children,t=n.className,r=n.content,i=xe("sub header",t),a=De(pa,n),s=Be(pa,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}pa.handledProps=["as","children","className","content"];pa.propTypes={};pa.create=st(pa,function(n){return{content:n}});function lo(n){var e=n.children,t=n.className,r=n.content,i=xe("content",t),a=De(lo,n),s=Be(lo,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}lo.handledProps=["as","children","className","content"];lo.propTypes={};function Mi(n){var e=n.attached,t=n.block,r=n.children,i=n.className,a=n.color,s=n.content,o=n.disabled,l=n.dividing,u=n.floated,c=n.icon,d=n.image,h=n.inverted,p=n.size,g=n.sub,E=n.subheader,A=n.textAlign,b=xe("ui",a,p,k(t,"block"),k(o,"disabled"),k(l,"dividing"),cn(u,"floated"),k(c===!0,"icon"),k(d===!0,"image"),k(h,"inverted"),k(g,"sub"),vt(e,"attached"),ys(A),"header",i),T=De(Mi,n),C=Be(Mi,n);if(!je(r))return Y.createElement(C,te({},T,{className:b}),r);var P=kt.create(c,{autoGenerateKey:!1}),D=dr.create(d,{autoGenerateKey:!1}),F=pa.create(E,{autoGenerateKey:!1});return P||D?Y.createElement(C,te({},T,{className:b}),P||D,(s||F)&&Y.createElement(lo,null,s,F)):Y.createElement(C,te({},T,{className:b}),s,F)}Mi.handledProps=["as","attached","block","children","className","color","content","disabled","dividing","floated","icon","image","inverted","size","sub","subheader","textAlign"];Mi.propTypes={};Mi.Content=lo;Mi.Subheader=pa;function Y2(n){return kn(n)&&n.nodeType===1&&!qy(n)}var X2=Te.createContext();Te.createContext();var Z2=function(e){return Array.isArray(e)?e[0]:e},eB=function(e){if(typeof e=="function"){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return e.apply(void 0,r)}},tB=function(e,t){if(typeof e=="function")return eB(e,t);e!=null&&(e.current=t)},Rw=function(e){return e.reduce(function(t,r){var i=r[0],a=r[1];return t[i]=a,t},{})},xw=typeof window<"u"&&window.document&&window.document.createElement?Te.useLayoutEffect:Te.useEffect,An="top",pr="bottom",mr="right",Rn="left",Wy="auto",Lu=[An,pr,mr,Rn],uo="start",su="end",nB="clippingParents",fC="viewport",tl="popper",rB="reference",_w=Lu.reduce(function(n,e){return n.concat([e+"-"+uo,e+"-"+su])},[]),pC=[].concat(Lu,[Wy]).reduce(function(n,e){return n.concat([e,e+"-"+uo,e+"-"+su])},[]),iB="beforeRead",aB="read",sB="afterRead",oB="beforeMain",lB="main",uB="afterMain",cB="beforeWrite",dB="write",hB="afterWrite",fB=[iB,aB,sB,oB,lB,uB,cB,dB,hB];function ti(n){return n?(n.nodeName||"").toLowerCase():null}function Un(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function rs(n){var e=Un(n).Element;return n instanceof e||n instanceof Element}function ar(n){var e=Un(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Hy(n){if(typeof ShadowRoot>"u")return!1;var e=Un(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function pB(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!ar(a)||!ti(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function mB(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],a=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),o=s.reduce(function(l,u){return l[u]="",l},{});!ar(i)||!ti(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const yB={name:"applyStyles",enabled:!0,phase:"write",fn:pB,effect:mB,requires:["computeStyles"]};function Kr(n){return n.split("-")[0]}var Va=Math.max,xd=Math.min,co=Math.round;function Jp(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function mC(){return!/^((?!chrome|android).)*safari/i.test(Jp())}function ho(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,a=1;e&&ar(n)&&(i=n.offsetWidth>0&&co(r.width)/n.offsetWidth||1,a=n.offsetHeight>0&&co(r.height)/n.offsetHeight||1);var s=rs(n)?Un(n):window,o=s.visualViewport,l=!mC()&&t,u=(r.left+(l&&o?o.offsetLeft:0))/i,c=(r.top+(l&&o?o.offsetTop:0))/a,d=r.width/i,h=r.height/a;return{width:d,height:h,top:c,right:u+d,bottom:c+h,left:u,x:u,y:c}}function Gy(n){var e=ho(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function yC(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Hy(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Oi(n){return Un(n).getComputedStyle(n)}function gB(n){return["table","td","th"].indexOf(ti(n))>=0}function Sa(n){return((rs(n)?n.ownerDocument:n.document)||window.document).documentElement}function Sh(n){return ti(n)==="html"?n:n.assignedSlot||n.parentNode||(Hy(n)?n.host:null)||Sa(n)}function Pw(n){return!ar(n)||Oi(n).position==="fixed"?null:n.offsetParent}function vB(n){var e=/firefox/i.test(Jp()),t=/Trident/i.test(Jp());if(t&&ar(n)){var r=Oi(n);if(r.position==="fixed")return null}var i=Sh(n);for(Hy(i)&&(i=i.host);ar(i)&&["html","body"].indexOf(ti(i))<0;){var a=Oi(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function qu(n){for(var e=Un(n),t=Pw(n);t&&gB(t)&&Oi(t).position==="static";)t=Pw(t);return t&&(ti(t)==="html"||ti(t)==="body"&&Oi(t).position==="static")?e:t||vB(n)||e}function Ky(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Nl(n,e,t){return Va(n,xd(e,t))}function EB(n,e,t){var r=Nl(n,e,t);return r>t?t:r}function gC(){return{top:0,right:0,bottom:0,left:0}}function vC(n){return Object.assign({},gC(),n)}function EC(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var wB=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,vC(typeof e!="number"?e:EC(e,Lu))};function TB(n){var e,t=n.state,r=n.name,i=n.options,a=t.elements.arrow,s=t.modifiersData.popperOffsets,o=Kr(t.placement),l=Ky(o),u=[Rn,mr].indexOf(o)>=0,c=u?"height":"width";if(!(!a||!s)){var d=wB(i.padding,t),h=Gy(a),p=l==="y"?An:Rn,g=l==="y"?pr:mr,E=t.rects.reference[c]+t.rects.reference[l]-s[l]-t.rects.popper[c],A=s[l]-t.rects.reference[l],b=qu(a),T=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,C=E/2-A/2,P=d[p],D=T-h[c]-d[g],F=T/2-h[c]/2+C,Q=Nl(P,F,D),W=l;t.modifiersData[r]=(e={},e[W]=Q,e.centerOffset=Q-F,e)}}function bB(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||yC(e.elements.popper,i)&&(e.elements.arrow=i))}const NB={name:"arrow",enabled:!0,phase:"main",fn:TB,effect:bB,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fo(n){return n.split("-")[1]}var CB={top:"auto",right:"auto",bottom:"auto",left:"auto"};function SB(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:co(t*i)/i||0,y:co(r*i)/i||0}}function Mw(n){var e,t=n.popper,r=n.popperRect,i=n.placement,a=n.variation,s=n.offsets,o=n.position,l=n.gpuAcceleration,u=n.adaptive,c=n.roundOffsets,d=n.isFixed,h=s.x,p=h===void 0?0:h,g=s.y,E=g===void 0?0:g,A=typeof c=="function"?c({x:p,y:E}):{x:p,y:E};p=A.x,E=A.y;var b=s.hasOwnProperty("x"),T=s.hasOwnProperty("y"),C=Rn,P=An,D=window;if(u){var F=qu(t),Q="clientHeight",W="clientWidth";if(F===Un(t)&&(F=Sa(t),Oi(F).position!=="static"&&o==="absolute"&&(Q="scrollHeight",W="scrollWidth")),F=F,i===An||(i===Rn||i===mr)&&a===su){P=pr;var B=d&&F===D&&D.visualViewport?D.visualViewport.height:F[Q];E-=B-r.height,E*=l?1:-1}if(i===Rn||(i===An||i===pr)&&a===su){C=mr;var K=d&&F===D&&D.visualViewport?D.visualViewport.width:F[W];p-=K-r.width,p*=l?1:-1}}var M=Object.assign({position:o},u&&CB),Z=c===!0?SB({x:p,y:E},Un(t)):{x:p,y:E};if(p=Z.x,E=Z.y,l){var q;return Object.assign({},M,(q={},q[P]=T?"0":"",q[C]=b?"0":"",q.transform=(D.devicePixelRatio||1)<=1?"translate("+p+"px, "+E+"px)":"translate3d("+p+"px, "+E+"px, 0)",q))}return Object.assign({},M,(e={},e[P]=T?E+"px":"",e[C]=b?p+"px":"",e.transform="",e))}function AB(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,a=t.adaptive,s=a===void 0?!0:a,o=t.roundOffsets,l=o===void 0?!0:o,u={placement:Kr(e.placement),variation:fo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mw(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mw(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const RB={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:AB,data:{}};var Nc={passive:!0};function xB(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,a=i===void 0?!0:i,s=r.resize,o=s===void 0?!0:s,l=Un(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&u.forEach(function(c){c.addEventListener("scroll",t.update,Nc)}),o&&l.addEventListener("resize",t.update,Nc),function(){a&&u.forEach(function(c){c.removeEventListener("scroll",t.update,Nc)}),o&&l.removeEventListener("resize",t.update,Nc)}}const _B={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xB,data:{}};var PB={left:"right",right:"left",bottom:"top",top:"bottom"};function Qc(n){return n.replace(/left|right|bottom|top/g,function(e){return PB[e]})}var MB={start:"end",end:"start"};function Ow(n){return n.replace(/start|end/g,function(e){return MB[e]})}function Jy(n){var e=Un(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function Yy(n){return ho(Sa(n)).left+Jy(n).scrollLeft}function OB(n,e){var t=Un(n),r=Sa(n),i=t.visualViewport,a=r.clientWidth,s=r.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;var u=mC();(u||!u&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o+Yy(n),y:l}}function IB(n){var e,t=Sa(n),r=Jy(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=Va(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Va(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-r.scrollLeft+Yy(n),l=-r.scrollTop;return Oi(i||t).direction==="rtl"&&(o+=Va(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function Xy(n){var e=Oi(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function wC(n){return["html","body","#document"].indexOf(ti(n))>=0?n.ownerDocument.body:ar(n)&&Xy(n)?n:wC(Sh(n))}function Cl(n,e){var t;e===void 0&&(e=[]);var r=wC(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),a=Un(r),s=i?[a].concat(a.visualViewport||[],Xy(r)?r:[]):r,o=e.concat(s);return i?o:o.concat(Cl(Sh(s)))}function Yp(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function DB(n,e){var t=ho(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Iw(n,e,t){return e===fC?Yp(OB(n,t)):rs(e)?DB(e,t):Yp(IB(Sa(n)))}function $B(n){var e=Cl(Sh(n)),t=["absolute","fixed"].indexOf(Oi(n).position)>=0,r=t&&ar(n)?qu(n):n;return rs(r)?e.filter(function(i){return rs(i)&&yC(i,r)&&ti(i)!=="body"}):[]}function LB(n,e,t,r){var i=e==="clippingParents"?$B(n):[].concat(e),a=[].concat(i,[t]),s=a[0],o=a.reduce(function(l,u){var c=Iw(n,u,r);return l.top=Va(c.top,l.top),l.right=xd(c.right,l.right),l.bottom=xd(c.bottom,l.bottom),l.left=Va(c.left,l.left),l},Iw(n,s,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function TC(n){var e=n.reference,t=n.element,r=n.placement,i=r?Kr(r):null,a=r?fo(r):null,s=e.x+e.width/2-t.width/2,o=e.y+e.height/2-t.height/2,l;switch(i){case An:l={x:s,y:e.y-t.height};break;case pr:l={x:s,y:e.y+e.height};break;case mr:l={x:e.x+e.width,y:o};break;case Rn:l={x:e.x-t.width,y:o};break;default:l={x:e.x,y:e.y}}var u=i?Ky(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(a){case uo:l[u]=l[u]-(e[c]/2-t[c]/2);break;case su:l[u]=l[u]+(e[c]/2-t[c]/2);break}}return l}function ou(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,a=t.strategy,s=a===void 0?n.strategy:a,o=t.boundary,l=o===void 0?nB:o,u=t.rootBoundary,c=u===void 0?fC:u,d=t.elementContext,h=d===void 0?tl:d,p=t.altBoundary,g=p===void 0?!1:p,E=t.padding,A=E===void 0?0:E,b=vC(typeof A!="number"?A:EC(A,Lu)),T=h===tl?rB:tl,C=n.rects.popper,P=n.elements[g?T:h],D=LB(rs(P)?P:P.contextElement||Sa(n.elements.popper),l,c,s),F=ho(n.elements.reference),Q=TC({reference:F,element:C,strategy:"absolute",placement:i}),W=Yp(Object.assign({},C,Q)),B=h===tl?W:F,K={top:D.top-B.top+b.top,bottom:B.bottom-D.bottom+b.bottom,left:D.left-B.left+b.left,right:B.right-D.right+b.right},M=n.modifiersData.offset;if(h===tl&&M){var Z=M[i];Object.keys(K).forEach(function(q){var G=[mr,pr].indexOf(q)>=0?1:-1,oe=[An,pr].indexOf(q)>=0?"y":"x";K[q]+=Z[oe]*G})}return K}function qB(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,a=t.rootBoundary,s=t.padding,o=t.flipVariations,l=t.allowedAutoPlacements,u=l===void 0?pC:l,c=fo(r),d=c?o?_w:_w.filter(function(g){return fo(g)===c}):Lu,h=d.filter(function(g){return u.indexOf(g)>=0});h.length===0&&(h=d);var p=h.reduce(function(g,E){return g[E]=ou(n,{placement:E,boundary:i,rootBoundary:a,padding:s})[Kr(E)],g},{});return Object.keys(p).sort(function(g,E){return p[g]-p[E]})}function BB(n){if(Kr(n)===Wy)return[];var e=Qc(n);return[Ow(n),e,Ow(e)]}function FB(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,s=t.altAxis,o=s===void 0?!0:s,l=t.fallbackPlacements,u=t.padding,c=t.boundary,d=t.rootBoundary,h=t.altBoundary,p=t.flipVariations,g=p===void 0?!0:p,E=t.allowedAutoPlacements,A=e.options.placement,b=Kr(A),T=b===A,C=l||(T||!g?[Qc(A)]:BB(A)),P=[A].concat(C).reduce(function(Pe,Le){return Pe.concat(Kr(Le)===Wy?qB(e,{placement:Le,boundary:c,rootBoundary:d,padding:u,flipVariations:g,allowedAutoPlacements:E}):Le)},[]),D=e.rects.reference,F=e.rects.popper,Q=new Map,W=!0,B=P[0],K=0;K<P.length;K++){var M=P[K],Z=Kr(M),q=fo(M)===uo,G=[An,pr].indexOf(Z)>=0,oe=G?"width":"height",he=ou(e,{placement:M,boundary:c,rootBoundary:d,altBoundary:h,padding:u}),pe=G?q?mr:Rn:q?pr:An;D[oe]>F[oe]&&(pe=Qc(pe));var ee=Qc(pe),de=[];if(a&&de.push(he[Z]<=0),o&&de.push(he[pe]<=0,he[ee]<=0),de.every(function(Pe){return Pe})){B=M,W=!1;break}Q.set(M,de)}if(W)for(var Ee=g?3:1,ye=function(Le){var Ve=P.find(function(et){var ut=Q.get(et);if(ut)return ut.slice(0,Le).every(function(mt){return mt})});if(Ve)return B=Ve,"break"},re=Ee;re>0;re--){var Ze=ye(re);if(Ze==="break")break}e.placement!==B&&(e.modifiersData[r]._skip=!0,e.placement=B,e.reset=!0)}}const kB={name:"flip",enabled:!0,phase:"main",fn:FB,requiresIfExists:["offset"],data:{_skip:!1}};function Dw(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function $w(n){return[An,mr,pr,Rn].some(function(e){return n[e]>=0})}function UB(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=ou(e,{elementContext:"reference"}),o=ou(e,{altBoundary:!0}),l=Dw(s,r),u=Dw(o,i,a),c=$w(l),d=$w(u);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}const jB={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:UB};function QB(n,e,t){var r=Kr(n),i=[Rn,An].indexOf(r)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Rn,mr].indexOf(r)>=0?{x:o,y:s}:{x:s,y:o}}function VB(n){var e=n.state,t=n.options,r=n.name,i=t.offset,a=i===void 0?[0,0]:i,s=pC.reduce(function(c,d){return c[d]=QB(d,e.rects,a),c},{}),o=s[e.placement],l=o.x,u=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=s}const zB={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:VB};function WB(n){var e=n.state,t=n.name;e.modifiersData[t]=TC({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const HB={name:"popperOffsets",enabled:!0,phase:"read",fn:WB,data:{}};function GB(n){return n==="x"?"y":"x"}function KB(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,a=i===void 0?!0:i,s=t.altAxis,o=s===void 0?!1:s,l=t.boundary,u=t.rootBoundary,c=t.altBoundary,d=t.padding,h=t.tether,p=h===void 0?!0:h,g=t.tetherOffset,E=g===void 0?0:g,A=ou(e,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),b=Kr(e.placement),T=fo(e.placement),C=!T,P=Ky(b),D=GB(P),F=e.modifiersData.popperOffsets,Q=e.rects.reference,W=e.rects.popper,B=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,K=typeof B=="number"?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),M=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Z={x:0,y:0};if(F){if(a){var q,G=P==="y"?An:Rn,oe=P==="y"?pr:mr,he=P==="y"?"height":"width",pe=F[P],ee=pe+A[G],de=pe-A[oe],Ee=p?-W[he]/2:0,ye=T===uo?Q[he]:W[he],re=T===uo?-W[he]:-Q[he],Ze=e.elements.arrow,Pe=p&&Ze?Gy(Ze):{width:0,height:0},Le=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:gC(),Ve=Le[G],et=Le[oe],ut=Nl(0,Q[he],Pe[he]),mt=C?Q[he]/2-Ee-ut-Ve-K.mainAxis:ye-ut-Ve-K.mainAxis,Mt=C?-Q[he]/2+Ee+ut+et+K.mainAxis:re+ut+et+K.mainAxis,Ut=e.elements.arrow&&qu(e.elements.arrow),nn=Ut?P==="y"?Ut.clientTop||0:Ut.clientLeft||0:0,Re=(q=M==null?void 0:M[P])!=null?q:0,He=pe+mt-Re-nn,Pn=pe+Mt-Re,Dt=Nl(p?xd(ee,He):ee,pe,p?Va(de,Pn):de);F[P]=Dt,Z[P]=Dt-pe}if(o){var Kt,gr=P==="x"?An:Rn,tt=P==="x"?pr:mr,$t=F[D],jt=D==="y"?"height":"width",it=$t+A[gr],En=$t-A[tt],j=[An,Rn].indexOf(b)!==-1,X=(Kt=M==null?void 0:M[D])!=null?Kt:0,ie=j?it:$t-Q[jt]-W[jt]-X+K.altAxis,N=j?$t+Q[jt]+W[jt]-X-K.altAxis:En,m=p&&j?EB(ie,$t,N):Nl(p?ie:it,$t,p?N:En);F[D]=m,Z[D]=m-$t}e.modifiersData[r]=Z}}const JB={name:"preventOverflow",enabled:!0,phase:"main",fn:KB,requiresIfExists:["offset"]};function YB(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function XB(n){return n===Un(n)||!ar(n)?Jy(n):YB(n)}function ZB(n){var e=n.getBoundingClientRect(),t=co(e.width)/n.offsetWidth||1,r=co(e.height)/n.offsetHeight||1;return t!==1||r!==1}function eF(n,e,t){t===void 0&&(t=!1);var r=ar(e),i=ar(e)&&ZB(e),a=Sa(e),s=ho(n,i,t),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((ti(e)!=="body"||Xy(a))&&(o=XB(e)),ar(e)?(l=ho(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=Yy(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function tF(n){var e=new Map,t=new Set,r=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!t.has(o)){var l=e.get(o);l&&i(l)}}),r.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),r}function nF(n){var e=tF(n);return fB.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function rF(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function iF(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Lw={placement:"bottom",modifiers:[],strategy:"absolute"};function qw(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function aF(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?Lw:i;return function(o,l,u){u===void 0&&(u=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Lw,a),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},d=[],h=!1,p={state:c,setOptions:function(b){var T=typeof b=="function"?b(c.options):b;E(),c.options=Object.assign({},a,c.options,T),c.scrollParents={reference:rs(o)?Cl(o):o.contextElement?Cl(o.contextElement):[],popper:Cl(l)};var C=nF(iF([].concat(r,c.options.modifiers)));return c.orderedModifiers=C.filter(function(P){return P.enabled}),g(),p.update()},forceUpdate:function(){if(!h){var b=c.elements,T=b.reference,C=b.popper;if(qw(T,C)){c.rects={reference:eF(T,qu(C),c.options.strategy==="fixed"),popper:Gy(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(K){return c.modifiersData[K.name]=Object.assign({},K.data)});for(var P=0;P<c.orderedModifiers.length;P++){if(c.reset===!0){c.reset=!1,P=-1;continue}var D=c.orderedModifiers[P],F=D.fn,Q=D.options,W=Q===void 0?{}:Q,B=D.name;typeof F=="function"&&(c=F({state:c,options:W,name:B,instance:p})||c)}}}},update:rF(function(){return new Promise(function(A){p.forceUpdate(),A(c)})}),destroy:function(){E(),h=!0}};if(!qw(o,l))return p;p.setOptions(u).then(function(A){!h&&u.onFirstUpdate&&u.onFirstUpdate(A)});function g(){c.orderedModifiers.forEach(function(A){var b=A.name,T=A.options,C=T===void 0?{}:T,P=A.effect;if(typeof P=="function"){var D=P({state:c,name:b,instance:p,options:C}),F=function(){};d.push(D||F)}})}function E(){d.forEach(function(A){return A()}),d=[]}return p}}var sF=[_B,HB,RB,yB,zB,kB,JB,NB,jB],oF=aF({defaultModifiers:sF}),lF=typeof Element<"u",uF=typeof Map=="function",cF=typeof Set=="function",dF=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Vc(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){if(n.constructor!==e.constructor)return!1;var t,r,i;if(Array.isArray(n)){if(t=n.length,t!=e.length)return!1;for(r=t;r--!==0;)if(!Vc(n[r],e[r]))return!1;return!0}var a;if(uF&&n instanceof Map&&e instanceof Map){if(n.size!==e.size)return!1;for(a=n.entries();!(r=a.next()).done;)if(!e.has(r.value[0]))return!1;for(a=n.entries();!(r=a.next()).done;)if(!Vc(r.value[1],e.get(r.value[0])))return!1;return!0}if(cF&&n instanceof Set&&e instanceof Set){if(n.size!==e.size)return!1;for(a=n.entries();!(r=a.next()).done;)if(!e.has(r.value[0]))return!1;return!0}if(dF&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(e)){if(t=n.length,t!=e.length)return!1;for(r=t;r--!==0;)if(n[r]!==e[r])return!1;return!0}if(n.constructor===RegExp)return n.source===e.source&&n.flags===e.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof e.valueOf=="function")return n.valueOf()===e.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof e.toString=="function")return n.toString()===e.toString();if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,i[r]))return!1;if(lF&&n instanceof Element)return!1;for(r=t;r--!==0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&n.$$typeof)&&!Vc(n[i[r]],e[i[r]]))return!1;return!0}return n!==n&&e!==e}var hF=function(e,t){try{return Vc(e,t)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};const fF=ss(hF);var pF=[],mF=function(e,t,r){r===void 0&&(r={});var i=Te.useRef(null),a={onFirstUpdate:r.onFirstUpdate,placement:r.placement||"bottom",strategy:r.strategy||"absolute",modifiers:r.modifiers||pF},s=Te.useState({styles:{popper:{position:a.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=s[0],l=s[1],u=Te.useMemo(function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(p){var g=p.state,E=Object.keys(g.elements);jl.flushSync(function(){l({styles:Rw(E.map(function(A){return[A,g.styles[A]||{}]})),attributes:Rw(E.map(function(A){return[A,g.attributes[A]]}))})})},requires:["computeStyles"]}},[]),c=Te.useMemo(function(){var h={onFirstUpdate:a.onFirstUpdate,placement:a.placement,strategy:a.strategy,modifiers:[].concat(a.modifiers,[u,{name:"applyStyles",enabled:!1}])};return fF(i.current,h)?i.current||h:(i.current=h,h)},[a.onFirstUpdate,a.placement,a.strategy,a.modifiers,u]),d=Te.useRef();return xw(function(){d.current&&d.current.setOptions(c)},[c]),xw(function(){if(!(e==null||t==null)){var h=r.createPopper||oF,p=h(e,t,c);return d.current=p,function(){p.destroy(),d.current=null}}},[e,t,r.createPopper]),{state:d.current?d.current.state:null,styles:o.styles,attributes:o.attributes,update:d.current?d.current.update:null,forceUpdate:d.current?d.current.forceUpdate:null}},yF=function(){},gF=function(){return Promise.resolve(null)},vF=[];function EF(n){var e=n.placement,t=e===void 0?"bottom":e,r=n.strategy,i=r===void 0?"absolute":r,a=n.modifiers,s=a===void 0?vF:a,o=n.referenceElement,l=n.onFirstUpdate,u=n.innerRef,c=n.children,d=Te.useContext(X2),h=Te.useState(null),p=h[0],g=h[1],E=Te.useState(null),A=E[0],b=E[1];Te.useEffect(function(){tB(u,p)},[u,p]);var T=Te.useMemo(function(){return{placement:t,strategy:i,onFirstUpdate:l,modifiers:[].concat(s,[{name:"arrow",enabled:A!=null,options:{element:A}}])}},[t,i,l,s,A]),C=mF(o||d,p,T),P=C.state,D=C.styles,F=C.forceUpdate,Q=C.update,W=Te.useMemo(function(){return{ref:g,style:D.popper,placement:P?P.placement:t,hasPopperEscaped:P&&P.modifiersData.hide?P.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:P&&P.modifiersData.hide?P.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:D.arrow,ref:b},forceUpdate:F||yF,update:Q||gF}},[g,b,t,P,D,Q,F]);return Z2(c)(W)}function wF(n,e,t,r){return dN(n,function(i,a,s){e(r,t(i),a,s)}),r}function TF(n,e){return function(t,r){return wF(t,n,e(r),{})}}var bF=Object.prototype,NF=bF.toString,CF=TF(function(n,e,t){e!=null&&typeof e.toString!="function"&&(e=NF.call(e)),n[e]=t},nN(Oo)),Zy={"top center":"top","top left":"top-start","top right":"top-end","bottom center":"bottom","bottom left":"bottom-start","bottom right":"bottom-end","right center":"right","left center":"left"};Io(Zy);var SF=CF(Zy),AF=function(){function n(t){this.ref=t}var e=n.prototype;return e.getBoundingClientRect=function(){return ve(this.ref.current,"getBoundingClientRect")||{}},w1(n,[{key:"clientWidth",get:function(){return this.getBoundingClientRect().width}},{key:"clientHeight",get:function(){return this.getBoundingClientRect().height}},{key:"parentNode",get:function(){return this.ref.current?this.ref.current.parentNode:void 0}},{key:"contextElement",get:function(){return this.ref.current}}]),n}(),RF=gh(function(n){return new AF(ZM(n)?n:{current:n})});const xF=RF;function ma(n){var e=n.children,t=n.className,r=n.content,i=xe("content",t),a=De(ma,n),s=Be(ma,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}ma.handledProps=["as","children","className","content"];ma.propTypes={};ma.create=st(ma,function(n){return{children:n}});function ya(n){var e=n.children,t=n.className,r=n.content,i=xe("header",t),a=De(ya,n),s=Be(ya,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}ya.handledProps=["as","children","className","content"];ya.propTypes={};ya.create=st(ya,function(n){return{children:n}});var Aa=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.state={},r.open=!1,r.zIndexWasSynced=!1,r.triggerRef=Y.createRef(),r.elementRef=Y.createRef(),r.getPortalProps=function(){var o={},l=r.props,u=l.on,c=l.hoverable,d=Pt(u)?u:[u];return c&&(o.closeOnPortalMouseLeave=!0,o.mouseLeaveDelay=300),fi(d,"hover")&&(o.openOnTriggerClick=!1,o.closeOnTriggerClick=!1,o.openOnTriggerMouseEnter=!0,o.closeOnTriggerMouseLeave=!0,o.mouseLeaveDelay=70,o.mouseEnterDelay=50),fi(d,"click")&&(o.openOnTriggerClick=!0,o.closeOnTriggerClick=!0,o.closeOnDocumentClick=!0),fi(d,"focus")&&(o.openOnTriggerFocus=!0,o.closeOnTriggerBlur=!0),o},r.hideOnScroll=function(o){Y2(o.target)&&r.elementRef.current.contains(o.target)||(r.setState({closed:!0}),Tr.unsub("scroll",r.hideOnScroll,{target:window}),r.timeoutId=setTimeout(function(){r.setState({closed:!1})},50),r.handleClose(o))},r.handleClose=function(o){ve(r.props,"onClose",o,te({},r.props,{open:!1}))},r.handleOpen=function(o){ve(r.props,"onOpen",o,te({},r.props,{open:!0}))},r.handlePortalMount=function(o){ve(r.props,"onMount",o,r.props)},r.handlePortalUnmount=function(o){r.positionUpdate=null,ve(r.props,"onUnmount",o,r.props)},r.renderContent=function(o){var l=o.placement,u=o.ref,c=o.update,d=o.style,h=r.props,p=h.basic,g=h.children,E=h.className,A=h.content,b=h.hideOnScroll,T=h.flowing,C=h.header,P=h.inverted,D=h.popper,F=h.size,Q=h.style,W=h.wide,B=r.state.contentRestProps;r.positionUpdate=c;var K=xe("ui",SF[l],F,vt(W,"wide"),k(p,"basic"),k(T,"flowing"),k(P,"inverted"),"popup transition visible",E),M=Be(e,r.props),Z=te({left:"auto",right:"auto",position:"initial"},Q),q=Y.createElement(M,te({},B,{className:K,style:Z,ref:r.elementRef}),je(g)?Y.createElement(Y.Fragment,null,ya.create(C,{autoGenerateKey:!1}),ma.create(A,{autoGenerateKey:!1})):g,b&&Y.createElement(ci,{on:r.hideOnScroll,name:"scroll",target:"window"}));return GL(D||{},{overrideProps:{children:q,ref:u,style:te({display:"flex"},d)}})},r}e.getDerivedStateFromProps=function(i,a){if(a.closed||a.disabled)return{};var s=De(e,i),o=zy(s,function(u,c,d){return fi(Ei.handledProps,d)||(u[d]=c),u},{}),l=IN(s,Ei.handledProps);return{contentRestProps:o,portalRestProps:l}};var t=e.prototype;return t.componentDidUpdate=function(i){var a=Qa(this.props.popperDependencies,i.popperDependencies);a||this.handleUpdate()},t.componentWillUnmount=function(){clearTimeout(this.timeoutId)},t.handleUpdate=function(){this.positionUpdate&&this.positionUpdate()},t.render=function(){var i=this,a=this.props,s=a.context,o=a.disabled,l=a.eventsEnabled,u=a.offset,c=a.pinned,d=a.popper,h=a.popperModifiers,p=a.position,g=a.positionFixed,E=a.trigger,A=this.state,b=A.closed,T=A.portalRestProps;if(b||o)return E;var C=[{name:"arrow",enabled:!1},{name:"eventListeners",options:{scroll:!!l,resize:!!l}},{name:"flip",enabled:!c},{name:"preventOverflow",enabled:!!u},{name:"offset",enabled:!!u,options:{offset:u}}].concat(h,[{name:"syncZIndex",enabled:!0,phase:"beforeRead",fn:function(Q){var W,B=Q.state;if(!i.zIndexWasSynced){var K=d==null||(W=d.style)==null?void 0:W.zIndex;Iu(K)&&(B.elements.popper.style.zIndex=window.getComputedStyle(B.elements.popper.firstChild).zIndex),i.zIndexWasSynced=!0}},effect:function(){return function(){i.zIndexWasSynced=!1}}}]),P=xF(Je(s)?this.triggerRef:s),D=te({},this.getPortalProps(),T);return Y.createElement(Ei,te({},D,{onClose:this.handleClose,onMount:this.handlePortalMount,onOpen:this.handleOpen,onUnmount:this.handlePortalUnmount,trigger:E,triggerRef:this.triggerRef}),Y.createElement(EF,{modifiers:C,placement:Zy[p],strategy:g?"fixed":null,referenceElement:P},this.renderContent))},e}(Te.Component);Aa.handledProps=["as","basic","children","className","content","context","disabled","eventsEnabled","flowing","header","hideOnScroll","hoverable","inverted","offset","on","onClose","onMount","onOpen","onUnmount","pinned","popper","popperDependencies","popperModifiers","position","positionFixed","size","style","trigger","wide"];Aa.propTypes={};Aa.defaultProps={disabled:!1,eventsEnabled:!0,on:["click","hover"],pinned:!1,popperModifiers:[],position:"top left"};Aa.Content=ma;Aa.Header=ya;var _d=Gl&&new Gl,bC=_d?function(n,e){return _d.set(n,e),n}:Oo;function lu(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Qy(n.prototype),r=n.apply(t,e);return Zr(r)?r:t}}var _F=1;function PF(n,e,t){var r=e&_F,i=lu(n);function a(){var s=this&&this!==Hn&&this instanceof a?i:n;return s.apply(r?t:this,arguments)}return a}var MF=Math.max;function NC(n,e,t,r){for(var i=-1,a=n.length,s=t.length,o=-1,l=e.length,u=MF(a-s,0),c=Array(l+u),d=!r;++o<l;)c[o]=e[o];for(;++i<s;)(d||i<a)&&(c[t[i]]=n[i]);for(;u--;)c[o++]=n[i++];return c}var OF=Math.max;function CC(n,e,t,r){for(var i=-1,a=n.length,s=-1,o=t.length,l=-1,u=e.length,c=OF(a-o,0),d=Array(c+u),h=!r;++i<c;)d[i]=n[i];for(var p=i;++l<u;)d[p+l]=e[l];for(;++s<o;)(h||i<a)&&(d[p+t[s]]=n[i++]);return d}function IF(n,e){for(var t=n.length,r=0;t--;)n[t]===e&&++r;return r}function eg(){}var DF=4294967295;function po(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=DF,this.__views__=[]}po.prototype=Qy(eg.prototype);po.prototype.constructor=po;var SC=_d?function(n){return _d.get(n)}:ky,Bw={},$F=Object.prototype,LF=$F.hasOwnProperty;function qF(n){for(var e=n.name+"",t=Bw[e],r=LF.call(Bw,e)?t.length:0;r--;){var i=t[r],a=i.func;if(a==null||a==n)return i.name}return e}function mo(n,e){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}mo.prototype=Qy(eg.prototype);mo.prototype.constructor=mo;function AC(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}function BF(n){if(n instanceof po)return n.clone();var e=new mo(n.__wrapped__,n.__chain__);return e.__actions__=AC(n.__actions__),e.__index__=n.__index__,e.__values__=n.__values__,e}var FF=Object.prototype,kF=FF.hasOwnProperty;function Pd(n){if(kn(n)&&!Pt(n)&&!(n instanceof po)){if(n instanceof mo)return n;if(kF.call(n,"__wrapped__"))return BF(n)}return new mo(n)}Pd.prototype=eg.prototype;Pd.prototype.constructor=Pd;function UF(n){var e=qF(n),t=Pd[e];if(typeof t!="function"||!(e in po.prototype))return!1;if(n===t)return!0;var r=SC(t);return!!r&&n===r[0]}var RC=rN(bC),jF=/\{\n\/\* \[wrapped with (.+)\] \*/,QF=/,? & /;function VF(n){var e=n.match(jF);return e?e[1].split(QF):[]}var zF=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function WF(n,e){var t=e.length;if(!t)return n;var r=t-1;return e[r]=(t>1?"& ":"")+e[r],e=e.join(t>2?", ":" "),n.replace(zF,`{
/* [wrapped with `+e+`] */
`)}var HF=1,GF=2,KF=8,JF=16,YF=32,XF=64,ZF=128,ek=256,tk=512,nk=[["ary",ZF],["bind",HF],["bindKey",GF],["curry",KF],["curryRight",JF],["flip",tk],["partial",YF],["partialRight",XF],["rearg",ek]];function rk(n,e){return bN(nk,function(t){var r="_."+t[0];e&t[1]&&!Dy(n,r)&&n.push(r)}),n.sort()}function xC(n,e,t){var r=e+"";return _y(n,WF(r,rk(VF(r),t)))}var ik=1,ak=2,sk=4,ok=8,Fw=32,kw=64;function _C(n,e,t,r,i,a,s,o,l,u){var c=e&ok,d=c?s:void 0,h=c?void 0:s,p=c?a:void 0,g=c?void 0:a;e|=c?Fw:kw,e&=~(c?kw:Fw),e&sk||(e&=~(ik|ak));var E=[n,e,i,p,d,g,h,o,l,u],A=t.apply(void 0,E);return UF(n)&&RC(A,E),A.placeholder=r,xC(A,n,e)}function tg(n){var e=n;return e.placeholder}var lk=Math.min;function uk(n,e){for(var t=n.length,r=lk(e.length,t),i=AC(n);r--;){var a=e[r];n[r]=Mu(a,t)?i[a]:void 0}return n}var Uw="__lodash_placeholder__";function uu(n,e){for(var t=-1,r=n.length,i=0,a=[];++t<r;){var s=n[t];(s===e||s===Uw)&&(n[t]=Uw,a[i++]=t)}return a}var ck=1,dk=2,hk=8,fk=16,pk=128,mk=512;function ng(n,e,t,r,i,a,s,o,l,u){var c=e&pk,d=e&ck,h=e&dk,p=e&(hk|fk),g=e&mk,E=h?void 0:lu(n);function A(){for(var b=arguments.length,T=Array(b),C=b;C--;)T[C]=arguments[C];if(p)var P=tg(A),D=IF(T,P);if(r&&(T=NC(T,r,i,p)),a&&(T=CC(T,a,s,p)),b-=D,p&&b<u){var F=uu(T,P);return _C(n,e,ng,A.placeholder,t,T,F,o,l,u-b)}var Q=d?t:this,W=h?Q[n]:n;return b=T.length,o?T=uk(T,o):g&&b>1&&T.reverse(),c&&l<b&&(T.length=l),this&&this!==Hn&&this instanceof A&&(W=E||lu(W)),W.apply(Q,T)}return A}function yk(n,e,t){var r=lu(n);function i(){for(var a=arguments.length,s=Array(a),o=a,l=tg(i);o--;)s[o]=arguments[o];var u=a<3&&s[0]!==l&&s[a-1]!==l?[]:uu(s,l);if(a-=u.length,a<t)return _C(n,e,ng,i.placeholder,void 0,s,u,void 0,void 0,t-a);var c=this&&this!==Hn&&this instanceof i?r:n;return wh(c,this,s)}return i}var gk=1;function vk(n,e,t,r){var i=e&gk,a=lu(n);function s(){for(var o=-1,l=arguments.length,u=-1,c=r.length,d=Array(c+l),h=this&&this!==Hn&&this instanceof s?a:n;++u<c;)d[u]=r[u];for(;l--;)d[u++]=arguments[++o];return wh(h,i?t:this,d)}return s}var jw="__lodash_placeholder__",_f=1,Ek=2,wk=4,Qw=8,nl=128,Vw=256,Tk=Math.min;function bk(n,e){var t=n[1],r=e[1],i=t|r,a=i<(_f|Ek|nl),s=r==nl&&t==Qw||r==nl&&t==Vw&&n[7].length<=e[8]||r==(nl|Vw)&&e[7].length<=e[8]&&t==Qw;if(!(a||s))return n;r&_f&&(n[2]=e[2],i|=t&_f?0:wk);var o=e[3];if(o){var l=n[3];n[3]=l?NC(l,o,e[4]):o,n[4]=l?uu(n[3],jw):e[4]}return o=e[5],o&&(l=n[5],n[5]=l?CC(l,o,e[6]):o,n[6]=l?uu(n[5],jw):e[6]),o=e[7],o&&(n[7]=o),r&nl&&(n[8]=n[8]==null?e[8]:Tk(n[8],e[8])),n[9]==null&&(n[9]=e[9]),n[0]=e[0],n[1]=i,n}var Nk="Expected a function",zw=1,Ck=2,Pf=8,Mf=16,Of=32,Ww=64,Hw=Math.max;function Sk(n,e,t,r,i,a,s,o){var l=e&Ck;if(!l&&typeof n!="function")throw new TypeError(Nk);var u=r?r.length:0;if(u||(e&=~(Of|Ww),r=i=void 0),s=s===void 0?s:Hw(Hl(s),0),o=o===void 0?o:Hl(o),u-=i?i.length:0,e&Ww){var c=r,d=i;r=i=void 0}var h=l?void 0:SC(n),p=[n,e,t,r,i,c,d,a,s,o];if(h&&bk(p,h),n=p[0],e=p[1],t=p[2],r=p[3],i=p[4],o=p[9]=p[9]===void 0?l?0:n.length:Hw(p[9]-u,0),!o&&e&(Pf|Mf)&&(e&=~(Pf|Mf)),!e||e==zw)var g=PF(n,e,t);else e==Pf||e==Mf?g=yk(n,e,o):(e==Of||e==(zw|Of))&&!i.length?g=vk(n,e,t,r):g=ng.apply(void 0,p);var E=h?bC:RC;return xC(E(g,p),n,e)}var Ak=64,rg=Ou(function(n,e){var t=uu(e,tg(rg));return Sk(n,Ak,void 0,e,t)});rg.placeholder={};const Rk=rg;function ig(n){var e=n.categoryContent,t=n.resultsContent;return Y.createElement(Y.Fragment,null,Y.createElement("div",{className:"name"},e),Y.createElement("div",{className:"results"},t))}ig.handledProps=["categoryContent","resultsContent"];ig.propTypes={};function is(n){var e=n.active,t=n.children,r=n.className,i=n.content,a=n.layoutRenderer,s=n.renderer,o=xe(k(e,"active"),"category",r),l=De(is,n),u=Be(is,n),c=s(n),d=je(t)?i:t;return Y.createElement(u,te({},l,{className:o}),a({categoryContent:c,resultsContent:d}))}is.handledProps=["active","as","children","className","content","layoutRenderer","name","renderer","results"];is.defaultProps={layoutRenderer:ig,renderer:function(e){var t=e.name;return t}};is.propTypes={};var PC=function(e){var t=e.image,r=e.price,i=e.title,a=e.description;return[t&&Y.createElement("div",{key:"image",className:"image"},KL(t,{autoGenerateKey:!1})),Y.createElement("div",{key:"content",className:"content"},r&&Y.createElement("div",{className:"price"},r),i&&Y.createElement("div",{className:"title"},i),a&&Y.createElement("div",{className:"description"},a))]};PC.handledProps=[];var Bu=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleClick=function(o){var l=r.props.onClick;l&&l(o,r.props)},r}var t=e.prototype;return t.render=function(){var i=this.props,a=i.active,s=i.className,o=i.renderer,l=xe(k(a,"active"),"result",s),u=De(e,this.props),c=Be(e,this.props);return Y.createElement(c,te({},u,{className:l,onClick:this.handleClick}),o(this.props))},e}(Te.Component);Bu.handledProps=["active","as","className","content","description","id","image","onClick","price","renderer","title"];Bu.propTypes={};Bu.defaultProps={renderer:PC};function yo(n){var e=n.children,t=n.className,r=n.content,i=xe("results transition",t),a=De(yo,n),s=Be(yo,n);return Y.createElement(s,te({},a,{className:i}),je(e)?r:e)}yo.handledProps=["as","children","className","content"];yo.propTypes={};var xk=function(e){var t=e.input;return Iu(t)?te({},e,{input:{className:"prompt"}}):qy(t)?te({},e,{input:te({},t,{className:xe(t.className,"prompt")})}):e},Ra=function(n){wt(e,n);function e(){for(var r,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r=n.call.apply(n,[this].concat(a))||this,r.handleResultSelect=function(o,l){ve(r.props,"onResultSelect",o,te({},r.props,{result:l}))},r.handleSelectionChange=function(o){var l=r.getSelectedResult();ve(r.props,"onSelectionChange",o,te({},r.props,{result:l}))},r.closeOnEscape=function(o){at.getCode(o)===at.Escape&&(o.preventDefault(),r.close())},r.moveSelectionOnKeyDown=function(o){switch(at.getCode(o)){case at.ArrowDown:o.preventDefault(),r.moveSelectionBy(o,1);break;case at.ArrowUp:o.preventDefault(),r.moveSelectionBy(o,-1);break}},r.selectItemOnEnter=function(o){if(at.getCode(o)===at.Enter){var l=r.getSelectedResult();l&&(o.preventDefault(),r.setValue(l.title),r.handleResultSelect(o,l),r.close())}},r.closeOnDocumentClick=function(o){r.close()},r.handleMouseDown=function(o){r.isMouseDown=!0,ve(r.props,"onMouseDown",o,r.props),Tr.sub("mouseup",r.handleDocumentMouseUp)},r.handleDocumentMouseUp=function(){r.isMouseDown=!1,Tr.unsub("mouseup",r.handleDocumentMouseUp)},r.handleInputClick=function(o){o.nativeEvent.stopImmediatePropagation(),r.tryOpen()},r.handleItemClick=function(o,l){var u=l.id,c=r.getSelectedResult(u);o.nativeEvent.stopImmediatePropagation(),r.setValue(c.title),r.handleResultSelect(o,c),r.close()},r.handleItemMouseDown=function(o){o.preventDefault()},r.handleFocus=function(o){ve(r.props,"onFocus",o,r.props),r.setState({focus:!0})},r.handleBlur=function(o){ve(r.props,"onBlur",o,r.props),r.setState({focus:!1})},r.handleSearchChange=function(o){o.stopPropagation();var l=r.props.minCharacters,u=r.state.open,c=o.target.value;ve(r.props,"onSearchChange",o,te({},r.props,{value:c})),c.length<l?r.close():u||r.tryOpen(c),r.setValue(c)},r.getFlattenedResults=function(){var o=r.props,l=o.category,u=o.results;return l?zy(u,function(c,d){return c.concat(d.results)},[]):u},r.getSelectedResult=function(o){o===void 0&&(o=r.state.selectedIndex);var l=r.getFlattenedResults();return Ki(l,o)},r.setValue=function(o){var l=r.props.selectFirstResult;r.setState({value:o,selectedIndex:l?0:-1})},r.moveSelectionBy=function(o,l){var u=r.state.selectedIndex,c=r.getFlattenedResults(),d=c.length-1,h=u+l;h>d?h=0:h<0&&(h=d),r.setState({selectedIndex:h}),r.scrollSelectedItemIntoView(),r.handleSelectionChange(o)},r.scrollSelectedItemIntoView=function(){if(Ad()){var o=document.querySelector(".ui.search.active.visible .results.visible");if(o){var l=o.querySelector(".result.active");if(l){var u=l.offsetTop<o.scrollTop,c=l.offsetTop+l.clientHeight>o.scrollTop+o.clientHeight;u?o.scrollTop=l.offsetTop:c&&(o.scrollTop=l.offsetTop+l.clientHeight-o.clientHeight)}}}},r.tryOpen=function(o){o===void 0&&(o=r.state.value);var l=r.props.minCharacters;o.length<l||r.open()},r.open=function(){r.setState({open:!0})},r.close=function(){r.setState({open:!1})},r.renderSearchInput=function(o){var l=r.props,u=l.icon,c=l.input,d=l.placeholder,h=r.state.value;return oo.create(c,{autoGenerateKey:!1,defaultProps:te({},o,{autoComplete:"off",icon:u,onChange:r.handleSearchChange,onClick:r.handleInputClick,tabIndex:"0",value:h,placeholder:d}),overrideProps:xk})},r.renderNoResults=function(){var o=r.props,l=o.noResultsDescription,u=o.noResultsMessage;return Y.createElement("div",{className:"message empty"},Y.createElement("div",{className:"header"},u),l&&Y.createElement("div",{className:"description"},l))},r.renderResult=function(o,l,u,c){var d=o.childKey,h=qp(o,["childKey"]);c===void 0&&(c=0);var p=r.props.resultRenderer,g=r.state.selectedIndex,E=l+c;return Y.createElement(Bu,te({key:d??(h.id||h.title),active:g===E,onClick:r.handleItemClick,onMouseDown:r.handleItemMouseDown,renderer:p},h,{id:E}))},r.renderResults=function(){var o=r.props.results;return qn(o,r.renderResult)},r.renderCategories=function(){var o=r.props,l=o.categoryLayoutRenderer,u=o.categoryRenderer,c=o.results,d=r.state.selectedIndex,h=0;return qn(c,function(p){var g=p.childKey,E=qp(p,["childKey"]),A=te({key:g??E.name,active:Wp(d,h,h+E.results.length),layoutRenderer:l,renderer:u},E),b=Rk(r.renderResult,h);return h+=E.results.length,Y.createElement(is,A,E.results.map(b))})},r.renderMenuContent=function(){var o=r.props,l=o.category,u=o.showNoResults,c=o.results;return ul(c)?u?r.renderNoResults():null:l?r.renderCategories():r.renderResults()},r.renderResultsMenu=function(){var o=r.state.open,l=o?"visible":"",u=r.renderMenuContent();if(u)return Y.createElement(yo,{className:l},u)},r}e.getAutoControlledStateFromProps=function(i,a){if(typeof a.prevValue<"u"&&Qa(a.prevValue,a.value))return{prevValue:a.value};var s=i.selectFirstResult?0:-1;return{prevValue:a.value,selectedIndex:s}};var t=e.prototype;return t.shouldComponentUpdate=function(i,a){return!Qa(i,this.props)||!Qa(a,this.state)},t.componentDidUpdate=function(i,a){!a.focus&&this.state.focus?(this.isMouseDown||this.tryOpen(),this.state.open&&Tr.sub("keydown",[this.moveSelectionOnKeyDown,this.selectItemOnEnter])):a.focus&&!this.state.focus&&(this.isMouseDown||this.close(),Tr.unsub("keydown",[this.moveSelectionOnKeyDown,this.selectItemOnEnter])),!a.open&&this.state.open?(this.open(),Tr.sub("click",this.closeOnDocumentClick),Tr.sub("keydown",[this.closeOnEscape,this.moveSelectionOnKeyDown,this.selectItemOnEnter])):a.open&&!this.state.open&&(this.close(),Tr.unsub("click",this.closeOnDocumentClick),Tr.unsub("keydown",[this.closeOnEscape,this.moveSelectionOnKeyDown,this.selectItemOnEnter]))},t.componentWillUnmount=function(){Tr.unsub("click",this.closeOnDocumentClick),Tr.unsub("keydown",[this.closeOnEscape,this.moveSelectionOnKeyDown,this.selectItemOnEnter])},t.render=function(){var i=this.state,a=i.searchClasses,s=i.focus,o=i.open,l=this.props,u=l.aligned,c=l.category,d=l.className,h=l.fluid,p=l.loading,g=l.size,E=xe("ui",o&&"active visible",g,a,k(c,"category"),k(s,"focus"),k(h,"fluid"),k(p,"loading"),cn(u,"aligned"),"search",d),A=De(e,this.props),b=Be(e,this.props),T=Ch(A,{htmlProps:jy}),C=T[0],P=T[1];return Y.createElement(b,te({},P,{className:E,onBlur:this.handleBlur,onFocus:this.handleFocus,onMouseDown:this.handleMouseDown}),this.renderSearchInput(C),this.renderResultsMenu())},e}($o);Ra.handledProps=["aligned","as","category","categoryLayoutRenderer","categoryRenderer","className","defaultOpen","defaultValue","fluid","icon","input","loading","minCharacters","noResultsDescription","noResultsMessage","onBlur","onFocus","onMouseDown","onResultSelect","onSearchChange","onSelectionChange","open","placeholder","resultRenderer","results","selectFirstResult","showNoResults","size","value"];Ra.propTypes={};Ra.defaultProps={icon:"search",input:"text",minCharacters:1,noResultsMessage:"No results found.",showNoResults:!0};Ra.autoControlledProps=["open","value"];Ra.Category=is;Ra.Result=Bu;Ra.Results=yo;function _k(){return V.jsxs(V.Fragment,{children:[V.jsx(Mi,{size:"large",children:"CoolMikeHatsune22 - List of Translations"}),V.jsxs(ns,{children:[V.jsx(da,{href:"https://coolmikehatsune22.wordpress.com/",title:"Back to Wordpress",children:"Home"}),V.jsx(_i,{icon:"right chevron"}),V.jsx(da,{link:!0,active:!0,children:"List of Translations"})]}),V.jsx("hr",{})]})}function Pk({showEnglish:n,dispatchSearchSongs:e,stateFilterOptions:t}){const{songs:r,isLoading:i}=Ss(o=>o.search),[a,s]=t;return Te.useEffect(()=>{r&&r.length===0?s({...a,ids:null,synths:null,producers:null,vocalists:null,circles:null,page:1}):s({...a,ids:r.map(o=>o.id),synths:null,producers:null,vocalists:null,circles:null,page:1})},[r]),V.jsx(Ra,{className:"search-bar",loading:i,fluid:!0,placeholder:"Search...",onSearchChange:(o,l)=>{console.log("Changing search query",l.value),e(l.value)},results:r.slice(0,5).map(o=>{let l,u;return n?(l=o.engTitle||o.orgTitle,u=o.engTitle?`${o.orgTitle}${o.romTitle?` (${o.romTitle})`:""}`:null):(l=o.orgTitle,u=o.engTitle?`${o.engTitle}${o.romTitle?` (${o.romTitle})`:""}`:null),{title:l,description:u}})})}function Cc({value:n,field:e,options:t,placeholder:r,stateFilterOptions:i,showEnglish:a}){const[s,o]=i,l=c=>{var b;let d=a&&c.loclName||c.origName,h=a?c.loclName?c.origName:"":c.loclName||"",p=((b=c==null?void 0:c.aliases)==null?void 0:b.join(", "))||"",g=`${h}${h===""||p===""?"":", "}${p}`,E=V.jsxs("div",{children:[d,V.jsx("br",{}),V.jsxs("span",{children:[c.engine?V.jsx(hr,{size:"mini",color:"green",className:"engine-label",children:c.engine}):null,V.jsx("small",{children:g})]})]}),A=c.numSongs>1?`(${c.numSongs} songs)`:`(${c.numSongs} song)`;return{content:E,text:d,description:A,value:c.id}},u=(c,d)=>{c=c||"",c=c.normalize("NFD").replace(/[\u0300-\u036f]/g,""),d=d.replace(/([\\\.\+\*\?\^\$\(\)\[\]\{\}\|\/])/g,"\\$1");const h=new RegExp("\\b"+d,"i");return c.match(h)!==null};return V.jsx(yr,{placeholder:r,fluid:!0,multiple:!0,selection:!0,options:t.map(l),value:n||[],onChange:(c,d)=>{var p;let h=((p=d.value)==null?void 0:p.slice())||null;h&&h.length===0&&(h=null),console.log(h),o({...s,page:1,[e]:h,ids:null})},search:(c,d)=>{d=d.toLocaleLowerCase();const h=t.filter(p=>u(p.origName,d)||u(p.loclName,d)?!0:p!=null&&p.aliases?p.aliases.some(E=>u(E,d)):!1);return h.length===0?[]:h.map(l)}})}function Mk({synths:n,producers:e,vocalists:t,circles:r,stateFilterOptions:i,stateShowEnglish:a,stateShowSubs:s,dispatchSearchSongs:o}){const[l,u]=i,[c,d]=a,[h,p]=s,g=()=>V.jsxs("div",{className:"filter-submenu",children:[V.jsx("div",{children:V.jsx(yr,{className:"lang-dropdown",placeholder:"Language",selection:!0,button:!0,value:l.lang||0,header:"Filter songs by language",options:[{key:0,text:"Default - All languages",value:0},{key:1,text:"Chinese",value:"CN"},{key:2,text:"Japanese",value:"JP"}],onChange:(E,A)=>{let b=A.value||null;u({...l,lang:b})}})}),V.jsxs("div",{className:"flex-middle",children:[V.jsx(io,{toggle:!0,checked:!c,onChange:(E,A)=>d(!A.checked)}),V.jsx("span",{children:"Show titles in original language"})]}),V.jsxs("div",{className:"flex-middle",children:[V.jsx(io,{toggle:!0,checked:h,onChange:(E,A)=>p(A.checked)}),V.jsx("span",{children:"Show sub links"})]})]});return V.jsxs(ha,{stretched:!0,relaxed:!0,verticalAlign:"middle",children:[V.jsxs(Rr,{children:[V.jsx(Lt,{width:3,children:"Search songs"}),V.jsx(Lt,{width:13,children:V.jsx(Pk,{showEnglish:c,dispatchSearchSongs:o,stateFilterOptions:i})})]}),V.jsxs(Rr,{only:"computer",children:[V.jsx(Lt,{width:12,children:V.jsxs(ha,{children:[V.jsxs(Rr,{children:[V.jsx(Lt,{width:4,children:"Filter by synths:"}),V.jsx(Lt,{width:12,children:V.jsx(Cc,{field:"synths",placeholder:"Hatsune Miku",options:n,value:l.synths,stateFilterOptions:i,showEnglish:c})})]}),V.jsxs(Rr,{children:[V.jsx(Lt,{width:4,children:"Filter by vocalists:"}),V.jsx(Lt,{width:12,children:V.jsx(Cc,{field:"vocalists",placeholder:"...",options:t,value:l.vocalists,stateFilterOptions:i,showEnglish:c})})]}),V.jsxs(Rr,{children:[V.jsx(Lt,{width:4,children:"Filter by producers:"}),V.jsx(Lt,{width:12,children:V.jsx(Cc,{field:"producers",placeholder:"...",options:e,value:l.producers,stateFilterOptions:i,showEnglish:c})})]}),V.jsxs(Rr,{children:[V.jsx(Lt,{width:4,children:"Filter by circles:"}),V.jsx(Lt,{width:12,children:V.jsx(Cc,{field:"circles",placeholder:"...",options:r,value:l.circles,stateFilterOptions:i,showEnglish:c})})]})]})}),V.jsx(Lt,{width:4,children:V.jsx(g,{})})]})]})}function Ok({pageUrl:n,orgTitle:e,romTitle:t,engTitle:r,showEnglish:i}){return i?V.jsxs(V.Fragment,{children:[V.jsx(Mi,{as:"h3",children:V.jsx("a",{href:n||"",target:"_blank",children:r||e})}),r?V.jsx("div",{children:t?V.jsxs(V.Fragment,{children:[e,V.jsx("span",{children:` (${t})`})]}):V.jsx(V.Fragment,{children:e})}):null]}):V.jsxs(V.Fragment,{children:[V.jsx(Mi,{as:"h3",children:V.jsx("a",{href:n||"",target:"_blank",children:e})}),!r&&!t?null:V.jsxs("div",{children:[r," ",t?V.jsx("span",{children:`(${t})`}):null]})]})}function rl({artist:n,showEnglish:e}){const{__synthProps:t,__vocalistProps:r}=n;let i,a,s,o=null;t.id?(i=t.origName,a=t.loclName,s=t.aliases,o=t.engine):(i=r.origName,a=r.loclName,s=r.aliases);let l,u,c,d,h;return e?(l=V.jsx("span",{children:a||i}),u=a?i:""):(l=V.jsx("span",{children:i}),u=a||""),c=s.join(", "),d=`${u}${u===""||c===""?"":", "}${c}`,d===""&&!o?l:(h=d===""?null:V.jsx(V.Fragment,{children:`AKA: ${d}`}),o&&(h=V.jsxs("div",{children:[h?V.jsxs(V.Fragment,{children:[h,V.jsx("hr",{})]}):null,o," synth"]})),V.jsx(Aa,{trigger:l,content:h,position:"bottom left",size:"mini"}))}function il({producer:n,showEnglish:e}){const{role:t,__props:{origName:r,loclName:i,aliases:a=[]}={}}=n;let s,o,l,u;return e?(s=V.jsx("span",{children:i||r}),o=i?r:""):(s=V.jsx("span",{children:r}),o=i||""),l=a.join(", "),u=`${o}${o===""||l===""?"":", "}${l}`,V.jsx(Aa,{trigger:s,content:V.jsxs("div",{children:[u===""?null:V.jsxs(V.Fragment,{children:[`AKA: ${u}`,V.jsx("hr",{})]}),t]}),position:"bottom left",size:"mini"})}function Ik({circle:n,showEnglish:e}){const{origName:t,loclName:r}=n;let i,a;return e?(i=V.jsx("span",{className:"circle-element",children:r||t}),a=r?t:""):(i=V.jsx("span",{className:"circle-element",children:t}),a=r||""),a===""?i:V.jsx(Aa,{trigger:i,content:V.jsx("div",{children:a}),position:"bottom left",size:"mini"})}function Dk({sub:n}){let e=n.description,t=n.subUrl;return e===null&&(t.match(/^https?:\/\/nekocap\.com/)?e="Nekocap":t.match(/^https?:\/\/www\.youtube\.com/)?e="YouTube":e="Sub"),V.jsx("a",{href:t,target:"_blank",children:`[${e}]`})}function If({field:n,filterOptions:e,setFilterOptions:t}){var o,l;const r=((o=e.sort)==null?void 0:o.field)||null,i=((l=e.sort)==null?void 0:l.order)||null;let a="caret down",s=!1;return r===n&&(s=!0,i==="ASC"&&(a="caret up")),V.jsx(kt,{name:a,className:s?"active-filter":"",onClick:()=>{t({...e,page:1,sort:{field:n,order:s&&i==="ASC"?"DESC":"ASC"}})}})}const $k=n=>{const e={};for(let t of n){const r=t.ver;e[r]===void 0&&(e[r]=[]),e[r].push(t)}return Object.values(e)},Lk=(n,e)=>{const t=n.length;return t===1?V.jsx(rl,{artist:n[0],showEnglish:e}):t===2?V.jsxs(V.Fragment,{children:[V.jsx(rl,{artist:n[0],showEnglish:e})," and ",V.jsx(rl,{artist:n[1],showEnglish:e})]}):V.jsxs(V.Fragment,{children:[n.map((r,i)=>i===t-1?null:V.jsxs(V.Fragment,{children:[V.jsx(rl,{artist:r,showEnglish:e}),", "]})),"and ",V.jsx(rl,{artist:n[t-1],showEnglish:e})]})},qk=(n,e)=>{const t=n.length;return t===1?V.jsx(il,{producer:n[0],showEnglish:e}):t===2?V.jsxs(V.Fragment,{children:[V.jsx(il,{producer:n[0],showEnglish:e})," and ",V.jsx(il,{producer:n[1],showEnglish:e})]}):V.jsxs(V.Fragment,{children:[n.map((r,i)=>i===t-1?null:V.jsxs(V.Fragment,{children:[V.jsx(il,{producer:r,showEnglish:e}),", "]})),"and ",V.jsx(il,{producer:n[t-1],showEnglish:e})]})};function Bk({songs:n=[],totalCount:e=1,stateFilterOptions:t,showEnglish:r,showSubs:i}){const a=Te.useRef(null),[s,o]=t;return V.jsxs(V.Fragment,{children:[V.jsx("span",{ref:a}),V.jsxs(fr,{celled:!0,striped:!0,color:"teal",compact:!0,children:[V.jsx(Pi,{children:V.jsxs(pn,{children:[V.jsxs(In,{collapsing:!0,width:1,children:["No",V.jsx(If,{field:"song_translated_date",filterOptions:s,setFilterOptions:o})]}),V.jsxs(In,{width:i?5:7,children:["Title",V.jsx(If,{field:r?"song_english_title":"song_romanized_title",filterOptions:s,setFilterOptions:o})]}),V.jsx(In,{width:3,children:"Vocals"}),V.jsx(In,{width:3,children:"Producers"}),V.jsx(In,{width:1,children:"Tags"}),V.jsxs(In,{width:1,children:["Song Release Year",V.jsx(If,{field:"song_released_date",filterOptions:s,setFilterOptions:o})]}),i&&V.jsx(In,{width:2,children:"Available Subs"})]})}),V.jsx(fa,{children:n.map((l,u)=>V.jsxs(pn,{children:[V.jsx(Zt,{textAlign:"center",children:((s.page||1)-1)*Ed+u+1}),V.jsx(Zt,{children:V.jsx(Ok,{pageUrl:l.pageUrl,orgTitle:l.orgTitle,romTitle:l.romTitle,engTitle:l.engTitle,showEnglish:r})}),V.jsx(Zt,{children:$k(l.singers).map(c=>V.jsxs(V.Fragment,{children:[Lk(c,r),V.jsx("br",{})]}))}),V.jsxs(Zt,{children:[l.circles.length===0?null:V.jsxs("div",{children:[l.circles.map(c=>V.jsx(Ik,{circle:c,showEnglish:r})),":"]}),qk(l.producers,r)]}),V.jsx(Zt,{textAlign:"center",children:V.jsx("div",{className:"lang-tag",children:l.lang})}),V.jsx(Zt,{textAlign:"center",children:new Date(l.releasedDate).getFullYear()}),i&&V.jsx(Zt,{children:l.subs.map(c=>V.jsx(Dk,{sub:c}))})]},l.id))}),V.jsx(gs,{children:V.jsx(pn,{children:V.jsx(In,{colSpan:i?7:6,children:V.jsxs("div",{className:"table-footer",children:[V.jsx("div",{className:"table-footer-info-songs",children:V.jsxs("div",{children:["Showing ",n.length," entries out of ",e]})}),V.jsx(Lo,{totalPages:Math.ceil(e/Ed),activePage:s.page||1,boundaryRange:0,siblingRange:1,ellipsisItem:null,onPageChange:(l,u)=>{var c;o({...s,page:u.activePage}),(c=a==null?void 0:a.current)==null||c.scrollIntoView({behavior:"smooth",block:"start"})}})]})})})})]})]})}function Fk(){const n=bx(),{dataSource:e}=EM(),[t,r]=Te.useState({lang:null,ids:null,synths:null,producers:null,vocalists:null,circles:null,page:1,sort:{field:"song_translated_date",order:"DESC"}}),[i,a]=Te.useState(!0),[s,o]=Te.useState(!1);Te.useEffect(()=>{e!==null&&(n(MM(e,t)),n(DM(e,t)),n(qM(e,t)),n(kM(e,t)),n(QM(e,t)))},[e,t]);const{synths:l}=Ss(E=>E.synths),{vocalists:u}=Ss(E=>E.vocalists),{producers:c}=Ss(E=>E.producers),{circles:d}=Ss(E=>E.circles),{songs:h,count:p}=Ss(E=>E.songs),g=E=>n(WM(e,E));return V.jsxs(V.Fragment,{children:[V.jsx("header",{children:V.jsx(_k,{})}),V.jsxs("main",{children:[V.jsx("article",{id:"filter-article",children:V.jsx(Mk,{synths:l,vocalists:u,producers:c,circles:d,stateFilterOptions:[t,r],stateShowEnglish:[i,a],stateShowSubs:[s,o],dispatchSearchSongs:g})}),V.jsx("article",{id:"main-article",children:V.jsx(Bk,{songs:h,totalCount:p,stateFilterOptions:[t,r],showEnglish:i,showSubs:s})})]}),V.jsx("footer",{children:"This is a footer."})]})}function Yt(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var kk=typeof Symbol=="function"&&Symbol.observable||"@@observable",Gw=kk,Df=()=>Math.random().toString(36).substring(7).split("").join("."),Uk={INIT:`@@redux/INIT${Df()}`,REPLACE:`@@redux/REPLACE${Df()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Df()}`},Md=Uk;function ag(n){if(typeof n!="object"||n===null)return!1;let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e||Object.getPrototypeOf(n)===null}function MC(n,e,t){if(typeof n!="function")throw new Error(Yt(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(Yt(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(Yt(1));return t(MC)(n,e)}let r=n,i=e,a=new Map,s=a,o=0,l=!1;function u(){s===a&&(s=new Map,a.forEach((A,b)=>{s.set(b,A)}))}function c(){if(l)throw new Error(Yt(3));return i}function d(A){if(typeof A!="function")throw new Error(Yt(4));if(l)throw new Error(Yt(5));let b=!0;u();const T=o++;return s.set(T,A),function(){if(b){if(l)throw new Error(Yt(6));b=!1,u(),s.delete(T),a=null}}}function h(A){if(!ag(A))throw new Error(Yt(7));if(typeof A.type>"u")throw new Error(Yt(8));if(typeof A.type!="string")throw new Error(Yt(17));if(l)throw new Error(Yt(9));try{l=!0,i=r(i,A)}finally{l=!1}return(a=s).forEach(T=>{T()}),A}function p(A){if(typeof A!="function")throw new Error(Yt(10));r=A,h({type:Md.REPLACE})}function g(){const A=d;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Yt(11));function T(){const P=b;P.next&&P.next(c())}return T(),{unsubscribe:A(T)}},[Gw](){return this}}}return h({type:Md.INIT}),{dispatch:h,subscribe:d,getState:c,replaceReducer:p,[Gw]:g}}function jk(n){Object.keys(n).forEach(e=>{const t=n[e];if(typeof t(void 0,{type:Md.INIT})>"u")throw new Error(Yt(12));if(typeof t(void 0,{type:Md.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Yt(13))})}function Qk(n){const e=Object.keys(n),t={};for(let a=0;a<e.length;a++){const s=e[a];typeof n[s]=="function"&&(t[s]=n[s])}const r=Object.keys(t);let i;try{jk(t)}catch(a){i=a}return function(s={},o){if(i)throw i;let l=!1;const u={};for(let c=0;c<r.length;c++){const d=r[c],h=t[d],p=s[d],g=h(p,o);if(typeof g>"u")throw o&&o.type,new Error(Yt(14));u[d]=g,l=l||g!==p}return l=l||r.length!==Object.keys(s).length,l?u:s}}function Od(...n){return n.length===0?e=>e:n.length===1?n[0]:n.reduce((e,t)=>(...r)=>e(t(...r)))}function Vk(...n){return e=>(t,r)=>{const i=e(t,r);let a=()=>{throw new Error(Yt(15))};const s={getState:i.getState,dispatch:(l,...u)=>a(l,...u)},o=n.map(l=>l(s));return a=Od(...o)(i.dispatch),{...i,dispatch:a}}}function zk(n){return ag(n)&&"type"in n&&typeof n.type=="string"}var OC=Symbol.for("immer-nothing"),Kw=Symbol.for("immer-draftable"),jn=Symbol.for("immer-state");function xr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var go=Object.getPrototypeOf;function ga(n){return!!n&&!!n[jn]}function Ii(n){var e;return n?IC(n)||Array.isArray(n)||!!n[Kw]||!!((e=n.constructor)!=null&&e[Kw])||Rh(n)||xh(n):!1}var Wk=Object.prototype.constructor.toString();function IC(n){if(!n||typeof n!="object")return!1;const e=go(n);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Wk}function cu(n,e){Ah(n)===0?Object.entries(n).forEach(([t,r])=>{e(t,r,n)}):n.forEach((t,r)=>e(r,t,n))}function Ah(n){const e=n[jn];return e?e.type_:Array.isArray(n)?1:Rh(n)?2:xh(n)?3:0}function Xp(n,e){return Ah(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function DC(n,e,t){const r=Ah(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Hk(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Rh(n){return n instanceof Map}function xh(n){return n instanceof Set}function La(n){return n.copy_||n.base_}function Zp(n,e){if(Rh(n))return new Map(n);if(xh(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);if(!e&&IC(n))return go(n)?{...n}:Object.assign(Object.create(null),n);const t=Object.getOwnPropertyDescriptors(n);delete t[jn];let r=Reflect.ownKeys(t);for(let i=0;i<r.length;i++){const a=r[i],s=t[a];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[a]={configurable:!0,writable:!0,enumerable:s.enumerable,value:n[a]})}return Object.create(go(n),t)}function sg(n,e=!1){return _h(n)||ga(n)||!Ii(n)||(Ah(n)>1&&(n.set=n.add=n.clear=n.delete=Gk),Object.freeze(n),e&&cu(n,(t,r)=>sg(r,!0))),n}function Gk(){xr(2)}function _h(n){return Object.isFrozen(n)}var Kk={};function as(n){const e=Kk[n];return e||xr(0,n),e}var du;function $C(){return du}function Jk(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Jw(n,e){e&&(as("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function em(n){tm(n),n.drafts_.forEach(Yk),n.drafts_=null}function tm(n){n===du&&(du=n.parent_)}function Yw(n){return du=Jk(du,n)}function Yk(n){const e=n[jn];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Xw(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[jn].modified_&&(em(e),xr(4)),Ii(n)&&(n=Id(e,n),e.parent_||Dd(e,n)),e.patches_&&as("Patches").generateReplacementPatches_(t[jn].base_,n,e.patches_,e.inversePatches_)):n=Id(e,t,[]),em(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==OC?n:void 0}function Id(n,e,t){if(_h(e))return e;const r=e[jn];if(!r)return cu(e,(i,a)=>Zw(n,r,e,i,a,t)),e;if(r.scope_!==n)return e;if(!r.modified_)return Dd(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const i=r.copy_;let a=i,s=!1;r.type_===3&&(a=new Set(i),i.clear(),s=!0),cu(a,(o,l)=>Zw(n,r,i,o,l,t,s)),Dd(n,i,!1),t&&n.patches_&&as("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function Zw(n,e,t,r,i,a,s){if(ga(i)){const o=a&&e&&e.type_!==3&&!Xp(e.assigned_,r)?a.concat(r):void 0,l=Id(n,i,o);if(DC(t,r,l),ga(l))n.canAutoFreeze_=!1;else return}else s&&t.add(i);if(Ii(i)&&!_h(i)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;Id(n,i),(!e||!e.scope_.parent_)&&Dd(n,i)}}function Dd(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&sg(e,t)}function Xk(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:$C(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,a=og;t&&(i=[r],a=hu);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return r.draft_=o,r.revoke_=s,o}var og={get(n,e){if(e===jn)return n;const t=La(n);if(!Xp(t,e))return Zk(n,t,e);const r=t[e];return n.finalized_||!Ii(r)?r:r===$f(n.base_,e)?(Lf(n),n.copy_[e]=rm(r,n)):r},has(n,e){return e in La(n)},ownKeys(n){return Reflect.ownKeys(La(n))},set(n,e,t){const r=LC(La(n),e);if(r!=null&&r.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=$f(La(n),e),a=i==null?void 0:i[jn];if(a&&a.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Hk(t,i)&&(t!==void 0||Xp(n.base_,e)))return!0;Lf(n),nm(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return $f(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,Lf(n),nm(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=La(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){xr(11)},getPrototypeOf(n){return go(n.base_)},setPrototypeOf(){xr(12)}},hu={};cu(og,(n,e)=>{hu[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});hu.deleteProperty=function(n,e){return hu.set.call(this,n,e,void 0)};hu.set=function(n,e,t){return og.set.call(this,n[0],e,t,n[0])};function $f(n,e){const t=n[jn];return(t?La(t):n)[e]}function Zk(n,e,t){var i;const r=LC(e,t);return r?"value"in r?r.value:(i=r.get)==null?void 0:i.call(n.draft_):void 0}function LC(n,e){if(!(e in n))return;let t=go(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=go(t)}}function nm(n){n.modified_||(n.modified_=!0,n.parent_&&nm(n.parent_))}function Lf(n){n.copy_||(n.copy_=Zp(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var eU=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const a=t;t=e;const s=this;return function(l=a,...u){return s.produce(l,c=>t.call(this,c,...u))}}typeof t!="function"&&xr(6),r!==void 0&&typeof r!="function"&&xr(7);let i;if(Ii(e)){const a=Yw(this),s=rm(e,void 0);let o=!0;try{i=t(s),o=!1}finally{o?em(a):tm(a)}return Jw(a,r),Xw(i,a)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===OC&&(i=void 0),this.autoFreeze_&&sg(i,!0),r){const a=[],s=[];as("Patches").generateReplacementPatches_(e,i,a,s),r(a,s)}return i}else xr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,l=>e(l,...o));let r,i;return[this.produce(e,t,(s,o)=>{r=s,i=o}),r,i]},typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof(n==null?void 0:n.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){Ii(n)||xr(8),ga(n)&&(n=qC(n));const e=Yw(this),t=rm(n,void 0);return t[jn].isManual_=!0,tm(e),t}finishDraft(n,e){const t=n&&n[jn];(!t||!t.isManual_)&&xr(9);const{scope_:r}=t;return Jw(r,e),Xw(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=as("Patches").applyPatches_;return ga(n)?r(n,e):this.produce(n,i=>r(i,e))}};function rm(n,e){const t=Rh(n)?as("MapSet").proxyMap_(n,e):xh(n)?as("MapSet").proxySet_(n,e):Xk(n,e);return(e?e.scope_:$C()).drafts_.push(t),t}function qC(n){return ga(n)||xr(10,n),BC(n)}function BC(n){if(!Ii(n)||_h(n))return n;const e=n[jn];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Zp(n,e.scope_.immer_.useStrictShallowCopy_)}else t=Zp(n,!0);return cu(t,(r,i)=>{DC(t,r,BC(i))}),e&&(e.finalized_=!1),t}var Qn=new eU,FC=Qn.produce;Qn.produceWithPatches.bind(Qn);Qn.setAutoFreeze.bind(Qn);Qn.setUseStrictShallowCopy.bind(Qn);Qn.applyPatches.bind(Qn);Qn.createDraft.bind(Qn);Qn.finishDraft.bind(Qn);function tU(n,e=`expected a function, instead received ${typeof n}`){if(typeof n!="function")throw new TypeError(e)}function nU(n,e=`expected an object, instead received ${typeof n}`){if(typeof n!="object")throw new TypeError(e)}function rU(n,e="expected all items to be functions, instead received the following types: "){if(!n.every(t=>typeof t=="function")){const t=n.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${e}[${t}]`)}}var eT=n=>Array.isArray(n)?n:[n];function iU(n){const e=Array.isArray(n[0])?n[0]:n;return rU(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function aU(n,e){const t=[],{length:r}=n;for(let i=0;i<r;i++)t.push(n[i].apply(null,e));return t}var sU=class{constructor(n){this.value=n}deref(){return this.value}},oU=typeof WeakRef<"u"?WeakRef:sU,lU=0,tT=1;function Sc(){return{s:lU,v:void 0,o:null,p:null}}function lg(n,e={}){let t=Sc();const{resultEqualityCheck:r}=e;let i,a=0;function s(){var d;let o=t;const{length:l}=arguments;for(let h=0,p=l;h<p;h++){const g=arguments[h];if(typeof g=="function"||typeof g=="object"&&g!==null){let E=o.o;E===null&&(o.o=E=new WeakMap);const A=E.get(g);A===void 0?(o=Sc(),E.set(g,o)):o=A}else{let E=o.p;E===null&&(o.p=E=new Map);const A=E.get(g);A===void 0?(o=Sc(),E.set(g,o)):o=A}}const u=o;let c;if(o.s===tT?c=o.v:(c=n.apply(null,arguments),a++),u.s=tT,r){const h=((d=i==null?void 0:i.deref)==null?void 0:d.call(i))??i;h!=null&&r(h,c)&&(c=h,a!==0&&a--),i=typeof c=="object"&&c!==null||typeof c=="function"?new oU(c):c}return u.v=c,c}return s.clearCache=()=>{t=Sc(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function kC(n,...e){const t=typeof n=="function"?{memoize:n,memoizeOptions:e}:n,r=(...i)=>{let a=0,s=0,o,l={},u=i.pop();typeof u=="object"&&(l=u,u=i.pop()),tU(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const c={...t,...l},{memoize:d,memoizeOptions:h=[],argsMemoize:p=lg,argsMemoizeOptions:g=[],devModeChecks:E={}}=c,A=eT(h),b=eT(g),T=iU(i),C=d(function(){return a++,u.apply(null,arguments)},...A),P=p(function(){s++;const F=aU(T,arguments);return o=C.apply(null,F),o},...b);return Object.assign(P,{resultFunc:u,memoizedResultFunc:C,dependencies:T,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:d,argsMemoize:p})};return Object.assign(r,{withTypes:()=>r}),r}var uU=kC(lg),cU=Object.assign((n,e=uU)=>{nU(n,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof n}`);const t=Object.keys(n),r=t.map(a=>n[a]);return e(r,(...a)=>a.reduce((s,o,l)=>(s[t[l]]=o,s),{}))},{withTypes:()=>cU});function UC(n){return({dispatch:t,getState:r})=>i=>a=>typeof a=="function"?a(t,r,n):i(a)}var dU=UC(),hU=UC,fU=(...n)=>{const e=kC(...n);return(...t)=>{const r=e(...t),i=(a,...s)=>r(ga(a)?qC(a):a,...s);return Object.assign(i,r),i}};fU(lg);var pU=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Od:Od.apply(null,arguments)};function fu(n,e){function t(...r){if(e){let i=e(...r);if(!i)throw new Error(Ir(0));return{type:n,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:n,payload:r[0]}}return t.toString=()=>`${n}`,t.type=n,t.match=r=>zk(r)&&r.type===n,t}var jC=class cl extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,cl.prototype)}static get[Symbol.species](){return cl}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new cl(...e[0].concat(this)):new cl(...e.concat(this))}};function nT(n){return Ii(n)?FC(n,()=>{}):n}function rT(n,e,t){if(n.has(e)){let i=n.get(e);return t.update&&(i=t.update(i,e,n),n.set(e,i)),i}if(!t.insert)throw new Error(Ir(10));const r=t.insert(e,n);return n.set(e,r),r}function mU(n){return typeof n=="boolean"}var yU=()=>function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new jC;return t&&(mU(t)?s.push(dU):s.push(hU(t.extraArgument))),s},gU="RTK_autoBatch",QC=n=>e=>{setTimeout(e,n)},vU=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:QC(10),EU=(n={type:"raf"})=>e=>(...t)=>{const r=e(...t);let i=!0,a=!1,s=!1;const o=new Set,l=n.type==="tick"?queueMicrotask:n.type==="raf"?vU:n.type==="callback"?n.queueNotification:QC(n.timeout),u=()=>{s=!1,a&&(a=!1,o.forEach(c=>c()))};return Object.assign({},r,{subscribe(c){const d=()=>i&&c(),h=r.subscribe(d);return o.add(c),()=>{h(),o.delete(c)}},dispatch(c){var d;try{return i=!((d=c==null?void 0:c.meta)!=null&&d[gU]),a=!i,a&&(s||(s=!0,l(u))),r.dispatch(c)}finally{i=!0}}})},wU=n=>function(t){const{autoBatch:r=!0}=t??{};let i=new jC(n);return r&&i.push(EU(typeof r=="object"?r:void 0)),i},TU=!0;function bU(n){const e=yU(),{reducer:t=void 0,middleware:r,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=n||{};let o;if(typeof t=="function")o=t;else if(ag(t))o=Qk(t);else throw new Error(Ir(1));let l;typeof r=="function"?l=r(e):l=e();let u=Od;i&&(u=pU({trace:!TU,...typeof i=="object"&&i}));const c=Vk(...l),d=wU(c);let h=typeof s=="function"?s(d):d();const p=u(...h);return MC(o,a,p)}function VC(n){const e={},t=[];let r;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Ir(28));if(o in e)throw new Error(Ir(29));return e[o]=s,i},addMatcher(a,s){return t.push({matcher:a,reducer:s}),i},addDefaultCase(a){return r=a,i}};return n(i),[e,t,r]}function NU(n){return typeof n=="function"}function CU(n,e){let[t,r,i]=VC(e),a;if(NU(n))a=()=>nT(n());else{const o=nT(n);a=()=>o}function s(o=a(),l){let u=[t[l.type],...r.filter(({matcher:c})=>c(l)).map(({reducer:c})=>c)];return u.filter(c=>!!c).length===0&&(u=[i]),u.reduce((c,d)=>{if(d)if(ga(c)){const p=d(c,l);return p===void 0?c:p}else{if(Ii(c))return FC(c,h=>d(h,l));{const h=d(c,l);if(h===void 0){if(c===null)return c;throw new Error(Ir(9))}return h}}return c},o)}return s.getInitialState=a,s}var SU=Symbol.for("rtk-slice-createasyncthunk");function AU(n,e){return`${n}/${e}`}function RU({creators:n}={}){var t;const e=(t=n==null?void 0:n.asyncThunk)==null?void 0:t[SU];return function(i){const{name:a,reducerPath:s=a}=i;if(!a)throw new Error(Ir(11));typeof process<"u";const o=(typeof i.reducers=="function"?i.reducers(_U()):i.reducers)||{},l=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(A,b){const T=typeof A=="string"?A:A.type;if(!T)throw new Error(Ir(12));if(T in u.sliceCaseReducersByType)throw new Error(Ir(13));return u.sliceCaseReducersByType[T]=b,c},addMatcher(A,b){return u.sliceMatchers.push({matcher:A,reducer:b}),c},exposeAction(A,b){return u.actionCreators[A]=b,c},exposeCaseReducer(A,b){return u.sliceCaseReducersByName[A]=b,c}};l.forEach(A=>{const b=o[A],T={reducerName:A,type:AU(a,A),createNotation:typeof i.reducers=="function"};MU(b)?IU(T,b,c,e):PU(T,b,c)});function d(){const[A={},b=[],T=void 0]=typeof i.extraReducers=="function"?VC(i.extraReducers):[i.extraReducers],C={...A,...u.sliceCaseReducersByType};return CU(i.initialState,P=>{for(let D in C)P.addCase(D,C[D]);for(let D of u.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of b)P.addMatcher(D.matcher,D.reducer);T&&P.addDefaultCase(T)})}const h=A=>A,p=new WeakMap;let g;const E={name:a,reducerPath:s,reducer(A,b){return g||(g=d()),g(A,b)},actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState(){return g||(g=d()),g.getInitialState()},getSelectors(A=h){const b=rT(p,this,{insert:()=>new WeakMap});return rT(b,A,{insert:()=>{const T={};for(const[C,P]of Object.entries(i.selectors??{}))T[C]=xU(this,P,A,this!==E);return T}})},selectSlice(A){let b=A[this.reducerPath];return typeof b>"u"&&this!==E&&(b=this.getInitialState()),b},get selectors(){return this.getSelectors(this.selectSlice)},injectInto(A,{reducerPath:b,...T}={}){const C=b??this.reducerPath;return A.inject({reducerPath:C,reducer:this.reducer},T),{...this,reducerPath:C}}};return E}}function xU(n,e,t,r){function i(a,...s){let o=t.call(n,a);return typeof o>"u"&&r&&(o=n.getInitialState()),e(o,...s)}return i.unwrapped=e,i}RU();function _U(){function n(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return n.withTypes=()=>n,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:n}}function PU({type:n,reducerName:e,createNotation:t},r,i){let a,s;if("reducer"in r){if(t&&!OU(r))throw new Error(Ir(17));a=r.reducer,s=r.prepare}else a=r;i.addCase(n,a).exposeCaseReducer(e,a).exposeAction(e,s?fu(n,s):fu(n))}function MU(n){return n._reducerDefinitionType==="asyncThunk"}function OU(n){return n._reducerDefinitionType==="reducerWithPrepare"}function IU({type:n,reducerName:e},t,r,i){if(!i)throw new Error(Ir(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:l,settled:u,options:c}=t,d=i(n,a,c);r.exposeAction(e,d),s&&r.addCase(d.fulfilled,s),o&&r.addCase(d.pending,o),l&&r.addCase(d.rejected,l),u&&r.addMatcher(d.settled,u),r.exposeCaseReducer(e,{fulfilled:s||Ac,pending:o||Ac,rejected:l||Ac,settled:u||Ac})}function Ac(){}var ug="listenerMiddleware";fu(`${ug}/add`);fu(`${ug}/removeAll`);fu(`${ug}/remove`);function Ir(n){return`Minified Redux Toolkit error #${n}; visit https://redux-toolkit.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}const DU={datasource:null,isLoading:!1};function $U(n=DU,e){switch(e.type){case wM:return{...n,datasource:e.payload};case TM:return{...n,datasource:null};case bM:return{...n,isLoading:e.payload}}return n}const LU={synths:[],isLoading:!1};function qU(n=LU,e){switch(e.type){case ay:return{...n,synths:e.payload};case sy:return{...n,synths:[]};case oy:return{...n,isLoading:e.payload}}return n}const BU={vocalists:[],isLoading:!1};function FU(n=BU,e){switch(e.type){case dy:return{...n,vocalists:e.payload};case hy:return{...n,vocalists:[]};case fy:return{...n,isLoading:e.payload}}return n}const kU={producers:[],isLoading:!1};function UU(n=kU,e){switch(e.type){case ly:return{...n,producers:e.payload};case uy:return{...n,producers:[]};case cy:return{...n,isLoading:e.payload}}return n}const jU={circles:[],isLoading:!1};function QU(n=jU,e){switch(e.type){case py:return{...n,circles:e.payload};case my:return{...n,circles:[]};case yy:return{...n,isLoading:e.payload}}return n}const VU={songs:[],count:0,isLoading:!1};function zU(n=VU,e){switch(e.type){case gy:return{...n,songs:e.payload.songs,count:e.payload.count};case vy:return{...n,songs:[]};case Ey:return{...n,isLoading:e.payload}}return n}const WU={songs:[],isLoading:!1};function HU(n=WU,e){switch(e.type){case wy:return{...n,songs:e.payload};case Ty:return{...n,songs:[]};case by:return{...n,isLoading:e.payload}}return n}const GU=bU({reducer:{datasource:$U,synths:qU,vocalists:FU,producers:UU,circles:QU,songs:zU,search:HU},middleware:n=>n({serializableCheck:{ignoredActions:[ay,sy,oy,ly,uy,cy,dy,hy,fy,py,my,yy,gy,vy,Ey,wy,Ty,by],ignoredPaths:["synths.synths","vocalists.vocalists","producers.producers","circles.circles","songs.songs","search.songs"]}})});qf.createRoot(document.getElementById("root")).render(V.jsx(Ex,{store:GU,children:V.jsx(Fk,{})}))});export default KU();
