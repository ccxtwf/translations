var GB=Object.defineProperty;var YB=(rn,Mt,Ri)=>Mt in rn?GB(rn,Mt,{enumerable:!0,configurable:!0,writable:!0,value:Ri}):rn[Mt]=Ri;var ve=(rn,Mt,Ri)=>(YB(rn,typeof Mt!="symbol"?Mt+"":Mt,Ri),Ri);var JB=(rn,Mt)=>()=>(Mt||rn((Mt={exports:{}}).exports,Mt),Mt.exports),XB=JB((rn,Mt)=>{function Ri(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in n)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(n,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();var Uc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mi(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function QC(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),t}var fg={exports:{}},Fc={},yg={exports:{}},Qe={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var ko=Symbol.for("react.element"),GC=Symbol.for("react.portal"),YC=Symbol.for("react.fragment"),JC=Symbol.for("react.strict_mode"),XC=Symbol.for("react.profiler"),ZC=Symbol.for("react.provider"),e1=Symbol.for("react.context"),t1=Symbol.for("react.forward_ref"),n1=Symbol.for("react.suspense"),r1=Symbol.for("react.memo"),a1=Symbol.for("react.lazy"),gg=Symbol.iterator;function i1(n){return n===null||typeof n!="object"?null:(n=gg&&n[gg]||n["@@iterator"],typeof n=="function"?n:null)}var bg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vg=Object.assign,Eg={};function bs(n,e,t){this.props=n,this.context=e,this.refs=Eg,this.updater=t||bg}bs.prototype.isReactComponent={},bs.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")},bs.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function wg(){}wg.prototype=bs.prototype;function Ld(n,e,t){this.props=n,this.context=e,this.refs=Eg,this.updater=t||bg}var qd=Ld.prototype=new wg;qd.constructor=Ld,vg(qd,bs.prototype),qd.isPureReactComponent=!0;var Tg=Array.isArray,Ng=Object.prototype.hasOwnProperty,$d={current:null},Cg={key:!0,ref:!0,__self:!0,__source:!0};function Ag(n,e,t){var r,a={},i=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(i=""+e.key),e)Ng.call(e,r)&&!Cg.hasOwnProperty(r)&&(a[r]=e[r]);var o=arguments.length-2;if(o===1)a.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:ko,type:n,key:i,ref:s,props:a,_owner:$d.current}}function s1(n,e){return{$$typeof:ko,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function kd(n){return typeof n=="object"&&n!==null&&n.$$typeof===ko}function o1(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Sg=/\/+/g;function jd(n,e){return typeof n=="object"&&n!==null&&n.key!=null?o1(""+n.key):e.toString(36)}function Vc(n,e,t,r,a){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case ko:case GC:s=!0}}if(s)return s=n,a=a(s),n=r===""?"."+jd(s,0):r,Tg(a)?(t="",n!=null&&(t=n.replace(Sg,"$&/")+"/"),Vc(a,e,t,"",function(c){return c})):a!=null&&(kd(a)&&(a=s1(a,t+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(Sg,"$&/")+"/")+n)),e.push(a)),1;if(s=0,r=r===""?".":r+":",Tg(n))for(var o=0;o<n.length;o++){i=n[o];var l=r+jd(i,o);s+=Vc(i,e,t,l,a)}else if(l=i1(n),typeof l=="function")for(n=l.call(n),o=0;!(i=n.next()).done;)i=i.value,l=r+jd(i,o++),s+=Vc(i,e,t,l,a);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function zc(n,e,t){if(n==null)return n;var r=[],a=0;return Vc(n,r,"","",function(i){return e.call(t,i,a++)}),r}function l1(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var mn={current:null},Wc={transition:null},c1={ReactCurrentDispatcher:mn,ReactCurrentBatchConfig:Wc,ReactCurrentOwner:$d};Qe.Children={map:zc,forEach:function(n,e,t){zc(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return zc(n,function(){e++}),e},toArray:function(n){return zc(n,function(e){return e})||[]},only:function(n){if(!kd(n))throw Error("React.Children.only expected to receive a single React element child.");return n}},Qe.Component=bs,Qe.Fragment=YC,Qe.Profiler=XC,Qe.PureComponent=Ld,Qe.StrictMode=JC,Qe.Suspense=n1,Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c1,Qe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=vg({},n.props),a=n.key,i=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,s=$d.current),e.key!==void 0&&(a=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)Ng.call(e,l)&&!Cg.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:ko,type:n.type,key:a,ref:i,props:r,_owner:s}},Qe.createContext=function(n){return n={$$typeof:e1,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:ZC,_context:n},n.Consumer=n},Qe.createElement=Ag,Qe.createFactory=function(n){var e=Ag.bind(null,n);return e.type=n,e},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(n){return{$$typeof:t1,render:n}},Qe.isValidElement=kd,Qe.lazy=function(n){return{$$typeof:a1,_payload:{_status:-1,_result:n},_init:l1}},Qe.memo=function(n,e){return{$$typeof:r1,type:n,compare:e===void 0?null:e}},Qe.startTransition=function(n){var e=Wc.transition;Wc.transition={};try{n()}finally{Wc.transition=e}},Qe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Qe.useCallback=function(n,e){return mn.current.useCallback(n,e)},Qe.useContext=function(n){return mn.current.useContext(n)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(n){return mn.current.useDeferredValue(n)},Qe.useEffect=function(n,e){return mn.current.useEffect(n,e)},Qe.useId=function(){return mn.current.useId()},Qe.useImperativeHandle=function(n,e,t){return mn.current.useImperativeHandle(n,e,t)},Qe.useInsertionEffect=function(n,e){return mn.current.useInsertionEffect(n,e)},Qe.useLayoutEffect=function(n,e){return mn.current.useLayoutEffect(n,e)},Qe.useMemo=function(n,e){return mn.current.useMemo(n,e)},Qe.useReducer=function(n,e,t){return mn.current.useReducer(n,e,t)},Qe.useRef=function(n){return mn.current.useRef(n)},Qe.useState=function(n){return mn.current.useState(n)},Qe.useSyncExternalStore=function(n,e,t){return mn.current.useSyncExternalStore(n,e,t)},Qe.useTransition=function(){return mn.current.useTransition()},Qe.version="18.2.0",yg.exports=Qe;var ye=yg.exports;const Y=Mi(ye),Rg=Ri({__proto__:null,default:Y},[ye]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var u1=ye,h1=Symbol.for("react.element"),d1=Symbol.for("react.fragment"),p1=Object.prototype.hasOwnProperty,m1=u1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f1={key:!0,ref:!0,__self:!0,__source:!0};function Mg(n,e,t){var r,a={},i=null,s=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)p1.call(e,r)&&!f1.hasOwnProperty(r)&&(a[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:h1,type:n,key:i,ref:s,props:a,_owner:m1.current}}Fc.Fragment=d1,Fc.jsx=Mg,Fc.jsxs=Mg,fg.exports=Fc;var j=fg.exports,Bd={},Og={exports:{}},Pn={},_g={exports:{}},xg={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(n){function e(ie,fe){var Me=ie.length;ie.push(fe);e:for(;0<Me;){var ge=Me-1>>>1,ne=ie[ge];if(0<a(ne,fe))ie[ge]=fe,ie[Me]=ne,Me=ge;else break e}}function t(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var fe=ie[0],Me=ie.pop();if(Me!==fe){ie[0]=Me;e:for(var ge=0,ne=ie.length,Ye=ne>>>1;ge<Ye;){var xe=2*(ge+1)-1,ke=ie[xe],ze=xe+1,Ze=ie[ze];if(0>a(ke,Me))ze<ne&&0>a(Ze,ke)?(ie[ge]=Ze,ie[ze]=Me,ge=ze):(ie[ge]=ke,ie[xe]=Me,ge=xe);else if(ze<ne&&0>a(Ze,Me))ie[ge]=Ze,ie[ze]=Me,ge=ze;else break e}}return fe}function a(ie,fe){var Me=ie.sortIndex-fe.sortIndex;return Me!==0?Me:ie.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();n.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,h=null,d=3,f=!1,g=!1,v=!1,C=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(ie){for(var fe=t(c);fe!==null;){if(fe.callback===null)r(c);else if(fe.startTime<=ie)r(c),fe.sortIndex=fe.expirationTime,e(l,fe);else break;fe=t(c)}}function O(ie){if(v=!1,S(ie),!g)if(t(l)!==null)g=!0,ue(k);else{var fe=t(c);fe!==null&&Se(O,fe.startTime-ie)}}function k(ie,fe){g=!1,v&&(v=!1,w(V),V=-1),f=!0;var Me=d;try{for(S(fe),h=t(l);h!==null&&(!(h.expirationTime>fe)||ie&&!I());){var ge=h.callback;if(typeof ge=="function"){h.callback=null,d=h.priorityLevel;var ne=ge(h.expirationTime<=fe);fe=n.unstable_now(),typeof ne=="function"?h.callback=ne:h===t(l)&&r(l),S(fe)}else r(l);h=t(l)}if(h!==null)var Ye=!0;else{var xe=t(c);xe!==null&&Se(O,xe.startTime-fe),Ye=!1}return Ye}finally{h=null,d=Me,f=!1}}var B=!1,D=null,V=-1,q=5,K=-1;function I(){return!(n.unstable_now()-K<q)}function G(){if(D!==null){var ie=n.unstable_now();K=ie;var fe=!0;try{fe=D(!0,ie)}finally{fe?H():(B=!1,D=null)}}else B=!1}var H;if(typeof T=="function")H=function(){T(G)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,re=se.port2;se.port1.onmessage=G,H=function(){re.postMessage(null)}}else H=function(){C(G,0)};function ue(ie){D=ie,B||(B=!0,H())}function Se(ie,fe){V=C(function(){ie(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_continueExecution=function(){g||f||(g=!0,ue(k))},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var fe=3;break;default:fe=d}var Me=d;d=fe;try{return ie()}finally{d=Me}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ie,fe){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Me=d;d=ie;try{return fe()}finally{d=Me}},n.unstable_scheduleCallback=function(ie,fe,Me){var ge=n.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?ge+Me:ge):Me=ge,ie){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=Me+ne,ie={id:u++,callback:fe,priorityLevel:ie,startTime:Me,expirationTime:ne,sortIndex:-1},Me>ge?(ie.sortIndex=Me,e(c,ie),t(l)===null&&ie===t(c)&&(v?(w(V),V=-1):v=!0,Se(O,Me-ge))):(ie.sortIndex=ne,e(l,ie),g||f||(g=!0,ue(k))),ie},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(ie){var fe=d;return function(){var Me=d;d=fe;try{return ie.apply(this,arguments)}finally{d=Me}}}})(xg),_g.exports=xg;var y1=_g.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Pg=ye,In=y1;function ce(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ig=new Set,jo={};function Oi(n,e){vs(n,e),vs(n+"Capture",e)}function vs(n,e){for(jo[n]=e,n=0;n<e.length;n++)Ig.add(e[n])}var la=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ud=Object.prototype.hasOwnProperty,g1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dg={},Lg={};function b1(n){return Ud.call(Lg,n)?!0:Ud.call(Dg,n)?!1:g1.test(n)?Lg[n]=!0:(Dg[n]=!0,!1)}function v1(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function E1(n,e,t,r){if(e===null||typeof e>"u"||v1(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fn(n,e,t,r,a,i,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Gt[n]=new fn(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Gt[e]=new fn(e,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){Gt[n]=new fn(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Gt[n]=new fn(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Gt[n]=new fn(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){Gt[n]=new fn(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){Gt[n]=new fn(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){Gt[n]=new fn(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){Gt[n]=new fn(n,5,!1,n.toLowerCase(),null,!1,!1)});var Fd=/[\-:]([a-z])/g;function Vd(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Fd,Vd);Gt[e]=new fn(e,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Fd,Vd);Gt[e]=new fn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Fd,Vd);Gt[e]=new fn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){Gt[n]=new fn(n,1,!1,n.toLowerCase(),null,!1,!1)}),Gt.xlinkHref=new fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){Gt[n]=new fn(n,1,!1,n.toLowerCase(),null,!0,!0)});function zd(n,e,t,r){var a=Gt.hasOwnProperty(e)?Gt[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E1(e,t,a,r)&&(t=null),r||a===null?b1(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):a.mustUseProperty?n[a.propertyName]=t===null?a.type===3?!1:"":t:(e=a.attributeName,r=a.attributeNamespace,t===null?n.removeAttribute(e):(a=a.type,t=a===3||a===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var ca=Pg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hc=Symbol.for("react.element"),Es=Symbol.for("react.portal"),ws=Symbol.for("react.fragment"),Wd=Symbol.for("react.strict_mode"),Hd=Symbol.for("react.profiler"),qg=Symbol.for("react.provider"),$g=Symbol.for("react.context"),Kd=Symbol.for("react.forward_ref"),Qd=Symbol.for("react.suspense"),Gd=Symbol.for("react.suspense_list"),Yd=Symbol.for("react.memo"),ja=Symbol.for("react.lazy"),kg=Symbol.for("react.offscreen"),jg=Symbol.iterator;function Bo(n){return n===null||typeof n!="object"?null:(n=jg&&n[jg]||n["@@iterator"],typeof n=="function"?n:null)}var vt=Object.assign,Jd;function Uo(n){if(Jd===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Jd=e&&e[1]||""}return`
`+Jd+n}var Xd=!1;function Zd(n,e){if(!n||Xd)return"";Xd=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=r.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=s&&0<=o);break}}}finally{Xd=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Uo(n):""}function w1(n){switch(n.tag){case 5:return Uo(n.type);case 16:return Uo("Lazy");case 13:return Uo("Suspense");case 19:return Uo("SuspenseList");case 0:case 2:case 15:return n=Zd(n.type,!1),n;case 11:return n=Zd(n.type.render,!1),n;case 1:return n=Zd(n.type,!0),n;default:return""}}function ep(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ws:return"Fragment";case Es:return"Portal";case Hd:return"Profiler";case Wd:return"StrictMode";case Qd:return"Suspense";case Gd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case $g:return(n.displayName||"Context")+".Consumer";case qg:return(n._context.displayName||"Context")+".Provider";case Kd:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Yd:return e=n.displayName||null,e!==null?e:ep(n.type)||"Memo";case ja:e=n._payload,n=n._init;try{return ep(n(e))}catch{}}return null}function T1(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ep(e);case 8:return e===Wd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ba(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Bg(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function N1(n){var e=Bg(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var a=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return a.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Kc(n){n._valueTracker||(n._valueTracker=N1(n))}function Ug(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Bg(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Qc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function tp(n,e){var t=e.checked;return vt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Fg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Ba(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Vg(n,e){e=e.checked,e!=null&&zd(n,"checked",e,!1)}function np(n,e){Vg(n,e);var t=Ba(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?rp(n,e.type,t):e.hasOwnProperty("defaultValue")&&rp(n,e.type,Ba(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function zg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function rp(n,e,t){(e!=="number"||Qc(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Fo=Array.isArray;function Ts(n,e,t,r){if(n=n.options,e){e={};for(var a=0;a<t.length;a++)e["$"+t[a]]=!0;for(t=0;t<n.length;t++)a=e.hasOwnProperty("$"+n[t].value),n[t].selected!==a&&(n[t].selected=a),a&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Ba(t),e=null,a=0;a<n.length;a++){if(n[a].value===t){n[a].selected=!0,r&&(n[a].defaultSelected=!0);return}e!==null||n[a].disabled||(e=n[a])}e!==null&&(e.selected=!0)}}function ap(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return vt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Wg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ce(92));if(Fo(t)){if(1<t.length)throw Error(ce(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ba(t)}}function Hg(n,e){var t=Ba(e.value),r=Ba(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Kg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Qg(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ip(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Qg(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Gc,Gg=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,a){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,a)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Vo(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C1=["Webkit","ms","Moz","O"];Object.keys(zo).forEach(function(n){C1.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),zo[e]=zo[n]})});function Yg(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||zo.hasOwnProperty(n)&&zo[n]?(""+e).trim():e+"px"}function Jg(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,a=Yg(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,a):n[t]=a}}var A1=vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sp(n,e){if(e){if(A1[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function op(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lp=null;function cp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var up=null,Ns=null,Cs=null;function Xg(n){if(n=dl(n)){if(typeof up!="function")throw Error(ce(280));var e=n.stateNode;e&&(e=bu(e),up(n.stateNode,n.type,e))}}function Zg(n){Ns?Cs?Cs.push(n):Cs=[n]:Ns=n}function eb(){if(Ns){var n=Ns,e=Cs;if(Cs=Ns=null,Xg(n),e)for(n=0;n<e.length;n++)Xg(e[n])}}function tb(n,e){return n(e)}function nb(){}var hp=!1;function rb(n,e,t){if(hp)return n(e,t);hp=!0;try{return tb(n,e,t)}finally{hp=!1,(Ns!==null||Cs!==null)&&(nb(),eb())}}function Wo(n,e){var t=n.stateNode;if(t===null)return null;var r=bu(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ce(231,e,typeof t));return t}var dp=!1;if(la)try{var Ho={};Object.defineProperty(Ho,"passive",{get:function(){dp=!0}}),window.addEventListener("test",Ho,Ho),window.removeEventListener("test",Ho,Ho)}catch{dp=!1}function S1(n,e,t,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Ko=!1,Yc=null,Jc=!1,pp=null,R1={onError:function(n){Ko=!0,Yc=n}};function M1(n,e,t,r,a,i,s,o,l){Ko=!1,Yc=null,S1.apply(R1,arguments)}function O1(n,e,t,r,a,i,s,o,l){if(M1.apply(this,arguments),Ko){if(Ko){var c=Yc;Ko=!1,Yc=null}else throw Error(ce(198));Jc||(Jc=!0,pp=c)}}function _i(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function ab(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function ib(n){if(_i(n)!==n)throw Error(ce(188))}function _1(n){var e=n.alternate;if(!e){if(e=_i(n),e===null)throw Error(ce(188));return e!==n?null:n}for(var t=n,r=e;;){var a=t.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){t=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===t)return ib(a),n;if(i===r)return ib(a),e;i=i.sibling}throw Error(ce(188))}if(t.return!==r.return)t=a,r=i;else{for(var s=!1,o=a.child;o;){if(o===t){s=!0,t=a,r=i;break}if(o===r){s=!0,r=a,t=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===t){s=!0,t=i,r=a;break}if(o===r){s=!0,r=i,t=a;break}o=o.sibling}if(!s)throw Error(ce(189))}}if(t.alternate!==r)throw Error(ce(190))}if(t.tag!==3)throw Error(ce(188));return t.stateNode.current===t?n:e}function sb(n){return n=_1(n),n!==null?ob(n):null}function ob(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=ob(n);if(e!==null)return e;n=n.sibling}return null}var lb=In.unstable_scheduleCallback,cb=In.unstable_cancelCallback,x1=In.unstable_shouldYield,P1=In.unstable_requestPaint,Ot=In.unstable_now,I1=In.unstable_getCurrentPriorityLevel,mp=In.unstable_ImmediatePriority,ub=In.unstable_UserBlockingPriority,Xc=In.unstable_NormalPriority,D1=In.unstable_LowPriority,hb=In.unstable_IdlePriority,Zc=null,Br=null;function L1(n){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Zc,n,void 0,(n.current.flags&128)===128)}catch{}}var vr=Math.clz32?Math.clz32:k1,q1=Math.log,$1=Math.LN2;function k1(n){return n>>>=0,n===0?32:31-(q1(n)/$1|0)|0}var eu=64,tu=4194304;function Qo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function nu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,a=n.suspendedLanes,i=n.pingedLanes,s=t&268435455;if(s!==0){var o=s&~a;o!==0?r=Qo(o):(i&=s,i!==0&&(r=Qo(i)))}else s=t&~a,s!==0?r=Qo(s):i!==0&&(r=Qo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-vr(e),a=1<<t,r|=n[t],e&=~a;return r}function j1(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B1(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,a=n.expirationTimes,i=n.pendingLanes;0<i;){var s=31-vr(i),o=1<<s,l=a[s];l===-1?(!(o&t)||o&r)&&(a[s]=j1(o,e)):l<=e&&(n.expiredLanes|=o),i&=~o}}function fp(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function db(){var n=eu;return eu<<=1,!(eu&4194240)&&(eu=64),n}function yp(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Go(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-vr(e),n[e]=t}function U1(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var a=31-vr(t),i=1<<a;e[a]=0,r[a]=-1,n[a]=-1,t&=~i}}function gp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-vr(t),a=1<<r;a&e|n[r]&e&&(n[r]|=e),t&=~a}}var nt=0;function pb(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var mb,bp,fb,yb,gb,vp=!1,ru=[],Ua=null,Fa=null,Va=null,Yo=new Map,Jo=new Map,za=[],F1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bb(n,e){switch(n){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":Fa=null;break;case"mouseover":case"mouseout":Va=null;break;case"pointerover":case"pointerout":Yo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jo.delete(e.pointerId)}}function Xo(n,e,t,r,a,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=dl(e),e!==null&&bp(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),n)}function V1(n,e,t,r,a){switch(e){case"focusin":return Ua=Xo(Ua,n,e,t,r,a),!0;case"dragenter":return Fa=Xo(Fa,n,e,t,r,a),!0;case"mouseover":return Va=Xo(Va,n,e,t,r,a),!0;case"pointerover":var i=a.pointerId;return Yo.set(i,Xo(Yo.get(i)||null,n,e,t,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Jo.set(i,Xo(Jo.get(i)||null,n,e,t,r,a)),!0}return!1}function vb(n){var e=xi(n.target);if(e!==null){var t=_i(e);if(t!==null){if(e=t.tag,e===13){if(e=ab(t),e!==null){n.blockedOn=e,gb(n.priority,function(){fb(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function au(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=wp(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);lp=r,t.target.dispatchEvent(r),lp=null}else return e=dl(t),e!==null&&bp(e),n.blockedOn=t,!1;e.shift()}return!0}function Eb(n,e,t){au(n)&&t.delete(e)}function z1(){vp=!1,Ua!==null&&au(Ua)&&(Ua=null),Fa!==null&&au(Fa)&&(Fa=null),Va!==null&&au(Va)&&(Va=null),Yo.forEach(Eb),Jo.forEach(Eb)}function Zo(n,e){n.blockedOn===e&&(n.blockedOn=null,vp||(vp=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,z1)))}function el(n){function e(a){return Zo(a,n)}if(0<ru.length){Zo(ru[0],n);for(var t=1;t<ru.length;t++){var r=ru[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Ua!==null&&Zo(Ua,n),Fa!==null&&Zo(Fa,n),Va!==null&&Zo(Va,n),Yo.forEach(e),Jo.forEach(e),t=0;t<za.length;t++)r=za[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<za.length&&(t=za[0],t.blockedOn===null);)vb(t),t.blockedOn===null&&za.shift()}var As=ca.ReactCurrentBatchConfig,iu=!0;function W1(n,e,t,r){var a=nt,i=As.transition;As.transition=null;try{nt=1,Ep(n,e,t,r)}finally{nt=a,As.transition=i}}function H1(n,e,t,r){var a=nt,i=As.transition;As.transition=null;try{nt=4,Ep(n,e,t,r)}finally{nt=a,As.transition=i}}function Ep(n,e,t,r){if(iu){var a=wp(n,e,t,r);if(a===null)kp(n,e,r,su,t),bb(n,r);else if(V1(a,n,e,t,r))r.stopPropagation();else if(bb(n,r),e&4&&-1<F1.indexOf(n)){for(;a!==null;){var i=dl(a);if(i!==null&&mb(i),i=wp(n,e,t,r),i===null&&kp(n,e,r,su,t),i===a)break;a=i}a!==null&&r.stopPropagation()}else kp(n,e,r,null,t)}}var su=null;function wp(n,e,t,r){if(su=null,n=cp(r),n=xi(n),n!==null)if(e=_i(n),e===null)n=null;else if(t=e.tag,t===13){if(n=ab(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return su=n,null}function wb(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(I1()){case mp:return 1;case ub:return 4;case Xc:case D1:return 16;case hb:return 536870912;default:return 16}default:return 16}}var Wa=null,Tp=null,ou=null;function Tb(){if(ou)return ou;var n,e=Tp,t=e.length,r,a="value"in Wa?Wa.value:Wa.textContent,i=a.length;for(n=0;n<t&&e[n]===a[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===a[i-r];r++);return ou=a.slice(n,1<r?1-r:void 0)}function lu(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function cu(){return!0}function Nb(){return!1}function Dn(n){function e(t,r,a,i,s){this._reactName=t,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?cu:Nb,this.isPropagationStopped=Nb,this}return vt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=cu)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=cu)},persist:function(){},isPersistent:cu}),e}var Ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Np=Dn(Ss),tl=vt({},Ss,{view:0,detail:0}),K1=Dn(tl),Cp,Ap,nl,uu=vt({},tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==nl&&(nl&&n.type==="mousemove"?(Cp=n.screenX-nl.screenX,Ap=n.screenY-nl.screenY):Ap=Cp=0,nl=n),Cp)},movementY:function(n){return"movementY"in n?n.movementY:Ap}}),Cb=Dn(uu),Q1=vt({},uu,{dataTransfer:0}),G1=Dn(Q1),Y1=vt({},tl,{relatedTarget:0}),Sp=Dn(Y1),J1=vt({},Ss,{animationName:0,elapsedTime:0,pseudoElement:0}),X1=Dn(J1),Z1=vt({},Ss,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),eA=Dn(Z1),tA=vt({},Ss,{data:0}),Ab=Dn(tA),nA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iA(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=aA[n])?!!e[n]:!1}function Rp(){return iA}var sA=vt({},tl,{key:function(n){if(n.key){var e=nA[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=lu(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?rA[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rp,charCode:function(n){return n.type==="keypress"?lu(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?lu(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),oA=Dn(sA),lA=vt({},uu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sb=Dn(lA),cA=vt({},tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rp}),uA=Dn(cA),hA=vt({},Ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),dA=Dn(hA),pA=vt({},uu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),mA=Dn(pA),fA=[9,13,27,32],Mp=la&&"CompositionEvent"in window,rl=null;la&&"documentMode"in document&&(rl=document.documentMode);var yA=la&&"TextEvent"in window&&!rl,Rb=la&&(!Mp||rl&&8<rl&&11>=rl),Mb=" ",Ob=!1;function _b(n,e){switch(n){case"keyup":return fA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xb(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Rs=!1;function gA(n,e){switch(n){case"compositionend":return xb(e);case"keypress":return e.which!==32?null:(Ob=!0,Mb);case"textInput":return n=e.data,n===Mb&&Ob?null:n;default:return null}}function bA(n,e){if(Rs)return n==="compositionend"||!Mp&&_b(n,e)?(n=Tb(),ou=Tp=Wa=null,Rs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Rb&&e.locale!=="ko"?null:e.data;default:return null}}var vA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!vA[n.type]:e==="textarea"}function Ib(n,e,t,r){Zg(r),e=fu(e,"onChange"),0<e.length&&(t=new Np("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var al=null,il=null;function EA(n){Jb(n,0)}function hu(n){var e=Ps(n);if(Ug(e))return n}function wA(n,e){if(n==="change")return e}var Db=!1;if(la){var Op;if(la){var _p="oninput"in document;if(!_p){var Lb=document.createElement("div");Lb.setAttribute("oninput","return;"),_p=typeof Lb.oninput=="function"}Op=_p}else Op=!1;Db=Op&&(!document.documentMode||9<document.documentMode)}function qb(){al&&(al.detachEvent("onpropertychange",$b),il=al=null)}function $b(n){if(n.propertyName==="value"&&hu(il)){var e=[];Ib(e,il,n,cp(n)),rb(EA,e)}}function TA(n,e,t){n==="focusin"?(qb(),al=e,il=t,al.attachEvent("onpropertychange",$b)):n==="focusout"&&qb()}function NA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return hu(il)}function CA(n,e){if(n==="click")return hu(e)}function AA(n,e){if(n==="input"||n==="change")return hu(e)}function SA(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Er=typeof Object.is=="function"?Object.is:SA;function sl(n,e){if(Er(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var a=t[r];if(!Ud.call(e,a)||!Er(n[a],e[a]))return!1}return!0}function kb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function jb(n,e){var t=kb(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=kb(t)}}function Bb(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Bb(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Ub(){for(var n=window,e=Qc();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Qc(n.document)}return e}function xp(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function RA(n){var e=Ub(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Bb(t.ownerDocument.documentElement,t)){if(r!==null&&xp(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var a=t.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!n.extend&&i>r&&(a=r,r=i,i=a),a=jb(t,i);var s=jb(t,r);a&&s&&(n.rangeCount!==1||n.anchorNode!==a.node||n.anchorOffset!==a.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var MA=la&&"documentMode"in document&&11>=document.documentMode,Ms=null,Pp=null,ol=null,Ip=!1;function Fb(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Ip||Ms==null||Ms!==Qc(r)||(r=Ms,"selectionStart"in r&&xp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ol&&sl(ol,r)||(ol=r,r=fu(Pp,"onSelect"),0<r.length&&(e=new Np("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ms)))}function du(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Os={animationend:du("Animation","AnimationEnd"),animationiteration:du("Animation","AnimationIteration"),animationstart:du("Animation","AnimationStart"),transitionend:du("Transition","TransitionEnd")},Dp={},Vb={};la&&(Vb=document.createElement("div").style,"AnimationEvent"in window||(delete Os.animationend.animation,delete Os.animationiteration.animation,delete Os.animationstart.animation),"TransitionEvent"in window||delete Os.transitionend.transition);function pu(n){if(Dp[n])return Dp[n];if(!Os[n])return n;var e=Os[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Vb)return Dp[n]=e[t];return n}var zb=pu("animationend"),Wb=pu("animationiteration"),Hb=pu("animationstart"),Kb=pu("transitionend"),Qb=new Map,Gb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ha(n,e){Qb.set(n,e),Oi(e,[n])}for(var Lp=0;Lp<Gb.length;Lp++){var qp=Gb[Lp],OA=qp.toLowerCase(),_A=qp[0].toUpperCase()+qp.slice(1);Ha(OA,"on"+_A)}Ha(zb,"onAnimationEnd"),Ha(Wb,"onAnimationIteration"),Ha(Hb,"onAnimationStart"),Ha("dblclick","onDoubleClick"),Ha("focusin","onFocus"),Ha("focusout","onBlur"),Ha(Kb,"onTransitionEnd"),vs("onMouseEnter",["mouseout","mouseover"]),vs("onMouseLeave",["mouseout","mouseover"]),vs("onPointerEnter",["pointerout","pointerover"]),vs("onPointerLeave",["pointerout","pointerover"]),Oi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xA=new Set("cancel close invalid load scroll toggle".split(" ").concat(ll));function Yb(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,O1(r,e,void 0,n),n.currentTarget=null}function Jb(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Yb(a,o,c),i=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Yb(a,o,c),i=l}}}if(Jc)throw n=pp,Jc=!1,pp=null,n}function ct(n,e){var t=e[zp];t===void 0&&(t=e[zp]=new Set);var r=n+"__bubble";t.has(r)||(Xb(e,n,2,!1),t.add(r))}function $p(n,e,t){var r=0;e&&(r|=4),Xb(t,n,r,e)}var mu="_reactListening"+Math.random().toString(36).slice(2);function cl(n){if(!n[mu]){n[mu]=!0,Ig.forEach(function(t){t!=="selectionchange"&&(xA.has(t)||$p(t,!1,n),$p(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[mu]||(e[mu]=!0,$p("selectionchange",!1,e))}}function Xb(n,e,t,r){switch(wb(e)){case 1:var a=W1;break;case 4:a=H1;break;default:a=Ep}t=a.bind(null,e,t,n),a=void 0,!dp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?n.addEventListener(e,t,{capture:!0,passive:a}):n.addEventListener(e,t,!0):a!==void 0?n.addEventListener(e,t,{passive:a}):n.addEventListener(e,t,!1)}function kp(n,e,t,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=xi(o),s===null)return;if(l=s.tag,l===5||l===6){r=i=s;continue e}o=o.parentNode}}r=r.return}rb(function(){var c=i,u=cp(t),h=[];e:{var d=Qb.get(n);if(d!==void 0){var f=Np,g=n;switch(n){case"keypress":if(lu(t)===0)break e;case"keydown":case"keyup":f=oA;break;case"focusin":g="focus",f=Sp;break;case"focusout":g="blur",f=Sp;break;case"beforeblur":case"afterblur":f=Sp;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Cb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=G1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=uA;break;case zb:case Wb:case Hb:f=X1;break;case Kb:f=dA;break;case"scroll":f=K1;break;case"wheel":f=mA;break;case"copy":case"cut":case"paste":f=eA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Sb}var v=(e&4)!==0,C=!v&&n==="scroll",w=v?d!==null?d+"Capture":null:d;v=[];for(var T=c,S;T!==null;){S=T;var O=S.stateNode;if(S.tag===5&&O!==null&&(S=O,w!==null&&(O=Wo(T,w),O!=null&&v.push(ul(T,O,S)))),C)break;T=T.return}0<v.length&&(d=new f(d,g,null,t,u),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==lp&&(g=t.relatedTarget||t.fromElement)&&(xi(g)||g[ua]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(g=t.relatedTarget||t.toElement,f=c,g=g?xi(g):null,g!==null&&(C=_i(g),g!==C||g.tag!==5&&g.tag!==6)&&(g=null)):(f=null,g=c),f!==g)){if(v=Cb,O="onMouseLeave",w="onMouseEnter",T="mouse",(n==="pointerout"||n==="pointerover")&&(v=Sb,O="onPointerLeave",w="onPointerEnter",T="pointer"),C=f==null?d:Ps(f),S=g==null?d:Ps(g),d=new v(O,T+"leave",f,t,u),d.target=C,d.relatedTarget=S,O=null,xi(u)===c&&(v=new v(w,T+"enter",g,t,u),v.target=S,v.relatedTarget=C,O=v),C=O,f&&g)t:{for(v=f,w=g,T=0,S=v;S;S=_s(S))T++;for(S=0,O=w;O;O=_s(O))S++;for(;0<T-S;)v=_s(v),T--;for(;0<S-T;)w=_s(w),S--;for(;T--;){if(v===w||w!==null&&v===w.alternate)break t;v=_s(v),w=_s(w)}v=null}else v=null;f!==null&&Zb(h,d,f,v,!1),g!==null&&C!==null&&Zb(h,C,g,v,!0)}}e:{if(d=c?Ps(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var k=wA;else if(Pb(d))if(Db)k=AA;else{k=NA;var B=TA}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(k=CA);if(k&&(k=k(n,c))){Ib(h,k,t,u);break e}B&&B(n,d,c),n==="focusout"&&(B=d._wrapperState)&&B.controlled&&d.type==="number"&&rp(d,"number",d.value)}switch(B=c?Ps(c):window,n){case"focusin":(Pb(B)||B.contentEditable==="true")&&(Ms=B,Pp=c,ol=null);break;case"focusout":ol=Pp=Ms=null;break;case"mousedown":Ip=!0;break;case"contextmenu":case"mouseup":case"dragend":Ip=!1,Fb(h,t,u);break;case"selectionchange":if(MA)break;case"keydown":case"keyup":Fb(h,t,u)}var D;if(Mp)e:{switch(n){case"compositionstart":var V="onCompositionStart";break e;case"compositionend":V="onCompositionEnd";break e;case"compositionupdate":V="onCompositionUpdate";break e}V=void 0}else Rs?_b(n,t)&&(V="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(V="onCompositionStart");V&&(Rb&&t.locale!=="ko"&&(Rs||V!=="onCompositionStart"?V==="onCompositionEnd"&&Rs&&(D=Tb()):(Wa=u,Tp="value"in Wa?Wa.value:Wa.textContent,Rs=!0)),B=fu(c,V),0<B.length&&(V=new Ab(V,n,null,t,u),h.push({event:V,listeners:B}),D?V.data=D:(D=xb(t),D!==null&&(V.data=D)))),(D=yA?gA(n,t):bA(n,t))&&(c=fu(c,"onBeforeInput"),0<c.length&&(u=new Ab("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=D))}Jb(h,e)})}function ul(n,e,t){return{instance:n,listener:e,currentTarget:t}}function fu(n,e){for(var t=e+"Capture",r=[];n!==null;){var a=n,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Wo(n,t),i!=null&&r.unshift(ul(n,i,a)),i=Wo(n,e),i!=null&&r.push(ul(n,i,a))),n=n.return}return r}function _s(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Zb(n,e,t,r,a){for(var i=e._reactName,s=[];t!==null&&t!==r;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,a?(l=Wo(t,i),l!=null&&s.unshift(ul(t,l,o))):a||(l=Wo(t,i),l!=null&&s.push(ul(t,l,o)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var PA=/\r\n?/g,IA=/\u0000|\uFFFD/g;function ev(n){return(typeof n=="string"?n:""+n).replace(PA,`
`).replace(IA,"")}function yu(n,e,t){if(e=ev(e),ev(n)!==e&&t)throw Error(ce(425))}function gu(){}var jp=null,Bp=null;function Up(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fp=typeof setTimeout=="function"?setTimeout:void 0,DA=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,LA=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(n){return tv.resolve(null).then(n).catch(qA)}:Fp;function qA(n){setTimeout(function(){throw n})}function Vp(n,e){var t=e,r=0;do{var a=t.nextSibling;if(n.removeChild(t),a&&a.nodeType===8)if(t=a.data,t==="/$"){if(r===0){n.removeChild(a),el(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=a}while(t);el(e)}function Ka(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function nv(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var xs=Math.random().toString(36).slice(2),Ur="__reactFiber$"+xs,hl="__reactProps$"+xs,ua="__reactContainer$"+xs,zp="__reactEvents$"+xs,$A="__reactListeners$"+xs,kA="__reactHandles$"+xs;function xi(n){var e=n[Ur];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ua]||t[Ur]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=nv(n);n!==null;){if(t=n[Ur])return t;n=nv(n)}return e}n=t,t=n.parentNode}return null}function dl(n){return n=n[Ur]||n[ua],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ps(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ce(33))}function bu(n){return n[hl]||null}var Wp=[],Is=-1;function Qa(n){return{current:n}}function ut(n){0>Is||(n.current=Wp[Is],Wp[Is]=null,Is--)}function ot(n,e){Is++,Wp[Is]=n.current,n.current=e}var Ga={},an=Qa(Ga),wn=Qa(!1),Pi=Ga;function Ds(n,e){var t=n.type.contextTypes;if(!t)return Ga;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in t)a[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=a),a}function Tn(n){return n=n.childContextTypes,n!=null}function vu(){ut(wn),ut(an)}function rv(n,e,t){if(an.current!==Ga)throw Error(ce(168));ot(an,e),ot(wn,t)}function av(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(ce(108,T1(n)||"Unknown",a));return vt({},t,r)}function Eu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ga,Pi=an.current,ot(an,n),ot(wn,wn.current),!0}function iv(n,e,t){var r=n.stateNode;if(!r)throw Error(ce(169));t?(n=av(n,e,Pi),r.__reactInternalMemoizedMergedChildContext=n,ut(wn),ut(an),ot(an,n)):ut(wn),ot(wn,t)}var ha=null,wu=!1,Hp=!1;function sv(n){ha===null?ha=[n]:ha.push(n)}function jA(n){wu=!0,sv(n)}function Ya(){if(!Hp&&ha!==null){Hp=!0;var n=0,e=nt;try{var t=ha;for(nt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}ha=null,wu=!1}catch(a){throw ha!==null&&(ha=ha.slice(n+1)),lb(mp,Ya),a}finally{nt=e,Hp=!1}}return null}var Ls=[],qs=0,Tu=null,Nu=0,Yn=[],Jn=0,Ii=null,da=1,pa="";function Di(n,e){Ls[qs++]=Nu,Ls[qs++]=Tu,Tu=n,Nu=e}function ov(n,e,t){Yn[Jn++]=da,Yn[Jn++]=pa,Yn[Jn++]=Ii,Ii=n;var r=da;n=pa;var a=32-vr(r)-1;r&=~(1<<a),t+=1;var i=32-vr(e)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,da=1<<32-vr(e)+a|t<<a|r,pa=i+n}else da=1<<i|t<<a|r,pa=n}function Kp(n){n.return!==null&&(Di(n,1),ov(n,1,0))}function Qp(n){for(;n===Tu;)Tu=Ls[--qs],Ls[qs]=null,Nu=Ls[--qs],Ls[qs]=null;for(;n===Ii;)Ii=Yn[--Jn],Yn[Jn]=null,pa=Yn[--Jn],Yn[Jn]=null,da=Yn[--Jn],Yn[Jn]=null}var Ln=null,qn=null,mt=!1,wr=null;function lv(n,e){var t=tr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function cv(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ln=n,qn=Ka(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ln=n,qn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ii!==null?{id:da,overflow:pa}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=tr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ln=n,qn=null,!0):!1;default:return!1}}function Gp(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Yp(n){if(mt){var e=qn;if(e){var t=e;if(!cv(n,e)){if(Gp(n))throw Error(ce(418));e=Ka(t.nextSibling);var r=Ln;e&&cv(n,e)?lv(r,t):(n.flags=n.flags&-4097|2,mt=!1,Ln=n)}}else{if(Gp(n))throw Error(ce(418));n.flags=n.flags&-4097|2,mt=!1,Ln=n}}}function uv(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ln=n}function Cu(n){if(n!==Ln)return!1;if(!mt)return uv(n),mt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Up(n.type,n.memoizedProps)),e&&(e=qn)){if(Gp(n))throw hv(),Error(ce(418));for(;e;)lv(n,e),e=Ka(e.nextSibling)}if(uv(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ce(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){qn=Ka(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}qn=null}}else qn=Ln?Ka(n.stateNode.nextSibling):null;return!0}function hv(){for(var n=qn;n;)n=Ka(n.nextSibling)}function $s(){qn=Ln=null,mt=!1}function Jp(n){wr===null?wr=[n]:wr.push(n)}var BA=ca.ReactCurrentBatchConfig;function Tr(n,e){if(n&&n.defaultProps){e=vt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var Au=Qa(null),Su=null,ks=null,Xp=null;function Zp(){Xp=ks=Su=null}function em(n){var e=Au.current;ut(Au),n._currentValue=e}function tm(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function js(n,e){Su=n,Xp=ks=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Nn=!0),n.firstContext=null)}function Xn(n){var e=n._currentValue;if(Xp!==n)if(n={context:n,memoizedValue:e,next:null},ks===null){if(Su===null)throw Error(ce(308));ks=n,Su.dependencies={lanes:0,firstContext:n}}else ks=ks.next=n;return e}var Li=null;function nm(n){Li===null?Li=[n]:Li.push(n)}function dv(n,e,t,r){var a=e.interleaved;return a===null?(t.next=t,nm(e)):(t.next=a.next,a.next=t),e.interleaved=t,ma(n,r)}function ma(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ja=!1;function rm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pv(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function fa(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Xa(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,ma(n,t)}return a=r.interleaved,a===null?(e.next=e,nm(r)):(e.next=a.next,a.next=e),r.interleaved=e,ma(n,t)}function Ru(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,gp(n,t)}}function mv(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var a=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?a=i=s:i=i.next=s,t=t.next}while(t!==null);i===null?a=i=e:i=i.next=e}else a=i=e;t={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Mu(n,e,t,r){var a=n.updateQueue;Ja=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=n.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=a.baseState;s=0,u=c=l=null,o=i;do{var d=o.lane,f=o.eventTime;if((r&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=n,v=o;switch(d=e,f=t,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(f,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,d=typeof g=="function"?g.call(f,h,d):g,d==null)break e;h=vt({},h,d);break e;case 2:Ja=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,s|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,e=a.shared.interleaved,e!==null){a=e;do s|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);ki|=s,n.lanes=s,n.memoizedState=h}}function fv(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],a=r.callback;if(a!==null){if(r.callback=null,r=t,typeof a!="function")throw Error(ce(191,a));a.call(r)}}}var yv=new Pg.Component().refs;function am(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:vt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Ou={isMounted:function(n){return(n=n._reactInternals)?_i(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=gn(),a=ni(n),i=fa(r,a);i.payload=e,t!=null&&(i.callback=t),e=Xa(n,i,a),e!==null&&(Ar(e,n,a,r),Ru(e,n,a))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=gn(),a=ni(n),i=fa(r,a);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Xa(n,i,a),e!==null&&(Ar(e,n,a,r),Ru(e,n,a))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=gn(),r=ni(n),a=fa(t,r);a.tag=2,e!=null&&(a.callback=e),e=Xa(n,a,r),e!==null&&(Ar(e,n,r,t),Ru(e,n,r))}};function gv(n,e,t,r,a,i,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,s):e.prototype&&e.prototype.isPureReactComponent?!sl(t,r)||!sl(a,i):!0}function bv(n,e,t){var r=!1,a=Ga,i=e.contextType;return typeof i=="object"&&i!==null?i=Xn(i):(a=Tn(e)?Pi:an.current,r=e.contextTypes,i=(r=r!=null)?Ds(n,a):Ga),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ou,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=i),e}function vv(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Ou.enqueueReplaceState(e,e.state,null)}function im(n,e,t,r){var a=n.stateNode;a.props=t,a.state=n.memoizedState,a.refs=yv,rm(n);var i=e.contextType;typeof i=="object"&&i!==null?a.context=Xn(i):(i=Tn(e)?Pi:an.current,a.context=Ds(n,i)),a.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(am(n,e,i,t),a.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Ou.enqueueReplaceState(a,a.state,null),Mu(n,t,a,r),a.state=n.memoizedState),typeof a.componentDidMount=="function"&&(n.flags|=4194308)}function pl(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ce(309));var r=t.stateNode}if(!r)throw Error(ce(147,n));var a=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(s){var o=a.refs;o===yv&&(o=a.refs={}),s===null?delete o[i]:o[i]=s},e._stringRef=i,e)}if(typeof n!="string")throw Error(ce(284));if(!t._owner)throw Error(ce(290,n))}return n}function _u(n,e){throw n=Object.prototype.toString.call(e),Error(ce(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Ev(n){var e=n._init;return e(n._payload)}function wv(n){function e(w,T){if(n){var S=w.deletions;S===null?(w.deletions=[T],w.flags|=16):S.push(T)}}function t(w,T){if(!n)return null;for(;T!==null;)e(w,T),T=T.sibling;return null}function r(w,T){for(w=new Map;T!==null;)T.key!==null?w.set(T.key,T):w.set(T.index,T),T=T.sibling;return w}function a(w,T){return w=ai(w,T),w.index=0,w.sibling=null,w}function i(w,T,S){return w.index=S,n?(S=w.alternate,S!==null?(S=S.index,S<T?(w.flags|=2,T):S):(w.flags|=2,T)):(w.flags|=1048576,T)}function s(w){return n&&w.alternate===null&&(w.flags|=2),w}function o(w,T,S,O){return T===null||T.tag!==6?(T=Um(S,w.mode,O),T.return=w,T):(T=a(T,S),T.return=w,T)}function l(w,T,S,O){var k=S.type;return k===ws?u(w,T,S.props.children,O,S.key):T!==null&&(T.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ja&&Ev(k)===T.type)?(O=a(T,S.props),O.ref=pl(w,T,S),O.return=w,O):(O=Gu(S.type,S.key,S.props,null,w.mode,O),O.ref=pl(w,T,S),O.return=w,O)}function c(w,T,S,O){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=Fm(S,w.mode,O),T.return=w,T):(T=a(T,S.children||[]),T.return=w,T)}function u(w,T,S,O,k){return T===null||T.tag!==7?(T=Fi(S,w.mode,O,k),T.return=w,T):(T=a(T,S),T.return=w,T)}function h(w,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Um(""+T,w.mode,S),T.return=w,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Hc:return S=Gu(T.type,T.key,T.props,null,w.mode,S),S.ref=pl(w,null,T),S.return=w,S;case Es:return T=Fm(T,w.mode,S),T.return=w,T;case ja:var O=T._init;return h(w,O(T._payload),S)}if(Fo(T)||Bo(T))return T=Fi(T,w.mode,S,null),T.return=w,T;_u(w,T)}return null}function d(w,T,S,O){var k=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return k!==null?null:o(w,T,""+S,O);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Hc:return S.key===k?l(w,T,S,O):null;case Es:return S.key===k?c(w,T,S,O):null;case ja:return k=S._init,d(w,T,k(S._payload),O)}if(Fo(S)||Bo(S))return k!==null?null:u(w,T,S,O,null);_u(w,S)}return null}function f(w,T,S,O,k){if(typeof O=="string"&&O!==""||typeof O=="number")return w=w.get(S)||null,o(T,w,""+O,k);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Hc:return w=w.get(O.key===null?S:O.key)||null,l(T,w,O,k);case Es:return w=w.get(O.key===null?S:O.key)||null,c(T,w,O,k);case ja:var B=O._init;return f(w,T,S,B(O._payload),k)}if(Fo(O)||Bo(O))return w=w.get(S)||null,u(T,w,O,k,null);_u(T,O)}return null}function g(w,T,S,O){for(var k=null,B=null,D=T,V=T=0,q=null;D!==null&&V<S.length;V++){D.index>V?(q=D,D=null):q=D.sibling;var K=d(w,D,S[V],O);if(K===null){D===null&&(D=q);break}n&&D&&K.alternate===null&&e(w,D),T=i(K,T,V),B===null?k=K:B.sibling=K,B=K,D=q}if(V===S.length)return t(w,D),mt&&Di(w,V),k;if(D===null){for(;V<S.length;V++)D=h(w,S[V],O),D!==null&&(T=i(D,T,V),B===null?k=D:B.sibling=D,B=D);return mt&&Di(w,V),k}for(D=r(w,D);V<S.length;V++)q=f(D,w,V,S[V],O),q!==null&&(n&&q.alternate!==null&&D.delete(q.key===null?V:q.key),T=i(q,T,V),B===null?k=q:B.sibling=q,B=q);return n&&D.forEach(function(I){return e(w,I)}),mt&&Di(w,V),k}function v(w,T,S,O){var k=Bo(S);if(typeof k!="function")throw Error(ce(150));if(S=k.call(S),S==null)throw Error(ce(151));for(var B=k=null,D=T,V=T=0,q=null,K=S.next();D!==null&&!K.done;V++,K=S.next()){D.index>V?(q=D,D=null):q=D.sibling;var I=d(w,D,K.value,O);if(I===null){D===null&&(D=q);break}n&&D&&I.alternate===null&&e(w,D),T=i(I,T,V),B===null?k=I:B.sibling=I,B=I,D=q}if(K.done)return t(w,D),mt&&Di(w,V),k;if(D===null){for(;!K.done;V++,K=S.next())K=h(w,K.value,O),K!==null&&(T=i(K,T,V),B===null?k=K:B.sibling=K,B=K);return mt&&Di(w,V),k}for(D=r(w,D);!K.done;V++,K=S.next())K=f(D,w,V,K.value,O),K!==null&&(n&&K.alternate!==null&&D.delete(K.key===null?V:K.key),T=i(K,T,V),B===null?k=K:B.sibling=K,B=K);return n&&D.forEach(function(G){return e(w,G)}),mt&&Di(w,V),k}function C(w,T,S,O){if(typeof S=="object"&&S!==null&&S.type===ws&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Hc:e:{for(var k=S.key,B=T;B!==null;){if(B.key===k){if(k=S.type,k===ws){if(B.tag===7){t(w,B.sibling),T=a(B,S.props.children),T.return=w,w=T;break e}}else if(B.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ja&&Ev(k)===B.type){t(w,B.sibling),T=a(B,S.props),T.ref=pl(w,B,S),T.return=w,w=T;break e}t(w,B);break}else e(w,B);B=B.sibling}S.type===ws?(T=Fi(S.props.children,w.mode,O,S.key),T.return=w,w=T):(O=Gu(S.type,S.key,S.props,null,w.mode,O),O.ref=pl(w,T,S),O.return=w,w=O)}return s(w);case Es:e:{for(B=S.key;T!==null;){if(T.key===B)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){t(w,T.sibling),T=a(T,S.children||[]),T.return=w,w=T;break e}else{t(w,T);break}else e(w,T);T=T.sibling}T=Fm(S,w.mode,O),T.return=w,w=T}return s(w);case ja:return B=S._init,C(w,T,B(S._payload),O)}if(Fo(S))return g(w,T,S,O);if(Bo(S))return v(w,T,S,O);_u(w,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(t(w,T.sibling),T=a(T,S),T.return=w,w=T):(t(w,T),T=Um(S,w.mode,O),T.return=w,w=T),s(w)):t(w,T)}return C}var Bs=wv(!0),Tv=wv(!1),ml={},Fr=Qa(ml),fl=Qa(ml),yl=Qa(ml);function qi(n){if(n===ml)throw Error(ce(174));return n}function sm(n,e){switch(ot(yl,e),ot(fl,n),ot(Fr,ml),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ip(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=ip(e,n)}ut(Fr),ot(Fr,e)}function Us(){ut(Fr),ut(fl),ut(yl)}function Nv(n){qi(yl.current);var e=qi(Fr.current),t=ip(e,n.type);e!==t&&(ot(fl,n),ot(Fr,t))}function om(n){fl.current===n&&(ut(Fr),ut(fl))}var Et=Qa(0);function xu(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lm=[];function cm(){for(var n=0;n<lm.length;n++)lm[n]._workInProgressVersionPrimary=null;lm.length=0}var Pu=ca.ReactCurrentDispatcher,um=ca.ReactCurrentBatchConfig,$i=0,wt=null,Dt=null,Ft=null,Iu=!1,gl=!1,bl=0,UA=0;function sn(){throw Error(ce(321))}function hm(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Er(n[t],e[t]))return!1;return!0}function dm(n,e,t,r,a,i){if($i=i,wt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pu.current=n===null||n.memoizedState===null?WA:HA,n=t(r,a),gl){i=0;do{if(gl=!1,bl=0,25<=i)throw Error(ce(301));i+=1,Ft=Dt=null,e.updateQueue=null,Pu.current=KA,n=t(r,a)}while(gl)}if(Pu.current=qu,e=Dt!==null&&Dt.next!==null,$i=0,Ft=Dt=wt=null,Iu=!1,e)throw Error(ce(300));return n}function pm(){var n=bl!==0;return bl=0,n}function Vr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?wt.memoizedState=Ft=n:Ft=Ft.next=n,Ft}function Zn(){if(Dt===null){var n=wt.alternate;n=n!==null?n.memoizedState:null}else n=Dt.next;var e=Ft===null?wt.memoizedState:Ft.next;if(e!==null)Ft=e,Dt=n;else{if(n===null)throw Error(ce(310));Dt=n,n={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Ft===null?wt.memoizedState=Ft=n:Ft=Ft.next=n}return Ft}function vl(n,e){return typeof e=="function"?e(n):e}function mm(n){var e=Zn(),t=e.queue;if(t===null)throw Error(ce(311));t.lastRenderedReducer=n;var r=Dt,a=r.baseQueue,i=t.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,t.pending=null}if(a!==null){i=a.next,r=r.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if(($i&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,s=r):l=l.next=h,wt.lanes|=u,ki|=u}c=c.next}while(c!==null&&c!==i);l===null?s=r:l.next=o,Er(r,e.memoizedState)||(Nn=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){a=n;do i=a.lane,wt.lanes|=i,ki|=i,a=a.next;while(a!==n)}else a===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function fm(n){var e=Zn(),t=e.queue;if(t===null)throw Error(ce(311));t.lastRenderedReducer=n;var r=t.dispatch,a=t.pending,i=e.memoizedState;if(a!==null){t.pending=null;var s=a=a.next;do i=n(i,s.action),s=s.next;while(s!==a);Er(i,e.memoizedState)||(Nn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function Cv(){}function Av(n,e){var t=wt,r=Zn(),a=e(),i=!Er(r.memoizedState,a);if(i&&(r.memoizedState=a,Nn=!0),r=r.queue,ym(Mv.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||Ft!==null&&Ft.memoizedState.tag&1){if(t.flags|=2048,El(9,Rv.bind(null,t,r,a,e),void 0,null),Vt===null)throw Error(ce(349));$i&30||Sv(t,e,a)}return a}function Sv(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Rv(n,e,t,r){e.value=t,e.getSnapshot=r,Ov(e)&&_v(n)}function Mv(n,e,t){return t(function(){Ov(e)&&_v(n)})}function Ov(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Er(n,t)}catch{return!0}}function _v(n){var e=ma(n,1);e!==null&&Ar(e,n,1,-1)}function xv(n){var e=Vr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:n},e.queue=n,n=n.dispatch=zA.bind(null,wt,n),[e.memoizedState,n]}function El(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function Pv(){return Zn().memoizedState}function Du(n,e,t,r){var a=Vr();wt.flags|=n,a.memoizedState=El(1|e,t,void 0,r===void 0?null:r)}function Lu(n,e,t,r){var a=Zn();r=r===void 0?null:r;var i=void 0;if(Dt!==null){var s=Dt.memoizedState;if(i=s.destroy,r!==null&&hm(r,s.deps)){a.memoizedState=El(e,t,i,r);return}}wt.flags|=n,a.memoizedState=El(1|e,t,i,r)}function Iv(n,e){return Du(8390656,8,n,e)}function ym(n,e){return Lu(2048,8,n,e)}function Dv(n,e){return Lu(4,2,n,e)}function Lv(n,e){return Lu(4,4,n,e)}function qv(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function $v(n,e,t){return t=t!=null?t.concat([n]):null,Lu(4,4,qv.bind(null,e,n),t)}function gm(){}function kv(n,e){var t=Zn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&hm(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function jv(n,e){var t=Zn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&hm(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Bv(n,e,t){return $i&21?(Er(t,e)||(t=db(),wt.lanes|=t,ki|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Nn=!0),n.memoizedState=t)}function FA(n,e){var t=nt;nt=t!==0&&4>t?t:4,n(!0);var r=um.transition;um.transition={};try{n(!1),e()}finally{nt=t,um.transition=r}}function Uv(){return Zn().memoizedState}function VA(n,e,t){var r=ni(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Fv(n))Vv(e,t);else if(t=dv(n,e,t,r),t!==null){var a=gn();Ar(t,n,r,a),zv(t,e,r)}}function zA(n,e,t){var r=ni(n),a={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Fv(n))Vv(e,a);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var s=e.lastRenderedState,o=i(s,t);if(a.hasEagerState=!0,a.eagerState=o,Er(o,s)){var l=e.interleaved;l===null?(a.next=a,nm(e)):(a.next=l.next,l.next=a),e.interleaved=a;return}}catch{}finally{}t=dv(n,e,a,r),t!==null&&(a=gn(),Ar(t,n,r,a),zv(t,e,r))}}function Fv(n){var e=n.alternate;return n===wt||e!==null&&e===wt}function Vv(n,e){gl=Iu=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function zv(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,gp(n,t)}}var qu={readContext:Xn,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},WA={readContext:Xn,useCallback:function(n,e){return Vr().memoizedState=[n,e===void 0?null:e],n},useContext:Xn,useEffect:Iv,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Du(4194308,4,qv.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Du(4194308,4,n,e)},useInsertionEffect:function(n,e){return Du(4,2,n,e)},useMemo:function(n,e){var t=Vr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Vr();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=VA.bind(null,wt,n),[r.memoizedState,n]},useRef:function(n){var e=Vr();return n={current:n},e.memoizedState=n},useState:xv,useDebugValue:gm,useDeferredValue:function(n){return Vr().memoizedState=n},useTransition:function(){var n=xv(!1),e=n[0];return n=FA.bind(null,n[1]),Vr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=wt,a=Vr();if(mt){if(t===void 0)throw Error(ce(407));t=t()}else{if(t=e(),Vt===null)throw Error(ce(349));$i&30||Sv(r,e,t)}a.memoizedState=t;var i={value:t,getSnapshot:e};return a.queue=i,Iv(Mv.bind(null,r,i,n),[n]),r.flags|=2048,El(9,Rv.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=Vr(),e=Vt.identifierPrefix;if(mt){var t=pa,r=da;t=(r&~(1<<32-vr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=bl++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=UA++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},HA={readContext:Xn,useCallback:kv,useContext:Xn,useEffect:ym,useImperativeHandle:$v,useInsertionEffect:Dv,useLayoutEffect:Lv,useMemo:jv,useReducer:mm,useRef:Pv,useState:function(){return mm(vl)},useDebugValue:gm,useDeferredValue:function(n){var e=Zn();return Bv(e,Dt.memoizedState,n)},useTransition:function(){var n=mm(vl)[0],e=Zn().memoizedState;return[n,e]},useMutableSource:Cv,useSyncExternalStore:Av,useId:Uv,unstable_isNewReconciler:!1},KA={readContext:Xn,useCallback:kv,useContext:Xn,useEffect:ym,useImperativeHandle:$v,useInsertionEffect:Dv,useLayoutEffect:Lv,useMemo:jv,useReducer:fm,useRef:Pv,useState:function(){return fm(vl)},useDebugValue:gm,useDeferredValue:function(n){var e=Zn();return Dt===null?e.memoizedState=n:Bv(e,Dt.memoizedState,n)},useTransition:function(){var n=fm(vl)[0],e=Zn().memoizedState;return[n,e]},useMutableSource:Cv,useSyncExternalStore:Av,useId:Uv,unstable_isNewReconciler:!1};function Fs(n,e){try{var t="",r=e;do t+=w1(r),r=r.return;while(r);var a=t}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:a,digest:null}}function bm(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function vm(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var QA=typeof WeakMap=="function"?WeakMap:Map;function Wv(n,e,t){t=fa(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Vu||(Vu=!0,Im=r),vm(n,e)},t}function Hv(n,e,t){t=fa(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;t.payload=function(){return r(a)},t.callback=function(){vm(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){vm(n,e),typeof r!="function"&&(ei===null?ei=new Set([this]):ei.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function Kv(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new QA;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(t)||(a.add(t),n=lS.bind(null,n,e,t),e.then(n,n))}function Qv(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Gv(n,e,t,r,a){return n.mode&1?(n.flags|=65536,n.lanes=a,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=fa(-1,1),e.tag=2,Xa(t,e,1))),t.lanes|=1),n)}var GA=ca.ReactCurrentOwner,Nn=!1;function yn(n,e,t,r){e.child=n===null?Tv(e,null,t,r):Bs(e,n.child,t,r)}function Yv(n,e,t,r,a){t=t.render;var i=e.ref;return js(e,a),r=dm(n,e,t,r,i,a),t=pm(),n!==null&&!Nn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~a,ya(n,e,a)):(mt&&t&&Kp(e),e.flags|=1,yn(n,e,r,a),e.child)}function Jv(n,e,t,r,a){if(n===null){var i=t.type;return typeof i=="function"&&!Bm(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,Xv(n,e,i,r,a)):(n=Gu(t.type,null,r,e,e.mode,a),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&a)){var s=i.memoizedProps;if(t=t.compare,t=t!==null?t:sl,t(s,r)&&n.ref===e.ref)return ya(n,e,a)}return e.flags|=1,n=ai(i,r),n.ref=e.ref,n.return=e,e.child=n}function Xv(n,e,t,r,a){if(n!==null){var i=n.memoizedProps;if(sl(i,r)&&n.ref===e.ref)if(Nn=!1,e.pendingProps=r=i,(n.lanes&a)!==0)n.flags&131072&&(Nn=!0);else return e.lanes=n.lanes,ya(n,e,a)}return Em(n,e,t,r,a)}function Zv(n,e,t){var r=e.pendingProps,a=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(zs,$n),$n|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ot(zs,$n),$n|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,ot(zs,$n),$n|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,ot(zs,$n),$n|=r;return yn(n,e,a,t),e.child}function eE(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Em(n,e,t,r,a){var i=Tn(t)?Pi:an.current;return i=Ds(e,i),js(e,a),t=dm(n,e,t,r,i,a),r=pm(),n!==null&&!Nn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~a,ya(n,e,a)):(mt&&r&&Kp(e),e.flags|=1,yn(n,e,t,a),e.child)}function tE(n,e,t,r,a){if(Tn(t)){var i=!0;Eu(e)}else i=!1;if(js(e,a),e.stateNode===null)ku(n,e),bv(e,t,r),im(e,t,r,a),r=!0;else if(n===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,c=t.contextType;typeof c=="object"&&c!==null?c=Xn(c):(c=Tn(t)?Pi:an.current,c=Ds(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==r||l!==c)&&vv(e,s,r,c),Ja=!1;var d=e.memoizedState;s.state=d,Mu(e,r,s,a),l=e.memoizedState,o!==r||d!==l||wn.current||Ja?(typeof u=="function"&&(am(e,t,u,r),l=e.memoizedState),(o=Ja||gv(e,t,o,r,d,l,c))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,pv(n,e),o=e.memoizedProps,c=e.type===e.elementType?o:Tr(e.type,o),s.props=c,h=e.pendingProps,d=s.context,l=t.contextType,typeof l=="object"&&l!==null?l=Xn(l):(l=Tn(t)?Pi:an.current,l=Ds(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||d!==l)&&vv(e,s,r,l),Ja=!1,d=e.memoizedState,s.state=d,Mu(e,r,s,a);var g=e.memoizedState;o!==h||d!==g||wn.current||Ja?(typeof f=="function"&&(am(e,t,f,r),g=e.memoizedState),(c=Ja||gv(e,t,c,r,d,g,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,g,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),s.props=r,s.state=g,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return wm(n,e,t,r,i,a)}function wm(n,e,t,r,a,i){eE(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return a&&iv(e,t,!1),ya(n,e,i);r=e.stateNode,GA.current=e;var o=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=Bs(e,n.child,null,i),e.child=Bs(e,null,o,i)):yn(n,e,o,i),e.memoizedState=r.state,a&&iv(e,t,!0),e.child}function nE(n){var e=n.stateNode;e.pendingContext?rv(n,e.pendingContext,e.pendingContext!==e.context):e.context&&rv(n,e.context,!1),sm(n,e.containerInfo)}function rE(n,e,t,r,a){return $s(),Jp(a),e.flags|=256,yn(n,e,t,r),e.child}var Tm={dehydrated:null,treeContext:null,retryLane:0};function Nm(n){return{baseLanes:n,cachePool:null,transitions:null}}function aE(n,e,t){var r=e.pendingProps,a=Et.current,i=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=n!==null&&n.memoizedState===null?!1:(a&2)!==0),o?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(a|=1),ot(Et,a&1),n===null)return Yp(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Yu(s,r,0,null),n=Fi(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Nm(t),e.memoizedState=Tm,n):Cm(e,s));if(a=n.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return YA(n,e,s,r,o,a,t);if(i){i=r.fallback,s=e.mode,a=n.child,o=a.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ai(a,l),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=ai(o,i):(i=Fi(i,s,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,s=n.child.memoizedState,s=s===null?Nm(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=n.childLanes&~t,e.memoizedState=Tm,r}return i=n.child,n=i.sibling,r=ai(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Cm(n,e){return e=Yu({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function $u(n,e,t,r){return r!==null&&Jp(r),Bs(e,n.child,null,t),n=Cm(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function YA(n,e,t,r,a,i,s){if(t)return e.flags&256?(e.flags&=-257,r=bm(Error(ce(422))),$u(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=Yu({mode:"visible",children:r.children},a,0,null),i=Fi(i,a,s,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Bs(e,n.child,null,s),e.child.memoizedState=Nm(s),e.memoizedState=Tm,i);if(!(e.mode&1))return $u(n,e,s,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(ce(419)),r=bm(i,r,void 0),$u(n,e,s,r)}if(o=(s&n.childLanes)!==0,Nn||o){if(r=Vt,r!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ma(n,a),Ar(r,n,a,-1))}return jm(),r=bm(Error(ce(421))),$u(n,e,s,r)}return a.data==="$?"?(e.flags|=128,e.child=n.child,e=cS.bind(null,n),a._reactRetry=e,null):(n=i.treeContext,qn=Ka(a.nextSibling),Ln=e,mt=!0,wr=null,n!==null&&(Yn[Jn++]=da,Yn[Jn++]=pa,Yn[Jn++]=Ii,da=n.id,pa=n.overflow,Ii=e),e=Cm(e,r.children),e.flags|=4096,e)}function iE(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),tm(n.return,e,t)}function Am(n,e,t,r,a){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=a)}function sE(n,e,t){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(yn(n,e,r.children,t),r=Et.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&iE(n,t,e);else if(n.tag===19)iE(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(ot(Et,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(t=e.child,a=null;t!==null;)n=t.alternate,n!==null&&xu(n)===null&&(a=t),t=t.sibling;t=a,t===null?(a=e.child,e.child=null):(a=t.sibling,t.sibling=null),Am(e,!1,a,t,i);break;case"backwards":for(t=null,a=e.child,e.child=null;a!==null;){if(n=a.alternate,n!==null&&xu(n)===null){e.child=a;break}n=a.sibling,a.sibling=t,t=a,a=n}Am(e,!0,t,null,i);break;case"together":Am(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ku(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ya(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ki|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ce(153));if(e.child!==null){for(n=e.child,t=ai(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ai(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function JA(n,e,t){switch(e.tag){case 3:nE(e),$s();break;case 5:Nv(e);break;case 1:Tn(e.type)&&Eu(e);break;case 4:sm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;ot(Au,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ot(Et,Et.current&1),e.flags|=128,null):t&e.child.childLanes?aE(n,e,t):(ot(Et,Et.current&1),n=ya(n,e,t),n!==null?n.sibling:null);ot(Et,Et.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return sE(n,e,t);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ot(Et,Et.current),r)break;return null;case 22:case 23:return e.lanes=0,Zv(n,e,t)}return ya(n,e,t)}var oE,Sm,lE,cE;oE=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}},Sm=function(){},lE=function(n,e,t,r){var a=n.memoizedProps;if(a!==r){n=e.stateNode,qi(Fr.current);var i=null;switch(t){case"input":a=tp(n,a),r=tp(n,r),i=[];break;case"select":a=vt({},a,{value:void 0}),r=vt({},r,{value:void 0}),i=[];break;case"textarea":a=ap(n,a),r=ap(n,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=gu)}sp(t,r);var s;t=null;for(c in a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(jo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(o=a==null?void 0:a[c],r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(jo.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ct("scroll",n),i||o===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}},cE=function(n,e,t,r){t!==r&&(e.flags|=4)};function wl(n,e){if(!mt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function on(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var a=n.child;a!==null;)t|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=n,a=a.sibling;else for(a=n.child;a!==null;)t|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=n,a=a.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function XA(n,e,t){var r=e.pendingProps;switch(Qp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(e),null;case 1:return Tn(e.type)&&vu(),on(e),null;case 3:return r=e.stateNode,Us(),ut(wn),ut(an),cm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Cu(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wr!==null&&(qm(wr),wr=null))),Sm(n,e),on(e),null;case 5:om(e);var a=qi(yl.current);if(t=e.type,n!==null&&e.stateNode!=null)lE(n,e,t,r,a),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ce(166));return on(e),null}if(n=qi(Fr.current),Cu(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Ur]=e,r[hl]=i,n=(e.mode&1)!==0,t){case"dialog":ct("cancel",r),ct("close",r);break;case"iframe":case"object":case"embed":ct("load",r);break;case"video":case"audio":for(a=0;a<ll.length;a++)ct(ll[a],r);break;case"source":ct("error",r);break;case"img":case"image":case"link":ct("error",r),ct("load",r);break;case"details":ct("toggle",r);break;case"input":Fg(r,i),ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ct("invalid",r);break;case"textarea":Wg(r,i),ct("invalid",r)}sp(t,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&yu(r.textContent,o,n),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&yu(r.textContent,o,n),a=["children",""+o]):jo.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&ct("scroll",r)}switch(t){case"input":Kc(r),zg(r,i,!0);break;case"textarea":Kc(r),Kg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=gu)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Qg(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[Ur]=e,n[hl]=r,oE(n,e,!1,!1),e.stateNode=n;e:{switch(s=op(t,r),t){case"dialog":ct("cancel",n),ct("close",n),a=r;break;case"iframe":case"object":case"embed":ct("load",n),a=r;break;case"video":case"audio":for(a=0;a<ll.length;a++)ct(ll[a],n);a=r;break;case"source":ct("error",n),a=r;break;case"img":case"image":case"link":ct("error",n),ct("load",n),a=r;break;case"details":ct("toggle",n),a=r;break;case"input":Fg(n,r),a=tp(n,r),ct("invalid",n);break;case"option":a=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},a=vt({},r,{value:void 0}),ct("invalid",n);break;case"textarea":Wg(n,r),a=ap(n,r),ct("invalid",n);break;default:a=r}sp(t,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?Jg(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Gg(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Vo(n,l):typeof l=="number"&&Vo(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(jo.hasOwnProperty(i)?l!=null&&i==="onScroll"&&ct("scroll",n):l!=null&&zd(n,i,l,s))}switch(t){case"input":Kc(n),zg(n,r,!1);break;case"textarea":Kc(n),Kg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Ba(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Ts(n,!!r.multiple,i,!1):r.defaultValue!=null&&Ts(n,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(n.onclick=gu)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return on(e),null;case 6:if(n&&e.stateNode!=null)cE(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ce(166));if(t=qi(yl.current),qi(Fr.current),Cu(e)){if(r=e.stateNode,t=e.memoizedProps,r[Ur]=e,(i=r.nodeValue!==t)&&(n=Ln,n!==null))switch(n.tag){case 3:yu(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&yu(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return on(e),null;case 13:if(ut(Et),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(mt&&qn!==null&&e.mode&1&&!(e.flags&128))hv(),$s(),e.flags|=98560,i=!1;else if(i=Cu(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(ce(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[Ur]=e}else $s(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;on(e),i=!1}else wr!==null&&(qm(wr),wr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Et.current&1?Lt===0&&(Lt=3):jm())),e.updateQueue!==null&&(e.flags|=4),on(e),null);case 4:return Us(),Sm(n,e),n===null&&cl(e.stateNode.containerInfo),on(e),null;case 10:return em(e.type._context),on(e),null;case 17:return Tn(e.type)&&vu(),on(e),null;case 19:if(ut(Et),i=e.memoizedState,i===null)return on(e),null;if(r=(e.flags&128)!==0,s=i.rendering,s===null)if(r)wl(i,!1);else{if(Lt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=xu(n),s!==null){for(e.flags|=128,wl(i,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,n=s.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ot(Et,Et.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ot()>Ws&&(e.flags|=128,r=!0,wl(i,!1),e.lanes=4194304)}else{if(!r)if(n=xu(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),wl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!mt)return on(e),null}else 2*Ot()-i.renderingStartTime>Ws&&t!==1073741824&&(e.flags|=128,r=!0,wl(i,!1),e.lanes=4194304);i.isBackwards?(s.sibling=e.child,e.child=s):(t=i.last,t!==null?t.sibling=s:e.child=s,i.last=s)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ot(),e.sibling=null,t=Et.current,ot(Et,r?t&1|2:t&1),e):(on(e),null);case 22:case 23:return km(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?$n&1073741824&&(on(e),e.subtreeFlags&6&&(e.flags|=8192)):on(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function ZA(n,e){switch(Qp(e),e.tag){case 1:return Tn(e.type)&&vu(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Us(),ut(wn),ut(an),cm(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return om(e),null;case 13:if(ut(Et),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));$s()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return ut(Et),null;case 4:return Us(),null;case 10:return em(e.type._context),null;case 22:case 23:return km(),null;case 24:return null;default:return null}}var ju=!1,ln=!1,eS=typeof WeakSet=="function"?WeakSet:Set,we=null;function Vs(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Nt(n,e,r)}else t.current=null}function uE(n,e,t){try{t()}catch(r){Nt(n,e,r)}}var hE=!1;function tS(n,e){if(jp=iu,n=Ub(),xp(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var s=0,o=-1,l=-1,c=0,u=0,h=n,d=null;t:for(;;){for(var f;h!==t||a!==0&&h.nodeType!==3||(o=s+a),h!==i||r!==0&&h.nodeType!==3||(l=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++c===a&&(o=s),d===i&&++u===r&&(l=s),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Bp={focusedElem:n,selectionRange:t},iu=!1,we=e;we!==null;)if(e=we,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,we=n;else for(;we!==null;){e=we;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,C=g.memoizedState,w=e.stateNode,T=w.getSnapshotBeforeUpdate(e.elementType===e.type?v:Tr(e.type,v),C);w.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(O){Nt(e,e.return,O)}if(n=e.sibling,n!==null){n.return=e.return,we=n;break}we=e.return}return g=hE,hE=!1,g}function Tl(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&n)===n){var i=a.destroy;a.destroy=void 0,i!==void 0&&uE(e,t,i)}a=a.next}while(a!==r)}}function Bu(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Rm(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function dE(n){var e=n.alternate;e!==null&&(n.alternate=null,dE(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ur],delete e[hl],delete e[zp],delete e[$A],delete e[kA])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function pE(n){return n.tag===5||n.tag===3||n.tag===4}function mE(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||pE(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Mm(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=gu));else if(r!==4&&(n=n.child,n!==null))for(Mm(n,e,t),n=n.sibling;n!==null;)Mm(n,e,t),n=n.sibling}function Om(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Om(n,e,t),n=n.sibling;n!==null;)Om(n,e,t),n=n.sibling}var Yt=null,Nr=!1;function Za(n,e,t){for(t=t.child;t!==null;)fE(n,e,t),t=t.sibling}function fE(n,e,t){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Zc,t)}catch{}switch(t.tag){case 5:ln||Vs(t,e);case 6:var r=Yt,a=Nr;Yt=null,Za(n,e,t),Yt=r,Nr=a,Yt!==null&&(Nr?(n=Yt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Yt.removeChild(t.stateNode));break;case 18:Yt!==null&&(Nr?(n=Yt,t=t.stateNode,n.nodeType===8?Vp(n.parentNode,t):n.nodeType===1&&Vp(n,t),el(n)):Vp(Yt,t.stateNode));break;case 4:r=Yt,a=Nr,Yt=t.stateNode.containerInfo,Nr=!0,Za(n,e,t),Yt=r,Nr=a;break;case 0:case 11:case 14:case 15:if(!ln&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&uE(t,e,s),a=a.next}while(a!==r)}Za(n,e,t);break;case 1:if(!ln&&(Vs(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Nt(t,e,o)}Za(n,e,t);break;case 21:Za(n,e,t);break;case 22:t.mode&1?(ln=(r=ln)||t.memoizedState!==null,Za(n,e,t),ln=r):Za(n,e,t);break;default:Za(n,e,t)}}function yE(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new eS),e.forEach(function(r){var a=uS.bind(null,n,r);t.has(r)||(t.add(r),r.then(a,a))})}}function Cr(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];try{var i=n,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:Yt=o.stateNode,Nr=!1;break e;case 3:Yt=o.stateNode.containerInfo,Nr=!0;break e;case 4:Yt=o.stateNode.containerInfo,Nr=!0;break e}o=o.return}if(Yt===null)throw Error(ce(160));fE(i,s,a),Yt=null,Nr=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Nt(a,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gE(e,n),e=e.sibling}function gE(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Cr(e,n),zr(n),r&4){try{Tl(3,n,n.return),Bu(3,n)}catch(v){Nt(n,n.return,v)}try{Tl(5,n,n.return)}catch(v){Nt(n,n.return,v)}}break;case 1:Cr(e,n),zr(n),r&512&&t!==null&&Vs(t,t.return);break;case 5:if(Cr(e,n),zr(n),r&512&&t!==null&&Vs(t,t.return),n.flags&32){var a=n.stateNode;try{Vo(a,"")}catch(v){Nt(n,n.return,v)}}if(r&4&&(a=n.stateNode,a!=null)){var i=n.memoizedProps,s=t!==null?t.memoizedProps:i,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Vg(a,i),op(o,s);var c=op(o,i);for(s=0;s<l.length;s+=2){var u=l[s],h=l[s+1];u==="style"?Jg(a,h):u==="dangerouslySetInnerHTML"?Gg(a,h):u==="children"?Vo(a,h):zd(a,u,h,c)}switch(o){case"input":np(a,i);break;case"textarea":Hg(a,i);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ts(a,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?Ts(a,!!i.multiple,i.defaultValue,!0):Ts(a,!!i.multiple,i.multiple?[]:"",!1))}a[hl]=i}catch(v){Nt(n,n.return,v)}}break;case 6:if(Cr(e,n),zr(n),r&4){if(n.stateNode===null)throw Error(ce(162));a=n.stateNode,i=n.memoizedProps;try{a.nodeValue=i}catch(v){Nt(n,n.return,v)}}break;case 3:if(Cr(e,n),zr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{el(e.containerInfo)}catch(v){Nt(n,n.return,v)}break;case 4:Cr(e,n),zr(n);break;case 13:Cr(e,n),zr(n),a=n.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Pm=Ot())),r&4&&yE(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(ln=(c=ln)||u,Cr(e,n),ln=c):Cr(e,n),zr(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(we=n,u=n.child;u!==null;){for(h=we=u;we!==null;){switch(d=we,f=d.child,d.tag){case 0:case 11:case 14:case 15:Tl(4,d,d.return);break;case 1:Vs(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){Nt(r,t,v)}}break;case 5:Vs(d,d.return);break;case 22:if(d.memoizedState!==null){EE(h);continue}}f!==null?(f.return=d,we=f):EE(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Yg("display",s))}catch(v){Nt(n,n.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Nt(n,n.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Cr(e,n),zr(n),r&4&&yE(n);break;case 21:break;default:Cr(e,n),zr(n)}}function zr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(pE(t)){var r=t;break e}t=t.return}throw Error(ce(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Vo(a,""),r.flags&=-33);var i=mE(n);Om(n,i,a);break;case 3:case 4:var s=r.stateNode.containerInfo,o=mE(n);Mm(n,o,s);break;default:throw Error(ce(161))}}catch(l){Nt(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function nS(n,e,t){we=n,bE(n)}function bE(n,e,t){for(var r=(n.mode&1)!==0;we!==null;){var a=we,i=a.child;if(a.tag===22&&r){var s=a.memoizedState!==null||ju;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||ln;o=ju;var c=ln;if(ju=s,(ln=l)&&!c)for(we=a;we!==null;)s=we,l=s.child,s.tag===22&&s.memoizedState!==null?wE(a):l!==null?(l.return=s,we=l):wE(a);for(;i!==null;)we=i,bE(i),i=i.sibling;we=a,ju=o,ln=c}vE(n)}else a.subtreeFlags&8772&&i!==null?(i.return=a,we=i):vE(n)}}function vE(n){for(;we!==null;){var e=we;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ln||Bu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ln)if(t===null)r.componentDidMount();else{var a=e.elementType===e.type?t.memoizedProps:Tr(e.type,t.memoizedProps);r.componentDidUpdate(a,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&fv(e,i,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}fv(e,s,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&el(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}ln||e.flags&512&&Rm(e)}catch(d){Nt(e,e.return,d)}}if(e===n){we=null;break}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}}function EE(n){for(;we!==null;){var e=we;if(e===n){we=null;break}var t=e.sibling;if(t!==null){t.return=e.return,we=t;break}we=e.return}}function wE(n){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Bu(4,e)}catch(l){Nt(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(l){Nt(e,a,l)}}var i=e.return;try{Rm(e)}catch(l){Nt(e,i,l)}break;case 5:var s=e.return;try{Rm(e)}catch(l){Nt(e,s,l)}}}catch(l){Nt(e,e.return,l)}if(e===n){we=null;break}var o=e.sibling;if(o!==null){o.return=e.return,we=o;break}we=e.return}}var rS=Math.ceil,Uu=ca.ReactCurrentDispatcher,_m=ca.ReactCurrentOwner,er=ca.ReactCurrentBatchConfig,Xe=0,Vt=null,Pt=null,Jt=0,$n=0,zs=Qa(0),Lt=0,Nl=null,ki=0,Fu=0,xm=0,Cl=null,Cn=null,Pm=0,Ws=1/0,ga=null,Vu=!1,Im=null,ei=null,zu=!1,ti=null,Wu=0,Al=0,Dm=null,Hu=-1,Ku=0;function gn(){return Xe&6?Ot():Hu!==-1?Hu:Hu=Ot()}function ni(n){return n.mode&1?Xe&2&&Jt!==0?Jt&-Jt:BA.transition!==null?(Ku===0&&(Ku=db()),Ku):(n=nt,n!==0||(n=window.event,n=n===void 0?16:wb(n.type)),n):1}function Ar(n,e,t,r){if(50<Al)throw Al=0,Dm=null,Error(ce(185));Go(n,t,r),(!(Xe&2)||n!==Vt)&&(n===Vt&&(!(Xe&2)&&(Fu|=t),Lt===4&&ri(n,Jt)),An(n,r),t===1&&Xe===0&&!(e.mode&1)&&(Ws=Ot()+500,wu&&Ya()))}function An(n,e){var t=n.callbackNode;B1(n,e);var r=nu(n,n===Vt?Jt:0);if(r===0)t!==null&&cb(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&cb(t),e===1)n.tag===0?jA(NE.bind(null,n)):sv(NE.bind(null,n)),LA(function(){!(Xe&6)&&Ya()}),t=null;else{switch(pb(r)){case 1:t=mp;break;case 4:t=ub;break;case 16:t=Xc;break;case 536870912:t=hb;break;default:t=Xc}t=xE(t,TE.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function TE(n,e){if(Hu=-1,Ku=0,Xe&6)throw Error(ce(327));var t=n.callbackNode;if(Hs()&&n.callbackNode!==t)return null;var r=nu(n,n===Vt?Jt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Qu(n,r);else{e=r;var a=Xe;Xe|=2;var i=AE();(Vt!==n||Jt!==e)&&(ga=null,Ws=Ot()+500,Bi(n,e));do try{sS();break}catch(o){CE(n,o)}while(!0);Zp(),Uu.current=i,Xe=a,Pt!==null?e=0:(Vt=null,Jt=0,e=Lt)}if(e!==0){if(e===2&&(a=fp(n),a!==0&&(r=a,e=Lm(n,a))),e===1)throw t=Nl,Bi(n,0),ri(n,r),An(n,Ot()),t;if(e===6)ri(n,r);else{if(a=n.current.alternate,!(r&30)&&!aS(a)&&(e=Qu(n,r),e===2&&(i=fp(n),i!==0&&(r=i,e=Lm(n,i))),e===1))throw t=Nl,Bi(n,0),ri(n,r),An(n,Ot()),t;switch(n.finishedWork=a,n.finishedLanes=r,e){case 0:case 1:throw Error(ce(345));case 2:Ui(n,Cn,ga);break;case 3:if(ri(n,r),(r&130023424)===r&&(e=Pm+500-Ot(),10<e)){if(nu(n,0)!==0)break;if(a=n.suspendedLanes,(a&r)!==r){gn(),n.pingedLanes|=n.suspendedLanes&a;break}n.timeoutHandle=Fp(Ui.bind(null,n,Cn,ga),e);break}Ui(n,Cn,ga);break;case 4:if(ri(n,r),(r&4194240)===r)break;for(e=n.eventTimes,a=-1;0<r;){var s=31-vr(r);i=1<<s,s=e[s],s>a&&(a=s),r&=~i}if(r=a,r=Ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*rS(r/1960))-r,10<r){n.timeoutHandle=Fp(Ui.bind(null,n,Cn,ga),r);break}Ui(n,Cn,ga);break;case 5:Ui(n,Cn,ga);break;default:throw Error(ce(329))}}}return An(n,Ot()),n.callbackNode===t?TE.bind(null,n):null}function Lm(n,e){var t=Cl;return n.current.memoizedState.isDehydrated&&(Bi(n,e).flags|=256),n=Qu(n,e),n!==2&&(e=Cn,Cn=t,e!==null&&qm(e)),n}function qm(n){Cn===null?Cn=n:Cn.push.apply(Cn,n)}function aS(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var a=t[r],i=a.getSnapshot;a=a.value;try{if(!Er(i(),a))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ri(n,e){for(e&=~xm,e&=~Fu,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-vr(e),r=1<<t;n[t]=-1,e&=~r}}function NE(n){if(Xe&6)throw Error(ce(327));Hs();var e=nu(n,0);if(!(e&1))return An(n,Ot()),null;var t=Qu(n,e);if(n.tag!==0&&t===2){var r=fp(n);r!==0&&(e=r,t=Lm(n,r))}if(t===1)throw t=Nl,Bi(n,0),ri(n,e),An(n,Ot()),t;if(t===6)throw Error(ce(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ui(n,Cn,ga),An(n,Ot()),null}function $m(n,e){var t=Xe;Xe|=1;try{return n(e)}finally{Xe=t,Xe===0&&(Ws=Ot()+500,wu&&Ya())}}function ji(n){ti!==null&&ti.tag===0&&!(Xe&6)&&Hs();var e=Xe;Xe|=1;var t=er.transition,r=nt;try{if(er.transition=null,nt=1,n)return n()}finally{nt=r,er.transition=t,Xe=e,!(Xe&6)&&Ya()}}function km(){$n=zs.current,ut(zs)}function Bi(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,DA(t)),Pt!==null)for(t=Pt.return;t!==null;){var r=t;switch(Qp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vu();break;case 3:Us(),ut(wn),ut(an),cm();break;case 5:om(r);break;case 4:Us();break;case 13:ut(Et);break;case 19:ut(Et);break;case 10:em(r.type._context);break;case 22:case 23:km()}t=t.return}if(Vt=n,Pt=n=ai(n.current,null),Jt=$n=e,Lt=0,Nl=null,xm=Fu=ki=0,Cn=Cl=null,Li!==null){for(e=0;e<Li.length;e++)if(t=Li[e],r=t.interleaved,r!==null){t.interleaved=null;var a=r.next,i=t.pending;if(i!==null){var s=i.next;i.next=a,r.next=s}t.pending=r}Li=null}return n}function CE(n,e){do{var t=Pt;try{if(Zp(),Pu.current=qu,Iu){for(var r=wt.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Iu=!1}if($i=0,Ft=Dt=wt=null,gl=!1,bl=0,_m.current=null,t===null||t.return===null){Lt=1,Nl=e,Pt=null;break}e:{var i=n,s=t.return,o=t,l=e;if(e=Jt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Qv(s);if(f!==null){f.flags&=-257,Gv(f,s,o,i,e),f.mode&1&&Kv(i,c,e),e=f,l=c;var g=e.updateQueue;if(g===null){var v=new Set;v.add(l),e.updateQueue=v}else g.add(l);break e}else{if(!(e&1)){Kv(i,c,e),jm();break e}l=Error(ce(426))}}else if(mt&&o.mode&1){var C=Qv(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Gv(C,s,o,i,e),Jp(Fs(l,o));break e}}i=l=Fs(l,o),Lt!==4&&(Lt=2),Cl===null?Cl=[i]:Cl.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=Wv(i,l,e);mv(i,w);break e;case 1:o=l;var T=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ei===null||!ei.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var O=Hv(i,o,e);mv(i,O);break e}}i=i.return}while(i!==null)}RE(t)}catch(k){e=k,Pt===t&&t!==null&&(Pt=t=t.return);continue}break}while(!0)}function AE(){var n=Uu.current;return Uu.current=qu,n===null?qu:n}function jm(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),Vt===null||!(ki&268435455)&&!(Fu&268435455)||ri(Vt,Jt)}function Qu(n,e){var t=Xe;Xe|=2;var r=AE();(Vt!==n||Jt!==e)&&(ga=null,Bi(n,e));do try{iS();break}catch(a){CE(n,a)}while(!0);if(Zp(),Xe=t,Uu.current=r,Pt!==null)throw Error(ce(261));return Vt=null,Jt=0,Lt}function iS(){for(;Pt!==null;)SE(Pt)}function sS(){for(;Pt!==null&&!x1();)SE(Pt)}function SE(n){var e=_E(n.alternate,n,$n);n.memoizedProps=n.pendingProps,e===null?RE(n):Pt=e,_m.current=null}function RE(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=ZA(t,e),t!==null){t.flags&=32767,Pt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Lt=6,Pt=null;return}}else if(t=XA(t,e,$n),t!==null){Pt=t;return}if(e=e.sibling,e!==null){Pt=e;return}Pt=e=n}while(e!==null);Lt===0&&(Lt=5)}function Ui(n,e,t){var r=nt,a=er.transition;try{er.transition=null,nt=1,oS(n,e,t,r)}finally{er.transition=a,nt=r}return null}function oS(n,e,t,r){do Hs();while(ti!==null);if(Xe&6)throw Error(ce(327));t=n.finishedWork;var a=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ce(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(U1(n,i),n===Vt&&(Pt=Vt=null,Jt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||zu||(zu=!0,xE(Xc,function(){return Hs(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=er.transition,er.transition=null;var s=nt;nt=1;var o=Xe;Xe|=4,_m.current=null,tS(n,t),gE(t,n),RA(Bp),iu=!!jp,Bp=jp=null,n.current=t,nS(t),P1(),Xe=o,nt=s,er.transition=i}else n.current=t;if(zu&&(zu=!1,ti=n,Wu=a),i=n.pendingLanes,i===0&&(ei=null),L1(t.stateNode),An(n,Ot()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)a=e[t],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vu)throw Vu=!1,n=Im,Im=null,n;return Wu&1&&n.tag!==0&&Hs(),i=n.pendingLanes,i&1?n===Dm?Al++:(Al=0,Dm=n):Al=0,Ya(),null}function Hs(){if(ti!==null){var n=pb(Wu),e=er.transition,t=nt;try{if(er.transition=null,nt=16>n?16:n,ti===null)var r=!1;else{if(n=ti,ti=null,Wu=0,Xe&6)throw Error(ce(331));var a=Xe;for(Xe|=4,we=n.current;we!==null;){var i=we,s=i.child;if(we.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(we=c;we!==null;){var u=we;switch(u.tag){case 0:case 11:case 15:Tl(8,u,i)}var h=u.child;if(h!==null)h.return=u,we=h;else for(;we!==null;){u=we;var d=u.sibling,f=u.return;if(dE(u),u===c){we=null;break}if(d!==null){d.return=f,we=d;break}we=f}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var C=v.sibling;v.sibling=null,v=C}while(v!==null)}}we=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,we=s;else e:for(;we!==null;){if(i=we,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Tl(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,we=w;break e}we=i.return}}var T=n.current;for(we=T;we!==null;){s=we;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,we=S;else e:for(s=T;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Bu(9,o)}}catch(k){Nt(o,o.return,k)}if(o===s){we=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,we=O;break e}we=o.return}}if(Xe=a,Ya(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Zc,n)}catch{}r=!0}return r}finally{nt=t,er.transition=e}}return!1}function ME(n,e,t){e=Fs(t,e),e=Wv(n,e,1),n=Xa(n,e,1),e=gn(),n!==null&&(Go(n,1,e),An(n,e))}function Nt(n,e,t){if(n.tag===3)ME(n,n,t);else for(;e!==null;){if(e.tag===3){ME(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ei===null||!ei.has(r))){n=Fs(t,n),n=Hv(e,n,1),e=Xa(e,n,1),n=gn(),e!==null&&(Go(e,1,n),An(e,n));break}}e=e.return}}function lS(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=gn(),n.pingedLanes|=n.suspendedLanes&t,Vt===n&&(Jt&t)===t&&(Lt===4||Lt===3&&(Jt&130023424)===Jt&&500>Ot()-Pm?Bi(n,0):xm|=t),An(n,e)}function OE(n,e){e===0&&(n.mode&1?(e=tu,tu<<=1,!(tu&130023424)&&(tu=4194304)):e=1);var t=gn();n=ma(n,e),n!==null&&(Go(n,e,t),An(n,t))}function cS(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),OE(n,t)}function uS(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,a=n.memoizedState;a!==null&&(t=a.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(e),OE(n,t)}var _E;_E=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||wn.current)Nn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Nn=!1,JA(n,e,t);Nn=!!(n.flags&131072)}else Nn=!1,mt&&e.flags&1048576&&ov(e,Nu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ku(n,e),n=e.pendingProps;var a=Ds(e,an.current);js(e,t),a=dm(null,e,r,n,a,t);var i=pm();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(i=!0,Eu(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,rm(e),a.updater=Ou,e.stateNode=a,a._reactInternals=e,im(e,r,n,t),e=wm(null,e,r,!0,i,t)):(e.tag=0,mt&&i&&Kp(e),yn(null,e,a,t),e=e.child),e;case 16:r=e.elementType;e:{switch(ku(n,e),n=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=dS(r),n=Tr(r,n),a){case 0:e=Em(null,e,r,n,t);break e;case 1:e=tE(null,e,r,n,t);break e;case 11:e=Yv(null,e,r,n,t);break e;case 14:e=Jv(null,e,r,Tr(r.type,n),t);break e}throw Error(ce(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Tr(r,a),Em(n,e,r,a,t);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Tr(r,a),tE(n,e,r,a,t);case 3:e:{if(nE(e),n===null)throw Error(ce(387));r=e.pendingProps,i=e.memoizedState,a=i.element,pv(n,e),Mu(e,r,null,t);var s=e.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=Fs(Error(ce(423)),e),e=rE(n,e,r,t,a);break e}else if(r!==a){a=Fs(Error(ce(424)),e),e=rE(n,e,r,t,a);break e}else for(qn=Ka(e.stateNode.containerInfo.firstChild),Ln=e,mt=!0,wr=null,t=Tv(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if($s(),r===a){e=ya(n,e,t);break e}yn(n,e,r,t)}e=e.child}return e;case 5:return Nv(e),n===null&&Yp(e),r=e.type,a=e.pendingProps,i=n!==null?n.memoizedProps:null,s=a.children,Up(r,a)?s=null:i!==null&&Up(r,i)&&(e.flags|=32),eE(n,e),yn(n,e,s,t),e.child;case 6:return n===null&&Yp(e),null;case 13:return aE(n,e,t);case 4:return sm(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Bs(e,null,r,t):yn(n,e,r,t),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Tr(r,a),Yv(n,e,r,a,t);case 7:return yn(n,e,e.pendingProps,t),e.child;case 8:return yn(n,e,e.pendingProps.children,t),e.child;case 12:return yn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,s=a.value,ot(Au,r._currentValue),r._currentValue=s,i!==null)if(Er(i.value,s)){if(i.children===a.children&&!wn.current){e=ya(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=fa(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),tm(i.return,t,e),o.lanes|=t;break}l=l.next}}else if(i.tag===10)s=i.type===e.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(ce(341));s.lanes|=t,o=s.alternate,o!==null&&(o.lanes|=t),tm(s,t,e),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}yn(n,e,a.children,t),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,js(e,t),a=Xn(a),r=r(a),e.flags|=1,yn(n,e,r,t),e.child;case 14:return r=e.type,a=Tr(r,e.pendingProps),a=Tr(r.type,a),Jv(n,e,r,a,t);case 15:return Xv(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Tr(r,a),ku(n,e),e.tag=1,Tn(r)?(n=!0,Eu(e)):n=!1,js(e,t),bv(e,r,a),im(e,r,a,t),wm(null,e,r,!0,n,t);case 19:return sE(n,e,t);case 22:return Zv(n,e,t)}throw Error(ce(156,e.tag))};function xE(n,e){return lb(n,e)}function hS(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tr(n,e,t,r){return new hS(n,e,t,r)}function Bm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function dS(n){if(typeof n=="function")return Bm(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Kd)return 11;if(n===Yd)return 14}return 2}function ai(n,e){var t=n.alternate;return t===null?(t=tr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gu(n,e,t,r,a,i){var s=2;if(r=n,typeof n=="function")Bm(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case ws:return Fi(t.children,a,i,e);case Wd:s=8,a|=8;break;case Hd:return n=tr(12,t,e,a|2),n.elementType=Hd,n.lanes=i,n;case Qd:return n=tr(13,t,e,a),n.elementType=Qd,n.lanes=i,n;case Gd:return n=tr(19,t,e,a),n.elementType=Gd,n.lanes=i,n;case kg:return Yu(t,a,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case qg:s=10;break e;case $g:s=9;break e;case Kd:s=11;break e;case Yd:s=14;break e;case ja:s=16,r=null;break e}throw Error(ce(130,n==null?n:typeof n,""))}return e=tr(s,t,e,a),e.elementType=n,e.type=r,e.lanes=i,e}function Fi(n,e,t,r){return n=tr(7,n,r,e),n.lanes=t,n}function Yu(n,e,t,r){return n=tr(22,n,r,e),n.elementType=kg,n.lanes=t,n.stateNode={isHidden:!1},n}function Um(n,e,t){return n=tr(6,n,null,e),n.lanes=t,n}function Fm(n,e,t){return e=tr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function pS(n,e,t,r,a){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yp(0),this.expirationTimes=yp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yp(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vm(n,e,t,r,a,i,s,o,l){return n=new pS(n,e,t,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=tr(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},rm(i),n}function mS(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Es,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function PE(n){if(!n)return Ga;n=n._reactInternals;e:{if(_i(n)!==n||n.tag!==1)throw Error(ce(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(n.tag===1){var t=n.type;if(Tn(t))return av(n,t,e)}return e}function IE(n,e,t,r,a,i,s,o,l){return n=Vm(t,r,!0,n,a,i,s,o,l),n.context=PE(null),t=n.current,r=gn(),a=ni(t),i=fa(r,a),i.callback=e??null,Xa(t,i,a),n.current.lanes=a,Go(n,a,r),An(n,r),n}function Ju(n,e,t,r){var a=e.current,i=gn(),s=ni(a);return t=PE(t),e.context===null?e.context=t:e.pendingContext=t,e=fa(i,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Xa(a,e,s),n!==null&&(Ar(n,a,s,i),Ru(n,a,s)),s}function Xu(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function DE(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function zm(n,e){DE(n,e),(n=n.alternate)&&DE(n,e)}function fS(){return null}var LE=typeof reportError=="function"?reportError:function(n){console.error(n)};function Wm(n){this._internalRoot=n}Zu.prototype.render=Wm.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ce(409));Ju(n,e,null,null)},Zu.prototype.unmount=Wm.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ji(function(){Ju(null,n,null,null)}),e[ua]=null}};function Zu(n){this._internalRoot=n}Zu.prototype.unstable_scheduleHydration=function(n){if(n){var e=yb();n={blockedOn:null,target:n,priority:e};for(var t=0;t<za.length&&e!==0&&e<za[t].priority;t++);za.splice(t,0,n),t===0&&vb(n)}};function Hm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function eh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function qE(){}function yS(n,e,t,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var c=Xu(s);i.call(c)}}var s=IE(e,r,n,0,null,!1,!1,"",qE);return n._reactRootContainer=s,n[ua]=s.current,cl(n.nodeType===8?n.parentNode:n),ji(),s}for(;a=n.lastChild;)n.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var c=Xu(l);o.call(c)}}var l=Vm(n,0,!1,null,null,!1,!1,"",qE);return n._reactRootContainer=l,n[ua]=l.current,cl(n.nodeType===8?n.parentNode:n),ji(function(){Ju(e,l,t,r)}),l}function th(n,e,t,r,a){var i=t._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=Xu(s);o.call(l)}}Ju(e,s,n,a)}else s=yS(t,e,n,a,r);return Xu(s)}mb=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Qo(e.pendingLanes);t!==0&&(gp(e,t|1),An(e,Ot()),!(Xe&6)&&(Ws=Ot()+500,Ya()))}break;case 13:ji(function(){var r=ma(n,1);if(r!==null){var a=gn();Ar(r,n,1,a)}}),zm(n,1)}},bp=function(n){if(n.tag===13){var e=ma(n,134217728);if(e!==null){var t=gn();Ar(e,n,134217728,t)}zm(n,134217728)}},fb=function(n){if(n.tag===13){var e=ni(n),t=ma(n,e);if(t!==null){var r=gn();Ar(t,n,e,r)}zm(n,e)}},yb=function(){return nt},gb=function(n,e){var t=nt;try{return nt=n,e()}finally{nt=t}},up=function(n,e,t){switch(e){case"input":if(np(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var a=bu(r);if(!a)throw Error(ce(90));Ug(r),np(r,a)}}}break;case"textarea":Hg(n,t);break;case"select":e=t.value,e!=null&&Ts(n,!!t.multiple,e,!1)}},tb=$m,nb=ji;var gS={usingClientEntryPoint:!1,Events:[dl,Ps,bu,Zg,eb,$m]},Sl={findFiberByHostInstance:xi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},bS={bundleType:Sl.bundleType,version:Sl.version,rendererPackageName:Sl.rendererPackageName,rendererConfig:Sl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ca.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=sb(n),n===null?null:n.stateNode},findFiberByHostInstance:Sl.findFiberByHostInstance||fS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nh.isDisabled&&nh.supportsFiber)try{Zc=nh.inject(bS),Br=nh}catch{}}Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gS,Pn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hm(e))throw Error(ce(200));return mS(n,e,null,t)},Pn.createRoot=function(n,e){if(!Hm(n))throw Error(ce(299));var t=!1,r="",a=LE;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Vm(n,1,!1,null,null,t,!1,r,a),n[ua]=e.current,cl(n.nodeType===8?n.parentNode:n),new Wm(e)},Pn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ce(188)):(n=Object.keys(n).join(","),Error(ce(268,n)));return n=sb(e),n=n===null?null:n.stateNode,n},Pn.flushSync=function(n){return ji(n)},Pn.hydrate=function(n,e,t){if(!eh(e))throw Error(ce(200));return th(null,n,e,!0,t)},Pn.hydrateRoot=function(n,e,t){if(!Hm(n))throw Error(ce(405));var r=t!=null&&t.hydratedSources||null,a=!1,i="",s=LE;if(t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=IE(e,null,n,1,t??null,a,!1,i,s),n[ua]=e.current,cl(n),r)for(n=0;n<r.length;n++)t=r[n],a=t._getVersion,a=a(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,a]:e.mutableSourceEagerHydrationData.push(t,a);return new Zu(e)},Pn.render=function(n,e,t){if(!eh(e))throw Error(ce(200));return th(null,n,e,!1,t)},Pn.unmountComponentAtNode=function(n){if(!eh(n))throw Error(ce(40));return n._reactRootContainer?(ji(function(){th(null,null,n,!1,function(){n._reactRootContainer=null,n[ua]=null})}),!0):!1},Pn.unstable_batchedUpdates=$m,Pn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!eh(t))throw Error(ce(200));if(n==null||n._reactInternals===void 0)throw Error(ce(38));return th(n,e,t,!1,r)},Pn.version="18.2.0-next-9e3b772b8-20220608";function $E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($E)}catch(n){console.error(n)}}$E(),Og.exports=Pn;var Rl=Og.exports,kE=Rl;Bd.createRoot=kE.createRoot,Bd.hydrateRoot=kE.hydrateRoot;/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var jE;(function(n){(function(e){var t=typeof globalThis=="object"?globalThis:typeof Uc=="object"?Uc:typeof self=="object"?self:typeof this=="object"?this:o(),r=a(n);typeof t.Reflect<"u"&&(r=a(t.Reflect,r)),e(r,t),typeof t.Reflect>"u"&&(t.Reflect=n);function a(l,c){return function(u,h){Object.defineProperty(l,u,{configurable:!0,writable:!0,value:h}),c&&c(u,h)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function o(){return i()||s()}})(function(e,t){var r=Object.prototype.hasOwnProperty,a=typeof Symbol=="function",i=a&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=a&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",l={__proto__:[]}instanceof Array,c=!o&&!l,u={create:o?function(){return _(Object.create(null))}:l?function(){return _({__proto__:null})}:function(){return _({})},has:c?function(A,R){return r.call(A,R)}:function(A,R){return R in A},get:c?function(A,R){return r.call(A,R)?A[R]:void 0}:function(A,R){return A[R]}},h=Object.getPrototypeOf(Function),d=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:m(),f=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:b(),g=typeof WeakMap=="function"?WeakMap:N(),v=a?Symbol.for("@reflect-metadata:registry"):void 0,C=xn(),w=z(C);function T(A,R,P,Q){if(ne(P)){if(!Kt(A))throw new TypeError;if(!Ae(R))throw new TypeError;return G(A,R)}else{if(!Kt(A))throw new TypeError;if(!ke(R))throw new TypeError;if(!ke(Q)&&!ne(Q)&&!Ye(Q))throw new TypeError;return Ye(Q)&&(Q=void 0),P=It(P),H(A,R,P,Q)}}e("decorate",T);function S(A,R){function P(Q,de){if(!ke(Q))throw new TypeError;if(!ne(de)&&!Ke(de))throw new TypeError;ie(A,R,Q,de)}return P}e("metadata",S);function O(A,R,P,Q){if(!ke(P))throw new TypeError;return ne(Q)||(Q=It(Q)),ie(A,R,P,Q)}e("defineMetadata",O);function k(A,R,P){if(!ke(R))throw new TypeError;return ne(P)||(P=It(P)),se(A,R,P)}e("hasMetadata",k);function B(A,R,P){if(!ke(R))throw new TypeError;return ne(P)||(P=It(P)),re(A,R,P)}e("hasOwnMetadata",B);function D(A,R,P){if(!ke(R))throw new TypeError;return ne(P)||(P=It(P)),ue(A,R,P)}e("getMetadata",D);function V(A,R,P){if(!ke(R))throw new TypeError;return ne(P)||(P=It(P)),Se(A,R,P)}e("getOwnMetadata",V);function q(A,R){if(!ke(A))throw new TypeError;return ne(R)||(R=It(R)),fe(A,R)}e("getMetadataKeys",q);function K(A,R){if(!ke(A))throw new TypeError;return ne(R)||(R=It(R)),Me(A,R)}e("getOwnMetadataKeys",K);function I(A,R,P){if(!ke(R))throw new TypeError;if(ne(P)||(P=It(P)),!ke(R))throw new TypeError;ne(P)||(P=It(P));var Q=te(R,P,!1);return ne(Q)?!1:Q.OrdinaryDeleteMetadata(A,R,P)}e("deleteMetadata",I);function G(A,R){for(var P=A.length-1;P>=0;--P){var Q=A[P],de=Q(R);if(!ne(de)&&!Ye(de)){if(!Ae(de))throw new TypeError;R=de}}return R}function H(A,R,P,Q){for(var de=A.length-1;de>=0;--de){var Le=A[de],qe=Le(R,P,Q);if(!ne(qe)&&!Ye(qe)){if(!ke(qe))throw new TypeError;Q=qe}}return Q}function se(A,R,P){var Q=re(A,R,P);if(Q)return!0;var de=Qt(R);return Ye(de)?!1:se(A,de,P)}function re(A,R,P){var Q=te(R,P,!1);return ne(Q)?!1:bt(Q.OrdinaryHasOwnMetadata(A,R,P))}function ue(A,R,P){var Q=re(A,R,P);if(Q)return Se(A,R,P);var de=Qt(R);if(!Ye(de))return ue(A,de,P)}function Se(A,R,P){var Q=te(R,P,!1);if(!ne(Q))return Q.OrdinaryGetOwnMetadata(A,R,P)}function ie(A,R,P,Q){var de=te(P,Q,!0);de.OrdinaryDefineOwnMetadata(A,R,P,Q)}function fe(A,R){var P=Me(A,R),Q=Qt(A);if(Q===null)return P;var de=fe(Q,R);if(de.length<=0)return P;if(P.length<=0)return de;for(var Le=new f,qe=[],oe=0,me=P;oe<me.length;oe++){var Ce=me[oe],Te=Le.has(Ce);Te||(Le.add(Ce),qe.push(Ce))}for(var Ne=0,We=de;Ne<We.length;Ne++){var Ce=We[Ne],Te=Le.has(Ce);Te||(Le.add(Ce),qe.push(Ce))}return qe}function Me(A,R){var P=te(A,R,!1);return P?P.OrdinaryOwnMetadataKeys(A,R):[]}function ge(A){if(A===null)return 1;switch(typeof A){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return A===null?1:6;default:return 6}}function ne(A){return A===void 0}function Ye(A){return A===null}function xe(A){return typeof A=="symbol"}function ke(A){return typeof A=="object"?A!==null:typeof A=="function"}function ze(A,R){switch(ge(A)){case 0:return A;case 1:return A;case 2:return A;case 3:return A;case 4:return A;case 5:return A}var P=R===3?"string":R===5?"number":"default",Q=jt(A,i);if(Q!==void 0){var de=Q.call(A,P);if(ke(de))throw new TypeError;return de}return Ze(A,P==="default"?"number":P)}function Ze(A,R){if(R==="string"){var P=A.toString;if(dn(P)){var Q=P.call(A);if(!ke(Q))return Q}var de=A.valueOf;if(dn(de)){var Q=de.call(A);if(!ke(Q))return Q}}else{var de=A.valueOf;if(dn(de)){var Q=de.call(A);if(!ke(Q))return Q}var Le=A.toString;if(dn(Le)){var Q=Le.call(A);if(!ke(Q))return Q}}throw new TypeError}function bt(A){return!!A}function Rt(A){return""+A}function It(A){var R=ze(A,3);return xe(R)?R:Rt(R)}function Kt(A){return Array.isArray?Array.isArray(A):A instanceof Object?A instanceof Array:Object.prototype.toString.call(A)==="[object Array]"}function dn(A){return typeof A=="function"}function Ae(A){return typeof A=="function"}function Ke(A){switch(ge(A)){case 3:return!0;case 4:return!0;default:return!1}}function Qn(A,R){return A===R||A!==A&&R!==R}function jt(A,R){var P=A[R];if(P!=null){if(!dn(P))throw new TypeError;return P}}function tn(A){var R=jt(A,s);if(!dn(R))throw new TypeError;var P=R.call(A);if(!ke(P))throw new TypeError;return P}function $r(A){return A.value}function tt(A){var R=A.next();return R.done?!1:R}function Bt(A){var R=A.return;R&&R.call(A)}function Qt(A){var R=Object.getPrototypeOf(A);if(typeof A!="function"||A===h||R!==h)return R;var P=A.prototype,Q=P&&Object.getPrototypeOf(P);if(Q==null||Q===Object.prototype)return R;var de=Q.constructor;return typeof de!="function"||de===A?R:de}function st(){var A;!ne(v)&&typeof t.Reflect<"u"&&!(v in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(A=X(t.Reflect));var R,P,Q,de=new g,Le={registerProvider:qe,getProvider:me,setProvider:Te};return Le;function qe(Ne){if(!Object.isExtensible(Le))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case A===Ne:break;case ne(R):R=Ne;break;case R===Ne:break;case ne(P):P=Ne;break;case P===Ne:break;default:Q===void 0&&(Q=new f),Q.add(Ne);break}}function oe(Ne,We){if(!ne(R)){if(R.isProviderFor(Ne,We))return R;if(!ne(P)){if(P.isProviderFor(Ne,We))return R;if(!ne(Q))for(var Je=tn(Q);;){var Tt=tt(Je);if(!Tt)return;var le=$r(Tt);if(le.isProviderFor(Ne,We))return Bt(Je),le}}}if(!ne(A)&&A.isProviderFor(Ne,We))return A}function me(Ne,We){var Je=de.get(Ne),Tt;return ne(Je)||(Tt=Je.get(We)),ne(Tt)&&(Tt=oe(Ne,We),ne(Tt)||(ne(Je)&&(Je=new d,de.set(Ne,Je)),Je.set(We,Tt))),Tt}function Ce(Ne){if(ne(Ne))throw new TypeError;return R===Ne||P===Ne||!ne(Q)&&Q.has(Ne)}function Te(Ne,We,Je){if(!Ce(Je))throw new Error("Metadata provider not registered.");var Tt=me(Ne,We);if(Tt!==Je){if(!ne(Tt))return!1;var le=de.get(Ne);ne(le)&&(le=new d,de.set(Ne,le)),le.set(We,Je)}return!0}}function xn(){var A;return!ne(v)&&ke(t.Reflect)&&Object.isExtensible(t.Reflect)&&(A=t.Reflect[v]),ne(A)&&(A=st()),!ne(v)&&ke(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:A}),A}function z(A){var R=new g,P={isProviderFor:function(Ce,Te){var Ne=R.get(Ce);return ne(Ne)?!1:Ne.has(Te)},OrdinaryDefineOwnMetadata:qe,OrdinaryHasOwnMetadata:de,OrdinaryGetOwnMetadata:Le,OrdinaryOwnMetadataKeys:oe,OrdinaryDeleteMetadata:me};return C.registerProvider(P),P;function Q(Ce,Te,Ne){var We=R.get(Ce),Je=!1;if(ne(We)){if(!Ne)return;We=new d,R.set(Ce,We),Je=!0}var Tt=We.get(Te);if(ne(Tt)){if(!Ne)return;if(Tt=new d,We.set(Te,Tt),!A.setProvider(Ce,Te,P))throw We.delete(Te),Je&&R.delete(Ce),new Error("Wrong provider for target.")}return Tt}function de(Ce,Te,Ne){var We=Q(Te,Ne,!1);return ne(We)?!1:bt(We.has(Ce))}function Le(Ce,Te,Ne){var We=Q(Te,Ne,!1);if(!ne(We))return We.get(Ce)}function qe(Ce,Te,Ne,We){var Je=Q(Ne,We,!0);Je.set(Ce,Te)}function oe(Ce,Te){var Ne=[],We=Q(Ce,Te,!1);if(ne(We))return Ne;for(var Je=We.keys(),Tt=tn(Je),le=0;;){var Do=tt(Tt);if(!Do)return Ne.length=le,Ne;var pn=$r(Do);try{Ne[le]=pn}catch(ps){try{Bt(Tt)}finally{throw ps}}le++}}function me(Ce,Te,Ne){var We=Q(Te,Ne,!1);if(ne(We)||!We.delete(Ce))return!1;if(We.size===0){var Je=R.get(Te);ne(Je)||(Je.delete(Ne),Je.size===0&&R.delete(Je))}return!0}}function X(A){var R=A.defineMetadata,P=A.hasOwnMetadata,Q=A.getOwnMetadata,de=A.getOwnMetadataKeys,Le=A.deleteMetadata,qe=new g,oe={isProviderFor:function(me,Ce){var Te=qe.get(me);return ne(Te)?de(me,Ce).length?(ne(Te)&&(Te=new f,qe.set(me,Te)),Te.add(Ce),!0):!1:Te.has(Ce)},OrdinaryDefineOwnMetadata:R,OrdinaryHasOwnMetadata:P,OrdinaryGetOwnMetadata:Q,OrdinaryOwnMetadataKeys:de,OrdinaryDeleteMetadata:Le};return oe}function te(A,R,P){var Q=C.getProvider(A,R);if(!ne(Q))return Q;if(P){if(C.setProvider(A,R,w))return w;throw new Error("Illegal state.")}}function m(){var A={},R=[],P=function(){function oe(me,Ce,Te){this._index=0,this._keys=me,this._values=Ce,this._selector=Te}return oe.prototype["@@iterator"]=function(){return this},oe.prototype[s]=function(){return this},oe.prototype.next=function(){var me=this._index;if(me>=0&&me<this._keys.length){var Ce=this._selector(this._keys[me],this._values[me]);return me+1>=this._keys.length?(this._index=-1,this._keys=R,this._values=R):this._index++,{value:Ce,done:!1}}return{value:void 0,done:!0}},oe.prototype.throw=function(me){throw this._index>=0&&(this._index=-1,this._keys=R,this._values=R),me},oe.prototype.return=function(me){return this._index>=0&&(this._index=-1,this._keys=R,this._values=R),{value:me,done:!0}},oe}(),Q=function(){function oe(){this._keys=[],this._values=[],this._cacheKey=A,this._cacheIndex=-2}return Object.defineProperty(oe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),oe.prototype.has=function(me){return this._find(me,!1)>=0},oe.prototype.get=function(me){var Ce=this._find(me,!1);return Ce>=0?this._values[Ce]:void 0},oe.prototype.set=function(me,Ce){var Te=this._find(me,!0);return this._values[Te]=Ce,this},oe.prototype.delete=function(me){var Ce=this._find(me,!1);if(Ce>=0){for(var Te=this._keys.length,Ne=Ce+1;Ne<Te;Ne++)this._keys[Ne-1]=this._keys[Ne],this._values[Ne-1]=this._values[Ne];return this._keys.length--,this._values.length--,Qn(me,this._cacheKey)&&(this._cacheKey=A,this._cacheIndex=-2),!0}return!1},oe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=A,this._cacheIndex=-2},oe.prototype.keys=function(){return new P(this._keys,this._values,de)},oe.prototype.values=function(){return new P(this._keys,this._values,Le)},oe.prototype.entries=function(){return new P(this._keys,this._values,qe)},oe.prototype["@@iterator"]=function(){return this.entries()},oe.prototype[s]=function(){return this.entries()},oe.prototype._find=function(me,Ce){if(!Qn(this._cacheKey,me)){this._cacheIndex=-1;for(var Te=0;Te<this._keys.length;Te++)if(Qn(this._keys[Te],me)){this._cacheIndex=Te;break}}return this._cacheIndex<0&&Ce&&(this._cacheIndex=this._keys.length,this._keys.push(me),this._values.push(void 0)),this._cacheIndex},oe}();return Q;function de(oe,me){return oe}function Le(oe,me){return me}function qe(oe,me){return[oe,me]}}function b(){var A=function(){function R(){this._map=new d}return Object.defineProperty(R.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),R.prototype.has=function(P){return this._map.has(P)},R.prototype.add=function(P){return this._map.set(P,P),this},R.prototype.delete=function(P){return this._map.delete(P)},R.prototype.clear=function(){this._map.clear()},R.prototype.keys=function(){return this._map.keys()},R.prototype.values=function(){return this._map.keys()},R.prototype.entries=function(){return this._map.entries()},R.prototype["@@iterator"]=function(){return this.keys()},R.prototype[s]=function(){return this.keys()},R}();return A}function N(){var A=16,R=u.create(),P=Q();return function(){function me(){this._key=Q()}return me.prototype.has=function(Ce){var Te=de(Ce,!1);return Te!==void 0?u.has(Te,this._key):!1},me.prototype.get=function(Ce){var Te=de(Ce,!1);return Te!==void 0?u.get(Te,this._key):void 0},me.prototype.set=function(Ce,Te){var Ne=de(Ce,!0);return Ne[this._key]=Te,this},me.prototype.delete=function(Ce){var Te=de(Ce,!1);return Te!==void 0?delete Te[this._key]:!1},me.prototype.clear=function(){this._key=Q()},me}();function Q(){var me;do me="@@WeakMap@@"+oe();while(u.has(R,me));return R[me]=!0,me}function de(me,Ce){if(!r.call(me,P)){if(!Ce)return;Object.defineProperty(me,P,{value:u.create()})}return me[P]}function Le(me,Ce){for(var Te=0;Te<Ce;++Te)me[Te]=Math.random()*255|0;return me}function qe(me){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(me)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(me)):Le(new Uint8Array(me),me):Le(new Array(me),me)}function oe(){var me=qe(A);me[6]=me[6]&79|64,me[8]=me[8]&191|128;for(var Ce="",Te=0;Te<A;++Te){var Ne=me[Te];(Te===4||Te===6||Te===8)&&(Ce+="-"),Ne<16&&(Ce+="0"),Ce+=Ne.toString(16).toLowerCase()}return Ce}}function _(A){return A.__=void 0,delete A.__,A}})})(jE||(jE={}));var BE={exports:{}},UE={};/**
* @license React
* use-sync-external-store-with-selector.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Ml=ye;function vS(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ES=typeof Object.is=="function"?Object.is:vS,wS=Ml.useSyncExternalStore,TS=Ml.useRef,NS=Ml.useEffect,CS=Ml.useMemo,AS=Ml.useDebugValue;UE.useSyncExternalStoreWithSelector=function(n,e,t,r,a){var i=TS(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=CS(function(){function l(f){if(!c){if(c=!0,u=f,f=r(f),a!==void 0&&s.hasValue){var g=s.value;if(a(g,f))return h=g}return h=f}if(g=h,ES(u,f))return g;var v=r(f);return a!==void 0&&a(g,v)?g:(u=f,h=v)}var c=!1,u,h,d=t===void 0?null:t;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,t,r,a]);var o=wS(n,i[0],i[1]);return NS(function(){s.hasValue=!0,s.value=o},[o]),AS(o),o},BE.exports=UE;var SS=BE.exports,kn="default"in Rg?Y:Rg,FE=Symbol.for("react-redux-context"),VE=typeof globalThis<"u"?globalThis:{};function RS(){if(!kn.createContext)return{};const n=VE[FE]??(VE[FE]=new Map);let e=n.get(kn.createContext);return e||(e=kn.createContext(null),n.set(kn.createContext,e)),e}var ii=RS(),MS=()=>{throw new Error("uSES not initialized!")};function Km(n=ii){return function(){return kn.useContext(n)}}var zE=Km(),WE=MS,OS=n=>{WE=n},_S=(n,e)=>n===e;function xS(n=ii){const e=n===ii?zE:Km(n);return function(t,r={}){const{equalityFn:a=_S,devModeChecks:i={}}=typeof r=="function"?{equalityFn:r}:r,{store:s,subscription:o,getServerState:l,stabilityCheck:c,identityFunctionCheck:u}=e();kn.useRef(!0);const h=kn.useCallback({[t.name](f){return t(f)}}[t.name],[t,c,i.stabilityCheck]),d=WE(o.addNestedSub,s.getState,l||s.getState,h,a);return kn.useDebugValue(d),d}}var Ks=xS();function PS(n){n()}function IS(){let n=null,e=null;return{clear(){n=null,e=null},notify(){PS(()=>{let t=n;for(;t;)t.callback(),t=t.next})},get(){let t=[],r=n;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0,a=e={callback:t,next:null,prev:e};return a.prev?a.prev.next=a:n=a,function(){!r||n===null||(r=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:n=a.next)}}}}var HE={notify(){},get:()=>[]};function DS(n,e){let t,r=HE,a=0,i=!1;function s(v){u();const C=r.subscribe(v);let w=!1;return()=>{w||(w=!0,C(),h())}}function o(){r.notify()}function l(){g.onStateChange&&g.onStateChange()}function c(){return i}function u(){a++,t||(t=e?e.addNestedSub(l):n.subscribe(l),r=IS())}function h(){a--,t&&a===0&&(t(),t=void 0,r.clear(),r=HE)}function d(){i||(i=!0,u())}function f(){i&&(i=!1,h())}const g={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>r};return g}var LS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qS=LS?kn.useLayoutEffect:kn.useEffect;function $S({store:n,context:e,children:t,serverState:r,stabilityCheck:a="once",identityFunctionCheck:i="once"}){const s=kn.useMemo(()=>{const c=DS(n);return{store:n,subscription:c,getServerState:r?()=>r:void 0,stabilityCheck:a,identityFunctionCheck:i}},[n,r,a,i]),o=kn.useMemo(()=>n.getState(),[n]);qS(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=e||ii;return kn.createElement(l.Provider,{value:s},t)}var kS=$S;function KE(n=ii){const e=n===ii?zE:Km(n);return function(){const{store:t}=e();return t}}var jS=KE();function BS(n=ii){const e=n===ii?jS:KE(n);return function(){return e().dispatch}}var US=BS();OS(SS.useSyncExternalStoreWithSelector);var rh=function(){return rh=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},rh.apply(this,arguments)};function FS(){var n=ye.useRef(!1),e=ye.useCallback(function(){return n.current},[]);return ye.useEffect(function(){return n.current=!0,function(){n.current=!1}},[]),e}function VS(n,e,t){e===void 0&&(e=[]),t===void 0&&(t={loading:!1});var r=ye.useRef(0),a=FS(),i=ye.useState(t),s=i[0],o=i[1],l=ye.useCallback(function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var h=++r.current;return s.loading||o(function(d){return rh(rh({},d),{loading:!0})}),n.apply(void 0,c).then(function(d){return a()&&h===r.current&&o({value:d,loading:!1}),d},function(d){return a()&&h===r.current&&o({error:d,loading:!1}),d})},e);return[s,l]}function zS(n,e){e===void 0&&(e=[]);var t=VS(n,e,{loading:!0}),r=t[0],a=t[1];return ye.useEffect(function(){a()},[a]),r}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var QE;(function(n){(function(e){var t=typeof Uc=="object"?Uc:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),r=a(n);typeof t.Reflect>"u"?t.Reflect=n:r=a(t.Reflect,r),e(r);function a(i,s){return function(o,l){typeof i[o]!="function"&&Object.defineProperty(i,o,{configurable:!0,writable:!0,value:l}),s&&s(o,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,r=typeof Symbol=="function",a=r&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",i=r&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",o={__proto__:[]}instanceof Array,l=!s&&!o,c={create:s?function(){return xn(Object.create(null))}:o?function(){return xn({__proto__:null})}:function(){return xn({})},has:l?function(z,X){return t.call(z,X)}:function(z,X){return X in z},get:l?function(z,X){return t.call(z,X)?z[X]:void 0}:function(z,X){return z[X]}},u=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",d=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Bt(),f=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Qt(),g=!h&&typeof WeakMap=="function"?WeakMap:st(),v=new g;function C(z,X,te,m){if(ge(te)){if(!It(z))throw new TypeError;if(!dn(X))throw new TypeError;return K(z,X)}else{if(!It(z))throw new TypeError;if(!xe(X))throw new TypeError;if(!xe(m)&&!ge(m)&&!ne(m))throw new TypeError;return ne(m)&&(m=void 0),te=Rt(te),I(z,X,te,m)}}e("decorate",C);function w(z,X){function te(m,b){if(!xe(m))throw new TypeError;if(!ge(b)&&!Ae(b))throw new TypeError;Se(z,X,m,b)}return te}e("metadata",w);function T(z,X,te,m){if(!xe(te))throw new TypeError;return ge(m)||(m=Rt(m)),Se(z,X,te,m)}e("defineMetadata",T);function S(z,X,te){if(!xe(X))throw new TypeError;return ge(te)||(te=Rt(te)),H(z,X,te)}e("hasMetadata",S);function O(z,X,te){if(!xe(X))throw new TypeError;return ge(te)||(te=Rt(te)),se(z,X,te)}e("hasOwnMetadata",O);function k(z,X,te){if(!xe(X))throw new TypeError;return ge(te)||(te=Rt(te)),re(z,X,te)}e("getMetadata",k);function B(z,X,te){if(!xe(X))throw new TypeError;return ge(te)||(te=Rt(te)),ue(z,X,te)}e("getOwnMetadata",B);function D(z,X){if(!xe(z))throw new TypeError;return ge(X)||(X=Rt(X)),ie(z,X)}e("getMetadataKeys",D);function V(z,X){if(!xe(z))throw new TypeError;return ge(X)||(X=Rt(X)),fe(z,X)}e("getOwnMetadataKeys",V);function q(z,X,te){if(!xe(X))throw new TypeError;ge(te)||(te=Rt(te));var m=G(X,te,!1);if(ge(m)||!m.delete(z))return!1;if(m.size>0)return!0;var b=v.get(X);return b.delete(te),b.size>0||v.delete(X),!0}e("deleteMetadata",q);function K(z,X){for(var te=z.length-1;te>=0;--te){var m=z[te],b=m(X);if(!ge(b)&&!ne(b)){if(!dn(b))throw new TypeError;X=b}}return X}function I(z,X,te,m){for(var b=z.length-1;b>=0;--b){var N=z[b],_=N(X,te,m);if(!ge(_)&&!ne(_)){if(!xe(_))throw new TypeError;m=_}}return m}function G(z,X,te){var m=v.get(z);if(ge(m)){if(!te)return;m=new d,v.set(z,m)}var b=m.get(X);if(ge(b)){if(!te)return;b=new d,m.set(X,b)}return b}function H(z,X,te){var m=se(z,X,te);if(m)return!0;var b=tt(X);return ne(b)?!1:H(z,b,te)}function se(z,X,te){var m=G(X,te,!1);return ge(m)?!1:Ze(m.has(z))}function re(z,X,te){var m=se(z,X,te);if(m)return ue(z,X,te);var b=tt(X);if(!ne(b))return re(z,b,te)}function ue(z,X,te){var m=G(X,te,!1);if(!ge(m))return m.get(z)}function Se(z,X,te,m){var b=G(te,m,!0);b.set(z,X)}function ie(z,X){var te=fe(z,X),m=tt(z);if(m===null)return te;var b=ie(m,X);if(b.length<=0)return te;if(te.length<=0)return b;for(var N=new f,_=[],A=0,R=te;A<R.length;A++){var P=R[A],Q=N.has(P);Q||(N.add(P),_.push(P))}for(var de=0,Le=b;de<Le.length;de++){var P=Le[de],Q=N.has(P);Q||(N.add(P),_.push(P))}return _}function fe(z,X){var te=[],m=G(z,X,!1);if(ge(m))return te;for(var b=m.keys(),N=Qn(b),_=0;;){var A=tn(N);if(!A)return te.length=_,te;var R=jt(A);try{te[_]=R}catch(P){try{$r(N)}finally{throw P}}_++}}function Me(z){if(z===null)return 1;switch(typeof z){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return z===null?1:6;default:return 6}}function ge(z){return z===void 0}function ne(z){return z===null}function Ye(z){return typeof z=="symbol"}function xe(z){return typeof z=="object"?z!==null:typeof z=="function"}function ke(z,X){switch(Me(z)){case 0:return z;case 1:return z;case 2:return z;case 3:return z;case 4:return z;case 5:return z}var te=X===3?"string":X===5?"number":"default",m=Ke(z,a);if(m!==void 0){var b=m.call(z,te);if(xe(b))throw new TypeError;return b}return ze(z,te==="default"?"number":te)}function ze(z,X){if(X==="string"){var te=z.toString;if(Kt(te)){var m=te.call(z);if(!xe(m))return m}var b=z.valueOf;if(Kt(b)){var m=b.call(z);if(!xe(m))return m}}else{var b=z.valueOf;if(Kt(b)){var m=b.call(z);if(!xe(m))return m}var N=z.toString;if(Kt(N)){var m=N.call(z);if(!xe(m))return m}}throw new TypeError}function Ze(z){return!!z}function bt(z){return""+z}function Rt(z){var X=ke(z,3);return Ye(X)?X:bt(X)}function It(z){return Array.isArray?Array.isArray(z):z instanceof Object?z instanceof Array:Object.prototype.toString.call(z)==="[object Array]"}function Kt(z){return typeof z=="function"}function dn(z){return typeof z=="function"}function Ae(z){switch(Me(z)){case 3:return!0;case 4:return!0;default:return!1}}function Ke(z,X){var te=z[X];if(te!=null){if(!Kt(te))throw new TypeError;return te}}function Qn(z){var X=Ke(z,i);if(!Kt(X))throw new TypeError;var te=X.call(z);if(!xe(te))throw new TypeError;return te}function jt(z){return z.value}function tn(z){var X=z.next();return X.done?!1:X}function $r(z){var X=z.return;X&&X.call(z)}function tt(z){var X=Object.getPrototypeOf(z);if(typeof z!="function"||z===u||X!==u)return X;var te=z.prototype,m=te&&Object.getPrototypeOf(te);if(m==null||m===Object.prototype)return X;var b=m.constructor;return typeof b!="function"||b===z?X:b}function Bt(){var z={},X=[],te=function(){function _(A,R,P){this._index=0,this._keys=A,this._values=R,this._selector=P}return _.prototype["@@iterator"]=function(){return this},_.prototype[i]=function(){return this},_.prototype.next=function(){var A=this._index;if(A>=0&&A<this._keys.length){var R=this._selector(this._keys[A],this._values[A]);return A+1>=this._keys.length?(this._index=-1,this._keys=X,this._values=X):this._index++,{value:R,done:!1}}return{value:void 0,done:!0}},_.prototype.throw=function(A){throw this._index>=0&&(this._index=-1,this._keys=X,this._values=X),A},_.prototype.return=function(A){return this._index>=0&&(this._index=-1,this._keys=X,this._values=X),{value:A,done:!0}},_}();return function(){function _(){this._keys=[],this._values=[],this._cacheKey=z,this._cacheIndex=-2}return Object.defineProperty(_.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_.prototype.has=function(A){return this._find(A,!1)>=0},_.prototype.get=function(A){var R=this._find(A,!1);return R>=0?this._values[R]:void 0},_.prototype.set=function(A,R){var P=this._find(A,!0);return this._values[P]=R,this},_.prototype.delete=function(A){var R=this._find(A,!1);if(R>=0){for(var P=this._keys.length,Q=R+1;Q<P;Q++)this._keys[Q-1]=this._keys[Q],this._values[Q-1]=this._values[Q];return this._keys.length--,this._values.length--,A===this._cacheKey&&(this._cacheKey=z,this._cacheIndex=-2),!0}return!1},_.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=z,this._cacheIndex=-2},_.prototype.keys=function(){return new te(this._keys,this._values,m)},_.prototype.values=function(){return new te(this._keys,this._values,b)},_.prototype.entries=function(){return new te(this._keys,this._values,N)},_.prototype["@@iterator"]=function(){return this.entries()},_.prototype[i]=function(){return this.entries()},_.prototype._find=function(A,R){return this._cacheKey!==A&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=A)),this._cacheIndex<0&&R&&(this._cacheIndex=this._keys.length,this._keys.push(A),this._values.push(void 0)),this._cacheIndex},_}();function m(_,A){return _}function b(_,A){return A}function N(_,A){return[_,A]}}function Qt(){return function(){function z(){this._map=new d}return Object.defineProperty(z.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),z.prototype.has=function(X){return this._map.has(X)},z.prototype.add=function(X){return this._map.set(X,X),this},z.prototype.delete=function(X){return this._map.delete(X)},z.prototype.clear=function(){this._map.clear()},z.prototype.keys=function(){return this._map.keys()},z.prototype.values=function(){return this._map.values()},z.prototype.entries=function(){return this._map.entries()},z.prototype["@@iterator"]=function(){return this.keys()},z.prototype[i]=function(){return this.keys()},z}()}function st(){var z=16,X=c.create(),te=m();return function(){function R(){this._key=m()}return R.prototype.has=function(P){var Q=b(P,!1);return Q!==void 0?c.has(Q,this._key):!1},R.prototype.get=function(P){var Q=b(P,!1);return Q!==void 0?c.get(Q,this._key):void 0},R.prototype.set=function(P,Q){var de=b(P,!0);return de[this._key]=Q,this},R.prototype.delete=function(P){var Q=b(P,!1);return Q!==void 0?delete Q[this._key]:!1},R.prototype.clear=function(){this._key=m()},R}();function m(){var R;do R="@@WeakMap@@"+A();while(c.has(X,R));return X[R]=!0,R}function b(R,P){if(!t.call(R,te)){if(!P)return;Object.defineProperty(R,te,{value:c.create()})}return R[te]}function N(R,P){for(var Q=0;Q<P;++Q)R[Q]=Math.random()*255|0;return R}function _(R){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(R)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(R)):N(new Uint8Array(R),R):N(new Array(R),R)}function A(){var R=_(z);R[6]=R[6]&79|64,R[8]=R[8]&191|128;for(var P="",Q=0;Q<z;++Q){var de=R[Q];(Q===4||Q===6||Q===8)&&(P+="-"),de<16&&(P+="0"),P+=de.toString(16).toLowerCase()}return P}}function xn(z){return z.__=void 0,delete z.__,z}})})(QE||(QE={}));class ah{static getInheritanceTree(e){const t=[e],r=a=>{const i=Object.getPrototypeOf(a);i&&i.name&&(t.push(i),r(i))};return r(e),t}static isInherited(e,t){return e.prototype instanceof t}static filterByTarget(e,t){return t?e.filter(r=>r.target&&t.indexOf(r.target)!==-1):e}}class GE{constructor(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}filterTables(e){return this.filterByTarget(this.tables,e)}filterColumns(e){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,e)}findGenerated(e,t){return this.generations.find(r=>(Array.isArray(e)?e.indexOf(r.target)!==-1:r.target===e)&&r.propertyName===t)}findTree(e){return this.trees.find(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterRelations(e){return this.filterByTargetAndWithoutDuplicateRelationProperties(this.relations,e)}filterRelationIds(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,e)}filterRelationCounts(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,e)}filterIndices(e){return this.indices.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterUniques(e){return this.uniques.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterChecks(e){return this.checks.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterExclusions(e){return this.exclusions.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterListeners(e){return this.filterByTarget(this.entityListeners,e)}filterEmbeddeds(e){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,e)}findJoinTable(e,t){return this.joinTables.find(r=>r.target===e&&r.propertyName===t)}filterJoinColumns(e,t){return this.joinColumns.filter(r=>r.target===e&&r.propertyName===t)}filterSubscribers(e){return this.filterByTarget(this.entitySubscribers,e)}filterNamingStrategies(e){return this.filterByTarget(this.namingStrategies,e)}filterTransactionEntityManagers(e,t){return this.transactionEntityManagers.filter(r=>(Array.isArray(e)?e.indexOf(r.target)!==-1:r.target===e)&&r.methodName===t)}filterTransactionRepository(e,t){return this.transactionRepositories.filter(r=>(Array.isArray(e)?e.indexOf(r.target)!==-1:r.target===e)&&r.methodName===t)}filterSingleTableChildren(e){return this.tables.filter(t=>typeof t.target=="function"&&typeof e=="function"&&ah.isInherited(t.target,e)&&t.type==="entity-child")}findInheritanceType(e){return this.inheritances.find(t=>t.target===e)}findDiscriminatorValue(e){return this.discriminatorValues.find(t=>t.target===e)}filterByTarget(e,t){return e.filter(r=>Array.isArray(t)?t.indexOf(r.target)!==-1:r.target===t)}filterByTargetAndWithoutDuplicateProperties(e,t){const r=[];return e.forEach(a=>{(Array.isArray(t)?t.indexOf(a.target)!==-1:a.target===t)&&(r.find(i=>i.propertyName===a.propertyName)||r.push(a))}),r}filterByTargetAndWithoutDuplicateRelationProperties(e,t){const r=[];return e.forEach(a=>{if(Array.isArray(t)?t.indexOf(a.target)!==-1:a.target===t){const i=r.findIndex(s=>s.propertyName===a.propertyName);if(Array.isArray(t)&&i!==-1&&t.indexOf(a.target)<t.indexOf(r[i].target)){const s=Object.create(r[i]);s.type=a.type,r[i]=s}else i===-1&&r.push(a)}}),r}filterByTargetAndWithoutDuplicateEmbeddedProperties(e,t){const r=[];return e.forEach(a=>{(Array.isArray(t)?t.indexOf(a.target)!==-1:a.target===t)&&(r.find(i=>i.prefix===a.prefix&&i.propertyName===a.propertyName)||r.push(a))}),r}}class ht{static getGlobalVariable(){return typeof window<"u"?window:global}static load(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: require("${e}").`);return""}static pathNormalize(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.normalize("${e}").`);return""}static pathExtname(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.extname("${e}").`);return""}static pathResolve(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.resolve("${e}").`);return""}static fileExist(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.existsSync("${e}").`);return!1}static dotenv(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: dotenv.config({ path: "${e}" }).`)}static getEnvVariable(e){}static readFileSync(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("${e}").`);return null}static appendFileSync(e,t){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("${e}").`)}static writeFile(e,t){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.writeFile("${e}").`);return Promise.reject(null)}static highlightSql(e){return e}static highlightJson(e){return e}static logInfo(e,t){console.info(e+" ",t)}static logError(e,t){console.error(e+" ",t)}static logWarn(e,t){console.warn(e+" ",t)}static log(e){console.log(e)}static warn(e){return e}}ht.type="browser",typeof window<"u"&&typeof require<"u"&&(window.Buffer=require("buffer/").Buffer),typeof global<"u"&&typeof require<"u"&&(global.Buffer=require("buffer/").Buffer);class si{static sha1(e){let t=function(k,B){return k<<B|k>>>32-B},r=function(k){let B="",D,V;for(D=7;D>=0;D--)V=k>>>D*4&15,B+=V.toString(16);return B},a,i,s,o=new Array(80),l=1732584193,c=4023233417,u=2562383102,h=271733878,d=3285377520,f,g,v,C,w,T;e=encodeURIComponent(e);let S=e.length,O=[];for(i=0;i<S-3;i+=4)s=e.charCodeAt(i)<<24|e.charCodeAt(i+1)<<16|e.charCodeAt(i+2)<<8|e.charCodeAt(i+3),O.push(s);switch(S%4){case 0:i=2147483648;break;case 1:i=e.charCodeAt(S-1)<<24|8388608;break;case 2:i=e.charCodeAt(S-2)<<24|e.charCodeAt(S-1)<<16|32768;break;case 3:i=e.charCodeAt(S-3)<<24|e.charCodeAt(S-2)<<16|e.charCodeAt(S-1)<<8|128;break}for(O.push(i);O.length%16!==14;)O.push(0);for(O.push(S>>>29),O.push(S<<3&4294967295),a=0;a<O.length;a+=16){for(i=0;i<16;i++)o[i]=O[a+i];for(i=16;i<=79;i++)o[i]=t(o[i-3]^o[i-8]^o[i-14]^o[i-16],1);for(f=l,g=c,v=u,C=h,w=d,i=0;i<=19;i++)T=t(f,5)+(g&v|~g&C)+w+o[i]+1518500249&4294967295,w=C,C=v,v=t(g,30),g=f,f=T;for(i=20;i<=39;i++)T=t(f,5)+(g^v^C)+w+o[i]+1859775393&4294967295,w=C,C=v,v=t(g,30),g=f,f=T;for(i=40;i<=59;i++)T=t(f,5)+(g&v|g&C|v&C)+w+o[i]+2400959708&4294967295,w=C,C=v,v=t(g,30),g=f,f=T;for(i=60;i<=79;i++)T=t(f,5)+(g^v^C)+w+o[i]+3395469782&4294967295,w=C,C=v,v=t(g,30),g=f,f=T;l=l+f&4294967295,c=c+g&4294967295,u=u+v&4294967295,h=h+C&4294967295,d=d+w&4294967295}return T=r(l)+r(c)+r(u)+r(h)+r(d),T.toLowerCase()}}var YE={exports:{}},Qm={exports:{}};typeof Object.create=="function"?Qm.exports=function(n,e){e&&(n.super_=e,n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:Qm.exports=function(n,e){if(e){n.super_=e;var t=function(){};t.prototype=e.prototype,n.prototype=new t,n.prototype.constructor=n}};var Qs=Qm.exports,Gm={exports:{}},Ym={},ih={};ih.byteLength=KS,ih.toByteArray=GS,ih.fromByteArray=XS;for(var Wr=[],nr=[],WS=typeof Uint8Array<"u"?Uint8Array:Array,Jm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gs=0,HS=Jm.length;Gs<HS;++Gs)Wr[Gs]=Jm[Gs],nr[Jm.charCodeAt(Gs)]=Gs;nr[45]=62,nr[95]=63;function JE(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function KS(n){var e=JE(n),t=e[0],r=e[1];return(t+r)*3/4-r}function QS(n,e,t){return(e+t)*3/4-t}function GS(n){var e,t=JE(n),r=t[0],a=t[1],i=new WS(QS(n,r,a)),s=0,o=a>0?r-4:r,l;for(l=0;l<o;l+=4)e=nr[n.charCodeAt(l)]<<18|nr[n.charCodeAt(l+1)]<<12|nr[n.charCodeAt(l+2)]<<6|nr[n.charCodeAt(l+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=e&255;return a===2&&(e=nr[n.charCodeAt(l)]<<2|nr[n.charCodeAt(l+1)]>>4,i[s++]=e&255),a===1&&(e=nr[n.charCodeAt(l)]<<10|nr[n.charCodeAt(l+1)]<<4|nr[n.charCodeAt(l+2)]>>2,i[s++]=e>>8&255,i[s++]=e&255),i}function YS(n){return Wr[n>>18&63]+Wr[n>>12&63]+Wr[n>>6&63]+Wr[n&63]}function JS(n,e,t){for(var r,a=[],i=e;i<t;i+=3)r=(n[i]<<16&16711680)+(n[i+1]<<8&65280)+(n[i+2]&255),a.push(YS(r));return a.join("")}function XS(n){for(var e,t=n.length,r=t%3,a=[],i=16383,s=0,o=t-r;s<o;s+=i)a.push(JS(n,s,s+i>o?o:s+i));return r===1?(e=n[t-1],a.push(Wr[e>>2]+Wr[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],a.push(Wr[e>>10]+Wr[e>>4&63]+Wr[e<<2&63]+"=")),a.join("")}var Xm={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Xm.read=function(n,e,t,r,a){var i,s,o=a*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,h=t?a-1:0,d=t?-1:1,f=n[e+h];for(h+=d,i=f&(1<<-u)-1,f>>=-u,u+=o;u>0;i=i*256+n[e+h],h+=d,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=r;u>0;s=s*256+n[e+h],h+=d,u-=8);if(i===0)i=1-c;else{if(i===l)return s?NaN:(f?-1:1)*(1/0);s=s+Math.pow(2,r),i=i-c}return(f?-1:1)*s*Math.pow(2,i-r)},Xm.write=function(n,e,t,r,a,i){var s,o,l,c=i*8-a-1,u=(1<<c)-1,h=u>>1,d=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,g=r?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?e+=d/l:e+=d*Math.pow(2,1-h),e*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(e*l-1)*Math.pow(2,a),s=s+h):(o=e*Math.pow(2,h-1)*Math.pow(2,a),s=0));a>=8;n[t+f]=o&255,f+=g,o/=256,a-=8);for(s=s<<a|o,c+=a;c>0;n[t+f]=s&255,f+=g,s/=256,c-=8);n[t+f-g]|=v*128};/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/(function(n){const e=ih,t=Xm,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=o,n.SlowBuffer=T,n.INSPECT_MAX_BYTES=50;const a=2147483647;n.kMaxLength=a,o.TYPED_ARRAY_SUPPORT=i(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const m=new Uint8Array(1),b={foo:function(){return 42}};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(m,b),m.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function s(m){if(m>a)throw new RangeError('The value "'+m+'" is invalid for option "size"');const b=new Uint8Array(m);return Object.setPrototypeOf(b,o.prototype),b}function o(m,b,N){if(typeof m=="number"){if(typeof b=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(m)}return l(m,b,N)}o.poolSize=8192;function l(m,b,N){if(typeof m=="string")return d(m,b);if(ArrayBuffer.isView(m))return g(m);if(m==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m);if(st(m,ArrayBuffer)||m&&st(m.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(st(m,SharedArrayBuffer)||m&&st(m.buffer,SharedArrayBuffer)))return v(m,b,N);if(typeof m=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _=m.valueOf&&m.valueOf();if(_!=null&&_!==m)return o.from(_,b,N);const A=C(m);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof m[Symbol.toPrimitive]=="function")return o.from(m[Symbol.toPrimitive]("string"),b,N);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m)}o.from=function(m,b,N){return l(m,b,N)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function c(m){if(typeof m!="number")throw new TypeError('"size" argument must be of type number');if(m<0)throw new RangeError('The value "'+m+'" is invalid for option "size"')}function u(m,b,N){return c(m),m<=0?s(m):b!==void 0?typeof N=="string"?s(m).fill(b,N):s(m).fill(b):s(m)}o.alloc=function(m,b,N){return u(m,b,N)};function h(m){return c(m),s(m<0?0:w(m)|0)}o.allocUnsafe=function(m){return h(m)},o.allocUnsafeSlow=function(m){return h(m)};function d(m,b){if((typeof b!="string"||b==="")&&(b="utf8"),!o.isEncoding(b))throw new TypeError("Unknown encoding: "+b);const N=S(m,b)|0;let _=s(N);const A=_.write(m,b);return A!==N&&(_=_.slice(0,A)),_}function f(m){const b=m.length<0?0:w(m.length)|0,N=s(b);for(let _=0;_<b;_+=1)N[_]=m[_]&255;return N}function g(m){if(st(m,Uint8Array)){const b=new Uint8Array(m);return v(b.buffer,b.byteOffset,b.byteLength)}return f(m)}function v(m,b,N){if(b<0||m.byteLength<b)throw new RangeError('"offset" is outside of buffer bounds');if(m.byteLength<b+(N||0))throw new RangeError('"length" is outside of buffer bounds');let _;return b===void 0&&N===void 0?_=new Uint8Array(m):N===void 0?_=new Uint8Array(m,b):_=new Uint8Array(m,b,N),Object.setPrototypeOf(_,o.prototype),_}function C(m){if(o.isBuffer(m)){const b=w(m.length)|0,N=s(b);return N.length===0||m.copy(N,0,0,b),N}if(m.length!==void 0)return typeof m.length!="number"||xn(m.length)?s(0):f(m);if(m.type==="Buffer"&&Array.isArray(m.data))return f(m.data)}function w(m){if(m>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return m|0}function T(m){return+m!=m&&(m=0),o.alloc(+m)}o.isBuffer=function(m){return m!=null&&m._isBuffer===!0&&m!==o.prototype},o.compare=function(m,b){if(st(m,Uint8Array)&&(m=o.from(m,m.offset,m.byteLength)),st(b,Uint8Array)&&(b=o.from(b,b.offset,b.byteLength)),!o.isBuffer(m)||!o.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===b)return 0;let N=m.length,_=b.length;for(let A=0,R=Math.min(N,_);A<R;++A)if(m[A]!==b[A]){N=m[A],_=b[A];break}return N<_?-1:_<N?1:0},o.isEncoding=function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(m,b){if(!Array.isArray(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return o.alloc(0);let N;if(b===void 0)for(b=0,N=0;N<m.length;++N)b+=m[N].length;const _=o.allocUnsafe(b);let A=0;for(N=0;N<m.length;++N){let R=m[N];if(st(R,Uint8Array))A+R.length>_.length?(o.isBuffer(R)||(R=o.from(R)),R.copy(_,A)):Uint8Array.prototype.set.call(_,R,A);else if(o.isBuffer(R))R.copy(_,A);else throw new TypeError('"list" argument must be an Array of Buffers');A+=R.length}return _};function S(m,b){if(o.isBuffer(m))return m.length;if(ArrayBuffer.isView(m)||st(m,ArrayBuffer))return m.byteLength;if(typeof m!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof m);const N=m.length,_=arguments.length>2&&arguments[2]===!0;if(!_&&N===0)return 0;let A=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return N;case"utf8":case"utf-8":return tn(m).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N*2;case"hex":return N>>>1;case"base64":return Bt(m).length;default:if(A)return _?-1:tn(m).length;b=(""+b).toLowerCase(),A=!0}}o.byteLength=S;function O(m,b,N){let _=!1;if((b===void 0||b<0)&&(b=0),b>this.length||((N===void 0||N>this.length)&&(N=this.length),N<=0)||(N>>>=0,b>>>=0,N<=b))return"";for(m||(m="utf8");;)switch(m){case"hex":return fe(this,b,N);case"utf8":case"utf-8":return se(this,b,N);case"ascii":return Se(this,b,N);case"latin1":case"binary":return ie(this,b,N);case"base64":return H(this,b,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,b,N);default:if(_)throw new TypeError("Unknown encoding: "+m);m=(m+"").toLowerCase(),_=!0}}o.prototype._isBuffer=!0;function k(m,b,N){const _=m[b];m[b]=m[N],m[N]=_}o.prototype.swap16=function(){const m=this.length;if(m%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<m;b+=2)k(this,b,b+1);return this},o.prototype.swap32=function(){const m=this.length;if(m%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<m;b+=4)k(this,b,b+3),k(this,b+1,b+2);return this},o.prototype.swap64=function(){const m=this.length;if(m%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<m;b+=8)k(this,b,b+7),k(this,b+1,b+6),k(this,b+2,b+5),k(this,b+3,b+4);return this},o.prototype.toString=function(){const m=this.length;return m===0?"":arguments.length===0?se(this,0,m):O.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(m){if(!o.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m?!0:o.compare(this,m)===0},o.prototype.inspect=function(){let m="";const b=n.INSPECT_MAX_BYTES;return m=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(m+=" ... "),"<Buffer "+m+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(m,b,N,_,A){if(st(m,Uint8Array)&&(m=o.from(m,m.offset,m.byteLength)),!o.isBuffer(m))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(b===void 0&&(b=0),N===void 0&&(N=m?m.length:0),_===void 0&&(_=0),A===void 0&&(A=this.length),b<0||N>m.length||_<0||A>this.length)throw new RangeError("out of range index");if(_>=A&&b>=N)return 0;if(_>=A)return-1;if(b>=N)return 1;if(b>>>=0,N>>>=0,_>>>=0,A>>>=0,this===m)return 0;let R=A-_,P=N-b;const Q=Math.min(R,P),de=this.slice(_,A),Le=m.slice(b,N);for(let qe=0;qe<Q;++qe)if(de[qe]!==Le[qe]){R=de[qe],P=Le[qe];break}return R<P?-1:P<R?1:0};function B(m,b,N,_,A){if(m.length===0)return-1;if(typeof N=="string"?(_=N,N=0):N>2147483647?N=2147483647:N<-2147483648&&(N=-2147483648),N=+N,xn(N)&&(N=A?0:m.length-1),N<0&&(N=m.length+N),N>=m.length){if(A)return-1;N=m.length-1}else if(N<0)if(A)N=0;else return-1;if(typeof b=="string"&&(b=o.from(b,_)),o.isBuffer(b))return b.length===0?-1:D(m,b,N,_,A);if(typeof b=="number")return b=b&255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(m,b,N):Uint8Array.prototype.lastIndexOf.call(m,b,N):D(m,[b],N,_,A);throw new TypeError("val must be string, number or Buffer")}function D(m,b,N,_,A){let R=1,P=m.length,Q=b.length;if(_!==void 0&&(_=String(_).toLowerCase(),_==="ucs2"||_==="ucs-2"||_==="utf16le"||_==="utf-16le")){if(m.length<2||b.length<2)return-1;R=2,P/=2,Q/=2,N/=2}function de(qe,oe){return R===1?qe[oe]:qe.readUInt16BE(oe*R)}let Le;if(A){let qe=-1;for(Le=N;Le<P;Le++)if(de(m,Le)===de(b,qe===-1?0:Le-qe)){if(qe===-1&&(qe=Le),Le-qe+1===Q)return qe*R}else qe!==-1&&(Le-=Le-qe),qe=-1}else for(N+Q>P&&(N=P-Q),Le=N;Le>=0;Le--){let qe=!0;for(let oe=0;oe<Q;oe++)if(de(m,Le+oe)!==de(b,oe)){qe=!1;break}if(qe)return Le}return-1}o.prototype.includes=function(m,b,N){return this.indexOf(m,b,N)!==-1},o.prototype.indexOf=function(m,b,N){return B(this,m,b,N,!0)},o.prototype.lastIndexOf=function(m,b,N){return B(this,m,b,N,!1)};function V(m,b,N,_){N=Number(N)||0;const A=m.length-N;_?(_=Number(_),_>A&&(_=A)):_=A;const R=b.length;_>R/2&&(_=R/2);let P;for(P=0;P<_;++P){const Q=parseInt(b.substr(P*2,2),16);if(xn(Q))return P;m[N+P]=Q}return P}function q(m,b,N,_){return Qt(tn(b,m.length-N),m,N,_)}function K(m,b,N,_){return Qt($r(b),m,N,_)}function I(m,b,N,_){return Qt(Bt(b),m,N,_)}function G(m,b,N,_){return Qt(tt(b,m.length-N),m,N,_)}o.prototype.write=function(m,b,N,_){if(b===void 0)_="utf8",N=this.length,b=0;else if(N===void 0&&typeof b=="string")_=b,N=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite(N)?(N=N>>>0,_===void 0&&(_="utf8")):(_=N,N=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const A=this.length-b;if((N===void 0||N>A)&&(N=A),m.length>0&&(N<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");_||(_="utf8");let R=!1;for(;;)switch(_){case"hex":return V(this,m,b,N);case"utf8":case"utf-8":return q(this,m,b,N);case"ascii":case"latin1":case"binary":return K(this,m,b,N);case"base64":return I(this,m,b,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,m,b,N);default:if(R)throw new TypeError("Unknown encoding: "+_);_=(""+_).toLowerCase(),R=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(m,b,N){return b===0&&N===m.length?e.fromByteArray(m):e.fromByteArray(m.slice(b,N))}function se(m,b,N){N=Math.min(m.length,N);const _=[];let A=b;for(;A<N;){const R=m[A];let P=null,Q=R>239?4:R>223?3:R>191?2:1;if(A+Q<=N){let de,Le,qe,oe;switch(Q){case 1:R<128&&(P=R);break;case 2:de=m[A+1],(de&192)===128&&(oe=(R&31)<<6|de&63,oe>127&&(P=oe));break;case 3:de=m[A+1],Le=m[A+2],(de&192)===128&&(Le&192)===128&&(oe=(R&15)<<12|(de&63)<<6|Le&63,oe>2047&&(oe<55296||oe>57343)&&(P=oe));break;case 4:de=m[A+1],Le=m[A+2],qe=m[A+3],(de&192)===128&&(Le&192)===128&&(qe&192)===128&&(oe=(R&15)<<18|(de&63)<<12|(Le&63)<<6|qe&63,oe>65535&&oe<1114112&&(P=oe))}}P===null?(P=65533,Q=1):P>65535&&(P-=65536,_.push(P>>>10&1023|55296),P=56320|P&1023),_.push(P),A+=Q}return ue(_)}const re=4096;function ue(m){const b=m.length;if(b<=re)return String.fromCharCode.apply(String,m);let N="",_=0;for(;_<b;)N+=String.fromCharCode.apply(String,m.slice(_,_+=re));return N}function Se(m,b,N){let _="";N=Math.min(m.length,N);for(let A=b;A<N;++A)_+=String.fromCharCode(m[A]&127);return _}function ie(m,b,N){let _="";N=Math.min(m.length,N);for(let A=b;A<N;++A)_+=String.fromCharCode(m[A]);return _}function fe(m,b,N){const _=m.length;(!b||b<0)&&(b=0),(!N||N<0||N>_)&&(N=_);let A="";for(let R=b;R<N;++R)A+=z[m[R]];return A}function Me(m,b,N){const _=m.slice(b,N);let A="";for(let R=0;R<_.length-1;R+=2)A+=String.fromCharCode(_[R]+_[R+1]*256);return A}o.prototype.slice=function(m,b){const N=this.length;m=~~m,b=b===void 0?N:~~b,m<0?(m+=N,m<0&&(m=0)):m>N&&(m=N),b<0?(b+=N,b<0&&(b=0)):b>N&&(b=N),b<m&&(b=m);const _=this.subarray(m,b);return Object.setPrototypeOf(_,o.prototype),_};function ge(m,b,N){if(m%1!==0||m<0)throw new RangeError("offset is not uint");if(m+b>N)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(m,b,N){m=m>>>0,b=b>>>0,N||ge(m,b,this.length);let _=this[m],A=1,R=0;for(;++R<b&&(A*=256);)_+=this[m+R]*A;return _},o.prototype.readUintBE=o.prototype.readUIntBE=function(m,b,N){m=m>>>0,b=b>>>0,N||ge(m,b,this.length);let _=this[m+--b],A=1;for(;b>0&&(A*=256);)_+=this[m+--b]*A;return _},o.prototype.readUint8=o.prototype.readUInt8=function(m,b){return m=m>>>0,b||ge(m,1,this.length),this[m]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(m,b){return m=m>>>0,b||ge(m,2,this.length),this[m]|this[m+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(m,b){return m=m>>>0,b||ge(m,2,this.length),this[m]<<8|this[m+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(m,b){return m=m>>>0,b||ge(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+this[m+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(m,b){return m=m>>>0,b||ge(m,4,this.length),this[m]*16777216+(this[m+1]<<16|this[m+2]<<8|this[m+3])},o.prototype.readBigUInt64LE=X(function(m){m=m>>>0,Ae(m,"offset");const b=this[m],N=this[m+7];(b===void 0||N===void 0)&&Ke(m,this.length-8);const _=b+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24,A=this[++m]+this[++m]*2**8+this[++m]*2**16+N*2**24;return BigInt(_)+(BigInt(A)<<BigInt(32))}),o.prototype.readBigUInt64BE=X(function(m){m=m>>>0,Ae(m,"offset");const b=this[m],N=this[m+7];(b===void 0||N===void 0)&&Ke(m,this.length-8);const _=b*2**24+this[++m]*2**16+this[++m]*2**8+this[++m],A=this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+N;return(BigInt(_)<<BigInt(32))+BigInt(A)}),o.prototype.readIntLE=function(m,b,N){m=m>>>0,b=b>>>0,N||ge(m,b,this.length);let _=this[m],A=1,R=0;for(;++R<b&&(A*=256);)_+=this[m+R]*A;return A*=128,_>=A&&(_-=Math.pow(2,8*b)),_},o.prototype.readIntBE=function(m,b,N){m=m>>>0,b=b>>>0,N||ge(m,b,this.length);let _=b,A=1,R=this[m+--_];for(;_>0&&(A*=256);)R+=this[m+--_]*A;return A*=128,R>=A&&(R-=Math.pow(2,8*b)),R},o.prototype.readInt8=function(m,b){return m=m>>>0,b||ge(m,1,this.length),this[m]&128?(255-this[m]+1)*-1:this[m]},o.prototype.readInt16LE=function(m,b){m=m>>>0,b||ge(m,2,this.length);const N=this[m]|this[m+1]<<8;return N&32768?N|4294901760:N},o.prototype.readInt16BE=function(m,b){m=m>>>0,b||ge(m,2,this.length);const N=this[m+1]|this[m]<<8;return N&32768?N|4294901760:N},o.prototype.readInt32LE=function(m,b){return m=m>>>0,b||ge(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},o.prototype.readInt32BE=function(m,b){return m=m>>>0,b||ge(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},o.prototype.readBigInt64LE=X(function(m){m=m>>>0,Ae(m,"offset");const b=this[m],N=this[m+7];(b===void 0||N===void 0)&&Ke(m,this.length-8);const _=this[m+4]+this[m+5]*2**8+this[m+6]*2**16+(N<<24);return(BigInt(_)<<BigInt(32))+BigInt(b+this[++m]*256+this[++m]*65536+this[++m]*16777216)}),o.prototype.readBigInt64BE=X(function(m){m=m>>>0,Ae(m,"offset");const b=this[m],N=this[m+7];(b===void 0||N===void 0)&&Ke(m,this.length-8);const _=(b<<24)+this[++m]*2**16+this[++m]*2**8+this[++m];return(BigInt(_)<<BigInt(32))+BigInt(this[++m]*16777216+this[++m]*65536+this[++m]*256+N)}),o.prototype.readFloatLE=function(m,b){return m=m>>>0,b||ge(m,4,this.length),t.read(this,m,!0,23,4)},o.prototype.readFloatBE=function(m,b){return m=m>>>0,b||ge(m,4,this.length),t.read(this,m,!1,23,4)},o.prototype.readDoubleLE=function(m,b){return m=m>>>0,b||ge(m,8,this.length),t.read(this,m,!0,52,8)},o.prototype.readDoubleBE=function(m,b){return m=m>>>0,b||ge(m,8,this.length),t.read(this,m,!1,52,8)};function ne(m,b,N,_,A,R){if(!o.isBuffer(m))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>A||b<R)throw new RangeError('"value" argument is out of bounds');if(N+_>m.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(m,b,N,_){if(m=+m,b=b>>>0,N=N>>>0,!_){const P=Math.pow(2,8*N)-1;ne(this,m,b,N,P,0)}let A=1,R=0;for(this[b]=m&255;++R<N&&(A*=256);)this[b+R]=m/A&255;return b+N},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(m,b,N,_){if(m=+m,b=b>>>0,N=N>>>0,!_){const P=Math.pow(2,8*N)-1;ne(this,m,b,N,P,0)}let A=N-1,R=1;for(this[b+A]=m&255;--A>=0&&(R*=256);)this[b+A]=m/R&255;return b+N},o.prototype.writeUint8=o.prototype.writeUInt8=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,1,255,0),this[b]=m&255,b+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,2,65535,0),this[b]=m&255,this[b+1]=m>>>8,b+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,2,65535,0),this[b]=m>>>8,this[b+1]=m&255,b+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,4,4294967295,0),this[b+3]=m>>>24,this[b+2]=m>>>16,this[b+1]=m>>>8,this[b]=m&255,b+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,4,4294967295,0),this[b]=m>>>24,this[b+1]=m>>>16,this[b+2]=m>>>8,this[b+3]=m&255,b+4};function Ye(m,b,N,_,A){dn(b,_,A,m,N,7);let R=Number(b&BigInt(4294967295));m[N++]=R,R=R>>8,m[N++]=R,R=R>>8,m[N++]=R,R=R>>8,m[N++]=R;let P=Number(b>>BigInt(32)&BigInt(4294967295));return m[N++]=P,P=P>>8,m[N++]=P,P=P>>8,m[N++]=P,P=P>>8,m[N++]=P,N}function xe(m,b,N,_,A){dn(b,_,A,m,N,7);let R=Number(b&BigInt(4294967295));m[N+7]=R,R=R>>8,m[N+6]=R,R=R>>8,m[N+5]=R,R=R>>8,m[N+4]=R;let P=Number(b>>BigInt(32)&BigInt(4294967295));return m[N+3]=P,P=P>>8,m[N+2]=P,P=P>>8,m[N+1]=P,P=P>>8,m[N]=P,N+8}o.prototype.writeBigUInt64LE=X(function(m,b=0){return Ye(this,m,b,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=X(function(m,b=0){return xe(this,m,b,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(m,b,N,_){if(m=+m,b=b>>>0,!_){const Q=Math.pow(2,8*N-1);ne(this,m,b,N,Q-1,-Q)}let A=0,R=1,P=0;for(this[b]=m&255;++A<N&&(R*=256);)m<0&&P===0&&this[b+A-1]!==0&&(P=1),this[b+A]=(m/R>>0)-P&255;return b+N},o.prototype.writeIntBE=function(m,b,N,_){if(m=+m,b=b>>>0,!_){const Q=Math.pow(2,8*N-1);ne(this,m,b,N,Q-1,-Q)}let A=N-1,R=1,P=0;for(this[b+A]=m&255;--A>=0&&(R*=256);)m<0&&P===0&&this[b+A+1]!==0&&(P=1),this[b+A]=(m/R>>0)-P&255;return b+N},o.prototype.writeInt8=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,1,127,-128),m<0&&(m=255+m+1),this[b]=m&255,b+1},o.prototype.writeInt16LE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,2,32767,-32768),this[b]=m&255,this[b+1]=m>>>8,b+2},o.prototype.writeInt16BE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,2,32767,-32768),this[b]=m>>>8,this[b+1]=m&255,b+2},o.prototype.writeInt32LE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,4,2147483647,-2147483648),this[b]=m&255,this[b+1]=m>>>8,this[b+2]=m>>>16,this[b+3]=m>>>24,b+4},o.prototype.writeInt32BE=function(m,b,N){return m=+m,b=b>>>0,N||ne(this,m,b,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[b]=m>>>24,this[b+1]=m>>>16,this[b+2]=m>>>8,this[b+3]=m&255,b+4},o.prototype.writeBigInt64LE=X(function(m,b=0){return Ye(this,m,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=X(function(m,b=0){return xe(this,m,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ke(m,b,N,_,A,R){if(N+_>m.length)throw new RangeError("Index out of range");if(N<0)throw new RangeError("Index out of range")}function ze(m,b,N,_,A){return b=+b,N=N>>>0,A||ke(m,b,N,4),t.write(m,b,N,_,23,4),N+4}o.prototype.writeFloatLE=function(m,b,N){return ze(this,m,b,!0,N)},o.prototype.writeFloatBE=function(m,b,N){return ze(this,m,b,!1,N)};function Ze(m,b,N,_,A){return b=+b,N=N>>>0,A||ke(m,b,N,8),t.write(m,b,N,_,52,8),N+8}o.prototype.writeDoubleLE=function(m,b,N){return Ze(this,m,b,!0,N)},o.prototype.writeDoubleBE=function(m,b,N){return Ze(this,m,b,!1,N)},o.prototype.copy=function(m,b,N,_){if(!o.isBuffer(m))throw new TypeError("argument should be a Buffer");if(N||(N=0),!_&&_!==0&&(_=this.length),b>=m.length&&(b=m.length),b||(b=0),_>0&&_<N&&(_=N),_===N||m.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(N<0||N>=this.length)throw new RangeError("Index out of range");if(_<0)throw new RangeError("sourceEnd out of bounds");_>this.length&&(_=this.length),m.length-b<_-N&&(_=m.length-b+N);const A=_-N;return this===m&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,N,_):Uint8Array.prototype.set.call(m,this.subarray(N,_),b),A},o.prototype.fill=function(m,b,N,_){if(typeof m=="string"){if(typeof b=="string"?(_=b,b=0,N=this.length):typeof N=="string"&&(_=N,N=this.length),_!==void 0&&typeof _!="string")throw new TypeError("encoding must be a string");if(typeof _=="string"&&!o.isEncoding(_))throw new TypeError("Unknown encoding: "+_);if(m.length===1){const R=m.charCodeAt(0);(_==="utf8"&&R<128||_==="latin1")&&(m=R)}}else typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=Number(m));if(b<0||this.length<b||this.length<N)throw new RangeError("Out of range index");if(N<=b)return this;b=b>>>0,N=N===void 0?this.length:N>>>0,m||(m=0);let A;if(typeof m=="number")for(A=b;A<N;++A)this[A]=m;else{const R=o.isBuffer(m)?m:o.from(m,_),P=R.length;if(P===0)throw new TypeError('The value "'+m+'" is invalid for argument "value"');for(A=0;A<N-b;++A)this[A+b]=R[A%P]}return this};const bt={};function Rt(m,b,N){bt[m]=class extends N{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${m}]`,this.stack,delete this.name}get code(){return m}set code(_){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:_,writable:!0})}toString(){return`${this.name} [${m}]: ${this.message}`}}}Rt("ERR_BUFFER_OUT_OF_BOUNDS",function(m){return m?`${m} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Rt("ERR_INVALID_ARG_TYPE",function(m,b){return`The "${m}" argument must be of type number. Received type ${typeof b}`},TypeError),Rt("ERR_OUT_OF_RANGE",function(m,b,N){let _=`The value of "${m}" is out of range.`,A=N;return Number.isInteger(N)&&Math.abs(N)>4294967296?A=It(String(N)):typeof N=="bigint"&&(A=String(N),(N>BigInt(2)**BigInt(32)||N<-(BigInt(2)**BigInt(32)))&&(A=It(A)),A+="n"),_+=` It must be ${b}. Received ${A}`,_},RangeError);function It(m){let b="",N=m.length;const _=m[0]==="-"?1:0;for(;N>=_+4;N-=3)b=`_${m.slice(N-3,N)}${b}`;return`${m.slice(0,N)}${b}`}function Kt(m,b,N){Ae(b,"offset"),(m[b]===void 0||m[b+N]===void 0)&&Ke(b,m.length-(N+1))}function dn(m,b,N,_,A,R){if(m>N||m<b){const P=typeof b=="bigint"?"n":"";let Q;throw R>3?b===0||b===BigInt(0)?Q=`>= 0${P} and < 2${P} ** ${(R+1)*8}${P}`:Q=`>= -(2${P} ** ${(R+1)*8-1}${P}) and < 2 ** ${(R+1)*8-1}${P}`:Q=`>= ${b}${P} and <= ${N}${P}`,new bt.ERR_OUT_OF_RANGE("value",Q,m)}Kt(_,A,R)}function Ae(m,b){if(typeof m!="number")throw new bt.ERR_INVALID_ARG_TYPE(b,"number",m)}function Ke(m,b,N){throw Math.floor(m)!==m?(Ae(m,N),new bt.ERR_OUT_OF_RANGE(N||"offset","an integer",m)):b<0?new bt.ERR_BUFFER_OUT_OF_BOUNDS:new bt.ERR_OUT_OF_RANGE(N||"offset",`>= ${N?1:0} and <= ${b}`,m)}const Qn=/[^+/0-9A-Za-z-_]/g;function jt(m){if(m=m.split("=")[0],m=m.trim().replace(Qn,""),m.length<2)return"";for(;m.length%4!==0;)m=m+"=";return m}function tn(m,b){b=b||1/0;let N;const _=m.length;let A=null;const R=[];for(let P=0;P<_;++P){if(N=m.charCodeAt(P),N>55295&&N<57344){if(!A){if(N>56319){(b-=3)>-1&&R.push(239,191,189);continue}else if(P+1===_){(b-=3)>-1&&R.push(239,191,189);continue}A=N;continue}if(N<56320){(b-=3)>-1&&R.push(239,191,189),A=N;continue}N=(A-55296<<10|N-56320)+65536}else A&&(b-=3)>-1&&R.push(239,191,189);if(A=null,N<128){if((b-=1)<0)break;R.push(N)}else if(N<2048){if((b-=2)<0)break;R.push(N>>6|192,N&63|128)}else if(N<65536){if((b-=3)<0)break;R.push(N>>12|224,N>>6&63|128,N&63|128)}else if(N<1114112){if((b-=4)<0)break;R.push(N>>18|240,N>>12&63|128,N>>6&63|128,N&63|128)}else throw new Error("Invalid code point")}return R}function $r(m){const b=[];for(let N=0;N<m.length;++N)b.push(m.charCodeAt(N)&255);return b}function tt(m,b){let N,_,A;const R=[];for(let P=0;P<m.length&&!((b-=2)<0);++P)N=m.charCodeAt(P),_=N>>8,A=N%256,R.push(A),R.push(_);return R}function Bt(m){return e.toByteArray(jt(m))}function Qt(m,b,N,_){let A;for(A=0;A<_&&!(A+N>=b.length||A>=m.length);++A)b[A+N]=m[A];return A}function st(m,b){return m instanceof b||m!=null&&m.constructor!=null&&m.constructor.name!=null&&m.constructor.name===b.name}function xn(m){return m!==m}const z=function(){const m="0123456789abcdef",b=new Array(256);for(let N=0;N<16;++N){const _=N*16;for(let A=0;A<16;++A)b[_+A]=m[N]+m[A]}return b}();function X(m){return typeof BigInt>"u"?te:m}function te(){throw new Error("BigInt not supported")}})(Ym);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=Ym,r=t.Buffer;function a(s,o){for(var l in s)o[l]=s[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=t:(a(t,e),e.Buffer=i);function i(s,o,l){return r(s,o,l)}i.prototype=Object.create(r.prototype),a(r,i),i.from=function(s,o,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return r(s,o,l)},i.alloc=function(s,o,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var c=r(s);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r(s)},i.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(s)}})(Gm,Gm.exports);var Vi=Gm.exports,XE=Vi.Buffer;function sh(n,e){this._block=XE.alloc(n),this._finalSize=e,this._blockSize=n,this._len=0}sh.prototype.update=function(n,e){typeof n=="string"&&(e=e||"utf8",n=XE.from(n,e));for(var t=this._block,r=this._blockSize,a=n.length,i=this._len,s=0;s<a;){for(var o=i%r,l=Math.min(a-s,r-o),c=0;c<l;c++)t[o+c]=n[s+c];i+=l,s+=l,i%r===0&&this._update(t)}return this._len+=a,this},sh.prototype.digest=function(n){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var t=this._len*8;if(t<=4294967295)this._block.writeUInt32BE(t,this._blockSize-4);else{var r=(t&4294967295)>>>0,a=(t-r)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var i=this._hash();return n?i.toString(n):i},sh.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var Ys=sh,ZS=Qs,ZE=Ys,eR=Vi.Buffer,tR=[1518500249,1859775393,-1894007588,-899497514],nR=new Array(80);function Ol(){this.init(),this._w=nR,ZE.call(this,64,56)}ZS(Ol,ZE),Ol.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function rR(n){return n<<5|n>>>27}function aR(n){return n<<30|n>>>2}function iR(n,e,t,r){return n===0?e&t|~e&r:n===2?e&t|e&r|t&r:e^t^r}Ol.prototype._update=function(n){for(var e=this._w,t=this._a|0,r=this._b|0,a=this._c|0,i=this._d|0,s=this._e|0,o=0;o<16;++o)e[o]=n.readInt32BE(o*4);for(;o<80;++o)e[o]=e[o-3]^e[o-8]^e[o-14]^e[o-16];for(var l=0;l<80;++l){var c=~~(l/20),u=rR(t)+iR(c,r,a,i)+s+e[l]+tR[c]|0;s=i,i=a,a=aR(r),r=t,t=u}this._a=t+this._a|0,this._b=r+this._b|0,this._c=a+this._c|0,this._d=i+this._d|0,this._e=s+this._e|0},Ol.prototype._hash=function(){var n=eR.allocUnsafe(20);return n.writeInt32BE(this._a|0,0),n.writeInt32BE(this._b|0,4),n.writeInt32BE(this._c|0,8),n.writeInt32BE(this._d|0,12),n.writeInt32BE(this._e|0,16),n};var sR=Ol,oR=Qs,ew=Ys,lR=Vi.Buffer,cR=[1518500249,1859775393,-1894007588,-899497514],uR=new Array(80);function _l(){this.init(),this._w=uR,ew.call(this,64,56)}oR(_l,ew),_l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function hR(n){return n<<1|n>>>31}function dR(n){return n<<5|n>>>27}function pR(n){return n<<30|n>>>2}function mR(n,e,t,r){return n===0?e&t|~e&r:n===2?e&t|e&r|t&r:e^t^r}_l.prototype._update=function(n){for(var e=this._w,t=this._a|0,r=this._b|0,a=this._c|0,i=this._d|0,s=this._e|0,o=0;o<16;++o)e[o]=n.readInt32BE(o*4);for(;o<80;++o)e[o]=hR(e[o-3]^e[o-8]^e[o-14]^e[o-16]);for(var l=0;l<80;++l){var c=~~(l/20),u=dR(t)+mR(c,r,a,i)+s+e[l]+cR[c]|0;s=i,i=a,a=pR(r),r=t,t=u}this._a=t+this._a|0,this._b=r+this._b|0,this._c=a+this._c|0,this._d=i+this._d|0,this._e=s+this._e|0},_l.prototype._hash=function(){var n=lR.allocUnsafe(20);return n.writeInt32BE(this._a|0,0),n.writeInt32BE(this._b|0,4),n.writeInt32BE(this._c|0,8),n.writeInt32BE(this._d|0,12),n.writeInt32BE(this._e|0,16),n};var fR=_l,yR=Qs,tw=Ys,gR=Vi.Buffer,bR=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],vR=new Array(64);function xl(){this.init(),this._w=vR,tw.call(this,64,56)}yR(xl,tw),xl.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function ER(n,e,t){return t^n&(e^t)}function wR(n,e,t){return n&e|t&(n|e)}function TR(n){return(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10)}function NR(n){return(n>>>6|n<<26)^(n>>>11|n<<21)^(n>>>25|n<<7)}function CR(n){return(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3}function AR(n){return(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10}xl.prototype._update=function(n){for(var e=this._w,t=this._a|0,r=this._b|0,a=this._c|0,i=this._d|0,s=this._e|0,o=this._f|0,l=this._g|0,c=this._h|0,u=0;u<16;++u)e[u]=n.readInt32BE(u*4);for(;u<64;++u)e[u]=AR(e[u-2])+e[u-7]+CR(e[u-15])+e[u-16]|0;for(var h=0;h<64;++h){var d=c+NR(s)+ER(s,o,l)+bR[h]+e[h]|0,f=TR(t)+wR(t,r,a)|0;c=l,l=o,o=s,s=i+d|0,i=a,a=r,r=t,t=d+f|0}this._a=t+this._a|0,this._b=r+this._b|0,this._c=a+this._c|0,this._d=i+this._d|0,this._e=s+this._e|0,this._f=o+this._f|0,this._g=l+this._g|0,this._h=c+this._h|0},xl.prototype._hash=function(){var n=gR.allocUnsafe(32);return n.writeInt32BE(this._a,0),n.writeInt32BE(this._b,4),n.writeInt32BE(this._c,8),n.writeInt32BE(this._d,12),n.writeInt32BE(this._e,16),n.writeInt32BE(this._f,20),n.writeInt32BE(this._g,24),n.writeInt32BE(this._h,28),n};var nw=xl,SR=Qs,RR=nw,MR=Ys,OR=Vi.Buffer,_R=new Array(64);function oh(){this.init(),this._w=_R,MR.call(this,64,56)}SR(oh,RR),oh.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},oh.prototype._hash=function(){var n=OR.allocUnsafe(28);return n.writeInt32BE(this._a,0),n.writeInt32BE(this._b,4),n.writeInt32BE(this._c,8),n.writeInt32BE(this._d,12),n.writeInt32BE(this._e,16),n.writeInt32BE(this._f,20),n.writeInt32BE(this._g,24),n};var xR=oh,PR=Qs,rw=Ys,IR=Vi.Buffer,aw=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],DR=new Array(160);function Pl(){this.init(),this._w=DR,rw.call(this,128,112)}PR(Pl,rw),Pl.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function iw(n,e,t){return t^n&(e^t)}function sw(n,e,t){return n&e|t&(n|e)}function ow(n,e){return(n>>>28|e<<4)^(e>>>2|n<<30)^(e>>>7|n<<25)}function lw(n,e){return(n>>>14|e<<18)^(n>>>18|e<<14)^(e>>>9|n<<23)}function LR(n,e){return(n>>>1|e<<31)^(n>>>8|e<<24)^n>>>7}function qR(n,e){return(n>>>1|e<<31)^(n>>>8|e<<24)^(n>>>7|e<<25)}function $R(n,e){return(n>>>19|e<<13)^(e>>>29|n<<3)^n>>>6}function kR(n,e){return(n>>>19|e<<13)^(e>>>29|n<<3)^(n>>>6|e<<26)}function zt(n,e){return n>>>0<e>>>0?1:0}Pl.prototype._update=function(n){for(var e=this._w,t=this._ah|0,r=this._bh|0,a=this._ch|0,i=this._dh|0,s=this._eh|0,o=this._fh|0,l=this._gh|0,c=this._hh|0,u=this._al|0,h=this._bl|0,d=this._cl|0,f=this._dl|0,g=this._el|0,v=this._fl|0,C=this._gl|0,w=this._hl|0,T=0;T<32;T+=2)e[T]=n.readInt32BE(T*4),e[T+1]=n.readInt32BE(T*4+4);for(;T<160;T+=2){var S=e[T-30],O=e[T-15*2+1],k=LR(S,O),B=qR(O,S);S=e[T-4],O=e[T-4+1];var D=$R(S,O),V=kR(O,S),q=e[T-7*2],K=e[T-7*2+1],I=e[T-16*2],G=e[T-16*2+1],H=B+K|0,se=k+q+zt(H,B)|0;H=H+V|0,se=se+D+zt(H,V)|0,H=H+G|0,se=se+I+zt(H,G)|0,e[T]=se,e[T+1]=H}for(var re=0;re<160;re+=2){se=e[re],H=e[re+1];var ue=sw(t,r,a),Se=sw(u,h,d),ie=ow(t,u),fe=ow(u,t),Me=lw(s,g),ge=lw(g,s),ne=aw[re],Ye=aw[re+1],xe=iw(s,o,l),ke=iw(g,v,C),ze=w+ge|0,Ze=c+Me+zt(ze,w)|0;ze=ze+ke|0,Ze=Ze+xe+zt(ze,ke)|0,ze=ze+Ye|0,Ze=Ze+ne+zt(ze,Ye)|0,ze=ze+H|0,Ze=Ze+se+zt(ze,H)|0;var bt=fe+Se|0,Rt=ie+ue+zt(bt,fe)|0;c=l,w=C,l=o,C=v,o=s,v=g,g=f+ze|0,s=i+Ze+zt(g,f)|0,i=a,f=d,a=r,d=h,r=t,h=u,u=ze+bt|0,t=Ze+Rt+zt(u,ze)|0}this._al=this._al+u|0,this._bl=this._bl+h|0,this._cl=this._cl+d|0,this._dl=this._dl+f|0,this._el=this._el+g|0,this._fl=this._fl+v|0,this._gl=this._gl+C|0,this._hl=this._hl+w|0,this._ah=this._ah+t+zt(this._al,u)|0,this._bh=this._bh+r+zt(this._bl,h)|0,this._ch=this._ch+a+zt(this._cl,d)|0,this._dh=this._dh+i+zt(this._dl,f)|0,this._eh=this._eh+s+zt(this._el,g)|0,this._fh=this._fh+o+zt(this._fl,v)|0,this._gh=this._gh+l+zt(this._gl,C)|0,this._hh=this._hh+c+zt(this._hl,w)|0},Pl.prototype._hash=function(){var n=IR.allocUnsafe(64);function e(t,r,a){n.writeInt32BE(t,a),n.writeInt32BE(r,a+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),n};var cw=Pl,jR=Qs,BR=cw,UR=Ys,FR=Vi.Buffer,VR=new Array(160);function lh(){this.init(),this._w=VR,UR.call(this,128,112)}jR(lh,BR),lh.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},lh.prototype._hash=function(){var n=FR.allocUnsafe(48);function e(t,r,a){n.writeInt32BE(t,a),n.writeInt32BE(r,a+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),n};var zR=lh,zi=YE.exports=function(n){n=n.toLowerCase();var e=zi[n];if(!e)throw new Error(n+" is not supported (we accept pull requests)");return new e};zi.sha=sR,zi.sha1=fR,zi.sha224=xR,zi.sha256=nw,zi.sha384=zR,zi.sha512=cw;var WR=YE.exports;const HR=Mi(WR);function Zm(n,e=!1){return e&&(n=" "+n),n.replace(/^([A-Z])|[\s-_](\w)/g,function(t,r,a){return a?a.toUpperCase():r.toLowerCase()})}function uw(n){return n.replace(/([A-Z])([A-Z])([a-z])/g,"$1_$2$3").replace(/([a-z0-9])([A-Z])/g,"$1_$2").toLowerCase()}function KR(n){return n.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())}function hw(n,e={}){const{segmentLength:t=4,separator:r="__",termLength:a=2}=e;return n.split(r).reduce((i,s)=>{const o=s.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),l=o.length>1?a:t,c=o.map(u=>u.substr(0,l)).join("");return i.push(c),i},[]).join(r)}function QR(n,e={}){const t=HR("sha1");t.update(n,"utf8");const r=t.digest("hex");return e.length?r.slice(0,e.length):r}class GR{constructor(){this.nestedSetColumnNames={left:"nsleft",right:"nsright"},this.materializedPathColumnName="mpath"}getTableName(e){return typeof e!="string"&&(e=e.name),e.split(".").pop()}tableName(e,t){return t||uw(e)}closureJunctionTableName(e){return e+"_closure"}columnName(e,t,r){const a=t||e;return r.length?Zm(r.join("_"))+KR(a):a}relationName(e){return e}primaryKeyName(e,t){const r=[...t];r.sort();const a=`${this.getTableName(e).replace(".","_")}_${r.join("_")}`;return"PK_"+si.sha1(a).substr(0,27)}uniqueConstraintName(e,t){const r=[...t];r.sort();const a=`${this.getTableName(e).replace(".","_")}_${r.join("_")}`;return"UQ_"+si.sha1(a).substr(0,27)}relationConstraintName(e,t,r){const a=[...t];a.sort();let i=`${this.getTableName(e).replace(".","_")}_${a.join("_")}`;return r&&(i+=`_${r}`),"REL_"+si.sha1(i).substr(0,26)}defaultConstraintName(e,t){const r=`${this.getTableName(e).replace(".","_")}_${t}`;return"DF_"+si.sha1(r).substr(0,27)}foreignKeyName(e,t,r,a){const i=[...t];i.sort();const s=`${this.getTableName(e).replace(".","_")}_${i.join("_")}`;return"FK_"+si.sha1(s).substr(0,27)}indexName(e,t,r){const a=[...t];a.sort();let i=`${this.getTableName(e).replace(".","_")}_${a.join("_")}`;return r&&(i+=`_${r}`),"IDX_"+si.sha1(i).substr(0,26)}checkConstraintName(e,t,r){const a=`${this.getTableName(e).replace(".","_")}_${t}`,i="CHK_"+si.sha1(a).substr(0,26);return r?`${i}_ENUM`:i}exclusionConstraintName(e,t){const r=`${this.getTableName(e).replace(".","_")}_${t}`;return"XCL_"+si.sha1(r).substr(0,26)}joinColumnName(e,t){return Zm(e+"_"+t)}joinTableName(e,t,r,a){return uw(e+"_"+r.replace(/\./gi,"_")+"_"+t)}joinTableColumnDuplicationPrefix(e,t){return e+"_"+t}joinTableColumnName(e,t,r){return Zm(e+"_"+(r||t))}joinTableInverseColumnName(e,t,r){return this.joinTableColumnName(e,t,r)}prefixTableName(e,t){return e+t}eagerJoinRelationAlias(e,t){return e+"_"+t.replace(".","_")}}class $ extends Error{get name(){return this.constructor.name}constructor(e){super(e),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class ch extends ${constructor(e){super(`Internal error. Subject ${e.metadata.targetName} must have an identifier to perform operation.`)}}class YR extends ${constructor(e){super(`Cannot create a "${e}" connection because connection to the database already established.`)}}class Js extends ${constructor(){super("Locking not supported on given driver.")}}class JR extends ${constructor(e,t){super();const r=e.primaryColumns.reduce((a,i,s)=>(i.setEntityValue(a,s+1),a),{});this.message=`Cannot use given entity id "${t}" because "${e.targetName}" contains multiple primary columns, you must provide object in following form: ${JSON.stringify(r)} as an id.`}}class XR extends ${constructor(e){super(`Cannot ${e}, given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.`)}}class ZR extends ${constructor(e){super(`Tree repositories are not supported in ${e.options.type} driver.`)}}class dw extends ${constructor(e){super(`Custom repository ${typeof e=="function"?e.name:e.constructor.name} was not found. Did you forgot to put @EntityRepository decorator on it?`)}}class rr extends ${constructor(){super("Transaction is not started yet, start transaction before committing or rolling it back.")}}class eM extends ${constructor(){super("Transaction already started for the given connection, commit current transaction before starting a new one.")}}class Ue{static isObject(e){return e!==null&&typeof e=="object"}static isObjectWithName(e){return e!==null&&typeof e=="object"&&e.name!==void 0}static assign(e,...t){for(const r of t)for(const a of Object.getOwnPropertyNames(r))e[a]=r[a]}static mixedListToArray(e){return e!==null&&typeof e=="object"?Object.keys(e).map(t=>e[t]):e}}class F{static isMssqlParameter(e){return this.check(e,"MssqlParameter")}static isEntityMetadata(e){return this.check(e,"EntityMetadata")}static isColumnMetadata(e){return this.check(e,"ColumnMetadata")}static isSelectQueryBuilder(e){return this.check(e,"SelectQueryBuilder")}static isInsertQueryBuilder(e){return this.check(e,"InsertQueryBuilder")}static isDeleteQueryBuilder(e){return this.check(e,"DeleteQueryBuilder")}static isUpdateQueryBuilder(e){return this.check(e,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(e){return this.check(e,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(e){return this.check(e,"RelationQueryBuilder")}static isBrackets(e){return this.check(e,"Brackets")||this.check(e,"NotBrackets")}static isNotBrackets(e){return this.check(e,"NotBrackets")}static isSubject(e){return this.check(e,"Subject")}static isRdbmsSchemaBuilder(e){return this.check(e,"RdbmsSchemaBuilder")}static isMongoEntityManager(e){return this.check(e,"MongoEntityManager")}static isSqljsEntityManager(e){return this.check(e,"SqljsEntityManager")}static isEntitySchema(e){return this.check(e,"EntitySchema")}static isBaseEntityConstructor(e){return typeof e=="function"&&typeof e.hasId=="function"&&typeof e.save=="function"&&typeof e.useDataSource=="function"}static isFindOperator(e){return this.check(e,"FindOperator")||this.check(e,"EqualOperator")}static isEqualOperator(e){return this.check(e,"EqualOperator")}static isQuery(e){return this.check(e,"Query")}static isTable(e){return this.check(e,"Table")}static isTableCheck(e){return this.check(e,"TableCheck")}static isTableColumn(e){return this.check(e,"TableColumn")}static isTableExclusion(e){return this.check(e,"TableExclusion")}static isTableForeignKey(e){return this.check(e,"TableForeignKey")}static isTableIndex(e){return this.check(e,"TableIndex")}static isTableUnique(e){return this.check(e,"TableUnique")}static isView(e){return this.check(e,"View")}static isDataSource(e){return this.check(e,"DataSource")}static check(e,t){return typeof e=="object"&&e!==null&&e["@instanceof"]===Symbol.for(t)}}class ef extends ${constructor(e,t){super(),this.message=`Could not find any entity of type "${this.stringifyTarget(e)}" matching: ${this.stringifyCriteria(t)}`}stringifyTarget(e){return F.isEntitySchema(e)?e.options.name:typeof e=="function"||Ue.isObject(e)&&"name"in e?e.name:e}stringifyCriteria(e){try{return JSON.stringify(e,null,4)}catch{}return""+e}}class tM extends ${constructor(e){super(),this.message=`No metadata for "${this.stringifyTarget(e)}" was found.`}stringifyTarget(e){return F.isEntitySchema(e)?e.options.name:typeof e=="function"||Ue.isObject(e)&&"name"in e?e.name:e}}class nM extends ${constructor(e,t){super(`Cannot ${e}, given value must be an entity, instead "${t}" is given.`)}}class pw extends ${constructor(e,t,r){super(`The optimistic lock on entity ${e} failed, version ${t} was expected, but is actually ${r}.`)}}class rM extends ${constructor(e){super(`Custom entity repository ${typeof e=="function"?e.name:e.constructor.name}  cannot inherit Repository class without entity being set in the @EntityRepository decorator.`)}}class mw extends ${constructor(){super("Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.")}}class fw extends ${constructor(e){super(`Cannot attach entity "${e}" to its parent. Please make sure parent is saved in the database before saving children nodes.`)}}class tf extends ${constructor(e){super(`Custom repository ${typeof e=="function"?e.name:e.constructor.name} does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? `)}}class aM extends ${constructor(e){super(`Circular relations detected: ${e}. To resolve this issue you need to set nullable: true somewhere in this dependency structure.`)}}class iM extends ${constructor(e){super(`Entity "${e.name}" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.`)}}class Hr extends ${constructor(e,t){super(e),Object.setPrototypeOf(this,Hr.prototype),this.message=`Property "${e}" was not found in "${t.targetName}". Make sure your query is correct.`}}class sM extends ${constructor(e,t=[]){super(`Wrong driver: "${e}" given. Supported drivers are: ${t.map(r=>`"${r}"`).join(", ")}.`)}}class Xs extends ${constructor(e,t){super(`${e} package has not been found installed. Try to install it: npm install ${t} --save`)}}class oM extends ${constructor(e){super(`Entity ${e} does not have version or update date columns.`)}}class Il extends ${constructor(){super("The optimistic lock can be used only with getOne() method.")}}class lM extends ${constructor(e){super(`Driver option (${e}) is not set. Please set it to perform connection to the database.`)}}class cM extends ${constructor(e){super(),e.length===1?this.message=`Relation "${e[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${e.map(t=>`"${t}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class uM extends ${constructor(){super("An open transaction is required for pessimistic lock.")}}class hM extends ${constructor(e,t,r){super();const a=typeof t=="string"?t:t.name;this.message=`Data type "${a}" in "${e.entityMetadata.targetName}.${e.propertyName}" is not supported by "${r}" database.`}}class dM extends ${constructor(e){super(`Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "${e.entityMetadata.targetName}#${e.propertyPath}". This is ORM requirement to make relations to work properly. Refer docs for more information.`)}}class Kr extends ${constructor(e,t,r){if(super(r.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,"")),this.query=e,this.parameters=t,this.driverError=r,r){const{name:a,...i}=r;Ue.assign(this,{...i})}}}class pM extends ${constructor(){super("Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.")}}class mM extends ${constructor(e){super(`Removed entity "${e.metadata.name}" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).`)}}class yw extends ${constructor(e,t){super(`Column type for ${e.constructor.name}#${t} is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.`)}}class bn extends ${constructor(){super("Query runner already released. Cannot run queries anymore.")}}class fM extends ${constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class Dl extends ${constructor(e){super(`Cannot execute operation on "${e}" connection because connection is not yet established.`)}}class yM extends ${constructor(e){super(`Option "${e}" is not set in your connection options, please define "${e}" option in your connection options or ormconfig.json`)}}class gM extends ${constructor(e){const t=e.map(r=>`"${r.name}"`);super(`Migrations ${t.join(", ")} override the transaction mode, but the global transaction mode is "all"`)}}class Sn{constructor(e){this["@instanceof"]=Symbol.for("TableColumn"),this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,e&&(this.name=e.name,this.type=e.type||"",this.length=e.length||"",this.width=e.width,this.charset=e.charset,this.collation=e.collation,this.precision=e.precision,this.scale=e.scale,this.zerofill=e.zerofill||!1,this.unsigned=this.zerofill?!0:e.unsigned||!1,this.default=e.default,this.onUpdate=e.onUpdate,this.isNullable=e.isNullable||!1,this.isGenerated=e.isGenerated||!1,this.generationStrategy=e.generationStrategy,this.generatedIdentity=e.generatedIdentity,this.isPrimary=e.isPrimary||!1,this.isUnique=e.isUnique||!1,this.isArray=e.isArray||!1,this.comment=e.comment,this.enum=e.enum,this.enumName=e.enumName,this.primaryKeyConstraintName=e.primaryKeyConstraintName,this.asExpression=e.asExpression,this.generatedType=e.generatedType,this.spatialFeatureType=e.spatialFeatureType,this.srid=e.srid)}clone(){return new Sn({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,enumName:this.enumName,primaryKeyConstraintName:this.primaryKeyConstraintName,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,generatedIdentity:this.generatedIdentity,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})}}class Ct{constructor(e){this["@instanceof"]=Symbol.for("TableIndex"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isFulltext=!!e.isFulltext,this.isNullFiltered=!!e.isNullFiltered,this.parser=e.parser,this.where=e.where?e.where:""}clone(){return new Ct({name:this.name,columnNames:[...this.columnNames],isUnique:this.isUnique,isSpatial:this.isSpatial,isFulltext:this.isFulltext,isNullFiltered:this.isNullFiltered,parser:this.parser,where:this.where})}static create(e){return new Ct({name:e.name,columnNames:e.columns.map(t=>t.databaseName),isUnique:e.isUnique,isSpatial:e.isSpatial,isFulltext:e.isFulltext,isNullFiltered:e.isNullFiltered,parser:e.parser,where:e.where})}}class ar{constructor(e){this["@instanceof"]=Symbol.for("TableForeignKey"),this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedDatabase=e.referencedDatabase,this.referencedSchema=e.referencedSchema,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}clone(){return new ar({name:this.name,columnNames:[...this.columnNames],referencedColumnNames:[...this.referencedColumnNames],referencedDatabase:this.referencedDatabase,referencedSchema:this.referencedSchema,referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})}static create(e,t){return new ar({name:e.name,columnNames:e.columnNames,referencedColumnNames:e.referencedColumnNames,referencedDatabase:e.referencedEntityMetadata.database,referencedSchema:e.referencedEntityMetadata.schema,referencedTableName:e.referencedTablePath,onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable})}}class uh{static createTableColumnOptions(e,t){return{name:e.databaseName,length:t.getColumnLength(e),width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:t.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,generatedIdentity:e.generatedIdentity,isNullable:e.isNullable,type:t.normalizeType(e),isPrimary:e.isPrimary,isUnique:t.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map(r=>r+""):e.enum,enumName:e.enumName,primaryKeyConstraintName:e.primaryKeyConstraintName,spatialFeatureType:e.spatialFeatureType,srid:e.srid}}}class cn{constructor(e){this["@instanceof"]=Symbol.for("TableUnique"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.deferrable=e.deferrable}clone(){return new cn({name:this.name,columnNames:[...this.columnNames],deferrable:this.deferrable})}static create(e){return new cn({name:e.name,columnNames:e.columns.map(t=>t.databaseName),deferrable:e.deferrable})}}class Sr{constructor(e){this["@instanceof"]=Symbol.for("TableCheck"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}clone(){return new Sr({name:this.name,columnNames:this.columnNames?[...this.columnNames]:[],expression:this.expression})}static create(e){return new Sr({name:e.name,expression:e.expression})}}class Wi{constructor(e){this["@instanceof"]=Symbol.for("TableExclusion"),this.name=e.name,this.expression=e.expression}clone(){return new Wi({name:this.name,expression:this.expression})}static create(e){return new Wi({name:e.name,expression:e.expression})}}let _t=class mg{constructor(e){this["@instanceof"]=Symbol.for("Table"),this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,this.withoutRowid=!1,e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,e.columns&&(this.columns=e.columns.map(t=>new Sn(t))),e.indices&&(this.indices=e.indices.map(t=>new Ct(t))),e.foreignKeys&&(this.foreignKeys=e.foreignKeys.map(t=>new ar({...t,referencedDatabase:(t==null?void 0:t.referencedDatabase)||e.database,referencedSchema:(t==null?void 0:t.referencedSchema)||e.schema}))),e.uniques&&(this.uniques=e.uniques.map(t=>new cn(t))),e.checks&&(this.checks=e.checks.map(t=>new Sr(t))),e.exclusions&&(this.exclusions=e.exclusions.map(t=>new Wi(t))),e.justCreated!==void 0&&(this.justCreated=e.justCreated),e.withoutRowid&&(this.withoutRowid=e.withoutRowid),this.engine=e.engine)}get primaryColumns(){return this.columns.filter(e=>e.isPrimary)}clone(){return new mg({schema:this.schema,database:this.database,name:this.name,columns:this.columns.map(e=>e.clone()),indices:this.indices.map(e=>e.clone()),foreignKeys:this.foreignKeys.map(e=>e.clone()),uniques:this.uniques.map(e=>e.clone()),checks:this.checks.map(e=>e.clone()),exclusions:this.exclusions.map(e=>e.clone()),justCreated:this.justCreated,withoutRowid:this.withoutRowid,engine:this.engine})}addColumn(e){this.columns.push(e)}removeColumn(e){const t=this.columns.find(r=>r.name===e.name);t&&this.columns.splice(this.columns.indexOf(t),1)}addUniqueConstraint(e){if(this.uniques.push(e),e.columnNames.length===1){const t=this.columns.find(r=>r.name===e.columnNames[0]);t&&(t.isUnique=!0)}}removeUniqueConstraint(e){const t=this.uniques.find(r=>r.name===e.name);if(t&&(this.uniques.splice(this.uniques.indexOf(t),1),t.columnNames.length===1)){const r=this.columns.find(a=>a.name===t.columnNames[0]);r&&(r.isUnique=!1)}}addCheckConstraint(e){this.checks.push(e)}removeCheckConstraint(e){const t=this.checks.find(r=>r.name===e.name);t&&this.checks.splice(this.checks.indexOf(t),1)}addExclusionConstraint(e){this.exclusions.push(e)}removeExclusionConstraint(e){const t=this.exclusions.find(r=>r.name===e.name);t&&this.exclusions.splice(this.exclusions.indexOf(t),1)}addForeignKey(e){this.foreignKeys.push(e)}removeForeignKey(e){const t=this.foreignKeys.find(r=>r.name===e.name);t&&this.foreignKeys.splice(this.foreignKeys.indexOf(t),1)}addIndex(e,t=!1){if(this.indices.push(e),e.columnNames.length===1&&e.isUnique&&t){const r=this.columns.find(a=>a.name===e.columnNames[0]);r&&(r.isUnique=!0)}}removeIndex(e,t=!1){const r=this.indices.find(a=>a.name===e.name);if(r&&(this.indices.splice(this.indices.indexOf(r),1),r.columnNames.length===1&&r.isUnique&&t)){const a=this.columns.find(i=>i.name===r.columnNames[0]);a&&(a.isUnique=this.indices.some(i=>i.columnNames.length===1&&i.columnNames[0]===a.name&&!!r.isUnique))}}findColumnByName(e){return this.columns.find(t=>t.name===e)}findColumnIndices(e){return this.indices.filter(t=>!!t.columnNames.find(r=>r===e.name))}findColumnForeignKeys(e){return this.foreignKeys.filter(t=>!!t.columnNames.find(r=>r===e.name))}findColumnUniques(e){return this.uniques.filter(t=>!!t.columnNames.find(r=>r===e.name))}findColumnChecks(e){return this.checks.filter(t=>!!t.columnNames.find(r=>r===e.name))}static create(e,t){const r=e.database===t.database?void 0:e.database,a=e.schema===t.options.schema?void 0:e.schema,i={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,a,r),withoutRowid:e.withoutRowid,engine:e.engine,columns:e.columns.filter(s=>s&&!s.isVirtualProperty).map(s=>uh.createTableColumnOptions(s,t)),indices:e.indices.filter(s=>s.synchronize===!0).map(s=>Ct.create(s)),uniques:e.uniques.map(s=>cn.create(s)),checks:e.checks.map(s=>Sr.create(s)),exclusions:e.exclusions.map(s=>Wi.create(s))};return new mg(i)}};class gw{constructor(e,t,r,a,i){this.id=e,this.timestamp=t,this.name=r,this.instance=a,this.transaction=i}}class Rr{constructor(e,t,...r){this.value=e,this.type=t,this["@instanceof"]=Symbol.for("MssqlParameter"),this.params=[],this.params=r||[]}}class nf{constructor(e,t){this.connection=e,this.queryRunner=t,this.transaction="all";const{schema:r}=this.connection.driver.options,a=this.connection.driver.database;this.migrationsDatabase=a,this.migrationsSchema=r,this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,r,a)}async executeMigration(e){return this.withQueryRunner(async t=>{await this.createMigrationsTableIfNotExist(t);const r=this.connection.driver.createSchemaBuilder();return F.isRdbmsSchemaBuilder(r)&&await r.createMetadataTableIfNecessary(t),await t.beforeMigration(),await e.instance.up(t),await t.afterMigration(),await this.insertExecutedMigration(t,e),e})}async getAllMigrations(){return Promise.resolve(this.getMigrations())}async getExecutedMigrations(){return this.withQueryRunner(async e=>(await this.createMigrationsTableIfNotExist(e),await this.loadExecutedMigrations(e)))}async getPendingMigrations(){const e=await this.getAllMigrations(),t=await this.getExecutedMigrations();return e.filter(r=>!t.find(a=>a.name===r.name))}insertMigration(e){return this.withQueryRunner(t=>this.insertExecutedMigration(t,e))}deleteMigration(e){return this.withQueryRunner(t=>this.deleteExecutedMigration(t,e))}async showMigrations(){let e=!1;const t=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(t);const r=await this.loadExecutedMigrations(t),a=this.getMigrations();for(const i of a){const s=r.find(o=>o.name===i.name);s?this.connection.logger.logSchemaBuild(`[X] ${s.id} ${i.name}`):(e=!0,this.connection.logger.logSchemaBuild(`[ ] ${i.name}`))}return this.queryRunner||await t.release(),e}async executePendingMigrations(){const e=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();F.isRdbmsSchemaBuilder(t)&&await t.createMetadataTableIfNecessary(e);const r=await this.loadExecutedMigrations(e);let a=this.getLatestTimestampMigration(r);const i=this.getMigrations(),s=[],o=i.filter(u=>!r.find(h=>h.name===u.name));if(!o.length)return this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner||await e.release(),[];if(this.connection.logger.logSchemaBuild(`${r.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${i.length} migrations were found in the source code.`),a&&this.connection.logger.logSchemaBuild(`${a.name} is the last executed migration. It was executed on ${new Date(a.timestamp).toString()}.`),this.connection.logger.logSchemaBuild(`${o.length} migrations are new migrations must be executed.`),this.transaction==="all"){const u=o.filter(h=>{var d;return((d=h.instance)===null||d===void 0?void 0:d.transaction)!==void 0});if(u.length>0){const h=new gM(u);throw this.connection.logger.logMigration(`Migrations failed, error: ${h.message}`),h}}const l={each:!0,none:!1,all:!1}[this.transaction];for(const u of o)if(u.instance){const h=u.instance.transaction;h===void 0?u.transaction=l:u.transaction=h}let c=!1;this.transaction==="all"&&!e.isTransactionActive&&(await e.beforeMigration(),await e.startTransaction(),c=!0);try{for(const u of o){if(this.fake){await this.insertExecutedMigration(e,u);continue}u.transaction&&!e.isTransactionActive&&(await e.beforeMigration(),await e.startTransaction(),c=!0),await u.instance.up(e).catch(h=>{throw this.connection.logger.logMigration(`Migration "${u.name}" failed, error: ${h==null?void 0:h.message}`),h}).then(async()=>{await this.insertExecutedMigration(e,u),u.transaction&&c&&(await e.commitTransaction(),await e.afterMigration())}).then(()=>{s.push(u),this.connection.logger.logSchemaBuild(`Migration ${u.name} has been ${this.fake?"(fake)":""} executed successfully.`)})}this.transaction==="all"&&c&&(await e.commitTransaction(),await e.afterMigration())}catch(u){if(c)try{await e.rollbackTransaction()}catch{}throw u}finally{this.queryRunner||await e.release()}return s}async undoLastMigration(){const e=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();F.isRdbmsSchemaBuilder(t)&&await t.createMetadataTableIfNecessary(e);const r=await this.loadExecutedMigrations(e);let a=this.getLatestExecutedMigration(r);if(!a){this.connection.logger.logSchemaBuild("No migrations were found in the database. Nothing to revert!");return}const i=this.getMigrations().find(o=>o.name===a.name);if(!i)throw new $(`No migration ${a.name} was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.`);this.connection.logger.logSchemaBuild(`${r.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${a.name} is the last executed migration. It was executed on ${new Date(a.timestamp).toString()}.`),this.connection.logger.logSchemaBuild("Now reverting it...");let s=!1;this.transaction!=="none"&&!e.isTransactionActive&&(await e.startTransaction(),s=!0);try{this.fake||(await e.beforeMigration(),await i.instance.down(e),await e.afterMigration()),await this.deleteExecutedMigration(e,i),this.connection.logger.logSchemaBuild(`Migration ${i.name} has been ${this.fake?"(fake)":""} reverted successfully.`),s&&await e.commitTransaction()}catch(o){if(s)try{await e.rollbackTransaction()}catch{}throw o}finally{this.queryRunner||await e.release()}}async createMigrationsTableIfNotExist(e){this.connection.driver.options.type!=="mongodb"&&(await e.hasTable(this.migrationsTable)||await e.createTable(new _t({database:this.migrationsDatabase,schema:this.migrationsSchema,name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]})))}async loadExecutedMigrations(e){return this.connection.driver.options.type==="mongodb"?e.cursor(this.migrationsTableName,{}).sort({_id:-1}).toArray():(await this.connection.manager.createQueryBuilder(e).select().orderBy(this.connection.driver.escape("id"),"DESC").from(this.migrationsTable,this.migrationsTableName).getRawMany()).map(t=>new gw(parseInt(t.id),parseInt(t.timestamp),t.name))}getMigrations(){const e=this.connection.migrations.map(t=>{const r=t.name||t.constructor.name,a=parseInt(r.substr(-13),10);if(!a||isNaN(a))throw new $(`${r} migration name is wrong. Migration class name should have a JavaScript timestamp appended.`);return new gw(void 0,a,r,t)});return this.checkForDuplicateMigrations(e),e.sort((t,r)=>t.timestamp-r.timestamp)}checkForDuplicateMigrations(e){const t=e.map(a=>a.name),r=Array.from(new Set(t.filter((a,i)=>t.indexOf(a)<i)));if(r.length>0)throw Error(`Duplicate migrations: ${r.join(", ")}`)}getLatestTimestampMigration(e){const t=e.map(r=>r).sort((r,a)=>(r.timestamp-a.timestamp)*-1);return t.length>0?t[0]:void 0}getLatestExecutedMigration(e){return e.length>0?e[0]:void 0}async insertExecutedMigration(e,t){const r={};this.connection.driver.options.type==="mssql"?(r.timestamp=new Rr(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),r.name=new Rr(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(r.timestamp=t.timestamp,r.name=t.name),this.connection.driver.options.type==="mongodb"?await e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insertOne(r):await e.manager.createQueryBuilder().insert().into(this.migrationsTable).values(r).execute()}async deleteExecutedMigration(e,t){const r={};if(this.connection.driver.options.type==="mssql"?(r.timestamp=new Rr(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),r.name=new Rr(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(r.timestamp=t.timestamp,r.name=t.name),this.connection.driver.options.type==="mongodb")await e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(r);else{const a=e.manager.createQueryBuilder();await a.delete().from(this.migrationsTable).where(`${a.escape("timestamp")} = :timestamp`).andWhere(`${a.escape("name")} = :name`).setParameters(r).execute()}}async withQueryRunner(e){const t=this.queryRunner||this.connection.createQueryRunner();try{return await e(t)}finally{this.queryRunner||await t.release()}}}function hh(n,e,t){let r=[],a={};return function i(s){a[s]=!0,r.push(s),n[s].forEach(function(o){if(!a[o])i(o);else if(r.indexOf(o)>=0)throw r.push(o),new $(`Dependency Cycle Found: ${r.join(" -> ")}`)}),r.pop(),(!e||n[s].length===0)&&t.indexOf(s)===-1&&t.push(s)}}class bM{constructor(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}addNode(e,t){this.hasNode(e)||(arguments.length===2?this.nodes[e]=t:this.nodes[e]=e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])}removeNode(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach(function(t){Object.keys(t).forEach(function(r){let a=t[r].indexOf(e);a>=0&&t[r].splice(a,1)},this)}))}hasNode(e){return this.nodes.hasOwnProperty(e)}getNodeData(e){if(this.hasNode(e))return this.nodes[e];throw new $(`Node does not exist: ${e}`)}setNodeData(e,t){if(this.hasNode(e))this.nodes[e]=t;else throw new $(`Node does not exist: ${e}`)}addDependency(e,t){if(!this.hasNode(e))throw new $(`Node does not exist: ${e}`);if(!this.hasNode(t))throw new $(`Node does not exist: ${t}`);return this.outgoingEdges[e].indexOf(t)===-1&&this.outgoingEdges[e].push(t),this.incomingEdges[t].indexOf(e)===-1&&this.incomingEdges[t].push(e),!0}removeDependency(e,t){let r;this.hasNode(e)&&(r=this.outgoingEdges[e].indexOf(t),r>=0&&this.outgoingEdges[e].splice(r,1)),this.hasNode(t)&&(r=this.incomingEdges[t].indexOf(e),r>=0&&this.incomingEdges[t].splice(r,1))}dependenciesOf(e,t){if(this.hasNode(e)){let r=[];hh(this.outgoingEdges,t,r)(e);let a=r.indexOf(e);return a>=0&&r.splice(a,1),r}else throw new $(`Node does not exist: ${e}`)}dependantsOf(e,t){if(this.hasNode(e)){let r=[];hh(this.incomingEdges,t,r)(e);let a=r.indexOf(e);return a>=0&&r.splice(a,1),r}else throw new $(`Node does not exist: ${e}`)}overallOrder(e){let t=this,r=[],a=Object.keys(this.nodes);if(a.length===0)return r;{let i=hh(this.outgoingEdges,!1,[]);a.forEach(function(o){i(o)});let s=hh(this.outgoingEdges,e,r);return a.filter(function(o){return t.incomingEdges[o].length===0}).forEach(function(o){s(o)}),r}}}class bw{static isGreaterOrEqual(e,t){const r=vw(e),a=vw(t);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function vw(n=""){const e=[0,0,0];return n.split(".").forEach((t,r)=>e[r]=parseInt(t,10)),e}class pe{static isSQLiteFamily(e){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(e.options.type)}static isMySQLFamily(e){return["mysql","mariadb"].includes(e.options.type)}static isReleaseVersionOrGreater(e,t){return e.version!=null&&bw.isGreaterOrEqual(e.version,t)}static isPostgresFamily(e){return["postgres","aurora-postgres","cockroachdb"].includes(e.options.type)}static buildDriverOptions(e,t){if(e.url){const r=this.parseConnectionUrl(e.url);t&&t.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},e,r)}return Object.assign({},e)}static buildMongoDBDriverOptions(e,t){if(e.url){const r=this.parseMongoDBConnectionUrl(e.url);t&&t.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},e,r)}return Object.assign({},e)}static buildAlias({maxAliasLength:e},t,...r){const a=r.length===1?r[0]:r.join(t&&t.joiner?t.joiner:"_");if(e&&e>0&&a.length>e){if(t&&t.shorten===!0){const i=hw(a);if(i.length<e)return i}return QR(a,{length:e})}return a}static buildColumnAlias({maxAliasLength:e},t,...r){return typeof t=="string"?(r.unshift(t),t={shorten:!1,joiner:"_"}):t=Object.assign({shorten:!1,joiner:"_"},t),this.buildAlias({maxAliasLength:e},t,...r)}static parseConnectionUrl(e){const t=e.split(":")[0],r=e.indexOf("//"),a=e.substr(r+2),i=a.indexOf("/"),s=i!==-1?a.substr(0,i):a;let o=i!==-1?a.substr(i+1):void 0;o&&o.indexOf("?")!==-1&&(o=o.substr(0,o.indexOf("?")));const l=s.lastIndexOf("@"),c=s.substr(0,l),u=s.substr(l+1);let h=c,d="";const f=c.indexOf(":");f!==-1&&(h=c.substr(0,f),d=c.substr(f+1));const[g,v]=u.split(":");return{type:t,host:g,username:decodeURIComponent(h),password:decodeURIComponent(d),port:v?parseInt(v):void 0,database:o||void 0}}static parseMongoDBConnectionUrl(e){const t=e.split(":")[0],r=e.indexOf("//"),a=e.substr(r+2),i=a.indexOf("/"),s=i!==-1?a.substr(0,i):a;let o=i!==-1?a.substr(i+1):void 0,l="",c,u,h,d,f={};if(o&&o.indexOf("?")!==-1){l=o.substr(o.indexOf("?")+1,o.length);const k=l.split("&");let B,D;k.forEach(V=>{B=V.split("=")[0],D=V.split("=")[1],f[B]=D}),d=f.replicaSet,o=o.substr(0,o.indexOf("?"))}const g=s.lastIndexOf("@"),v=s.substr(0,g),C=s.substr(g+1);let w=v,T="";const S=v.indexOf(":");S!==-1&&(w=v.substr(0,S),T=v.substr(S+1)),d?h=C:[c,u]=C.split(":");let O={type:t,host:c,hostReplicaSet:h,username:decodeURIComponent(w),password:decodeURIComponent(T),port:u?parseInt(u):void 0,database:o||void 0};for(const[k,B]of Object.entries(f))O[k]=B;return O}}class vM{validateMany(e,t){e.forEach(r=>this.validate(r,e,t)),this.validateDependencies(e),this.validateEagerRelations(e)}validate(e,t,r){if(!e.primaryColumns.length&&!e.isJunction)throw new iM(e);if(e.primaryColumns.length>1&&!e.primaryColumns.every((i,s,o)=>i.primaryKeyConstraintName===o[0].primaryKeyConstraintName))throw new $(`Entity ${e.name} has multiple primary columns with different constraint names. Constraint names should be the equal.`);if(e.inheritancePattern==="STI"||e.tableType==="entity-child"){if(!e.discriminatorColumn)throw new $(`Entity ${e.name} using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?`);if(typeof e.discriminatorValue>"u")throw new $(`Entity ${e.name} has an undefined discriminator value. Discriminator value should be defined.`);const i=t.find(s=>s!==e&&(s.inheritancePattern==="STI"||s.tableType==="entity-child")&&s.tableName===e.tableName&&s.discriminatorValue===e.discriminatorValue&&s.inheritanceTree.some(o=>e.inheritanceTree.indexOf(o)!==-1));if(i)throw new $(`Entities ${e.name} and ${i.name} have the same discriminator values. Make sure they are different while using the @ChildEntity decorator.`)}if(e.relationCounts.forEach(i=>{if(i.relation.isManyToOne||i.relation.isOneToOne)throw new $("Relation count can not be implemented on ManyToOne or OneToOne relations.")}),r.options.type!=="mongodb"&&e.columns.filter(i=>!i.isVirtualProperty).forEach(i=>{const s=r.normalizeType(i);if(r.supportedDataTypes.indexOf(s)===-1)throw new hM(i,s,r.options.type);if(i.length&&r.withLengthColumnTypes.indexOf(s)===-1)throw new $(`Column ${i.propertyName} of Entity ${e.name} does not support length property.`);if(i.type==="enum"&&!i.enum&&!i.enumName)throw new $(`Column "${i.propertyName}" of Entity "${e.name}" is defined as enum, but missing "enum" or "enumName" properties.`)}),(pe.isMySQLFamily(r)||r.options.type==="aurora-mysql")&&e.columns.filter(i=>i.isGenerated&&i.generationStrategy!=="uuid").length>1)throw new $(`Error in ${e.name} entity. There can be only one auto-increment column in MySql table.`);if(pe.isMySQLFamily(r)&&t.filter(i=>i.database).length===0&&!r.database)throw new yM("database");if(r.options.type==="mssql"&&e.columns.filter(i=>i.charset).length>1)throw new $("Character set specifying is not supported in Sql Server");if(r.options.type==="postgres"){const i=e.columns.find(s=>s.asExpression&&(!s.generatedType||s.generatedType==="VIRTUAL"));if(i)throw new $(`Column "${i.propertyName}" of Entity "${e.name}" is defined as VIRTUAL, but Postgres supports only STORED generated columns.`)}const a=e.create(void 0,{fromDeserializer:!0});e.relations.forEach(i=>{if(i.isManyToMany||i.isOneToMany){if(i.persistenceEnabled===!1)return;const s=i.getEntityValue(a);if(Array.isArray(s))throw new dM(i)}}),e.relations.forEach(i=>{if(r.supportedOnDeleteTypes&&i.onDelete&&!r.supportedOnDeleteTypes.includes(i.onDelete))throw new $(`OnDeleteType "${i.onDelete}" is not supported for ${r.options.type}!`);if(r.supportedOnUpdateTypes&&i.onUpdate&&!r.supportedOnUpdateTypes.includes(i.onUpdate))throw new $(`OnUpdateType "${i.onUpdate}" is not valid for ${r.options.type}!`)}),e.relations.forEach(i=>{if(i.isCascadeRemove&&i.inverseRelation&&i.inverseRelation.isCascadeRemove)throw new $(`Relation ${e.name}#${i.propertyName} and ${i.inverseRelation.entityMetadata.name}#${i.inverseRelation.propertyName} both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.`)}),e.eagerRelations.forEach(i=>{})}validateDependencies(e){const t=new bM;e.forEach(r=>{t.addNode(r.name)}),e.forEach(r=>{r.relationsWithJoinColumns.filter(a=>!a.isNullable).forEach(a=>{t.addDependency(r.name,a.inverseEntityMetadata.name)})});try{t.overallOrder()}catch(r){throw new aM(r.toString().replace("Error: Dependency Cycle Found: ",""))}}validateEagerRelations(e){e.forEach(t=>{t.eagerRelations.forEach(r=>{if(r.inverseRelation&&r.inverseRelation.isEager)throw new $(`Circular eager relations are disallowed. ${t.targetName}#${r.propertyPath} contains "eager: true", and its inverse side ${r.inverseEntityMetadata.targetName}#${r.inverseRelation.propertyPath} contains "eager: true" as well. Remove "eager: true" from one side of the relation.`)})})}}class EM{}class wM{}class TM{}class Ew{}class NM{}class CM{}class AM{}class ww{}class SM{}class RM{}class MM{}class un{static isFindOneOptions(e){const t=e;return t&&(Array.isArray(t.select)||Array.isArray(t.relations)||typeof t.select=="object"||typeof t.relations=="object"||typeof t.where=="object"||typeof t.join=="object"||typeof t.order=="object"||typeof t.cache=="object"||typeof t.cache=="boolean"||typeof t.cache=="number"||typeof t.comment=="string"||typeof t.lock=="object"||typeof t.loadRelationIds=="object"||typeof t.loadRelationIds=="boolean"||typeof t.loadEagerRelations=="boolean"||typeof t.withDeleted=="boolean"||typeof t.relationLoadStrategy=="string"||typeof t.transaction=="boolean")}static isFindManyOptions(e){const t=e;return t&&(this.isFindOneOptions(t)||typeof t.skip=="number"||typeof t.take=="number"||typeof t.skip=="string"||typeof t.take=="string")}static extractFindManyOptionsAlias(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias}static applyOptionsToTreeQueryBuilder(e,t){if(t!=null&&t.relations){const r=[...t.relations];if(un.applyRelationsRecursively(e,r,e.expressionMap.mainAlias.name,e.expressionMap.mainAlias.metadata,""),r.length>0)throw new cM(r)}return e}static applyRelationsRecursively(e,t,r,a,i){let s=[];if(i){const o=new RegExp("^"+i.replace(".","\\.")+"\\.");s=t.filter(l=>l.match(o)).map(l=>a.findRelationWithPropertyPath(l.replace(o,""))).filter(l=>l)}else s=t.map(o=>a.findRelationWithPropertyPath(o)).filter(o=>o);s.forEach(o=>{let l=pe.buildAlias(e.connection.driver,{joiner:"__"},r,o.propertyPath);const c=r+"."+o.propertyPath;e.expressionMap.relationLoadStrategy==="query"?e.concatRelationMetadata(o):e.leftJoinAndSelect(c,l),t.splice(t.indexOf(i?i+"."+o.propertyPath:o.propertyPath),1);let u,h;if(e.expressionMap.relationLoadStrategy==="query")u=o.inverseEntityMetadata,h=l;else{const d=e.expressionMap.joinAttributes.find(f=>f.entityOrProperty===c);u=d.metadata,h=d.alias.name}if(!h||!u)throw new Hr(o.propertyPath,a);if(this.applyRelationsRecursively(e,t,h,u,i?i+"."+o.propertyPath:o.propertyPath),e.expressionMap.relationLoadStrategy==="join"){const d=a.relations.find(f=>f.propertyName===o.propertyPath);d&&this.joinEagerRelations(e,l,d.inverseEntityMetadata)}})}static joinEagerRelations(e,t,r){r.eagerRelations.forEach(a=>{let i=pe.buildAlias(e.connection.driver,{joiner:"__"},t,a.propertyPath),s=!0;for(const c of e.expressionMap.joinAttributes)if(!(c.condition!==void 0||c.mapToProperty!==void 0||c.isMappingMany!==void 0||c.direction!=="LEFT"||c.entityOrProperty!==`${t}.${a.propertyPath}`)){s=!1,i=c.alias.name;break}const o=!!e.expressionMap.joinAttributes.find(c=>c.alias.name===i);s&&!o&&e.leftJoin(t+"."+a.propertyPath,i);let l=!0;for(const c of e.expressionMap.selects)if(!(c.aliasName!==void 0||c.virtual!==void 0||c.selection!==i)){l=!1;break}l&&e.addSelect(i),this.joinEagerRelations(e,i,a.inverseEntityMetadata)})}}class Hi{static createRelationMaps(e,t,r,a){return a.map(i=>{var s;const o=t.treeParentRelation.joinColumns[0],l=(s=o.referencedColumn)!==null&&s!==void 0?s:t.primaryColumns[0],c=o.givenDatabaseName||o.databaseName,u=l.givenDatabaseName||l.databaseName,h=i[r+"_"+u],d=i[r+"_"+c];return{id:e.connection.driver.prepareHydratedValue(h,l),parentId:e.connection.driver.prepareHydratedValue(d,o)}})}static buildChildrenEntityTree(e,t,r,a,i){var s;const o=e.treeChildrenRelation.propertyName;if(i.depth===0){t[o]=[];return}const l=(s=e.treeParentRelation.joinColumns[0].referencedColumn)!==null&&s!==void 0?s:e.primaryColumns[0],c=l.getEntityValue(t),u=a.filter(d=>d.parentId===c),h=new Set(u.map(d=>d.id));t[o]=r.filter(d=>h.has(l.getEntityValue(d))),t[o].forEach(d=>{Hi.buildChildrenEntityTree(e,d,r,a,{...i,depth:i.depth-1})})}static buildParentEntityTree(e,t,r,a){var i;const s=e.treeParentRelation.propertyName,o=(i=e.treeParentRelation.joinColumns[0].referencedColumn)!==null&&i!==void 0?i:e.primaryColumns[0],l=o.getEntityValue(t),c=a.find(h=>h.id===l),u=r.find(h=>c?o.getEntityValue(h)===c.parentId:!1);u&&(t[s]=u,Hi.buildParentEntityTree(e,t[s],r,a))}}class Tw{get metadata(){return this.manager.connection.getMetadata(this.target)}constructor(e,t,r){this.target=e,this.manager=t,this.queryRunner=r}createQueryBuilder(e,t){return this.manager.createQueryBuilder(this.metadata.target,e||this.metadata.targetName,t||this.queryRunner)}hasId(e){return this.manager.hasId(this.metadata.target,e)}getId(e){return this.manager.getId(this.metadata.target,e)}create(e){return this.manager.create(this.metadata.target,e)}merge(e,...t){return this.manager.merge(this.metadata.target,e,...t)}preload(e){return this.manager.preload(this.metadata.target,e)}save(e,t){return this.manager.save(this.metadata.target,e,t)}remove(e,t){return this.manager.remove(this.metadata.target,e,t)}softRemove(e,t){return this.manager.softRemove(this.metadata.target,e,t)}recover(e,t){return this.manager.recover(this.metadata.target,e,t)}insert(e){return this.manager.insert(this.metadata.target,e)}update(e,t){return this.manager.update(this.metadata.target,e,t)}upsert(e,t){return this.manager.upsert(this.metadata.target,e,t)}delete(e){return this.manager.delete(this.metadata.target,e)}softDelete(e){return this.manager.softDelete(this.metadata.target,e)}restore(e){return this.manager.restore(this.metadata.target,e)}exist(e){return this.manager.exists(this.metadata.target,e)}count(e){return this.manager.count(this.metadata.target,e)}countBy(e){return this.manager.countBy(this.metadata.target,e)}sum(e,t){return this.manager.sum(this.metadata.target,e,t)}average(e,t){return this.manager.average(this.metadata.target,e,t)}minimum(e,t){return this.manager.minimum(this.metadata.target,e,t)}maximum(e,t){return this.manager.maximum(this.metadata.target,e,t)}async find(e){return this.manager.find(this.metadata.target,e)}async findBy(e){return this.manager.findBy(this.metadata.target,e)}findAndCount(e){return this.manager.findAndCount(this.metadata.target,e)}findAndCountBy(e){return this.manager.findAndCountBy(this.metadata.target,e)}async findByIds(e){return this.manager.findByIds(this.metadata.target,e)}async findOne(e){return this.manager.findOne(this.metadata.target,e)}async findOneBy(e){return this.manager.findOneBy(this.metadata.target,e)}async findOneById(e){return this.manager.findOneById(this.metadata.target,e)}async findOneOrFail(e){return this.manager.findOneOrFail(this.metadata.target,e)}async findOneByOrFail(e){return this.manager.findOneByOrFail(this.metadata.target,e)}query(e,t){return this.manager.query(e,t)}clear(){return this.manager.clear(this.metadata.target)}increment(e,t,r){return this.manager.increment(this.metadata.target,e,t,r)}decrement(e,t,r){return this.manager.decrement(this.metadata.target,e,t,r)}extend(e){const t=this.constructor,{target:r,manager:a,queryRunner:i}=this,s=new class extends t{}(r,a,i);return Object.assign(s,e),s}}class OM extends Tw{async findTrees(e){const t=await this.findRoots(e);return await Promise.all(t.map(r=>this.findDescendantsTree(r,e))),t}findRoots(e){const t=o=>this.manager.connection.driver.escape(o),r=o=>this.manager.connection.driver.escape(o),a=this.metadata.treeParentRelation.joinColumns[0],i=a.givenDatabaseName||a.databaseName,s=this.createQueryBuilder("treeEntity");return un.applyOptionsToTreeQueryBuilder(s,e),s.where(`${t("treeEntity")}.${r(i)} IS NULL`).getMany()}findDescendants(e,t){const r=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);return un.applyOptionsToTreeQueryBuilder(r,t),r.getMany()}async findDescendantsTree(e,t){const r=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);un.applyOptionsToTreeQueryBuilder(r,t);const a=await r.getRawAndEntities(),i=Hi.createRelationMaps(this.manager,this.metadata,"treeEntity",a.raw);return Hi.buildChildrenEntityTree(this.metadata,e,a.entities,i,{depth:-1,...t}),e}countDescendants(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()}createDescendantsQueryBuilder(e,t,r){const a=i=>this.manager.connection.driver.escape(i);if(this.metadata.treeType==="closure-table"){const i=this.metadata.closureJunctionTable.descendantColumns.map(l=>a(t)+"."+a(l.propertyPath)+" = "+a(e)+"."+a(l.referencedColumn.propertyPath)).join(" AND "),s={},o=this.metadata.closureJunctionTable.ancestorColumns.map(l=>(s[l.referencedColumn.propertyName]=l.referencedColumn.getEntityValue(r),a(t)+"."+a(l.propertyPath)+" = :"+l.referencedColumn.propertyName)).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(o).setParameters(s)}else if(this.metadata.treeType==="nested-set"){const i=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath,s={},o=this.metadata.treeParentRelation.joinColumns.map(l=>{const c=l.referencedColumn.propertyPath.replace(".","_");return s[c]=l.referencedColumn.getEntityValue(r),"joined."+l.referencedColumn.propertyPath+" = :"+c}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",i).where(o,s)}else if(this.metadata.treeType==="materialized-path")return this.createQueryBuilder(e).where(i=>{const s=i.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(r));return pe.isSQLiteFamily(this.manager.connection.driver)?`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE ${s.getQuery()} || '%'`:`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE NULLIF(CONCAT(${s.getQuery()}, '%'), '%')`});throw new $("Supported only in tree entities")}findAncestors(e,t){const r=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);return un.applyOptionsToTreeQueryBuilder(r,t),r.getMany()}async findAncestorsTree(e,t){const r=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);un.applyOptionsToTreeQueryBuilder(r,t);const a=await r.getRawAndEntities(),i=Hi.createRelationMaps(this.manager,this.metadata,"treeEntity",a.raw);return Hi.buildParentEntityTree(this.metadata,e,a.entities,i),e}countAncestors(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()}createAncestorsQueryBuilder(e,t,r){if(this.metadata.treeType==="closure-table"){const a=this.metadata.closureJunctionTable.ancestorColumns.map(o=>t+"."+o.propertyPath+" = "+e+"."+o.referencedColumn.propertyPath).join(" AND "),i={},s=this.metadata.closureJunctionTable.descendantColumns.map(o=>(i[o.referencedColumn.propertyName]=o.referencedColumn.getEntityValue(r),t+"."+o.propertyPath+" = :"+o.referencedColumn.propertyName)).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,a).where(s).setParameters(i)}else if(this.metadata.treeType==="nested-set"){const a="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath,i={},s=this.metadata.treeParentRelation.joinColumns.map(o=>{const l=o.referencedColumn.propertyPath.replace(".","_");return i[l]=o.referencedColumn.getEntityValue(r),"joined."+o.referencedColumn.propertyPath+" = :"+l}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",a).where(s,i)}else if(this.metadata.treeType==="materialized-path")return this.createQueryBuilder(e).where(a=>{const i=a.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(r));return pe.isSQLiteFamily(this.manager.connection.driver)?`${i.getQuery()} LIKE ${e}.${this.metadata.materializedPathColumn.propertyPath} || '%'`:`${i.getQuery()} LIKE CONCAT(${e}.${this.metadata.materializedPathColumn.propertyPath}, '%')`});throw new $("Supported only in tree entities")}}class _M{transform(e,t,r,a=!1){return this.groupAndTransform(e,t,r,a),e}groupAndTransform(e,t,r,a=!1){r.nonVirtualColumns.forEach(i=>{const s=i.getEntityValue(t);s!==void 0&&i.setEntityValue(e,s)}),r.relations.length&&r.relations.forEach(i=>{let s=i.getEntityValue(e);const o=i.getEntityValue(t,a);if(o!==void 0)if(i.isOneToMany||i.isManyToMany){if(!Array.isArray(o))return;s||(s=[],i.setEntityValue(e,s)),o.forEach(l=>{let c=s.find(h=>i.inverseEntityMetadata.compareEntities(l,h));const u=i.inverseEntityMetadata.findInheritanceMetadata(l);c||(c=u.create(void 0,{fromDeserializer:!0}),s.push(c)),this.groupAndTransform(c,l,u,a)})}else{if(!Ue.isObject(o)){Ue.isObject(s)||i.setEntityValue(e,o);return}const l=i.inverseEntityMetadata.findInheritanceMetadata(o);s||(s=l.create(void 0,{fromDeserializer:!0}),i.setEntityValue(e,s)),this.groupAndTransform(s,o,l,a)}})}}class xM{constructor(e,t,r,a){this.plainEntity=e,this.metadata=t,this.parentLoadMapItem=r,this.relation=a}get target(){return this.metadata.target}get id(){return this.metadata.getEntityIdMixedMap(this.plainEntity)}}class PM{constructor(){this.loadMapItems=[]}get mainLoadMapItem(){return this.loadMapItems.find(e=>!e.relation&&!e.parentLoadMapItem)}addLoadMap(e){this.loadMapItems.find(t=>t.target===e.target&&t.id===e.id)||this.loadMapItems.push(e)}fillEntities(e,t){t.forEach(r=>{const a=this.loadMapItems.find(i=>i.target===e&&i.metadata.compareEntities(r,i.plainEntity));a&&(a.entity=r)})}groupByTargetIds(){const e=[];return this.loadMapItems.forEach(t=>{let r=e.find(a=>a.target===t.target);r||(r={target:t.target,ids:[]},e.push(r)),r.ids.push(t.id)}),e}}class IM{constructor(e){this.manager=e}async transform(e,t){if(!t.hasAllPrimaryKeys(e))return Promise.reject("Given object does not have a primary column, cannot transform it to database entity.");const r=new PM,a=(i,s,o,l)=>{const c=new xM(i,s,o,l);r.addLoadMap(c),s.extractRelationValuesFromEntity(i,t.relations).filter(u=>u!=null).forEach(([u,h,d])=>a(h,d,c,u))};return a(e,t),await Promise.all(r.groupByTargetIds().map(i=>this.manager.findByIds(i.target,i.ids).then(s=>r.fillEntities(i.target,s)))),r.loadMapItems.forEach(i=>{!i.relation||!i.entity||!i.parentLoadMapItem||!i.parentLoadMapItem.entity||(i.relation.isManyToMany||i.relation.isOneToMany?(i.parentLoadMapItem.entity[i.relation.propertyName]||(i.parentLoadMapItem.entity[i.relation.propertyName]=[]),i.parentLoadMapItem.entity[i.relation.propertyName].push(i.entity)):i.parentLoadMapItem.entity[i.relation.propertyName]=i.entity)}),r.mainLoadMapItem?r.mainLoadMapItem.entity:void 0}}class DM{get repository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new tf(this.constructor);return this.manager.getRepository(e)}get treeRepository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new tf(this.constructor);return this.manager.getTreeRepository(e)}createQueryBuilder(e){const t=this.getCustomRepositoryTarget(this.constructor);if(!t)throw new tf(this.constructor);return this.manager.getRepository(t).createQueryBuilder(e)}createQueryBuilderFor(e,t){return this.getRepositoryFor(e).createQueryBuilder(t)}getRepositoryFor(e){return this.manager.getRepository(e)}getTreeRepositoryFor(e){return this.manager.getTreeRepository(e)}getCustomRepositoryTarget(e){const t=Wt().entityRepositories.find(r=>r.target===(typeof e=="function"?e:e.constructor));if(!t)throw new dw(e);return t.entity}}class Nw{constructor(e){this.subjects=[...e],this.metadatas=this.getUniqueMetadatas(this.subjects)}sort(e){if(!this.metadatas.length)return this.subjects;const t=[];if(e==="delete"){const o=this.subjects.filter(l=>!l.entity&&!l.databaseEntity);t.push(...o),this.removeAlreadySorted(o)}const r=this.getNonNullableDependencies();let a=this.toposort(r);e==="insert"&&(a=a.reverse()),a.forEach(o=>{const l=this.subjects.filter(c=>c.metadata.targetName===o||c.metadata.inheritanceTree.some(u=>u.name===o));t.push(...l),this.removeAlreadySorted(l)});const i=this.getDependencies();let s=this.toposort(i);return e==="insert"&&(s=s.reverse()),s.forEach(o=>{const l=this.subjects.filter(c=>c.metadata.targetName===o);t.push(...l),this.removeAlreadySorted(l)}),t.push(...this.subjects),t}removeAlreadySorted(e){e.forEach(t=>{this.subjects.splice(this.subjects.indexOf(t),1)})}getUniqueMetadatas(e){const t=[];return e.forEach(r=>{t.indexOf(r.metadata)===-1&&t.push(r.metadata)}),t}getNonNullableDependencies(){return this.metadatas.reduce((e,t)=>(t.relationsWithJoinColumns.forEach(r=>{r.isNullable||e.push([t.targetName,r.inverseEntityMetadata.targetName])}),e),[])}getDependencies(){return this.metadatas.reduce((e,t)=>(t.relationsWithJoinColumns.forEach(r=>{r.inverseEntityMetadata!==t&&e.push([t.targetName,r.inverseEntityMetadata.targetName])}),e),[])}toposort(e){function t(c){let u=[];for(let h=0,d=c.length;h<d;h++){let f=c[h];u.indexOf(f[0])<0&&u.push(f[0]),u.indexOf(f[1])<0&&u.push(f[1])}return u}const r=t(e);let a=r.length,i=new Array(a),s={},o=a;for(;o--;)s[o]||l(r[o],o,[]);function l(c,u,h){if(h.indexOf(c)>=0)throw new $("Cyclic dependency: "+JSON.stringify(c));if(!~r.indexOf(c))throw new $("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(c));if(s[u])return;s[u]=!0;let d=e.filter(function(f){return f[0]===c});if(u=d.length){let f=h.concat(c);do{let g=d[--u][1];l(g,r.indexOf(g),f)}while(u)}i[--a]=c}return i}}function Ll(n){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ll(n)}function LM(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function qM(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}var Cw=6e4,Aw=36e5;function $M(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function rf(n,e){return rf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},rf(n,e)}function kM(n,e){if(Ll(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(Ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jM(n){var e=kM(n,"string");return Ll(e)=="symbol"?e:String(e)}function Sw(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,jM(r.key),r)}}function BM(n,e,t){return e&&Sw(n.prototype,e),t&&Sw(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function UM(n,e){var t;qM(1,arguments);var r=LM((t=e==null?void 0:e.additionalDigits)!==null&&t!==void 0?t:2);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof n=="string"||Object.prototype.toString.call(n)==="[object String]"))return new Date(NaN);var a=WM(n),i;if(a.date){var s=HM(a.date,r);i=KM(s.restDateString,s.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);var o=i.getTime(),l=0,c;if(a.time&&(l=QM(a.time),isNaN(l)))return new Date(NaN);if(a.timezone){if(c=GM(a.timezone),isNaN(c))return new Date(NaN)}else{var u=new Date(o+l),h=new Date(0);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return new Date(o+l+c)}var dh={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},FM=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,VM=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,zM=/^([+-])(\d{2})(?::?(\d{2}))?$/;function WM(n){var e={},t=n.split(dh.dateTimeDelimiter),r;if(t.length>2)return e;if(/:/.test(t[0])?r=t[0]:(e.date=t[0],r=t[1],dh.timeZoneDelimiter.test(e.date)&&(e.date=n.split(dh.timeZoneDelimiter)[0],r=n.substr(e.date.length,n.length))),r){var a=dh.timezone.exec(r);a?(e.time=r.replace(a[1],""),e.timezone=a[1]):e.time=r}return e}function HM(n,e){var t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=n.match(t);if(!r)return{year:NaN,restDateString:""};var a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?a:i*100,restDateString:n.slice((r[1]||r[2]).length)}}function KM(n,e){if(e===null)return new Date(NaN);var t=n.match(FM);if(!t)return new Date(NaN);var r=!!t[4],a=ql(t[1]),i=ql(t[2])-1,s=ql(t[3]),o=ql(t[4]),l=ql(t[5])-1;if(r)return eO(e,o,l)?YM(e,o,l):new Date(NaN);var c=new Date(0);return!XM(e,i,s)||!ZM(e,a)?new Date(NaN):(c.setUTCFullYear(e,i,Math.max(a,s)),c)}function ql(n){return n?parseInt(n):1}function QM(n){var e=n.match(VM);if(!e)return NaN;var t=af(e[1]),r=af(e[2]),a=af(e[3]);return tO(t,r,a)?t*Aw+r*Cw+a*1e3:NaN}function af(n){return n&&parseFloat(n.replace(",","."))||0}function GM(n){if(n==="Z")return 0;var e=n.match(zM);if(!e)return 0;var t=e[1]==="+"?-1:1,r=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return nO(r,a)?t*(r*Aw+a*Cw):NaN}function YM(n,e,t){var r=new Date(0);r.setUTCFullYear(n,0,4);var a=r.getUTCDay()||7,i=(e-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+i),r}var JM=[31,null,31,30,31,30,31,31,30,31,30,31];function Rw(n){return n%400===0||n%4===0&&n%100!==0}function XM(n,e,t){return e>=0&&e<=11&&t>=1&&t<=(JM[e]||(Rw(n)?29:28))}function ZM(n,e){return e>=1&&e<=(Rw(n)?366:365)}function eO(n,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function tO(n,e,t){return n===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&n>=0&&n<25}function nO(n,e){return e>=0&&e<=59}class Pe{static normalizeHydratedDate(e){return e&&(typeof e=="string"?new Date(e):e)}static mixedDateToDateString(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e}static mixedDateToDate(e,t=!1,r=!0){let a=typeof e=="string"?UM(e):e;return t&&(a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())),r||a.setUTCMilliseconds(0),a}static mixedDateToTimeString(e,t=!1){return e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e}static mixedTimeToDate(e){if(typeof e=="string"){const[t,r,a]=e.split(":"),i=new Date;return t&&i.setHours(parseInt(t)),r&&i.setMinutes(parseInt(r)),a&&i.setSeconds(parseInt(a)),i}return e}static mixedTimeToString(e,t=!1){return e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e,typeof e=="string"?e.split(":").map(r=>r.length===1?"0"+r:r).join(":"):e}static mixedDateToDatetimeString(e,t){if(typeof e=="string"&&(e=new Date(e)),e instanceof Date){let r=this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds());t&&(r+=`.${this.formatMilliseconds(e.getMilliseconds())}`),e=r}return e}static mixedDateToUtcDatetimeString(e){return typeof e=="string"&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear(),4)+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e}static simpleArrayToString(e){return Array.isArray(e)?e.map(t=>String(t)).join(","):e}static stringToSimpleArray(e){return typeof e=="string"?e.length>0?e.split(","):[]:e}static simpleJsonToString(e){return JSON.stringify(e)}static stringToSimpleJson(e){return typeof e=="string"?JSON.parse(e):e}static simpleEnumToString(e){return""+e}static stringToSimpleEnum(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e}static formatZerolessValue(e,t=2){return`${"0".repeat(t)}${e}`.slice(-t)}static formatMilliseconds(e){return e<10?"00"+e:e<100?"0"+e:String(e)}}class Ee{static chunk(e,t){return Array.from(Array(Math.ceil(e.length/t)),(r,a)=>e.slice(a*t,a*t+t))}static splitClassesAndStrings(e){return[e.filter(t=>typeof t!="string"),e.filter(t=>typeof t=="string")]}static groupBy(e,t){return e.reduce((r,a)=>{const i=t(a);let s=r.find(o=>o.id===i);return s||(s={id:i,items:[]},r.push(s)),s.items.push(a),r},[])}static uniq(e,t){return e.reduce((r,a)=>{let i=!1;if(typeof t=="function"){const s=t(a);i=!!r.find(o=>t(o)===s)}else typeof t=="string"?i=!!r.find(s=>s[t]===a[t]):i=r.indexOf(a)!==-1;return i||r.push(a),r},[])}static isPlainObject(e){return e==null?!1:!e.constructor||e.constructor===Object}static mergeArrayKey(e,t,r,a){if(a.has(r)){e[t]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){e[t]=r;return}e[t]||(e[t]=Array.isArray(r)?[]:{}),a.set(r,e[t]),this.merge(e[t],r,a),a.delete(r)}}static mergeObjectKey(e,t,r,a){if(a.has(r)){Object.assign(e,{[t]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(e,{[t]:r});return}e[t]||Object.assign(e,{[t]:Array.isArray(r)?[]:{}}),a.set(r,e[t]),this.merge(e[t],r,a),a.delete(r)}}static merge(e,t,r=new Map){if(this.isPlainObject(e)&&this.isPlainObject(t))for(const a of Object.keys(t))a!=="__proto__"&&this.mergeObjectKey(e,a,t[a],r);if(Array.isArray(e)&&Array.isArray(t))for(let a=0;a<t.length;a++)this.mergeArrayKey(e,a,t[a],r)}static mergeDeep(e,...t){if(!t.length)return e;for(const r of t)Ee.merge(e,r);return e}static deepCompare(...e){let t,r,a,i;if(arguments.length<1)return!0;for(t=1,r=arguments.length;t<r;t++)if(a=[],i=[],!this.compare2Objects(a,i,arguments[0],arguments[t]))return!1;return!0}static deepValue(e,t){const r=t.split(".");for(let a=0,i=r.length;a<i;a++)e=e[r[a]];return e}static replaceEmptyObjectsWithBooleans(e){for(let t in e)e[t]&&typeof e[t]=="object"&&(Object.keys(e[t]).length===0?e[t]=!0:this.replaceEmptyObjectsWithBooleans(e[t]))}static propertyPathsToTruthyObject(e){let t={};for(let r of e){const a=r.split(".");if(!a.length)continue;(!t[a[0]]||t[a[0]]===!0)&&(t[a[0]]={});let i=t[a[0]];for(let[s,o]of a.entries())s!==0&&(i[o]?i=i[o]:s===a.length-1?(i[o]={},i=null):(i[o]={},i=i[o]))}return this.replaceEmptyObjectsWithBooleans(t),t}static compareIds(e,t){return e==null||t===void 0||t===null?!1:(typeof e.id=="string"&&typeof t.id=="string"||typeof e.id=="number"&&typeof t.id=="number")&&Object.keys(e).length===1&&Object.keys(t).length===1?e.id===t.id:Ee.deepCompare(e,t)}static toBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e==="true"||e==="1":typeof e=="number"?e>0:!1}static zipObject(e,t){return e.reduce((r,a,i)=>(r[a]=t[i],r),{})}static isArraysEqual(e,t){return e.length!==t.length?!1:e.every(r=>t.indexOf(r)!==-1)}static areMutuallyExclusive(...e){return!e.some(t=>{const r=e.filter(a=>a!==t);return t.some(a=>r.some(i=>i.includes(a)))})}static compare2Objects(e,t,r,a){let i;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||e.indexOf(r)>-1||t.indexOf(a)>-1)return!1;for(i in a)if(a.hasOwnProperty(i)!==r.hasOwnProperty(i)||typeof a[i]!=typeof r[i])return!1;for(i in r){if(a.hasOwnProperty(i)!==r.hasOwnProperty(i)||typeof a[i]!=typeof r[i])return!1;switch(typeof r[i]){case"object":case"function":if(e.push(r),t.push(a),!this.compare2Objects(e,t,r[i],a[i]))return!1;e.pop(),t.pop();break;default:if(r[i]!==a[i])return!1;break}}return!0}}class qt{static transformFrom(e,t){return Array.isArray(e)?e.slice().reverse().reduce((r,a)=>a.from(r),t):e.from(t)}static transformTo(e,t){return Array.isArray(e)?e.reduce((r,a)=>a.to(r),t):e.to(t)}}class rO{compute(e){e.forEach(t=>{this.computeDiffColumns(t),this.computeDiffRelationalColumns(e,t)})}computeDiffColumns(e){e.entity&&e.metadata.columns.forEach(t=>{if(t.isVirtual||t.isDiscriminator)return;const r=e.changeMaps.find(i=>i.column===t);r&&e.changeMaps.splice(e.changeMaps.indexOf(r),1);const a=t.getEntityValue(e.entity);if(a!==void 0){if(e.databaseEntity){const i=t.type!=="json"&&t.type!=="jsonb";let s=t.getEntityValue(e.databaseEntity,i);if(t.relationMetadata&&t.relationMetadata.getEntityValue(e.entity)!=null)return;let o=a;if(a!==null){switch(t.type){case"date":o=Pe.mixedDateToDateString(a);break;case"time":case"time with time zone":case"time without time zone":case"timetz":o=Pe.mixedDateToTimeString(a);break;case"datetime":case"datetime2":case Date:case"timestamp":case"timestamp without time zone":case"timestamp with time zone":case"timestamp with local time zone":case"timestamptz":o=Pe.mixedDateToUtcDatetimeString(a),s=Pe.mixedDateToUtcDatetimeString(s);break;case"json":case"jsonb":if(Ee.deepCompare(a,s))return;break;case"simple-array":o=Pe.simpleArrayToString(a),s=Pe.simpleArrayToString(s);break;case"simple-enum":o=Pe.simpleEnumToString(a),s=Pe.simpleEnumToString(s);break;case"simple-json":o=Pe.simpleJsonToString(a),s=Pe.simpleJsonToString(s);break}t.transformer&&(o=qt.transformTo(t.transformer,a))}if(Buffer.isBuffer(o)&&Buffer.isBuffer(s)){if(o.equals(s))return}else if(o===s)return}e.diffColumns.includes(t)||e.diffColumns.push(t),e.changeMaps.push({column:t,value:a})}})}computeDiffRelationalColumns(e,t){t.entity&&t.metadata.relationsWithJoinColumns.forEach(r=>{let a=r.getEntityValue(t.entity);if(a===void 0)return;if(t.databaseEntity){let o=a;o!==null&&Ue.isObject(o)&&(o=r.getRelationIdMap(o));const l=r.getEntityValue(t.databaseEntity);if(Ee.compareIds(o,l))return;t.diffRelations.push(r)}const i=e.find(o=>o.mustBeInserted&&o.entity===a);i&&(a=i);const s=t.changeMaps.find(o=>o.relation===r);s?s.value=a:t.changeMaps.push({relation:r,value:a})})}}class sf{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class Mw extends ${constructor(){super("Nested sets do not support multiple root entities.")}}class of{constructor(e){this.queryRunner=e}async insert(e){const t=c=>this.queryRunner.connection.driver.escape(c),r=this.getTableName(e.metadata.tablePath),a=t(e.metadata.nestedSetLeftColumn.databaseName),i=t(e.metadata.nestedSetRightColumn.databaseName);let s=e.metadata.treeParentRelation.getEntityValue(e.entity);!s&&e.parentSubject&&e.parentSubject.entity&&(s=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const o=e.metadata.getEntityIdMap(s);let l;if(o&&(l=await this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.nestedSetRightColumn.propertyPath,"right").from(e.metadata.target,e.metadata.targetName).whereInIds(o).getRawOne().then(c=>{const u=c?c.right:void 0;return typeof u=="string"?parseInt(u):u})),l!==void 0)await this.queryRunner.query(`UPDATE ${r} SET ${a} = CASE WHEN ${a} > ${l} THEN ${a} + 2 ELSE ${a} END,${i} = ${i} + 2 WHERE ${i} >= ${l}`),Ee.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(l),e.metadata.nestedSetRightColumn.createValueMap(l+1));else{if(!await this.isUniqueRootEntity(e,s))throw new Mw;Ee.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(1),e.metadata.nestedSetRightColumn.createValueMap(2))}}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let r=e.databaseEntity;if(!r&&t&&(r=e.metadata.treeChildrenRelation.getEntityValue(t).find(o=>Object.entries(e.identifier).every(([l,c])=>o[l]===c))),r===void 0||t===void 0)return;const a=e.metadata.treeParentRelation.getEntityValue(r),i=e.metadata.getEntityIdMap(a),s=e.metadata.getEntityIdMap(t);if(!Ee.compareIds(i,s)){if(t){const o=g=>this.queryRunner.connection.driver.escape(g),l=this.getTableName(e.metadata.tablePath),c=o(e.metadata.nestedSetLeftColumn.databaseName),u=o(e.metadata.nestedSetRightColumn.databaseName),h=e.metadata.getEntityIdMap(r);let d;h&&(d=(await this.getNestedSetIds(e.metadata,h))[0]);let f;if(s&&(f=(await this.getNestedSetIds(e.metadata,s))[0]),d!==void 0&&f!==void 0){const g=f.left>d.left,v=d.right-d.left+1;let C;g?C=f.left-d.right:C=f.right-d.left;const w=`WHEN ${c} >= ${d.left} AND ${c} < ${d.right} THEN ${c} + ${C} `,T=`WHEN ${u} > ${d.left} AND ${u} <= ${d.right} THEN ${u} + ${C} `;g?await this.queryRunner.query(`UPDATE ${l} SET ${c} = CASE WHEN ${c} > ${d.right} AND ${c} <= ${f.left} THEN ${c} - ${v} `+w+`ELSE ${c} END, ${u} = CASE WHEN ${u} > ${d.right} AND ${u} < ${f.left} THEN ${u} - ${v} `+T+`ELSE ${u} END`):await this.queryRunner.query(`UPDATE ${l} SET ${c} = CASE WHEN ${c} < ${d.left} AND ${c} > ${f.right} THEN ${c} + ${v} `+w+`ELSE ${c} END, ${u} = CASE WHEN ${u} < ${d.left} AND ${u} >= ${f.right} THEN ${u} + ${v} `+T+`ELSE ${u} END`)}}else if(!await this.isUniqueRootEntity(e,t))throw new Mw}}async remove(e){Array.isArray(e)||(e=[e]);const t=e[0].metadata,r=c=>this.queryRunner.connection.driver.escape(c),a=this.getTableName(t.tablePath),i=r(t.nestedSetLeftColumn.databaseName),s=r(t.nestedSetRightColumn.databaseName);let o=[];for(const c of e){const u=t.getEntityIdMap(c.entity);u&&o.push(u)}let l=await this.getNestedSetIds(t,o);for(const c of l){const u=c.right-c.left+1;await this.queryRunner.query(`UPDATE ${a} SET ${i} = CASE WHEN ${i} > ${c.left} THEN ${i} - ${u} ELSE ${i} END, ${s} = CASE WHEN ${s} > ${c.right} THEN ${s} - ${u} ELSE ${s} END`)}}getNestedSetIds(e,t){const r={left:`${e.targetName}.${e.nestedSetLeftColumn.propertyPath}`,right:`${e.targetName}.${e.nestedSetRightColumn.propertyPath}`},a=this.queryRunner.manager.createQueryBuilder();return Object.entries(r).forEach(([i,s])=>{a.addSelect(s,i)}),a.from(e.target,e.targetName).whereInIds(t).orderBy(r.right,"DESC").getRawMany().then(i=>{const s=[];for(const o of i){const l={};for(const c of Object.keys(r)){const u=o?o[c]:void 0;l[c]=typeof u=="string"?parseInt(u):u}s.push(l)}return s})}async isUniqueRootEntity(e,t){const r=c=>this.queryRunner.connection.driver.escape(c),a=this.getTableName(e.metadata.tablePath),i=[],s=e.metadata.treeParentRelation.joinColumns.map(c=>{const u=r(c.databaseName),h=c.getEntityValue(t);if(h==null)return`${u} IS NULL`;i.push(h);const d=this.queryRunner.connection.driver.createParameter("entity_"+c.databaseName,i.length-1);return`${u} = ${d}`}).join(" AND "),o="count",l=await this.queryRunner.query(`SELECT COUNT(1) AS ${r(o)} FROM ${a} WHERE ${s}`,i,!0);return parseInt(l.records[0][o])===0}getTableName(e){return e.split(".").map(t=>t===""?t:this.queryRunner.connection.driver.escape(t)).join(".")}}class lf{constructor(e){this.queryRunner=e}async insert(e){const t={};e.metadata.closureJunctionTable.ancestorColumns.forEach(a=>{t[a.databaseName]=e.identifier}),e.metadata.closureJunctionTable.descendantColumns.forEach(a=>{t[a.databaseName]=e.identifier}),await this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.closureJunctionTable.tablePath).values(t).updateEntity(!1).callListeners(!1).execute();let r=e.metadata.treeParentRelation.getEntityValue(e.entity);if(!r&&e.parentSubject&&e.parentSubject.entity&&(r=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),r){const a=h=>this.queryRunner.connection.driver.escape(h),i=this.getTableName(e.metadata.closureJunctionTable.tablePath),s=[],o=e.metadata.closureJunctionTable.ancestorColumns.map(h=>a(h.databaseName)),l=e.metadata.closureJunctionTable.descendantColumns.map(h=>a(h.databaseName)),c=e.metadata.primaryColumns.map(h=>(s.push(h.getEntityValue(e.insertedValueSet?e.insertedValueSet:e.entity)),this.queryRunner.connection.driver.createParameter("child_entity_"+h.databaseName,s.length-1))),u=e.metadata.closureJunctionTable.descendantColumns.map(h=>{const d=a(h.databaseName),f=h.referencedColumn.getEntityValue(r);if(!f)throw new fw(e.metadata.name);s.push(f);const g=this.queryRunner.connection.driver.createParameter("parent_entity_"+h.referencedColumn.databaseName,s.length-1);return`${d} = ${g}`});await this.queryRunner.query(`INSERT INTO ${i} (${[...o,...l].join(", ")}) SELECT ${o.join(", ")}, ${c.join(", ")} FROM ${i} WHERE ${u.join(" AND ")}`,s)}}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let r=e.databaseEntity;if(!r&&t&&(r=e.metadata.treeChildrenRelation.getEntityValue(t).find(f=>Object.entries(e.identifier).every(([g,v])=>f[g]===v))),r===void 0||t===void 0)return;const a=e.metadata.treeParentRelation.getEntityValue(r),i=e.metadata.getEntityIdMap(a),s=e.metadata.getEntityIdMap(t);if(Ee.compareIds(i,s))return;const o=f=>this.queryRunner.connection.driver.escape(f),l=e.metadata.closureJunctionTable,c=l.ancestorColumns.map(f=>o(f.databaseName)),u=l.descendantColumns.map(f=>o(f.databaseName)),h=(f,g)=>{const v=`sub${g}`,C=f.createQueryBuilder().select(u.join(", ")).from(l.tablePath,v);for(const w of l.ancestorColumns)C.andWhere(`${o(v)}.${o(w.databaseName)} = :value_${w.referencedColumn.databaseName}`);return f.createQueryBuilder().select(u.join(", ")).from(`(${C.getQuery()})`,g).setParameters(C.getParameters()).getQuery()},d={};for(const f of e.metadata.primaryColumns)d[`value_${f.databaseName}`]=r[f.databaseName];if(await this.queryRunner.manager.createQueryBuilder().delete().from(l.tablePath).where(f=>`(${u.join(", ")}) IN (${h(f,"descendant")})`).andWhere(f=>`(${c.join(", ")}) NOT IN (${h(f,"ancestor")})`).setParameters(d).execute(),t){const f=[],g=this.getTableName(l.tablePath),v=o("supertree"),C=o("subtree"),w=[...c.map(O=>`${v}.${O}`),...u.map(O=>`${C}.${O}`)],T=e.metadata.closureJunctionTable.ancestorColumns.map(O=>{const k=o(O.databaseName),B=O.referencedColumn.getEntityValue(r);f.push(B);const D=this.queryRunner.connection.driver.createParameter("entity_"+O.referencedColumn.databaseName,f.length-1);return`${C}.${k} = ${D}`}),S=e.metadata.closureJunctionTable.descendantColumns.map(O=>{const k=o(O.databaseName),B=O.referencedColumn.getEntityValue(t);if(!B)throw new fw(e.metadata.name);f.push(B);const D=this.queryRunner.connection.driver.createParameter("parent_entity_"+O.referencedColumn.databaseName,f.length-1);return`${v}.${k} = ${D}`});await this.queryRunner.query(`INSERT INTO ${g} (${[...c,...u].join(", ")}) SELECT ${w.join(", ")} FROM ${g} AS ${v}, ${g} AS ${C} WHERE ${[...T,...S].join(" AND ")}`,f)}}async remove(e){if(this.queryRunner.connection.driver.options.type!=="mssql")return;Array.isArray(e)||(e=[e]);const t=l=>this.queryRunner.connection.driver.escape(l),r=e.map(l=>l.identifier),a=e[0].metadata.closureJunctionTable,i=l=>l.map(c=>{const u=r.map(h=>h[c.referencedColumn.databaseName]);return`${t(c.databaseName)} IN (${u.join(", ")})`}).join(" AND "),s=i(a.ancestorColumns),o=i(a.descendantColumns);await this.queryRunner.manager.createQueryBuilder().delete().from(a.tablePath).where(s).orWhere(o).execute()}getTableName(e){return e.split(".").map(t=>t===""?t:this.queryRunner.connection.driver.escape(t)).join(".")}}class Mr{constructor(e){this["@instanceof"]=Symbol.for("EntityMetadata"),this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.withoutRowid=!1,this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isAlwaysUsingConstructor=!0,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.beforeSoftRemoveListeners=[],this.beforeRecoverListeners=[],this.afterRemoveListeners=[],this.afterSoftRemoveListeners=[],this.afterRecoverListeners=[],this.connection=e.connection,this.inheritanceTree=e.inheritanceTree||[],this.inheritancePattern=e.inheritancePattern,this.treeType=e.tableTree?e.tableTree.type:void 0,this.treeOptions=e.tableTree?e.tableTree.options:void 0,this.parentClosureEntityMetadata=e.parentClosureEntityMetadata,this.tableMetadataArgs=e.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid,this.dependsOn=this.tableMetadataArgs.dependsOn}create(e,t){const r=!!(t&&t.pojo===!0);let a;return typeof this.target=="function"&&!r?!(t!=null&&t.fromDeserializer)||this.isAlwaysUsingConstructor?a=new this.target:a=Object.create(this.target.prototype):a={},this.connection.options.typename&&(a[this.connection.options.typename]=this.targetName),this.lazyRelations.forEach(i=>this.connection.relationLoader.enableLazyLoad(i,a,e)),a}hasId(e){return e?this.primaryColumns.every(t=>{const r=t.getEntityValue(e);return r!=null&&r!==""}):!1}hasAllPrimaryKeys(e){return this.primaryColumns.every(t=>t.getEntityValue(e)!=null)}ensureEntityIdMap(e){if(Ue.isObject(e))return e;if(this.hasMultiplePrimaryKeys)throw new JR(this,e);return this.primaryColumns[0].createValueMap(e)}getEntityIdMap(e){if(e)return Mr.getValueMap(e,this.primaryColumns,{skipNulls:!0})}getEntityIdMixedMap(e){if(!e)return e;const t=this.getEntityIdMap(e);return this.hasMultiplePrimaryKeys?t:t&&this.primaryColumns[0].getEntityValue(t)}compareEntities(e,t){const r=this.getEntityIdMap(e);if(!r)return!1;const a=this.getEntityIdMap(t);return a?Ee.compareIds(r,a):!1}findColumnWithPropertyName(e){return this.columns.find(t=>t.propertyName===e)}findColumnWithDatabaseName(e){return this.columns.find(t=>t.databaseName===e)}hasColumnWithPropertyPath(e){return this.columns.some(t=>t.propertyPath===e)||this.hasRelationWithPropertyPath(e)}findColumnWithPropertyPath(e){const t=this.columns.find(a=>a.propertyPath===e);if(t)return t;const r=this.relations.find(a=>a.propertyPath===e);if(r&&r.joinColumns.length===1)return r.joinColumns[0]}findColumnWithPropertyPathStrict(e){return this.columns.find(t=>t.propertyPath===e)}findColumnsWithPropertyPath(e){const t=this.columns.find(a=>a.propertyPath===e);if(t)return[t];const r=this.findRelationWithPropertyPath(e);return r&&r.joinColumns?r.joinColumns:[]}hasRelationWithPropertyPath(e){return this.relations.some(t=>t.propertyPath===e)}findRelationWithPropertyPath(e){return this.relations.find(t=>t.propertyPath===e)}hasEmbeddedWithPropertyPath(e){return this.allEmbeddeds.some(t=>t.propertyPath===e)}findEmbeddedWithPropertyPath(e){return this.allEmbeddeds.find(t=>t.propertyPath===e)}mapPropertyPathsToColumns(e){return e.map(t=>{const r=this.findColumnWithPropertyPath(t);if(r==null)throw new Hr(t,this);return r})}extractRelationValuesFromEntity(e,t){const r=[];return t.forEach(a=>{const i=a.getEntityValue(e);Array.isArray(i)?i.forEach(s=>r.push([a,s,Mr.getInverseEntityMetadata(s,a)])):i&&r.push([a,i,Mr.getInverseEntityMetadata(i,a)])}),r}findInheritanceMetadata(e){if(this.inheritancePattern==="STI"&&this.childEntityMetadatas.length>0){let t;return this.discriminatorColumn&&(t=e[this.discriminatorColumn.propertyName]),this.childEntityMetadatas.find(r=>t===r.discriminatorValue||e.constructor===r.target)||this}return this}static getInverseEntityMetadata(e,t){return t.inverseEntityMetadata.findInheritanceMetadata(e)}static createPropertyPath(e,t,r=""){const a=[];return Object.keys(t).forEach(i=>{const s=r?r+"."+i:i;if(e.hasEmbeddedWithPropertyPath(s)){const o=this.createPropertyPath(e,t[i],s);a.push(...o)}else{const o=r?r+"."+i:i;a.push(o)}}),a}static difference(e,t){return e.filter(r=>!t.find(a=>Ee.compareIds(r,a)))}static getValueMap(e,t,r){return t.reduce((a,i)=>{const s=i.getEntityValueMap(e,r);if(!(a===void 0||s===null||s===void 0))return Ee.mergeDeep(a,s)},{})}build(){var e;const t=this.connection.namingStrategy,r=this.connection.options.entityPrefix,a=this.connection.options.entitySkipConstructor;this.engine=this.tableMetadataArgs.engine,this.database=this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:!((e=this.connection.options)===null||e===void 0)&&e.hasOwnProperty("schema")&&(this.schema=this.connection.options.schema),this.givenTableName=this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=this.tableMetadataArgs.synchronize!==!1,this.targetName=typeof this.tableMetadataArgs.target=="function"?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,this.tableMetadataArgs.type==="closure-junction"?this.tableNameWithoutPrefix=t.closureJunctionTableName(this.givenTableName):this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.tableNameWithoutPrefix=t.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=t.tableName(this.targetName,this.givenTableName),this.tableMetadataArgs.type==="junction"&&this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=hw(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=r?t.prefixTableName(r,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid===!0,this.tablePath=this.connection.driver.buildTableName(this.tableName,this.schema,this.database),this.orderBy=typeof this.tableMetadataArgs.orderBy=="function"?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,a!==void 0&&(this.isAlwaysUsingConstructor=!a),this.isJunction=this.tableMetadataArgs.type==="closure-junction"||this.tableMetadataArgs.type==="junction",this.isClosureJunction=this.tableMetadataArgs.type==="closure-junction"}registerColumn(e){this.ownColumns.indexOf(e)===-1&&(this.ownColumns.push(e),this.columns=this.embeddeds.reduce((t,r)=>t.concat(r.columnsFromTree),this.ownColumns),this.primaryColumns=this.columns.filter(t=>t.isPrimary),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter(t=>t.isGenerated||t.generationStrategy==="uuid").length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach(t=>t.registerColumn(e)))}createPropertiesMap(){const e={};return this.columns.forEach(t=>Ee.mergeDeep(e,t.createValueMap(t.propertyPath))),this.relations.forEach(t=>Ee.mergeDeep(e,t.createValueMap(t.propertyPath))),e}getInsertionReturningColumns(){return this.columns.filter(e=>e.default!==void 0||e.isGenerated||e.isCreateDate||e.isUpdateDate||e.isDeleteDate||e.isVersion)}}class ph{constructor(e){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=e}}class Ow{constructor(e){this.queryRunner=e}async insert(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const r=e.metadata.getEntityIdMap(t);let a="";r&&(a=await this.getEntityPath(e,r));const i=e.metadata.treeParentRelation.joinColumns.map(s=>s.referencedColumn.getEntityValue(e.insertedValueSet)).join("_");await this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[e.metadata.materializedPathColumn.propertyPath]:a+i+"."}).where(e.identifier).execute()}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let r=e.databaseEntity;!r&&t&&(r=e.metadata.treeChildrenRelation.getEntityValue(t).find(h=>Object.entries(e.identifier).every(([d,f])=>h[d]===f)));const a=e.metadata.treeParentRelation.getEntityValue(r),i=this.getEntityParentReferencedColumnMap(e,a),s=this.getEntityParentReferencedColumnMap(e,t);if(Ee.compareIds(i,s))return;let o="";s&&(o=await this.getEntityPath(e,s));let l="";i&&(l=await this.getEntityPath(e,i)||"");const c=e.metadata.treeParentRelation.joinColumns.map(h=>h.referencedColumn.getEntityValue(r)).join("_"),u=e.metadata.materializedPathColumn.propertyPath;await this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[u]:()=>`REPLACE(${this.queryRunner.connection.driver.escape(u)}, '${l}${c}.', '${o}${c}.')`}).where(`${u} LIKE :path`,{path:`${l}${c}.%`}).execute()}getEntityParentReferencedColumnMap(e,t){if(t)return Mr.getValueMap(t,e.metadata.treeParentRelation.joinColumns.map(r=>r.referencedColumn).filter(r=>r!=null),{skipNulls:!0})}getEntityPath(e,t){const r=e.metadata,a=(Array.isArray(t)?t:[t]).map(i=>r.ensureEntityIdMap(i));return this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.materializedPathColumn.propertyPath,"path").from(e.metadata.target,e.metadata.targetName).where(new ph(i=>{for(const s of a)i.orWhere(new ph(o=>o.where(s)))})).getRawOne().then(i=>i?i.path:"")}}class aO{constructor(e,t,r){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.softRemoveSubjects=[],this.recoverSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=r,this.validate(),this.recompute()}async execute(){let e;(!this.options||this.options.listeners!==!1)&&(e=this.broadcastBeforeEventsForAll(),e.promises.length>0&&await Promise.all(e.promises)),e&&e.count>0&&(this.insertSubjects.forEach(t=>t.recompute()),this.updateSubjects.forEach(t=>t.recompute()),this.removeSubjects.forEach(t=>t.recompute()),this.softRemoveSubjects.forEach(t=>t.recompute()),this.recoverSubjects.forEach(t=>t.recompute()),this.recompute()),this.insertSubjects=new Nw(this.insertSubjects).sort("insert"),await this.executeInsertOperations(),this.updateSubjects=this.allSubjects.filter(t=>t.mustBeUpdated),await this.executeUpdateOperations(),this.removeSubjects=new Nw(this.removeSubjects).sort("delete"),await this.executeRemoveOperations(),this.softRemoveSubjects=this.allSubjects.filter(t=>t.mustBeSoftRemoved),await this.executeSoftRemoveOperations(),this.recoverSubjects=this.allSubjects.filter(t=>t.mustBeRecovered),await this.executeRecoverOperations(),await this.updateSpecialColumnsInPersistedEntities(),(!this.options||this.options.listeners!==!1)&&(e=this.broadcastAfterEventsForAll(),e.promises.length>0&&await Promise.all(e.promises))}validate(){this.allSubjects.forEach(e=>{if(e.mustBeUpdated&&e.mustBeRemoved)throw new mM(e)})}recompute(){new rO().compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter(e=>e.mustBeInserted),this.updateSubjects=this.allSubjects.filter(e=>e.mustBeUpdated),this.removeSubjects=this.allSubjects.filter(e=>e.mustBeRemoved),this.softRemoveSubjects=this.allSubjects.filter(e=>e.mustBeSoftRemoved),this.recoverSubjects=this.allSubjects.filter(e=>e.mustBeRecovered),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0||this.softRemoveSubjects.length>0||this.recoverSubjects.length>0}broadcastBeforeEventsForAll(){const e=new sf;return this.insertSubjects.length&&this.insertSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeInsertEvent(e,t.metadata,t.entity)),this.updateSubjects.length&&this.updateSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations)),this.removeSubjects.length&&this.removeSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.recoverSubjects.length&&this.recoverSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeRecoverEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),e}broadcastAfterEventsForAll(){const e=new sf;return this.insertSubjects.length&&this.insertSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterInsertEvent(e,t.metadata,t.entity)),this.updateSubjects.length&&this.updateSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations)),this.removeSubjects.length&&this.removeSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.recoverSubjects.length&&this.recoverSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterRecoverEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),e}async executeInsertOperations(){const[e,t]=this.groupBulkSubjects(this.insertSubjects,"insert");for(const r of t){const a=e[r],i=[],s=[],o=[];if(this.queryRunner.connection.driver.options.type==="mongodb"?a.forEach(l=>{l.metadata.createDateColumn&&l.entity&&(l.entity[l.metadata.createDateColumn.databaseName]=new Date),l.metadata.updateDateColumn&&l.entity&&(l.entity[l.metadata.updateDateColumn.databaseName]=new Date),l.createValueSetAndPopChangeMap(),s.push(l),i.push(l.entity)}):this.queryRunner.connection.driver.options.type==="oracle"?a.forEach(l=>{o.push(l)}):a.forEach(l=>{l.changeMaps.length===0||l.metadata.treeType||this.queryRunner.connection.driver.options.type==="oracle"||this.queryRunner.connection.driver.options.type==="sap"?o.push(l):(s.push(l),i.push(l.createValueSetAndPopChangeMap()))}),F.isMongoEntityManager(this.queryRunner.manager)){const l=await this.queryRunner.manager.insert(a[0].metadata.target,i);a.forEach((c,u)=>{c.identifier=l.identifiers[u],c.generatedMap=l.generatedMaps[u],c.insertedValueSet=i[u]})}else{if(i.length>0){const l=await this.queryRunner.manager.createQueryBuilder().insert().into(a[0].metadata.target).values(i).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1).execute();s.forEach((c,u)=>{c.identifier=l.identifiers[u],c.generatedMap=l.generatedMaps[u],c.insertedValueSet=i[u]})}if(o.length>0)for(const l of o)l.insertedValueSet=l.createValueSetAndPopChangeMap(),l.metadata.treeType==="nested-set"&&await new of(this.queryRunner).insert(l),await this.queryRunner.manager.createQueryBuilder().insert().into(l.metadata.target).values(l.insertedValueSet).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1).execute().then(c=>{l.identifier=c.identifiers[0],l.generatedMap=c.generatedMaps[0]}),l.metadata.treeType==="closure-table"?await new lf(this.queryRunner).insert(l):l.metadata.treeType==="materialized-path"&&await new Ow(this.queryRunner).insert(l)}a.forEach(l=>{l.generatedMap&&l.metadata.columns.forEach(c=>{const u=c.getEntityValue(l.generatedMap);if(u!=null){const h=this.queryRunner.connection.driver.prepareHydratedValue(u,c);c.setEntityValue(l.generatedMap,h)}})})}}async executeUpdateOperations(){const e=async i=>{if(!i.identifier)throw new ch(i);if(F.isMongoEntityManager(this.queryRunner.manager)){const s=this.cloneMongoSubjectEntity(i);i.metadata.objectIdColumn&&i.metadata.objectIdColumn.propertyName&&delete s[i.metadata.objectIdColumn.propertyName],i.metadata.createDateColumn&&i.metadata.createDateColumn.propertyName&&delete s[i.metadata.createDateColumn.propertyName],i.metadata.updateDateColumn&&i.metadata.updateDateColumn.propertyName&&(s[i.metadata.updateDateColumn.propertyName]=new Date),await this.queryRunner.manager.update(i.metadata.target,i.identifier,s)}else{const s=i.createValueSetAndPopChangeMap();switch(i.metadata.treeType){case"nested-set":await new of(this.queryRunner).update(i);break;case"closure-table":await new lf(this.queryRunner).update(i);break;case"materialized-path":await new Ow(this.queryRunner).update(i);break}const o=this.queryRunner.manager.createQueryBuilder().update(i.metadata.target).set(s).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);i.entity?o.whereEntity(i.identifier):o.where(i.identifier);let l=(await o.execute()).generatedMaps[0];l&&(i.metadata.columns.forEach(c=>{const u=c.getEntityValue(l);if(u!=null){const h=this.queryRunner.connection.driver.prepareHydratedValue(u,c);c.setEntityValue(l,h)}}),i.generatedMap||(i.generatedMap={}),Object.assign(i.generatedMap,l))}},t=[],r=[];for(const i of this.updateSubjects)i.metadata.treeType==="nested-set"?t.push(i):r.push(i);const a=new Promise(async(i,s)=>{for(const o of t)try{await e(o)}catch(l){s(l)}i()});await Promise.all([...r.map(e),a])}async executeRemoveOperations(){const[e,t]=this.groupBulkSubjects(this.removeSubjects,"delete");for(const r of t){const a=e[r],i=a.map(s=>{if(!s.identifier)throw new ch(s);return s.identifier});if(F.isMongoEntityManager(this.queryRunner.manager))await this.queryRunner.manager.delete(a[0].metadata.target,i);else{switch(a[0].metadata.treeType){case"nested-set":await new of(this.queryRunner).remove(a);break;case"closure-table":await new lf(this.queryRunner).remove(a);break}await this.queryRunner.manager.createQueryBuilder().delete().from(a[0].metadata.target).where(i).callListeners(!1).execute()}}}cloneMongoSubjectEntity(e){const t={};if(e.entity)for(const r of e.metadata.columns)Ee.mergeDeep(t,r.getEntityValueMap(e.entity));return t}async executeSoftRemoveOperations(){await Promise.all(this.softRemoveSubjects.map(async e=>{if(!e.identifier)throw new ch(e);let t;if(F.isMongoEntityManager(this.queryRunner.manager)){const r=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete r[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete r[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(r[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(r[e.metadata.deleteDateColumn.propertyName]=new Date),t=await this.queryRunner.manager.update(e.metadata.target,e.identifier,r)}else{const r=this.queryRunner.manager.createQueryBuilder().softDelete().from(e.metadata.target).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);e.entity?r.whereEntity(e.identifier):r.where(e.identifier),t=await r.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach(r=>{const a=r.getEntityValue(e.generatedMap);if(a!=null){const i=this.queryRunner.connection.driver.prepareHydratedValue(a,r);r.setEntityValue(e.generatedMap,i)}})}))}async executeRecoverOperations(){await Promise.all(this.recoverSubjects.map(async e=>{if(!e.identifier)throw new ch(e);let t;if(F.isMongoEntityManager(this.queryRunner.manager)){const r=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete r[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete r[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(r[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(r[e.metadata.deleteDateColumn.propertyName]=null),t=await this.queryRunner.manager.update(e.metadata.target,e.identifier,r)}else{const r=this.queryRunner.manager.createQueryBuilder().restore().from(e.metadata.target).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);e.entity?r.whereEntity(e.identifier):r.where(e.identifier),t=await r.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach(r=>{const a=r.getEntityValue(e.generatedMap);if(a!=null){const i=this.queryRunner.connection.driver.prepareHydratedValue(a,r);r.setEntityValue(e.generatedMap,i)}})}))}updateSpecialColumnsInPersistedEntities(){this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.softRemoveSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.softRemoveSubjects),this.recoverSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.recoverSubjects),this.removeSubjects.length&&this.removeSubjects.forEach(e=>{e.entity&&e.metadata.primaryColumns.forEach(t=>{t.setEntityValue(e.entity,void 0)})}),this.allSubjects.forEach(e=>{e.entity&&(e.metadata.relationIds.forEach(t=>{t.setValue(e.entity)}),F.isMongoEntityManager(this.queryRunner.manager)&&e.metadata.objectIdColumn&&e.metadata.objectIdColumn.databaseName&&e.metadata.objectIdColumn.databaseName!==e.metadata.objectIdColumn.propertyName&&delete e.entity[e.metadata.objectIdColumn.databaseName])})}updateSpecialColumnsInInsertedAndUpdatedEntities(e){e.forEach(t=>{t.entity&&(t.metadata.columns.forEach(r=>{t.metadata.childEntityMetadatas.length>0&&t.metadata.childEntityMetadatas.map(a=>a.target).indexOf(r.target)!==-1||r.isVirtual||(r.isNullable&&r.getEntityValue(t.entity)===void 0&&r.setEntityValue(t.entity,null),t.updatedRelationMaps.length>0&&t.updatedRelationMaps.forEach(a=>{a.relation.joinColumns.forEach(i=>{i.isVirtual!==!0&&i.setEntityValue(t.entity,Ue.isObject(a.value)?i.referencedColumn.getEntityValue(a.value):a.value)})}))}),t.generatedMap&&this.queryRunner.manager.merge(t.metadata.target,t.entity,t.generatedMap))})}groupBulkSubjects(e,t){const r={},a=[],i=e.some(o=>o.metadata.getInsertionReturningColumns().length>0),s=t==="delete"||this.queryRunner.connection.driver.isReturningSqlSupported("insert")||i===!1;return e.forEach((o,l)=>{const c=s||o.metadata.isJunction?o.metadata.name:o.metadata.name+"_"+l;r[c]?r[c].push(o):(r[c]=[o],a.push(c))}),[r,a]}}class ba{constructor(e){this["@instanceof"]=Symbol.for("Subject"),this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.canBeSoftRemoved=!1,this.canBeRecovered=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=e.metadata,this.entity=e.entity,this.parentSubject=e.parentSubject,e.canBeInserted!==void 0&&(this.canBeInserted=e.canBeInserted),e.canBeUpdated!==void 0&&(this.canBeUpdated=e.canBeUpdated),e.mustBeRemoved!==void 0&&(this.mustBeRemoved=e.mustBeRemoved),e.canBeSoftRemoved!==void 0&&(this.canBeSoftRemoved=e.canBeSoftRemoved),e.canBeRecovered!==void 0&&(this.canBeRecovered=e.canBeRecovered),e.identifier!==void 0&&(this.identifier=e.identifier),e.changeMaps!==void 0&&this.changeMaps.push(...e.changeMaps),this.recompute()}get mustBeInserted(){return this.canBeInserted&&!this.databaseEntity}get mustBeUpdated(){return this.canBeUpdated&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.length>0}get mustBeSoftRemoved(){return this.canBeSoftRemoved&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)}get mustBeRecovered(){return this.canBeRecovered&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)}createValueSetAndPopChangeMap(){const e=[],t=this.changeMaps.reduce((r,a)=>{let i=a.value;F.isSubject(i)&&(i=i.insertedValueSet?i.insertedValueSet:i.entity);let s;if(this.metadata.isJunction&&a.column)s=a.column.createValueMap(a.column.referencedColumn.getEntityValue(i));else if(a.column)s=a.column.createValueMap(i);else if(a.relation)if(Ue.isObject(i)&&!Buffer.isBuffer(i)){const o=a.relation.getRelationIdMap(i);if(o===void 0)return e.push(a),this.canBeUpdated=!0,r;s=a.relation.createValueMap(o),this.updatedRelationMaps.push({relation:a.relation,value:o})}else s=a.relation.createValueMap(i),this.updatedRelationMaps.push({relation:a.relation,value:i});return Ee.mergeDeep(r,s),r},{});return this.changeMaps=e,t}recompute(){this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach(e=>{if(e.relationMetadata&&e.relationMetadata.inverseEntityMetadata===this.parentSubject.metadata){const t=e.referencedColumn.getEntityValue(this.parentSubject.entity);e.setEntityValue(this.entityWithFulfilledIds,t)}}),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))}}class iO{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.metadata.oneToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&this.buildForSubjectRelation(e,t)})})}buildForSubjectRelation(e,t){var r;let a=[];if(e.databaseEntity){const o=t.getEntityValue(e.databaseEntity);o&&(a=o.map(l=>t.inverseEntityMetadata.getEntityIdMap(l)))}let i=t.getEntityValue(e.entity);if(i===null&&(i=[]),i===void 0)return;const s=[];i.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o),c=this.subjects.find(u=>u.entity===o);if(c&&(l=c.identifier),!l){if(!c)return;c.changeMaps.push({relation:t.inverseRelation,value:e});return}a.find(u=>Ee.compareIds(l,u))||(c||(c=new ba({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:l}),this.subjects.push(c)),c.changeMaps.push({relation:t.inverseRelation,value:e})),s.push(l)}),((r=t.inverseRelation)===null||r===void 0?void 0:r.orphanedRowAction)!=="disable"&&Mr.difference(a,s).forEach(o=>{const l=new ba({metadata:t.inverseEntityMetadata,parentSubject:e,identifier:o});!t.inverseRelation||t.inverseRelation.orphanedRowAction==="nullify"?(l.canBeUpdated=!0,l.changeMaps=[{relation:t.inverseRelation,value:null}]):t.inverseRelation.orphanedRowAction==="delete"?l.mustBeRemoved=!0:t.inverseRelation.orphanedRowAction==="soft-delete"&&(l.canBeSoftRemoved=!0),this.subjects.push(l)})}}class sO{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.metadata.oneToOneRelations.forEach(t=>{t.isOwning||t.persistenceEnabled===!1||this.buildForSubjectRelation(e,t)})})}buildForSubjectRelation(e,t){let r;e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));let a=t.getEntityValue(e.entity);if(a===void 0)return;if(a===null){if(r){const o=new ba({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:r,changeMaps:[{relation:t.inverseRelation,value:null}]});this.subjects.push(o)}return}let i=t.inverseEntityMetadata.getEntityIdMap(a),s=this.subjects.find(o=>!!o.entity&&o.entity===a);if(s&&(i=s.identifier),!i){if(!s)return;s.changeMaps.push({relation:t.inverseRelation,value:e})}r&&Ee.compareIds(i,r)||(s||(s=new ba({metadata:t.inverseEntityMetadata,canBeUpdated:!0,identifier:i}),this.subjects.push(s)),s.changeMaps.push({relation:t.inverseRelation,value:e}))}}class _w{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.entity&&e.metadata.manyToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&this.buildForSubjectRelation(e,t)})})}buildForAllRemoval(e){e.databaseEntity&&e.metadata.manyToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&t.getEntityValue(e.databaseEntity).forEach(r=>{const a=new ba({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,r)});this.subjects.push(a)})})}buildForSubjectRelation(e,t){let r=[];e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));let a=t.getEntityValue(e.entity);if(a===null&&(a=[]),!Array.isArray(a))return;a.forEach(s=>{let o=t.inverseEntityMetadata.getEntityIdMap(s);const l=this.subjects.find(d=>d.entity===s);if(l&&(o=l.identifier),!o&&!l||r.find(d=>Ee.compareIds(d,o)))return;const c=t.isOwning?e:l||s,u=t.isOwning?l||s:e,h=new ba({metadata:t.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});this.subjects.push(h),t.junctionEntityMetadata.ownerColumns.forEach(d=>{h.changeMaps.push({column:d,value:c})}),t.junctionEntityMetadata.inverseColumns.forEach(d=>{h.changeMaps.push({column:d,value:u})})});const i=[];a.forEach(s=>{let o=t.inverseEntityMetadata.getEntityIdMap(s);const l=this.subjects.find(c=>c.entity===s);l&&(o=l.identifier),o!=null&&i.push(o)}),r.filter(s=>!i.find(o=>Ee.compareIds(o,s))).forEach(s=>{const o=new ba({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,s)});this.subjects.push(o)})}buildJunctionIdentifier(e,t,r){const a=t.isOwning?e.entity:r,i=t.isOwning?r:e.entity,s={};return t.junctionEntityMetadata.ownerColumns.forEach(o=>{Ee.mergeDeep(s,o.createValueMap(o.referencedColumn.getEntityValue(a)))}),t.junctionEntityMetadata.inverseColumns.forEach(o=>{Ee.mergeDeep(s,o.createValueMap(o.referencedColumn.getEntityValue(i)))}),s}}class oO{constructor(e,t){this.queryRunner=e,this.subjects=t}async load(e){const t=this.groupByEntityTargets().map(async r=>{const a=[],i=[];if(r.subjects.forEach(c=>{c.databaseEntity||!c.identifier||(a.push(c.identifier),i.push(c))}),!a.length)return;const s=[];e==="save"||e==="soft-remove"||e==="recover"?r.subjects.forEach(c=>{c.metadata.relations.forEach(u=>{u.getEntityValue(c.entityWithFulfilledIds)!==void 0&&s.indexOf(u.propertyPath)===-1&&s.push(u.propertyPath)})}):s.push(...r.subjects[0].metadata.manyToManyRelations.map(c=>c.propertyPath));const o={loadEagerRelations:!1,loadRelationIds:{relations:s,disableMixedMap:!0},withDeleted:!0};let l=[];this.queryRunner.connection.driver.options.type==="mongodb"?l=await this.queryRunner.manager.getRepository(r.target).findByIds(a,o):l=await this.queryRunner.manager.getRepository(r.target).createQueryBuilder().setFindOptions(o).whereInIds(a).getMany(),l.forEach(c=>{this.findByPersistEntityLike(r.target,c).forEach(u=>{u.databaseEntity=c,u.identifier||(u.identifier=u.metadata.hasAllPrimaryKeys(c)?u.metadata.getEntityIdMap(c):void 0)})});for(let c of i)c.databaseEntityLoaded=!0});await Promise.all(t)}findByPersistEntityLike(e,t){return this.subjects.filter(r=>r.entity?r.entity===t?!0:r.metadata.target===e&&r.metadata.compareEntities(r.entityWithFulfilledIds,t):!1)}groupByEntityTargets(){return this.subjects.reduce((e,t)=>{let r=e.find(a=>a.target===t.metadata.target);return r||(r={target:t.metadata.target,subjects:[]},e.push(r)),r.subjects.push(t),e},[])}}class lO{constructor(e){this.allSubjects=e}build(e,t){e.metadata.extractRelationValuesFromEntity(e.entity,e.metadata.relations).forEach(([r,a,i])=>{if(a==null||!r.isCascadeInsert&&!r.isCascadeUpdate&&!r.isCascadeSoftRemove&&!r.isCascadeRecover||!Ue.isObject(a))return;const s=this.findByPersistEntityLike(i.target,a);if(s){s.canBeInserted===!1&&(s.canBeInserted=r.isCascadeInsert===!0&&t==="save"),s.canBeUpdated===!1&&(s.canBeUpdated=r.isCascadeUpdate===!0&&t==="save"),s.canBeSoftRemoved===!1&&(s.canBeSoftRemoved=r.isCascadeSoftRemove===!0&&t==="soft-remove"),s.canBeRecovered===!1&&(s.canBeRecovered=r.isCascadeRecover===!0&&t==="recover");return}const o=new ba({metadata:i,parentSubject:e,entity:a,canBeInserted:r.isCascadeInsert===!0&&t==="save",canBeUpdated:r.isCascadeUpdate===!0&&t==="save",canBeSoftRemoved:r.isCascadeSoftRemove===!0&&t==="soft-remove",canBeRecovered:r.isCascadeRecover===!0&&t==="recover"});this.allSubjects.push(o),this.build(o,t)})}findByPersistEntityLike(e,t){return this.allSubjects.find(r=>r.entity?r.entity===t?!0:r.metadata.target===e&&r.metadata.compareEntities(r.entityWithFulfilledIds,t):!1)}}class mh{constructor(e,t,r,a,i,s){this.connection=e,this.queryRunner=t,this.mode=r,this.target=a,this.entity=i,this.options=s}async execute(){if(!this.entity||typeof this.entity!="object")return Promise.reject(new nM(this.mode,this.entity));await Promise.resolve();const e=this.queryRunner||this.connection.createQueryRunner();let t=e.data;this.options&&this.options.data&&(e.data=this.options.data);try{const r=Array.isArray(this.entity)?this.entity:[this.entity],a=this.options&&this.options.chunk&&this.options.chunk>0?Ee.chunk(r,this.options.chunk):[r],i=(await Promise.all(a.map(async o=>{const l=[];o.forEach(u=>{const h=this.target?this.target:u.constructor;if(h===Object)throw new XR(this.mode);let d=this.connection.getMetadata(h).findInheritanceMetadata(u);l.push(new ba({metadata:d,entity:u,canBeInserted:this.mode==="save",canBeUpdated:this.mode==="save",mustBeRemoved:this.mode==="remove",canBeSoftRemoved:this.mode==="soft-remove",canBeRecovered:this.mode==="recover"}))});const c=new lO(l);return l.forEach(u=>{c.build(u,this.mode)}),await new oO(e,l).load(this.mode),this.mode==="save"||this.mode==="soft-remove"||this.mode==="recover"?(new iO(l).build(),new sO(l).build(),new _w(l).build()):l.forEach(u=>{u.mustBeRemoved&&new _w(l).buildForAllRemoval(u)}),new aO(e,l,this.options)}))).filter(o=>o.hasExecutableOperations);if(i.length===0)return;let s=!1;try{e.isTransactionActive||this.connection.driver.transactionSupport!=="none"&&(!this.options||this.options.transaction!==!1)&&(s=!0,await e.startTransaction());for(const o of i)await o.execute();s===!0&&await e.commitTransaction()}catch(o){if(s)try{await e.rollbackTransaction()}catch{}throw o}}finally{e.data=t,this.queryRunner||await e.release()}}}class xw{constructor(e,t){this["@instanceof"]=Symbol.for("EntityManager"),this.repositories=new Map,this.treeRepositories=[],this.plainObjectToEntityTransformer=new _M,this.connection=e,t&&(this.queryRunner=t,Ue.assign(this.queryRunner,{manager:this}))}async transaction(e,t){const r=typeof e=="string"?e:void 0,a=typeof e=="function"?e:t;if(!a)throw new $("Transaction method requires callback in second parameter if isolation level is supplied.");if(this.queryRunner&&this.queryRunner.isReleased)throw new mw;const i=this.queryRunner||this.connection.createQueryRunner();try{await i.startTransaction(r);const s=await a(i.manager);return await i.commitTransaction(),s}catch(s){try{await i.rollbackTransaction()}catch{}throw s}finally{this.queryRunner||await i.release()}}async query(e,t){return this.connection.query(e,t,this.queryRunner)}createQueryBuilder(e,t,r){return t?this.connection.createQueryBuilder(e,t,r||this.queryRunner):this.connection.createQueryBuilder(e||r||this.queryRunner)}hasId(e,t){const r=arguments.length===2?e:e.constructor,a=arguments.length===2?t:e;return this.connection.getMetadata(r).hasId(a)}getId(e,t){const r=arguments.length===2?e:e.constructor,a=arguments.length===2?t:e;return this.connection.getMetadata(r).getEntityIdMixedMap(a)}create(e,t){const r=this.connection.getMetadata(e);if(!t)return r.create(this.queryRunner);if(Array.isArray(t))return t.map(i=>this.create(e,i));const a=r.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(a,t,r,!0),a}merge(e,t,...r){const a=this.connection.getMetadata(e);return r.forEach(i=>this.plainObjectToEntityTransformer.transform(t,i,a)),t}async preload(e,t){const r=this.connection.getMetadata(e),a=await new IM(this.connection.manager).transform(t,r);if(a)return this.merge(e,a,t)}save(e,t,r){let a=arguments.length>1&&(typeof e=="function"||F.isEntitySchema(e)||typeof e=="string")?e:void 0;const i=a?t:e,s=a?r:t;return F.isEntitySchema(a)&&(a=a.options.name),Array.isArray(i)&&i.length===0?Promise.resolve(i):new mh(this.connection,this.queryRunner,"save",a,i,s).execute().then(()=>i)}remove(e,t,r){const a=arguments.length>1&&(typeof e=="function"||F.isEntitySchema(e)||typeof e=="string")?e:void 0,i=a?t:e,s=a?r:t;return Array.isArray(i)&&i.length===0?Promise.resolve(i):new mh(this.connection,this.queryRunner,"remove",a,i,s).execute().then(()=>i)}softRemove(e,t,r){let a=arguments.length>1&&(typeof e=="function"||F.isEntitySchema(e)||typeof e=="string")?e:void 0;const i=a?t:e,s=a?r:t;return F.isEntitySchema(a)&&(a=a.options.name),Array.isArray(i)&&i.length===0?Promise.resolve(i):new mh(this.connection,this.queryRunner,"soft-remove",a,i,s).execute().then(()=>i)}recover(e,t,r){let a=arguments.length>1&&(typeof e=="function"||F.isEntitySchema(e)||typeof e=="string")?e:void 0;const i=a?t:e,s=a?r:t;return F.isEntitySchema(a)&&(a=a.options.name),Array.isArray(i)&&i.length===0?Promise.resolve(i):new mh(this.connection,this.queryRunner,"recover",a,i,s).execute().then(()=>i)}async insert(e,t){return this.createQueryBuilder().insert().into(e).values(t).execute()}async upsert(e,t,r){const a=this.connection.getMetadata(e);let i;Array.isArray(r)?i={conflictPaths:r}:i=r;let s;Array.isArray(t)?s=t:s=[t];const o=a.mapPropertyPathsToColumns(Array.isArray(i.conflictPaths)?i.conflictPaths:Object.keys(i.conflictPaths)),l=a.columns.filter(c=>!o.includes(c)&&s.some(u=>typeof c.getEntityValue(u)<"u"));return this.createQueryBuilder().insert().into(e).values(s).orUpdate([...o,...l].map(c=>c.databaseName),o.map(c=>c.databaseName),{skipUpdateIfNoValuesChanged:i.skipUpdateIfNoValuesChanged,indexPredicate:i.indexPredicate,upsertType:i.upsertType||this.connection.driver.supportedUpsertTypes[0]}).execute()}update(e,t,r){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new $("Empty criteria(s) are not allowed for the update method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().update(e).set(r).whereInIds(t).execute():this.createQueryBuilder().update(e).set(r).where(t).execute()}delete(e,t){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new $("Empty criteria(s) are not allowed for the delete method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()}softDelete(e,t){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new $("Empty criteria(s) are not allowed for the delete method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().softDelete().from(e).whereInIds(t).execute():this.createQueryBuilder().softDelete().from(e).where(t).execute()}restore(e,t){return t==null||t===""||Array.isArray(t)&&t.length===0?Promise.reject(new $("Empty criteria(s) are not allowed for the delete method.")):typeof t=="string"||typeof t=="number"||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().restore().from(e).whereInIds(t).execute():this.createQueryBuilder().restore().from(e).where(t).execute()}exists(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,un.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getExists()}count(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,un.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getCount()}countBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t}).getCount()}sum(e,t,r){return this.callAggregateFun(e,"SUM",t,r)}average(e,t,r){return this.callAggregateFun(e,"AVG",t,r)}minimum(e,t,r){return this.callAggregateFun(e,"MIN",t,r)}maximum(e,t,r){return this.callAggregateFun(e,"MAX",t,r)}async callAggregateFun(e,t,r,a={}){const i=this.connection.getMetadata(e),s=await this.createQueryBuilder(e,i.name).setFindOptions({where:a}).select(`${t}(${this.connection.driver.escape(String(r))})`,t).getRawOne();return s[t]===null?null:parseFloat(s[t])}async find(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,un.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getMany()}async findBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t}).getMany()}findAndCount(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,un.extractFindManyOptionsAlias(t)||r.name).setFindOptions(t||{}).getManyAndCount()}findAndCountBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t}).getManyAndCount()}async findByIds(e,t){if(!t.length)return Promise.resolve([]);const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).andWhereInIds(t).getMany()}async findOne(e,t){let r=this.connection.getMetadata(e).name;if(t&&t.join&&(r=t.join.alias),!t.where)throw new Error("You must provide selection conditions in order to find a single row.");return this.createQueryBuilder(e,r).setFindOptions({...t,take:1}).getOne()}async findOneBy(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({where:t,take:1}).getOne()}async findOneById(e,t){const r=this.connection.getMetadata(e);return this.createQueryBuilder(e,r.name).setFindOptions({take:1}).whereInIds(r.ensureEntityIdMap(t)).getOne()}async findOneOrFail(e,t){return this.findOne(e,t).then(r=>r===null?Promise.reject(new ef(e,t)):Promise.resolve(r))}async findOneByOrFail(e,t){return this.findOneBy(e,t).then(r=>r===null?Promise.reject(new ef(e,t)):Promise.resolve(r))}async clear(e){const t=this.connection.getMetadata(e),r=this.queryRunner||this.connection.createQueryRunner();try{return await r.clearTable(t.tablePath)}finally{this.queryRunner||await r.release()}}async increment(e,t,r,a){const i=this.connection.getMetadata(e),s=i.findColumnWithPropertyPath(r);if(!s)throw new $(`Column ${r} was not found in ${i.targetName} entity.`);if(isNaN(Number(a)))throw new $(`Value "${a}" is not a number.`);const o=r.split(".").reduceRight((l,c)=>({[c]:l}),()=>this.connection.driver.escape(s.databaseName)+" + "+a);return this.createQueryBuilder(e,"entity").update(e).set(o).where(t).execute()}async decrement(e,t,r,a){const i=this.connection.getMetadata(e),s=i.findColumnWithPropertyPath(r);if(!s)throw new $(`Column ${r} was not found in ${i.targetName} entity.`);if(isNaN(Number(a)))throw new $(`Value "${a}" is not a number.`);const o=r.split(".").reduceRight((l,c)=>({[c]:l}),()=>this.connection.driver.escape(s.databaseName)+" - "+a);return this.createQueryBuilder(e,"entity").update(e).set(o).where(t).execute()}getRepository(e){const t=this.repositories.get(e);if(t)return t;if(this.connection.driver.options.type==="mongodb"){const r=new TM(e,this,this.queryRunner);return this.repositories.set(e,r),r}else{const r=new Tw(e,this,this.queryRunner);return this.repositories.set(e,r),r}}getTreeRepository(e){if(this.connection.driver.treeSupport===!1)throw new ZR(this.connection.driver);const t=this.treeRepositories.find(a=>a.target===e);if(t)return t;const r=new OM(e,this,this.queryRunner);return this.treeRepositories.push(r),r}getMongoRepository(e){return this.connection.getMongoRepository(e)}withRepository(e){const t=e.constructor,{target:r,manager:a,queryRunner:i,...s}=e;return Object.assign(new t(e.target,this),{...s})}getCustomRepository(e){const t=Wt().entityRepositories.find(i=>i.target===(typeof e=="function"?e:e.constructor));if(!t)throw new dw(e);const r=t.entity?this.connection.getMetadata(t.entity):void 0,a=new t.target(this,r);if(a instanceof DM)a.manager||(a.manager=this);else{if(!r)throw new rM(e);a.manager=this,a.metadata=r}return a}async release(){if(!this.queryRunner)throw new pM;return this.queryRunner.release()}}class cO extends xw{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("SqljsEntityManager"),this.driver=e.driver}async loadDatabase(e){await this.driver.load(e)}async saveDatabase(e){await this.driver.save(e)}exportDatabase(){return this.driver.export()}}class uO{create(e,t){return e.driver.options.type==="mongodb"?new wM(e):e.driver.options.type==="sqljs"?new cO(e,t):new xw(e,t)}}class va{constructor(e){this["@instanceof"]=Symbol.for("View"),this.indices=[],e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,this.expression=e.expression,this.materialized=!!e.materialized)}clone(){return new va({database:this.database,schema:this.schema,name:this.name,expression:this.expression,materialized:this.materialized})}addIndex(e){this.indices.push(e)}removeIndex(e){const t=this.indices.find(r=>r.name===e.name);t&&this.indices.splice(this.indices.indexOf(t),1)}static create(e,t){const r={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,e.schema,e.database),expression:e.expression,materialized:e.tableMetadataArgs.materialized};return new va(r)}}class Pw{static viewMetadataCmp(e,t){return!e||!t?0:e.dependsOn&&(e.dependsOn.has(t.target)||e.dependsOn.has(t.name))?1:t.dependsOn&&(t.dependsOn.has(e.target)||t.dependsOn.has(e.name))?-1:0}}class fh{constructor(e){this.connection=e,this["@instanceof"]=Symbol.for("RdbmsSchemaBuilder")}async build(){this.queryRunner=this.connection.createQueryRunner(),this.currentDatabase=this.connection.driver.database,this.currentSchema=this.connection.driver.schema;const e=this.connection.driver.options.type!=="cockroachdb"&&this.connection.driver.options.type!=="spanner"&&this.connection.options.migrationsTransactionMode!=="none";await this.queryRunner.beforeMigration(),e&&await this.queryRunner.startTransaction();try{await this.createMetadataTableIfNecessary(this.queryRunner);const t=this.entityToSyncMetadatas.map(a=>this.getTablePath(a)),r=this.viewEntityToSyncMetadatas.map(a=>this.getTablePath(a));await this.queryRunner.getTables(t),await this.queryRunner.getViews(r),await this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&await this.connection.queryResultCache.synchronize(this.queryRunner),e&&await this.queryRunner.commitTransaction()}catch(t){try{e&&await this.queryRunner.rollbackTransaction()}catch{}throw t}finally{await this.queryRunner.afterMigration(),await this.queryRunner.release()}}async createMetadataTableIfNecessary(e){(this.viewEntityToSyncMetadatas.length>0||this.hasGeneratedColumns())&&await this.createTypeormMetadataTable(e)}async log(){this.queryRunner=this.connection.createQueryRunner();try{const e=this.entityToSyncMetadatas.map(r=>this.getTablePath(r)),t=this.viewEntityToSyncMetadatas.map(r=>this.getTablePath(r));return await this.queryRunner.getTables(e),await this.queryRunner.getViews(t),this.queryRunner.enableSqlMemory(),await this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&await this.connection.queryResultCache.synchronize(this.queryRunner),this.queryRunner.getMemorySql()}finally{this.queryRunner.disableSqlMemory(),await this.queryRunner.release()}}get entityToSyncMetadatas(){return this.connection.entityMetadatas.filter(e=>e.synchronize&&e.tableType!=="entity-child"&&e.tableType!=="view")}get viewEntityToSyncMetadatas(){return this.connection.entityMetadatas.filter(e=>e.tableType==="view"&&e.synchronize).sort(Pw.viewMetadataCmp)}hasGeneratedColumns(){return this.connection.entityMetadatas.some(e=>e.columns.some(t=>t.generatedType))}async executeSchemaSyncOperationsInProperOrder(){await this.dropOldViews(),await this.dropOldForeignKeys(),await this.dropOldIndices(),await this.dropOldChecks(),await this.dropOldExclusions(),await this.dropCompositeUniqueConstraints(),await this.renameColumns(),await this.createNewTables(),await this.dropRemovedColumns(),await this.addNewColumns(),await this.updatePrimaryKeys(),await this.updateExistColumns(),await this.createNewIndices(),await this.createNewChecks(),await this.createNewExclusions(),await this.createCompositeUniqueConstraints(),await this.createForeignKeys(),await this.createViews(),await this.createNewViewIndices()}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema||this.currentSchema,t.database||this.currentDatabase)}async dropOldForeignKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=t.foreignKeys.filter(a=>{const i=e.foreignKeys.find(s=>a.name===s.name&&this.getTablePath(a)===this.getTablePath(s.referencedEntityMetadata));return!i||i.onDelete&&i.onDelete!==a.onDelete||i.onUpdate&&i.onUpdate!==a.onUpdate});r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old foreign keys of ${t.name}: ${r.map(a=>a.name).join(", ")}`),await this.queryRunner.dropForeignKeys(t,r))}}async renameTables(){}async renameColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===this.getTablePath(e));if(!t||e.columns.length!==t.columns.length)continue;const r=e.columns.filter(s=>!s.isVirtualProperty).filter(s=>!t.columns.find(o=>o.name===s.databaseName&&o.type===this.connection.driver.normalizeType(s)&&o.isNullable===s.isNullable&&o.isUnique===this.connection.driver.normalizeIsUnique(s)));if(r.length===0||r.length>1)continue;const a=t.columns.filter(s=>!e.columns.find(o=>!o.isVirtualProperty&&o.databaseName===s.name&&this.connection.driver.normalizeType(o)===s.type&&o.isNullable===s.isNullable&&this.connection.driver.normalizeIsUnique(o)===s.isUnique));if(a.length===0||a.length>1)continue;const i=a[0].clone();i.name=r[0].databaseName,this.connection.logger.logSchemaBuild(`renaming column "${a[0].name}" in "${t.name}" to "${i.name}"`),await this.queryRunner.renameColumn(t,a[0],i)}}async dropOldIndices(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=t.indices.filter(a=>{const i=e.indices.find(s=>s.name===a.name);return i?i.synchronize===!1?!1:i.isUnique!==a.isUnique||i.isSpatial!==a.isSpatial||this.connection.driver.isFullTextColumnTypeSupported()&&i.isFulltext!==a.isFulltext||i.columns.length!==a.columnNames.length?!0:!i.columns.every(s=>a.columnNames.indexOf(s.databaseName)!==-1):!0}).map(async a=>{this.connection.logger.logSchemaBuild(`dropping an index: "${a.name}" from table ${t.name}`),await this.queryRunner.dropIndex(t,a)});await Promise.all(r)}if(this.connection.options.type==="postgres"){const e=this.queryRunner;for(const t of this.viewEntityToSyncMetadatas){const r=this.queryRunner.loadedViews.find(i=>this.getTablePath(i)===this.getTablePath(t));if(!r)continue;const a=r.indices.filter(i=>{const s=t.indices.find(o=>o.name===i.name);return s?s.synchronize===!1?!1:s.isUnique!==i.isUnique||s.isSpatial!==i.isSpatial||this.connection.driver.isFullTextColumnTypeSupported()&&s.isFulltext!==i.isFulltext||s.columns.length!==i.columnNames.length?!0:!s.columns.every(o=>i.columnNames.indexOf(o.databaseName)!==-1):!0}).map(async i=>{this.connection.logger.logSchemaBuild(`dropping an index: "${i.name}" from view ${r.name}`),await e.dropViewIndex(r,i)});await Promise.all(a)}}}async dropOldChecks(){if(!(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"))for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=t.checks.filter(a=>!e.checks.find(i=>i.name===a.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old check constraint: ${r.map(a=>`"${a.name}"`).join(", ")} from table "${t.name}"`),await this.queryRunner.dropCheckConstraints(t,r))}}async dropCompositeUniqueConstraints(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=t.uniques.filter(a=>a.columnNames.length>1&&!e.uniques.find(i=>i.name===a.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old unique constraint: ${r.map(a=>`"${a.name}"`).join(", ")} from table "${t.name}"`),await this.queryRunner.dropUniqueConstraints(t,r))}}async dropOldExclusions(){if(this.connection.driver.options.type==="postgres")for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=t.exclusions.filter(a=>!e.exclusions.find(i=>i.name===a.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old exclusion constraint: ${r.map(a=>`"${a.name}"`).join(", ")} from table "${t.name}"`),await this.queryRunner.dropExclusionConstraints(t,r))}}async createNewTables(){for(const e of this.entityToSyncMetadatas){if(this.queryRunner.loadedTables.find(r=>this.getTablePath(r)===this.getTablePath(e)))continue;this.connection.logger.logSchemaBuild(`creating a new table: ${this.getTablePath(e)}`);const t=_t.create(e,this.connection.driver);await this.queryRunner.createTable(t,!1,!1),this.queryRunner.loadedTables.push(t)}}async createViews(){for(const e of this.viewEntityToSyncMetadatas){if(this.queryRunner.loadedViews.find(r=>{const a=typeof r.expression=="string"?r.expression.trim():r.expression(this.connection).getQuery(),i=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.getTablePath(r)===this.getTablePath(e)&&a===i}))continue;this.connection.logger.logSchemaBuild(`creating a new view: ${this.getTablePath(e)}`);const t=va.create(e,this.connection.driver);await this.queryRunner.createView(t,!0),this.queryRunner.loadedViews.push(t)}}async dropOldViews(){const e=[],t=this.viewEntityToSyncMetadatas,r=new Map;for(const s of this.queryRunner.loadedViews){const o=t.find(l=>this.getTablePath(s)===this.getTablePath(l));o&&r.set(s,o)}for(const s of this.queryRunner.loadedViews){const o=r.get(s);if(!o)continue;const l=typeof s.expression=="string"?s.expression.trim():s.expression(this.connection).getQuery(),c=typeof o.expression=="string"?o.expression.trim():o.expression(this.connection).getQuery();l!==c&&(this.connection.logger.logSchemaBuild(`dropping an old view: ${s.name}`),e.push(s))}const a=s=>{const o=r.get(s);let l=[s];if(!o)return l;for(const[c,u]of r.entries())c!==s&&u.dependsOn&&(u.dependsOn.has(o.target)||u.dependsOn.has(o.name))&&(l=l.concat(a(c)));return l},i=new Set(e.map(s=>a(s)).reduce((s,o)=>s.concat(o),[]).sort((s,o)=>Pw.viewMetadataCmp(r.get(s),r.get(o))).reverse());for(const s of i)await this.queryRunner.dropView(s);this.queryRunner.loadedViews=this.queryRunner.loadedViews.filter(s=>!i.has(s))}async dropRemovedColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=t.columns.filter(a=>!e.columns.find(i=>i.isVirtualProperty||i.databaseName===a.name));r.length!==0&&(this.connection.logger.logSchemaBuild(`columns dropped in ${t.name}: `+r.map(a=>a.name).join(", ")),await this.queryRunner.dropColumns(t,r))}}async addNewColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=e.columns.filter(i=>!i.isVirtualProperty&&!t.columns.find(s=>s.name===i.databaseName));if(r.length===0)continue;const a=this.metadataColumnsToTableColumnOptions(r).map(i=>new Sn(i));a.length!==0&&(this.connection.logger.logSchemaBuild("new columns added: "+r.map(i=>i.databaseName).join(", ")),await this.queryRunner.addColumns(t,a))}}async updatePrimaryKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.columns.filter(a=>a.isPrimary);if(t.columns.filter(a=>a.isPrimary).length!==r.length&&r.length>1){const a=r.map(i=>new Sn(uh.createTableColumnOptions(i,this.connection.driver)));await this.queryRunner.updatePrimaryKeys(t,a)}}}async updateExistColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=this.connection.driver.findChangedColumns(t.columns,e.columns);if(r.length===0)continue;for(const i of r)await this.dropColumnReferencedForeignKeys(this.getTablePath(e),i.databaseName);for(const i of r)await this.dropColumnCompositeIndices(this.getTablePath(e),i.databaseName);if(!(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="spanner"))for(const i of r)await this.dropColumnCompositeUniques(this.getTablePath(e),i.databaseName);const a=r.map(i=>{const s=t.columns.find(c=>c.name===i.databaseName),o=uh.createTableColumnOptions(i,this.connection.driver),l=new Sn(o);return{oldColumn:s,newColumn:l}});a.length!==0&&(this.connection.logger.logSchemaBuild(`columns changed in "${t.name}". updating: `+r.map(i=>i.databaseName).join(", ")),await this.queryRunner.changeColumns(t,a))}}async createNewIndices(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.indices.filter(a=>!t.indices.find(i=>i.name===a.name)&&a.synchronize===!0).map(a=>Ct.create(a));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new indices ${r.map(a=>`"${a.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createIndices(t,r))}}async createNewViewIndices(){if(this.connection.options.type!=="postgres"||!pe.isPostgresFamily(this.connection.driver))return;const e=this.queryRunner;for(const t of this.viewEntityToSyncMetadatas){const r=this.queryRunner.loadedViews.find(i=>{const s=typeof i.expression=="string"?i.expression.trim():i.expression(this.connection).getQuery(),o=typeof t.expression=="string"?t.expression.trim():t.expression(this.connection).getQuery();return this.getTablePath(i)===this.getTablePath(t)&&s===o});if(!r||!r.materialized)continue;const a=t.indices.filter(i=>!r.indices.find(s=>s.name===i.name)&&i.synchronize===!0).map(i=>Ct.create(i));a.length!==0&&(this.connection.logger.logSchemaBuild(`adding new indices ${a.map(i=>`"${i.name}"`).join(", ")} in view "${r.name}"`),await e.createViewIndices(r,a))}}async createNewChecks(){if(!(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"))for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.checks.filter(a=>!t.checks.find(i=>i.name===a.name)).map(a=>Sr.create(a));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new check constraints: ${r.map(a=>`"${a.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createCheckConstraints(t,r))}}async createCompositeUniqueConstraints(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.uniques.filter(a=>a.columns.length>1&&!t.uniques.find(i=>i.name===a.name)).map(a=>cn.create(a));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new unique constraints: ${r.map(a=>`"${a.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createUniqueConstraints(t,r))}}async createNewExclusions(){if(this.connection.driver.options.type==="postgres")for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const r=e.exclusions.filter(a=>!t.exclusions.find(i=>i.name===a.name)).map(a=>Wi.create(a));r.length!==0&&(this.connection.logger.logSchemaBuild(`adding new exclusion constraints: ${r.map(a=>`"${a.name}"`).join(", ")} in table "${t.name}"`),await this.queryRunner.createExclusionConstraints(t,r))}}async createForeignKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const r=e.foreignKeys.filter(i=>!t.foreignKeys.find(s=>s.name===i.name&&this.getTablePath(s)===this.getTablePath(i.referencedEntityMetadata)));if(r.length===0)continue;const a=r.map(i=>ar.create(i,this.connection.driver));this.connection.logger.logSchemaBuild(`creating a foreign keys: ${r.map(i=>i.name).join(", ")} on table "${t.name}"`),await this.queryRunner.createForeignKeys(t,a)}}async dropColumnReferencedForeignKeys(e,t){const r=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===e);if(!r)return;const a=[],i=r.foreignKeys.find(s=>s.columnNames.indexOf(t)!==-1);if(i){const s=r.clone();s.foreignKeys=[i],a.push(s),r.removeForeignKey(i)}for(const s of this.queryRunner.loadedTables){const o=s.foreignKeys.filter(l=>this.getTablePath(l)===e&&l.referencedColumnNames.indexOf(t)!==-1);if(o.length>0){const l=s.clone();l.foreignKeys=o,a.push(l),o.forEach(c=>s.removeForeignKey(c))}}if(a.length>0)for(const s of a)this.connection.logger.logSchemaBuild(`dropping related foreign keys of ${s.name}: ${s.foreignKeys.map(o=>o.name).join(", ")}`),await this.queryRunner.dropForeignKeys(s,s.foreignKeys)}async dropColumnCompositeIndices(e,t){const r=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===e);if(!r)return;const a=r.indices.filter(i=>i.columnNames.length>1&&i.columnNames.indexOf(t)!==-1);a.length!==0&&(this.connection.logger.logSchemaBuild(`dropping related indices of "${e}"."${t}": ${a.map(i=>i.name).join(", ")}`),await this.queryRunner.dropIndices(r,a))}async dropColumnCompositeUniques(e,t){const r=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===e);if(!r)return;const a=r.uniques.filter(i=>i.columnNames.length>1&&i.columnNames.indexOf(t)!==-1);a.length!==0&&(this.connection.logger.logSchemaBuild(`dropping related unique constraints of "${e}"."${t}": ${a.map(i=>i.name).join(", ")}`),await this.queryRunner.dropUniqueConstraints(r,a))}metadataColumnsToTableColumnOptions(e){return e.map(t=>uh.createTableColumnOptions(t,this.connection.driver))}async createTypeormMetadataTable(e){const t=this.currentSchema,r=this.currentDatabase,a=this.connection.driver.buildTableName(this.connection.metadataTableName,t,r),i=this.connection.driver.options.type==="spanner";await e.createTable(new _t({database:r,schema:t,name:a,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1,isPrimary:i},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0,isPrimary:i},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0,isPrimary:i},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0,isPrimary:i},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0,isPrimary:i},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0,isPrimary:i}]}),!0)}}class $l{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime","json"],this.supportedUpsertTypes=["on-conflict-do-update"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=pe.buildDriverOptions(this.options).database}async connect(){this.databaseConnection=await this.createDatabaseConnection()}afterConnect(){return Promise.resolve()}async disconnect(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close(r=>r?t(r):e())})}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,r;return(r=(t=this.attachedDatabases)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return(t=Object.values(this.attachedDatabases).find(({attachHandle:r})=>e===r))===null||t===void 0?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new fh(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=qt.transformTo(t.transformer,e)),e==null?e:t.type===Boolean||t.type==="boolean"?e===!0?1:0:t.type==="date"?Pe.mixedDateToDateString(e):t.type==="time"?Pe.mixedDateToTimeString(e):t.type==="datetime"||t.type===Date?Pe.mixedDateToUtcDatetimeString(e):t.type==="json"||t.type==="simple-json"?Pe.simpleJsonToString(e):t.type==="simple-array"?Pe.simpleArrayToString(e):t.type==="simple-enum"?Pe.simpleEnumToString(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?qt.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?(e&&typeof e=="string"&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=Pe.normalizeHydratedDate(e)):t.type==="date"?e=Pe.mixedDateToDateString(e):t.type==="time"?e=Pe.mixedTimeToString(e):t.type==="json"||t.type==="simple-json"?e=Pe.stringToSimpleJson(e):t.type==="simple-array"?e=Pe.stringToSimpleArray(e):t.type==="simple-enum"?e=Pe.stringToSimpleEnum(e,t):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=qt.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,r){const a=Object.keys(r).map(i=>typeof r[i]=="boolean"?r[i]===!0?1:0:r[i]instanceof Date?Pe.mixedDateToUtcDatetimeString(r[i]):r[i]);return!t||!Object.keys(t).length?[e,a]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(i,s,o)=>{if(!t.hasOwnProperty(o))return i;let l=t[o];return s?l.map(c=>(a.push(c),this.createParameter(o,a.length-1))).join(", "):typeof l=="function"?l():typeof l=="number"?String(l):typeof l=="boolean"?(a.push(+l),this.createParameter(o,a.length-1)):l instanceof Date?(a.push(Pe.mixedDateToUtcDatetimeString(l)),this.createParameter(o,a.length-1)):(a.push(l),this.createParameter(o,a.length-1))}),[e,a])}escape(e){return'"'+e+'"'}buildTableName(e,t,r){return e}parseTableName(e){var t;const r=this.database,a=void 0;if(F.isTable(e)||F.isView(e)){const s=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||s.database||r,schema:e.schema||s.schema||a,tableName:s.tableName}}if(F.isTableForeignKey(e)){const s=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||s.database||r,schema:e.referencedSchema||s.schema||a,tableName:s.tableName}}if(F.isEntityMetadata(e))return{database:e.database||r,schema:e.schema||a,tableName:e.tableName};const i=e.split(".");return i.length===3?{database:i[0]||r,schema:i[1]||a,tableName:i[2]}:i.length===2?{database:(t=this.getAttachedDatabasePathRelativeByHandle(i[0]))!==null&&t!==void 0?t:r,schema:i[0],tableName:i[1]}:{database:r,schema:a,tableName:e}}normalizeType(e){return e.type===Number||e.type==="int"?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"varchar":e.type||""}normalizeDefault(e){const t=e.default;if(typeof t=="number")return""+t;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!=null)return`${t}`}normalizeIsUnique(e){return e.entityMetadata.uniques.some(t=>t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+="("+e.precision+","+e.scale+")":e.precision!==null&&e.precision!==void 0&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,r,a){const i=e.generatedColumns.reduce((s,o)=>{let l;return o.generationStrategy==="increment"&&t&&(l=t-a+r+1),l?Ee.mergeDeep(s,o.createValueMap(l)):s},{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter(r=>{const a=e.find(i=>i.name===r.databaseName);return a?a.name!==r.databaseName||a.type!==this.normalizeType(r)||a.length!==r.length||a.precision!==r.precision||a.scale!==r.scale||this.normalizeDefault(r)!==a.default||a.isPrimary!==r.isPrimary||a.isNullable!==r.isNullable||a.generatedType!==r.generatedType||a.asExpression!==r.asExpression||a.isUnique!==this.normalizeIsUnique(r)||a.enum&&r.enum&&!Ee.isArraysEqual(a.enum,r.enum.map(i=>i+""))||r.generationStrategy!=="uuid"&&a.isGenerated!==r.isGenerated:!1})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){throw new $("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")}loadDependencies(){}}class x{constructor(e,t){this.query=e,this.parameters=t,this["@instanceof"]=Symbol.for("Query")}}class yh{constructor(){this.upQueries=[],this.downQueries=[]}}class gh{constructor(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new yh,this.transactionDepth=0,this.cachedTablePaths={}}async beforeMigration(){}async afterMigration(){}async getTable(e){return this.loadedTables=await this.loadTables([e]),this.loadedTables.length>0?this.loadedTables[0]:void 0}async getTables(e){return e?(this.loadedTables=await this.loadTables(e),this.loadedTables):await this.loadTables(e)}async getView(e){return this.loadedViews=await this.loadViews([e]),this.loadedViews.length>0?this.loadedViews[0]:void 0}async getViews(e){return this.loadedViews=await this.loadViews(e),this.loadedViews}enableSqlMemory(){this.sqlInMemory=new yh,this.sqlMemoryMode=!0}disableSqlMemory(){this.sqlInMemory=new yh,this.sqlMemoryMode=!1}clearSqlMemory(){this.sqlInMemory=new yh}getMemorySql(){return this.sqlInMemory}async executeMemoryUpSql(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)await this.query(e,t)}async executeMemoryDownSql(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())await this.query(e,t)}getReplicationMode(){return this.mode}async getCachedView(e){const t=this.loadedViews.find(a=>a.name===e);if(t)return t;const r=await this.loadViews([e]);if(r.length>0)return this.loadedViews.push(r[0]),r[0];throw new $(`View "${e}" does not exist.`)}async getCachedTable(e){if(e in this.cachedTablePaths){const r=this.cachedTablePaths[e],a=this.loadedTables.find(i=>this.getTablePath(i)===r);if(a)return a}const t=await this.loadTables([e]);if(t.length>0){const r=this.getTablePath(t[0]);return this.loadedTables.find(i=>this.getTablePath(i)===r)||(this.cachedTablePaths[e]=this.getTablePath(t[0]),this.loadedTables.push(t[0]),t[0])}else throw new $(`Table "${e}" does not exist.`)}replaceCachedTable(e,t){const r=this.getTablePath(e),a=this.loadedTables.find(i=>this.getTablePath(i)===r);for(const[i,s]of Object.entries(this.cachedTablePaths))s===r&&(this.cachedTablePaths[i]=this.getTablePath(t));a&&(a.database=t.database,a.schema=t.schema,a.name=t.name,a.columns=t.columns,a.indices=t.indices,a.foreignKeys=t.foreignKeys,a.uniques=t.uniques,a.checks=t.checks,a.justCreated=t.justCreated,a.engine=t.engine)}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema,t.database)}getTypeormMetadataTableName(){const e=this.connection.driver.options;return this.connection.driver.buildTableName(this.connection.metadataTableName,e.schema,e.database)}selectTypeormMetadataSql({database:e,schema:t,table:r,type:a,name:i}){const s=this.connection.createQueryBuilder(),o=s.select().from(this.getTypeormMetadataTableName(),"t").where(`${s.escape("type")} = :type`,{type:a}).andWhere(`${s.escape("name")} = :name`,{name:i});e&&o.andWhere(`${s.escape("database")} = :database`,{database:e}),t&&o.andWhere(`${s.escape("schema")} = :schema`,{schema:t}),r&&o.andWhere(`${s.escape("table")} = :table`,{table:r});const[l,c]=o.getQueryAndParameters();return new x(l,c)}insertTypeormMetadataSql({database:e,schema:t,table:r,type:a,name:i,value:s}){const[o,l]=this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({database:e,schema:t,table:r,type:a,name:i,value:s}).getQueryAndParameters();return new x(o,l)}deleteTypeormMetadataSql({database:e,schema:t,table:r,type:a,name:i}){const s=this.connection.createQueryBuilder(),o=s.delete().from(this.getTypeormMetadataTableName()).where(`${s.escape("type")} = :type`,{type:a}).andWhere(`${s.escape("name")} = :name`,{name:i});e&&o.andWhere(`${s.escape("database")} = :database`,{database:e}),t&&o.andWhere(`${s.escape("schema")} = :schema`,{schema:t}),r&&o.andWhere(`${s.escape("table")} = :table`,{table:r});const[l,c]=o.getQueryAndParameters();return new x(l,c)}isColumnChanged(e,t,r,a,i=!0){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||r&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||a&&e.comment!==t.comment||i&&this.isEnumChanged(e,t)}isEnumChanged(e,t){return!Ee.isArraysEqual(e.enum||[],t.enum||[])}isDefaultColumnLength(e,t,r){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&this.connection.driver.getColumnLength(a))return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length?this.connection.driver.dataTypeDefaults[t.type].length.toString()===r.toString():!1}isDefaultColumnPrecision(e,t,r){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&a.precision!==null&&a.precision!==void 0)return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].precision!==null&&this.connection.driver.dataTypeDefaults[t.type].precision!==void 0?this.connection.driver.dataTypeDefaults[t.type].precision===r:!1}isDefaultColumnScale(e,t,r){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&a.scale!==null&&a.scale!==void 0)return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].scale!==null&&this.connection.driver.dataTypeDefaults[t.type].scale!==void 0?this.connection.driver.dataTypeDefaults[t.type].scale===r:!1}async executeQueries(e,t){if(F.isQuery(e)&&(e=[e]),F.isQuery(t)&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),this.sqlMemoryMode===!0)return Promise.resolve();for(const{query:r,parameters:a}of e)await this.query(r,a)}generateIndexName(e,t){return this.connection.namingStrategy.indexName(e,t.columnNames,t.where)}}var Ie;(function(n){n.VIEW="VIEW",n.MATERIALIZED_VIEW="MATERIALIZED_VIEW",n.GENERATED_COLUMN="GENERATED_COLUMN"})(Ie||(Ie={}));class Zs extends gh{constructor(){super(),this.transactionPromise=null}connect(){return Promise.resolve(this.driver.databaseConnection)}release(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()}async startTransaction(e){if(this.driver.transactionSupport==="none")throw new $(`Transactions aren't supported by ${this.connection.driver.options.type}.`);if(this.isTransactionActive&&this.driver.transactionSupport==="simple")throw new eM;if(e&&e!=="READ UNCOMMITTED"&&e!=="SERIALIZABLE")throw new $("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?(e&&(e==="READ UNCOMMITTED"?await this.query("PRAGMA read_uncommitted = true"):await this.query("PRAGMA read_uncommitted = false")),await this.query("BEGIN TRANSACTION")):await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}stream(e,t,r,a){throw new $("Stream is not supported by sqlite driver.")}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){return Promise.resolve(!1)}async getCurrentDatabase(){return Promise.resolve(void 0)}async hasSchema(e){throw new $("This driver does not support table schemas")}async getCurrentSchema(){return Promise.resolve(void 0)}async hasTable(e){const t=`SELECT * FROM "sqlite_master" WHERE "type" = 'table' AND "name" = '${F.isTable(e)?e.name:e}'`;return!!(await this.query(t)).length}async hasColumn(e,t){const r=F.isTable(e)?e.name:e,a=`PRAGMA table_xinfo(${this.escapePath(r)})`;return!!(await this.query(a)).find(i=>i.name===t)}async createDatabase(e,t){return Promise.resolve()}async dropDatabase(e,t){return Promise.resolve()}async createSchema(e,t){return Promise.resolve()}async dropSchema(e,t){return Promise.resolve()}async createTable(e,t=!1,r=!0,a=!0){const i=[],s=[];if(t&&await this.hasTable(e))return Promise.resolve();i.push(this.createTableSql(e,r)),s.push(this.dropTableSql(e)),a&&e.indices.forEach(l=>{l.name||(l.name=this.connection.namingStrategy.indexName(e,l.columnNames,l.where)),i.push(this.createIndexSql(e,l)),s.push(this.dropIndexSql(l))});const o=e.columns.filter(l=>l.generatedType&&l.asExpression);for(const l of o){const c=this.insertTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:l.name,value:l.asExpression}),u=this.deleteTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:l.name});i.push(c),s.push(u)}await this.executeQueries(i,s)}async dropTable(e,t,r=!0,a=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const i=r,s=F.isTable(e)?e:await this.getCachedTable(e),o=[],l=[];a&&s.indices.forEach(u=>{o.push(this.dropIndexSql(u)),l.push(this.createIndexSql(s,u))}),o.push(this.dropTableSql(s,t)),l.push(this.createTableSql(s,i));const c=s.columns.filter(u=>u.generatedType&&u.asExpression);for(const u of c){const h=this.deleteTypeormMetadataSql({table:s.name,type:Ie.GENERATED_COLUMN,name:u.name}),d=this.insertTypeormMetadataSql({table:s.name,type:Ie.GENERATED_COLUMN,name:u.name,value:u.asExpression});o.push(h),l.push(d)}await this.executeQueries(o,l)}async createView(e,t=!1){const r=[],a=[];r.push(this.createViewSql(e)),t&&r.push(this.insertViewDefinitionSql(e)),a.push(this.dropViewSql(e)),t&&a.push(this.deleteViewDefinitionSql(e)),await this.executeQueries(r,a)}async dropView(e){const t=F.isView(e)?e.name:e,r=await this.getCachedView(t),a=[],i=[];a.push(this.deleteViewDefinitionSql(r)),a.push(this.dropViewSql(r)),i.push(this.insertViewDefinitionSql(r)),i.push(this.createViewSql(r)),await this.executeQueries(a,i)}async renameTable(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();a.name=t;const i=new x(`ALTER TABLE ${this.escapePath(r.name)} RENAME TO ${this.escapePath(t)}`),s=new x(`ALTER TABLE ${this.escapePath(t)} RENAME TO ${this.escapePath(r.name)}`);await this.executeQueries(i,s),a.uniques.forEach(o=>{const l=this.connection.namingStrategy.uniqueConstraintName(r,o.columnNames);o.name===l&&(o.name=this.connection.namingStrategy.uniqueConstraintName(a,o.columnNames))}),a.foreignKeys.forEach(o=>{const l=this.connection.namingStrategy.foreignKeyName(r,o.columnNames,this.getTablePath(o),o.referencedColumnNames);o.name===l&&(o.name=this.connection.namingStrategy.foreignKeyName(a,o.columnNames,this.getTablePath(o),o.referencedColumnNames))}),a.indices.forEach(o=>{const l=this.connection.namingStrategy.indexName(r,o.columnNames,o.where);o.name===l&&(o.name=this.connection.namingStrategy.indexName(a,o.columnNames,o.where))}),r.name=a.name,await this.recreateTable(a,r)}async addColumn(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);return this.addColumns(r,[t])}async addColumns(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.addColumn(i)),await this.recreateTable(a,r)}async renameColumn(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e),i=F.isTableColumn(t)?t:a.columns.find(o=>o.name===t);if(!i)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);let s;return F.isTableColumn(r)?s=r:(s=i.clone(),s.name=r),this.changeColumn(a,i,s)}async changeColumn(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e),i=F.isTableColumn(t)?t:a.columns.find(s=>s.name===t);if(!i)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);await this.changeColumns(a,[{oldColumn:i,newColumn:r}])}async changeColumns(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>{i.newColumn.name!==i.oldColumn.name&&(a.findColumnUniques(i.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.uniqueConstraintName(r,o.columnNames);o.columnNames.splice(o.columnNames.indexOf(i.oldColumn.name),1),o.columnNames.push(i.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.uniqueConstraintName(a,o.columnNames))}),a.findColumnForeignKeys(i.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.foreignKeyName(r,o.columnNames,this.getTablePath(o),o.referencedColumnNames);o.columnNames.splice(o.columnNames.indexOf(i.oldColumn.name),1),o.columnNames.push(i.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.foreignKeyName(a,o.columnNames,this.getTablePath(o),o.referencedColumnNames))}),a.findColumnIndices(i.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.indexName(r,o.columnNames,o.where);o.columnNames.splice(o.columnNames.indexOf(i.oldColumn.name),1),o.columnNames.push(i.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.indexName(a,o.columnNames,o.where))}));const s=a.columns.find(o=>o.name===i.oldColumn.name);s&&(a.columns[a.columns.indexOf(s)]=i.newColumn)}),await this.recreateTable(a,r)}async dropColumn(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableColumn(t)?t:r.findColumnByName(t);if(!a)throw new $(`Column "${t}" was not found in table "${r.name}"`);await this.dropColumns(r,[a])}async dropColumns(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>{const s=F.isTableColumn(i)?i:r.findColumnByName(i);if(!s)throw new Error(`Column "${i}" was not found in table "${r.name}"`);a.removeColumn(s),a.findColumnUniques(s).forEach(o=>a.removeUniqueConstraint(o)),a.findColumnIndices(s).forEach(o=>a.removeIndex(o)),a.findColumnForeignKeys(s).forEach(o=>a.removeForeignKey(o))}),await this.recreateTable(a,r)}async createPrimaryKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();a.columns.forEach(i=>{t.find(s=>s===i.name)&&(i.isPrimary=!0)}),await this.recreateTable(a,r),r.columns.forEach(i=>{t.find(s=>s===i.name)&&(i.isPrimary=!0)})}async updatePrimaryKeys(e,t){await Promise.resolve()}async dropPrimaryKey(e){const t=F.isTable(e)?e:await this.getCachedTable(e),r=t.clone();r.primaryColumns.forEach(a=>{a.isPrimary=!1}),await this.recreateTable(r,t),t.primaryColumns.forEach(a=>{a.isPrimary=!1})}async createUniqueConstraint(e,t){await this.createUniqueConstraints(e,[t])}async createUniqueConstraints(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.addUniqueConstraint(i)),await this.recreateTable(a,r)}async dropUniqueConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableUnique(t)?t:r.uniques.find(i=>i.name===t);if(!a)throw new $(`Supplied unique constraint was not found in table ${r.name}`);await this.dropUniqueConstraints(r,[a])}async dropUniqueConstraints(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.removeUniqueConstraint(i)),await this.recreateTable(a,r)}async createCheckConstraint(e,t){await this.createCheckConstraints(e,[t])}async createCheckConstraints(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.addCheckConstraint(i)),await this.recreateTable(a,r)}async dropCheckConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableCheck(t)?t:r.checks.find(i=>i.name===t);if(!a)throw new $(`Supplied check constraint was not found in table ${r.name}`);await this.dropCheckConstraints(r,[a])}async dropCheckConstraints(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.removeCheckConstraint(i)),await this.recreateTable(a,r)}async createExclusionConstraint(e,t){throw new $("Sqlite does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new $("Sqlite does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new $("Sqlite does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new $("Sqlite does not support exclusion constraints.")}async createForeignKey(e,t){await this.createForeignKeys(e,[t])}async createForeignKeys(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.addForeignKey(i)),await this.recreateTable(a,r)}async dropForeignKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableForeignKey(t)?t:r.foreignKeys.find(i=>i.name===t);if(!a)throw new $(`Supplied foreign key was not found in table ${r.name}`);await this.dropForeignKeys(e,[a])}async dropForeignKeys(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone();t.forEach(i=>a.removeForeignKey(i)),await this.recreateTable(a,r)}async createIndex(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const a=this.createIndexSql(r,t),i=this.dropIndexSql(t);await this.executeQueries(a,i),r.addIndex(t)}async createIndices(e,t){const r=t.map(a=>this.createIndex(e,a));await Promise.all(r)}async dropIndex(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!a)throw new $(`Supplied index ${t} was not found in table ${r.name}`);a.name||(a.name=this.generateIndexName(r,a));const i=this.dropIndexSql(a),s=this.createIndexSql(r,a);await this.executeQueries(i,s),r.removeIndex(a)}async dropIndices(e,t){const r=t.map(a=>this.dropIndex(e,a));await Promise.all(r)}async clearTable(e){await this.query(`DELETE FROM ${this.escapePath(e)}`)}async clearDatabase(e){let t;e&&this.driver.getAttachedDatabaseHandleByRelativePath(e)&&(t=this.driver.getAttachedDatabaseHandleByRelativePath(e)),await this.query("PRAGMA foreign_keys = OFF");const r=this.isTransactionActive;r||await this.startTransaction();try{const a=t?`SELECT 'DROP VIEW "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'view'`:`SELECT 'DROP VIEW "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'view'`,i=await this.query(a);await Promise.all(i.map(l=>this.query(l.query)));const s=t?`SELECT 'DROP TABLE "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`:`SELECT 'DROP TABLE "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`,o=await this.query(s);await Promise.all(o.map(l=>this.query(l.query))),r||await this.commitTransaction()}catch(a){try{r||await this.rollbackTransaction()}catch{}throw a}finally{await this.query("PRAGMA foreign_keys = ON")}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const t=e.map(a=>"'"+a+"'").join(", ");let r=`SELECT "t".* FROM "${this.getTypeormMetadataTableName()}" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = 'view' WHERE "t"."type" = '${Ie.VIEW}'`;return t.length>0&&(r+=` AND "t"."name" IN (${t})`),(await this.query(r)).map(a=>{const i=new va;return i.name=a.name,i.expression=a.value,i})}async loadTableRecords(e,t){let r;const[a,i]=this.splitTablePath(e);return a&&this.driver.getAttachedDatabasePathRelativeByHandle(a)&&(r=this.driver.getAttachedDatabasePathRelativeByHandle(a)),this.query(`SELECT ${r?`'${r}'`:null} as database, ${a?`'${a}'`:null} as schema, * FROM ${a?`"${a}".`:""}${this.escapePath("sqlite_master")} WHERE "type" = '${t}' AND "${t==="table"?"name":"tbl_name"}" IN ('${i}')`)}async loadPragmaRecords(e,t){const[,r]=this.splitTablePath(e);return this.query(`PRAGMA ${t}("${r}")`)}async loadTables(e){if(e&&e.length===0)return[];let t=[],r;if(e){const a=e.filter(o=>o.split(".").length===1).map(o=>`'${o}'`),i=e.filter(o=>o.split(".").length>1),s=o=>{const l=[...i.map(c=>this.loadTableRecords(c,o))];return a.length&&l.push(this.query(`SELECT * FROM "sqlite_master" WHERE "type" = '${o}' AND "${o==="table"?"name":"tbl_name"}" IN (${a})`)),l};t=(await Promise.all(s("table"))).reduce((o,l)=>[...o,...l],[]).filter(Boolean),r=(await Promise.all(s("index"))).reduce((o,l)=>[...o,...l],[]).filter(Boolean)}else{t.push(...await this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'table'`));const a=t.map(({name:i})=>`'${i}'`).join(", ");r=await this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'index' AND "tbl_name" IN (${a})`)}return t.length===0?[]:Promise.all(t.map(async a=>{const i=a.database&&this.driver.getAttachedDatabaseHandleByRelativePath(a.database)?`${this.driver.getAttachedDatabaseHandleByRelativePath(a.database)}.${a.name}`:a.name,s=a.sql,o=s.includes("WITHOUT ROWID"),l=new _t({name:i,withoutRowid:o}),[c,u,h]=await Promise.all([this.loadPragmaRecords(i,"table_xinfo"),this.loadPragmaRecords(i,"index_list"),this.loadPragmaRecords(i,"foreign_key_list")]);let d;const f=a.sql;let g=f.toUpperCase().indexOf("AUTOINCREMENT");if(g!==-1){d=f.substr(0,g);const I=d.lastIndexOf(","),G=d.lastIndexOf("(");I!==-1?(d=d.substr(I),d=d.substr(0,d.lastIndexOf('"')),d=d.substr(d.indexOf('"')+1)):G!==-1&&(d=d.substr(G),d=d.substr(0,d.lastIndexOf('"')),d=d.substr(d.indexOf('"')+1))}l.columns=await Promise.all(c.map(async I=>{const G=new Sn;if(G.name=I.name,G.type=I.type.toLowerCase(),G.default=I.dflt_value!==null&&I.dflt_value!==void 0?I.dflt_value:void 0,G.isNullable=I.notnull===0,G.isPrimary=I.pk>0,G.comment="",G.isGenerated=d===I.name,G.isGenerated&&(G.generationStrategy="increment"),I.hidden===2||I.hidden===3){G.generatedType=I.hidden===2?"VIRTUAL":"STORED";const se=await this.selectTypeormMetadataSql({table:l.name,type:Ie.GENERATED_COLUMN,name:G.name}),re=await this.query(se.query,se.parameters);re[0]&&re[0].value?G.asExpression=re[0].value:G.asExpression=""}if(G.type==="varchar"){const se=s.match(new RegExp('"('+G.name+`)" varchar CHECK\\s*\\(\\s*"\\1"\\s+IN\\s*\\(('[^']+'(?:\\s*,\\s*'[^']+')+)\\s*\\)\\s*\\)`));se&&(G.enum=se[2].substr(1,se[2].length-2).split("','"))}let H=G.type.indexOf("(");if(H!==-1){const se=G.type;let re=se.substr(0,H);if(this.driver.withLengthColumnTypes.find(ue=>ue===re)){let ue=parseInt(se.substring(H+1,se.length-1));ue&&(G.length=ue.toString(),G.type=re)}if(this.driver.withPrecisionColumnTypes.find(ue=>ue===re)){const ue=new RegExp(`^${re}\\((\\d+),?\\s?(\\d+)?\\)`),Se=se.match(ue);Se&&Se[1]&&(G.precision=+Se[1]),this.driver.withScaleColumnTypes.find(ie=>ie===re)&&Se&&Se[2]&&(G.scale=+Se[2]),G.type=re}}return G}));let v;const C=[],w=/CONSTRAINT "([^"]*)" FOREIGN KEY ?\((.*?)\) REFERENCES "([^"]*)"/g;for(;(v=w.exec(s))!==null;)C.push({name:v[1],columns:v[2].substr(1,v[2].length-2).split('", "'),referencedTableName:v[3]});const T=Ee.uniq(h,I=>I.id);l.foreignKeys=T.map(I=>{const G=h.filter(ue=>ue.id===I.id&&ue.table===I.table),H=G.map(ue=>ue.from),se=G.map(ue=>ue.to),re=C.find(ue=>ue.referencedTableName===I.table&&ue.columns.every(Se=>H.indexOf(Se)!==-1));return new ar({name:re==null?void 0:re.name,columnNames:H,referencedTableName:I.table,referencedColumnNames:se,onDelete:I.on_delete,onUpdate:I.on_update})});let S;const O=[],k=/CONSTRAINT "([^"]*)" UNIQUE ?\((.*?)\)/g;for(;(S=k.exec(s))!==null;)O.push({name:S[1],columns:S[2].substr(1,S[2].length-2).split('", "')});const B=u.filter(I=>I.origin==="u").map(I=>I.name).filter((I,G,H)=>H.indexOf(I)===G).map(async I=>{const G=u.find(re=>re.name===I),H=(await this.query(`PRAGMA index_info("${G.name}")`)).sort((re,ue)=>parseInt(re.seqno)-parseInt(ue.seqno)).map(re=>re.name);if(H.length===1){const re=l.columns.find(ue=>!!H.find(Se=>Se===ue.name));re&&(re.isUnique=!0)}const se=O.find(re=>re.columns.every(ue=>H.indexOf(ue)!==-1));return new cn({name:se?se.name:this.connection.namingStrategy.uniqueConstraintName(l,H),columnNames:H})});l.uniques=await Promise.all(B);let D;const V=/CONSTRAINT "([^"]*)" CHECK ?(\(.*?\))([,]|[)]$)/g;for(;(D=V.exec(s))!==null;)l.checks.push(new Sr({name:D[1],expression:D[2]}));const q=u.filter(I=>I.origin==="c").map(I=>I.name).filter((I,G,H)=>H.indexOf(I)===G).map(async I=>{const G=r.find(ie=>ie.name===I),H=/WHERE (.*)/.exec(G.sql),se=u.find(ie=>ie.name===I),re=(await this.query(`PRAGMA index_info("${se.name}")`)).sort((ie,fe)=>parseInt(ie.seqno)-parseInt(fe.seqno)).map(ie=>ie.name),ue=`${a.database?`${a.database}.`:""}${se.name}`,Se=se.unique==="1"||se.unique===1;return new Ct({table:l,name:ue,columnNames:re,isUnique:Se,where:H?H[1]:void 0})}),K=await Promise.all(q);return l.indices=K.filter(I=>!!I),l}))}createTableSql(e,t,r){const a=e.columns.filter(f=>f.isPrimary),i=a.find(f=>f.isGenerated&&f.generationStrategy==="increment"),s=a.length>1;if(s&&i)throw new $("Sqlite does not support AUTOINCREMENT on composite primary key");const o=e.columns.map(f=>this.buildCreateColumnSql(f,s)).join(", "),[l]=this.splitTablePath(e.name);let c=`CREATE TABLE ${this.escapePath(e.name)} (${o}`,[u,h]=this.splitTablePath(e.name);const d=r?`${u?`${u}.`:""}${h.replace(/^temporary_/,"")}`:e.name;if(e.columns.filter(f=>f.isUnique).forEach(f=>{e.uniques.some(g=>g.columnNames.length===1&&g.columnNames[0]===f.name)||e.uniques.push(new cn({name:this.connection.namingStrategy.uniqueConstraintName(e,[f.name]),columnNames:[f.name]}))}),e.uniques.length>0){const f=e.uniques.map(g=>{const v=g.name?g.name:this.connection.namingStrategy.uniqueConstraintName(d,g.columnNames),C=g.columnNames.map(w=>`"${w}"`).join(", ");return`CONSTRAINT "${v}" UNIQUE (${C})`}).join(", ");c+=`, ${f}`}if(e.checks.length>0){const f=e.checks.map(g=>`CONSTRAINT "${g.name?g.name:this.connection.namingStrategy.checkConstraintName(d,g.expression)}" CHECK (${g.expression})`).join(", ");c+=`, ${f}`}if(e.foreignKeys.length>0&&t){const f=e.foreignKeys.filter(g=>{const[v]=this.splitTablePath(g.referencedTableName);return v===l}).map(g=>{const[,v]=this.splitTablePath(g.referencedTableName),C=g.columnNames.map(S=>`"${S}"`).join(", ");g.name||(g.name=this.connection.namingStrategy.foreignKeyName(d,g.columnNames,this.getTablePath(g),g.referencedColumnNames));const w=g.referencedColumnNames.map(S=>`"${S}"`).join(", ");let T=`CONSTRAINT "${g.name}" FOREIGN KEY (${C}) REFERENCES "${v}" (${w})`;return g.onDelete&&(T+=` ON DELETE ${g.onDelete}`),g.onUpdate&&(T+=` ON UPDATE ${g.onUpdate}`),g.deferrable&&(T+=` DEFERRABLE ${g.deferrable}`),T}).join(", ");c+=`, ${f}`}if(a.length>1){const f=a.map(g=>`"${g.name}"`).join(", ");c+=`, PRIMARY KEY (${f})`}return c+=")",e.withoutRowid&&(c+=" WITHOUT ROWID"),new x(c)}dropTableSql(e,t){const r=F.isTable(e)?e.name:e,a=t?`DROP TABLE IF EXISTS ${this.escapePath(r)}`:`DROP TABLE ${this.escapePath(r)}`;return new x(a)}createViewSql(e){return typeof e.expression=="string"?new x(`CREATE VIEW "${e.name}" AS ${e.expression}`):new x(`CREATE VIEW "${e.name}" AS ${e.expression(this.connection).getQuery()}`)}insertViewDefinitionSql(e){const t=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:Ie.VIEW,name:e.name,value:t})}dropViewSql(e){const t=F.isView(e)?e.name:e;return new x(`DROP VIEW "${t}"`)}deleteViewDefinitionSql(e){const t=F.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:Ie.VIEW,name:t})}createIndexSql(e,t){const r=t.columnNames.map(s=>`"${s}"`).join(", "),[a,i]=this.splitTablePath(e.name);return new x(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX ${a?`"${a}".`:""}${this.escapePath(t.name)} ON "${i}" (${r}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e){let t=F.isTableIndex(e)?e.name:e;return new x(`DROP INDEX ${this.escapePath(t)}`)}buildCreateColumnSql(e,t){let r='"'+e.name+'"';return F.isColumnMetadata(e)?r+=" "+this.driver.normalizeType(e):r+=" "+this.connection.driver.createFullType(e),e.enum&&(r+=' CHECK( "'+e.name+'" IN ('+e.enum.map(a=>"'"+a+"'").join(",")+") )"),e.isPrimary&&!t&&(r+=" PRIMARY KEY"),e.isGenerated===!0&&e.generationStrategy==="increment"&&(r+=" AUTOINCREMENT"),e.collation&&(r+=" COLLATE "+e.collation),e.isNullable!==!0&&(r+=" NOT NULL"),e.asExpression?r+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`:e.default!==void 0&&e.default!==null&&(r+=" DEFAULT ("+e.default+")"),r}async recreateTable(e,t,r=!0){const a=[],i=[];t.indices.forEach(c=>{a.push(this.dropIndexSql(c)),i.push(this.createIndexSql(t,c))});let[s,o]=this.splitTablePath(e.name),[,l]=this.splitTablePath(t.name);if(e.name=o=`${s?`${s}.`:""}temporary_${o}`,a.push(this.createTableSql(e,!0,!0)),i.push(this.dropTableSql(e)),r){let c=e.columns.filter(h=>!h.generatedType).map(h=>`"${h.name}"`),u=t.columns.filter(h=>!h.generatedType).map(h=>`"${h.name}"`);u.length<c.length?c=e.columns.filter(h=>{const d=t.columns.find(f=>f.name===h.name);return d&&d.generatedType?!1:!h.generatedType&&d}).map(h=>`"${h.name}"`):u.length>c.length&&(u=t.columns.filter(h=>!h.generatedType&&e.columns.find(d=>d.name===h.name)).map(h=>`"${h.name}"`)),a.push(new x(`INSERT INTO ${this.escapePath(e.name)}(${c.join(", ")}) SELECT ${u.join(", ")} FROM ${this.escapePath(t.name)}`)),i.push(new x(`INSERT INTO ${this.escapePath(t.name)}(${u.join(", ")}) SELECT ${c.join(", ")} FROM ${this.escapePath(e.name)}`))}a.push(this.dropTableSql(t)),i.push(this.createTableSql(t,!0)),a.push(new x(`ALTER TABLE ${this.escapePath(e.name)} RENAME TO ${this.escapePath(l)}`)),i.push(new x(`ALTER TABLE ${this.escapePath(t.name)} RENAME TO ${this.escapePath(o)}`)),e.name=t.name,e.indices.forEach(c=>{c.name||(c.name=this.connection.namingStrategy.indexName(e,c.columnNames,c.where)),a.push(this.createIndexSql(e,c)),i.push(this.dropIndexSql(c))}),t.columns.filter(c=>{const u=e.columns.find(h=>h.name===c.name);return c.generatedType&&c.asExpression&&(!u||!u.generatedType&&!u.asExpression)}).forEach(c=>{const u=this.deleteTypeormMetadataSql({table:t.name,type:Ie.GENERATED_COLUMN,name:c.name}),h=this.insertTypeormMetadataSql({table:t.name,type:Ie.GENERATED_COLUMN,name:c.name,value:c.asExpression});a.push(u),i.push(h)}),e.columns.filter(c=>c.generatedType&&c.asExpression&&!t.columns.some(u=>u.name===c.name)).forEach(c=>{const u=this.insertTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:c.name,value:c.asExpression}),h=this.deleteTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:c.name});a.push(u),i.push(h)}),e.columns.filter(c=>c.generatedType&&c.asExpression).forEach(c=>{const u=t.columns.find(v=>v.name===c.name&&v.generatedType&&c.generatedType&&v.asExpression!==c.asExpression);if(!u)return;const h=this.deleteTypeormMetadataSql({table:t.name,type:Ie.GENERATED_COLUMN,name:u.name}),d=this.insertTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:c.name,value:c.asExpression});a.push(h),a.push(d);const f=this.insertTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:u.name,value:u.asExpression}),g=this.deleteTypeormMetadataSql({table:t.name,type:Ie.GENERATED_COLUMN,name:c.name});i.push(f),i.push(g)}),await this.executeQueries(a,i),this.replaceCachedTable(t,e)}splitTablePath(e){return e.indexOf(".")!==-1?e.split("."):[void 0,e]}escapePath(e,t){return(F.isTable(e)||F.isView(e)?e.name:e).replace(/^\.+|\.+$/g,"").split(".").map(r=>t?r:`"${r}"`).join(".")}}class Ea{constructor(e){this.queryRunner=e}async broadcast(e,...t){const r=new sf,a=this[`broadcast${e}Event`];typeof a=="function"&&a.call(this,r,...t),await r.wait()}broadcastBeforeInsertEvent(e,t,r){r&&t.beforeInsertListeners.length&&t.beforeInsertListeners.forEach(a=>{if(a.isAllowed(r)){const i=a.execute(r);i instanceof Promise&&e.promises.push(i),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.beforeInsert){const i=a.beforeInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t});i instanceof Promise&&e.promises.push(i),e.count++}})}broadcastBeforeUpdateEvent(e,t,r,a,i,s){r&&t.beforeUpdateListeners.length&&t.beforeUpdateListeners.forEach(o=>{if(o.isAllowed(r)){const l=o.execute(r);l instanceof Promise&&e.promises.push(l),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(o=>{if(this.isAllowedSubscriber(o,t.target)&&o.beforeUpdate){const l=o.beforeUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,updatedColumns:i||[],updatedRelations:s||[]});l instanceof Promise&&e.promises.push(l),e.count++}})}broadcastBeforeRemoveEvent(e,t,r,a,i){r&&t.beforeRemoveListeners.length&&t.beforeRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeRemove){const o=s.beforeRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,entityId:t.getEntityIdMixedMap(a??i)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastBeforeSoftRemoveEvent(e,t,r,a,i){r&&t.beforeSoftRemoveListeners.length&&t.beforeSoftRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeSoftRemove){const o=s.beforeSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,entityId:t.getEntityIdMixedMap(a??i)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastBeforeRecoverEvent(e,t,r,a,i){r&&t.beforeRecoverListeners.length&&t.beforeRecoverListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeRecover){const o=s.beforeRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,entityId:t.getEntityIdMixedMap(a??i)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterInsertEvent(e,t,r){r&&t.afterInsertListeners.length&&t.afterInsertListeners.forEach(a=>{if(a.isAllowed(r)){const i=a.execute(r);i instanceof Promise&&e.promises.push(i),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.afterInsert){const i=a.afterInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t});i instanceof Promise&&e.promises.push(i),e.count++}})}broadcastBeforeTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionStart){const r=t.beforeTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionStart){const r=t.afterTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastBeforeTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionCommit){const r=t.beforeTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionCommit){const r=t.afterTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastBeforeTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionRollback){const r=t.beforeTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionRollback){const r=t.afterTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}})}broadcastAfterUpdateEvent(e,t,r,a,i,s){r&&t.afterUpdateListeners.length&&t.afterUpdateListeners.forEach(o=>{if(o.isAllowed(r)){const l=o.execute(r);l instanceof Promise&&e.promises.push(l),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(o=>{if(this.isAllowedSubscriber(o,t.target)&&o.afterUpdate){const l=o.afterUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,updatedColumns:i||[],updatedRelations:s||[]});l instanceof Promise&&e.promises.push(l),e.count++}})}broadcastAfterRemoveEvent(e,t,r,a,i){r&&t.afterRemoveListeners.length&&t.afterRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterRemove){const o=s.afterRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,entityId:t.getEntityIdMixedMap(a??i)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterSoftRemoveEvent(e,t,r,a,i){r&&t.afterSoftRemoveListeners.length&&t.afterSoftRemoveListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterSoftRemove){const o=s.afterSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,entityId:t.getEntityIdMixedMap(a??i)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterRecoverEvent(e,t,r,a,i){r&&t.afterRecoverListeners.length&&t.afterRecoverListeners.forEach(s=>{if(s.isAllowed(r)){const o=s.execute(r);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterRecover){const o=s.afterRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:r,metadata:t,databaseEntity:a,entityId:t.getEntityIdMixedMap(a??i)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastLoadEventsForAll(e,t,r){return this.broadcastLoadEvent(e,t,r)}broadcastLoadEvent(e,t,r){const a=this.queryRunner.connection.subscribers.filter(i=>this.isAllowedSubscriber(i,t.target)&&i.afterLoad);if(t.relations.length||t.afterLoadListeners.length||a.length){const i=r.filter(s=>!(s instanceof Promise));t.relations.length&&t.relations.forEach(s=>{i.forEach(o=>{if(s.isLazy&&!o.hasOwnProperty(s.propertyName))return;const l=s.getEntityValue(o);Ue.isObject(l)&&this.broadcastLoadEvent(e,s.inverseEntityMetadata,Array.isArray(l)?l:[l])})}),t.afterLoadListeners.length&&t.afterLoadListeners.forEach(s=>{i.forEach(o=>{if(s.isAllowed(o)){const l=s.execute(o);l instanceof Promise&&e.promises.push(l),e.count++}})}),a.forEach(s=>{i.forEach(o=>{const l=s.afterLoad(o,{entity:o,metadata:t,connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});l instanceof Promise&&e.promises.push(l),e.count++})})}}isAllowedSubscriber(e,t){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===t||e.listenTo().isPrototypeOf(t)}}class Qr{constructor(){this.records=[]}}class hO extends Zs{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new Ea(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async query(e,t,r=!1){if(this.isReleased)throw new bn;const a=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const i=+new Date;try{const s=await new Promise(async(u,h)=>{a.executeSql(e,t,d=>u(d),d=>h(d))}),o=this.driver.options.maxQueryExecutionTime,l=+new Date-i;o&&l>o&&this.driver.connection.logger.logQuerySlow(l,e,t,this);const c=new Qr;if(e.substr(0,11)==="INSERT INTO")c.raw=s.insertId;else{let u=[];for(let h=0;h<s.rows.length;h++)u.push(s.rows.item(h));c.records=u,c.raw=u}return r?c:c.raw}catch(s){throw this.driver.connection.logger.logQueryError(s,e,t,this),new Kr(e,t,s)}}async startTransaction(){throw new $("Transactions are not supported by the Cordova driver")}async commitTransaction(){throw new $("Transactions are not supported by the Cordova driver")}async rollbackTransaction(){throw new $("Transactions are not supported by the Cordova driver")}async clearDatabase(){await this.query("PRAGMA foreign_keys = OFF");try{const e=await this.query(`SELECT 'DROP VIEW "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'view'`),t=await this.query(`SELECT 'DROP TABLE "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`);await Promise.all(e.map(r=>this.query(r.query))),await Promise.all(t.map(r=>this.query(r.query)))}finally{await this.query("PRAGMA foreign_keys = ON")}}parametrize(e,t=0){return Object.keys(e).map((r,a)=>`"${r}"=?`)}}class dO extends $l{constructor(e){super(e),this.transactionSupport="none",this.database=this.options.database,this.loadDependencies()}async disconnect(){return this.queryRunner=void 0,new Promise((e,t)=>{this.databaseConnection.close(e,t)})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new hO(this)),this.queryRunner}async createDatabaseConnection(){const e=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{}),t=await new Promise(r=>{this.sqlite.openDatabase(e,a=>r(a))});return await new Promise((r,a)=>{t.executeSql("PRAGMA foreign_keys = ON",[],()=>r(),i=>a(i))}),t}loadDependencies(){try{const e=this.options.driver||window.sqlitePlugin;this.sqlite=e}catch{throw new Xs("Cordova-SQLite","cordova-sqlite-storage")}}}class pO extends Zs{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new Ea(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}query(e,t,r=!1){if(this.isReleased)throw new bn;return new Promise(async(a,i)=>{const s=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=+new Date;s.executeSql(e,t,l=>{const c=this.driver.options.maxQueryExecutionTime,u=+new Date-o;c&&u>c&&this.driver.connection.logger.logQuerySlow(u,e,t,this);const h=new Qr;if(l!=null&&l.hasOwnProperty("rowsAffected")&&(h.affected=l.rowsAffected),l==null?void 0:l.hasOwnProperty("rows")){let d=[];for(let f=0;f<l.rows.length;f++)d.push(l.rows.item(f));h.raw=d,h.records=d}e.substr(0,11)==="INSERT INTO"&&(h.raw=l.insertId),a(r?h:h.raw)},l=>{this.driver.connection.logger.logQueryError(l,e,t,this),i(new Kr(e,t,l))})})}parametrize(e,t=0){return Object.keys(e).map((r,a)=>`"${r}"=?`)}}class mO{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.supportedUpsertTypes=["on-conflict-do-update"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=this.options.database,this.loadDependencies()}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new pO(this)),this.queryRunner}async connect(){this.databaseConnection=await this.createDatabaseConnection()}afterConnect(){return Promise.resolve()}async disconnect(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close(e,t)})}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,r;return(r=(t=this.attachedDatabases)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return(t=Object.values(this.attachedDatabases).find(({attachHandle:r})=>e===r))===null||t===void 0?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new fh(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=qt.transformTo(t.transformer,e)),e==null?e:t.type===Boolean||t.type==="boolean"?e===!0?1:0:t.type==="date"?Pe.mixedDateToDateString(e):t.type==="time"?Pe.mixedDateToTimeString(e):t.type==="datetime"||t.type===Date?Pe.mixedDateToUtcDatetimeString(e):t.type==="simple-array"?Pe.simpleArrayToString(e):t.type==="simple-json"?Pe.simpleJsonToString(e):t.type==="simple-enum"?Pe.simpleEnumToString(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?qt.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?(e&&typeof e=="string"&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=Pe.normalizeHydratedDate(e)):t.type==="date"?e=Pe.mixedDateToDateString(e):t.type==="time"?e=Pe.mixedTimeToString(e):t.type==="simple-array"?e=Pe.stringToSimpleArray(e):t.type==="simple-json"?e=Pe.stringToSimpleJson(e):t.type==="simple-enum"?e=Pe.stringToSimpleEnum(e,t):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=qt.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,r){const a=Object.keys(r).map(i=>typeof r[i]=="boolean"?r[i]===!0?1:0:r[i]instanceof Date?Pe.mixedDateToUtcDatetimeString(r[i]):r[i]);return!t||!Object.keys(t).length?[e,a]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(i,s,o)=>{if(!t.hasOwnProperty(o))return i;let l=t[o];return s?l.map(c=>(a.push(c),this.createParameter(o,a.length-1))).join(", "):typeof l=="function"?l():typeof l=="number"?String(l):typeof l=="boolean"?(a.push(+l),this.createParameter(o,a.length-1)):l instanceof Date?(a.push(Pe.mixedDateToUtcDatetimeString(l)),this.createParameter(o,a.length-1)):(a.push(l),this.createParameter(o,a.length-1))}),[e,a])}escape(e){return'"'+e+'"'}buildTableName(e,t,r){return e}parseTableName(e){var t;const r=this.database,a=void 0;if(F.isTable(e)||F.isView(e)){const s=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||s.database||r,schema:e.schema||s.schema||a,tableName:s.tableName}}if(F.isTableForeignKey(e)){const s=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||s.database||r,schema:e.referencedSchema||s.schema||a,tableName:s.tableName}}if(F.isEntityMetadata(e))return{database:e.database||r,schema:e.schema||a,tableName:e.tableName};const i=e.split(".");return i.length===3?{database:i[0]||r,schema:i[1]||a,tableName:i[2]}:i.length===2?{database:(t=this.getAttachedDatabasePathRelativeByHandle(i[0]))!==null&&t!==void 0?t:r,schema:i[0],tableName:i[1]}:{database:r,schema:a,tableName:e}}normalizeType(e){return e.type===Number||e.type==="int"?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"varchar":e.type||""}normalizeDefault(e){const t=e.default;if(typeof t=="number")return""+t;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!=null)return`${t}`}normalizeIsUnique(e){return e.entityMetadata.uniques.some(t=>t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+="("+e.precision+","+e.scale+")":e.precision!==null&&e.precision!==void 0&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,r,a){const i=e.generatedColumns.reduce((s,o)=>{let l;return o.generationStrategy==="increment"&&t&&(l=t-a+r+1),l?Ee.mergeDeep(s,o.createValueMap(l)):s},{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter(r=>{const a=e.find(i=>i.name===r.databaseName);return a?a.name!==r.databaseName||a.type!==this.normalizeType(r)||a.length!==r.length||a.precision!==r.precision||a.scale!==r.scale||this.normalizeDefault(r)!==a.default||a.isPrimary!==r.isPrimary||a.isNullable!==r.isNullable||a.generatedType!==r.generatedType||a.asExpression!==r.asExpression||a.isUnique!==this.normalizeIsUnique(r)||a.enum&&r.enum&&!Ee.isArraysEqual(a.enum,r.enum.map(i=>i+""))||r.generationStrategy!=="uuid"&&a.isGenerated!==r.isGenerated:!1})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){return new Promise((e,t)=>{const r=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{});this.sqlite.openDatabase(r,a=>{const i=a;i.executeSql("PRAGMA foreign_keys = ON",[],s=>{e(i)},s=>{t(s)})},a=>{t(a)})})}loadDependencies(){try{const e=this.options.driver||require("react-native-sqlite-storage");this.sqlite=e}catch{throw new Xs("React-Native","react-native-sqlite-storage")}}}class fO extends Zs{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new Ea(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async query(e,t,r=!1){if(this.isReleased)throw new bn;const a=this.driver.connection;return new Promise(async(i,s)=>{const o=await this.connect(),l=e.substr(0,11)==="INSERT INTO";a.logger.logQuery(e,t,this);const c=(h,d)=>{const f=this.driver.options.maxQueryExecutionTime,g=+new Date-u;f&&g>f&&a.logger.logQuerySlow(g,e,t,this),h&&(a.logger.logQueryError(h,e,t,this),s(new Kr(e,t,h)));const v=new Qr;v.raw=d,!l&&Array.isArray(d)&&(v.records=d),i(r?v:v.raw)},u=+new Date;l?o.execSQL(e,t,c):o.all(e,t,c)})}parametrize(e,t=0){return Object.keys(e).map((r,a)=>`"${r}"=?`)}}class yO extends $l{constructor(e){super(e),this.connection=e,this.options=e.options,this.database=this.options.database,this.driver=this.options.driver,this.loadDependencies()}async disconnect(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close().then(e).catch(t)})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new fO(this)),this.queryRunner}normalizeType(e){return e.type===Buffer?"blob":super.normalizeType(e)}createDatabaseConnection(){return new Promise((e,t)=>{const r=Object.assign({},{readOnly:this.options.readOnly,key:this.options.key,multithreading:this.options.multithreading,migrate:this.options.migrate,iosFlags:this.options.iosFlags,androidFlags:this.options.androidFlags},this.options.extra||{});new this.sqlite(this.options.database,r,(a,i)=>{if(a)return t(a);i.resultType(this.sqlite.RESULTSASOBJECT),i.execSQL("PRAGMA foreign_keys = ON",[],(s,o)=>{if(s)return t(s);e(i)})})})}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new Xs("Nativescript","nativescript-sqlite")}}class gO extends Zs{constructor(e){super(),this.isDirty=!1,this.driver=e,this.connection=e.connection,this.broadcaster=new Ea(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async flush(){this.isDirty&&(await this.driver.autoSave(),this.isDirty=!1)}async release(){return await this.flush(),super.release()}async commitTransaction(){await super.commitTransaction(),this.isTransactionActive||await this.flush()}async query(e,t=[],r=!1){if(this.isReleased)throw new bn;const a=e.trim().split(" ",1)[0],i=this.driver.databaseConnection;this.driver.connection.logger.logQuery(e,t,this);const s=+new Date;let o;try{o=i.prepare(e),t&&(t=t.map(d=>typeof d<"u"?d:null),o.bind(t));const l=this.driver.options.maxQueryExecutionTime,c=+new Date-s;l&&c>l&&this.driver.connection.logger.logQuerySlow(c,e,t,this);const u=[];for(;o.step();)u.push(o.getAsObject());const h=new Qr;return h.affected=i.getRowsModified(),h.records=u,h.raw=u,o.free(),a!=="SELECT"&&(this.isDirty=!0),r?h:h.raw}catch(l){throw o&&o.free(),this.driver.connection.logger.logQueryError(l,e,t,this),new Kr(e,t,l)}}}class bO extends $l{constructor(e){if(super(e),this.options.autoSave&&!this.options.location&&!this.options.autoSaveCallback)throw new lM("location or autoSaveCallback");this.loadDependencies()}async connect(){this.databaseConnection=await this.createDatabaseConnection()}async disconnect(){this.queryRunner=void 0,this.databaseConnection.close()}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new gO(this)),this.queryRunner}async load(e,t=!0){if(typeof e=="string")if(ht.type==="node")if(ht.fileExist(e)){const r=ht.readFileSync(e);return this.createDatabaseConnectionWithImport(r)}else{if(t)throw new $(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}else{let r=null;if(this.options.useLocalForage)if(window.localforage)r=await window.localforage.getItem(e);else throw new $("localforage is not defined - please import localforage.js into your site");else r=ht.getGlobalVariable().localStorage.getItem(e);if(r!=null)return this.createDatabaseConnectionWithImport(JSON.parse(r));if(t)throw new $(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}else return this.createDatabaseConnectionWithImport(e)}async save(e){if(!e&&!this.options.location)throw new $("No location is set, specify a location parameter or add the location option to your configuration");let t="";if(e?t=e:this.options.location&&(t=this.options.location),ht.type==="node")try{const r=Buffer.from(this.databaseConnection.export());await ht.writeFile(t,r)}catch(r){throw new $(`Could not save database, error: ${r}`)}else{const r=this.databaseConnection.export(),a=[].slice.call(r);if(this.options.useLocalForage)if(window.localforage)await window.localforage.setItem(t,JSON.stringify(a));else throw new $("localforage is not defined - please import localforage.js into your site");else ht.getGlobalVariable().localStorage.setItem(t,JSON.stringify(a))}}async autoSave(){var e;this.options.autoSave&&!(!((e=this.queryRunner)===null||e===void 0)&&e.isTransactionActive)&&(this.options.autoSaveCallback?await this.options.autoSaveCallback(this.export()):await this.save())}export(){return this.databaseConnection.export()}createGeneratedMap(e,t){const r=e.generatedColumns.reduce((a,i)=>{if(i.isPrimary&&i.generationStrategy==="increment"){const s="SELECT last_insert_rowid()";try{let o=this.databaseConnection.exec(s);return this.connection.logger.logQuery(s),Ee.mergeDeep(a,i.createValueMap(o[0].values[0][0]))}catch(o){this.connection.logger.logQueryError(o,s,[])}}return a},{});return Object.keys(r).length>0?r:void 0}createDatabaseConnection(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)}async createDatabaseConnectionWithImport(e){const t=typeof this.sqlite.Database=="function"?this.sqlite:await this.sqlite(this.options.sqlJsConfig);return e&&e.length>0?this.databaseConnection=new t.Database(e):this.databaseConnection=new t.Database,this.databaseConnection.exec("PRAGMA foreign_keys = ON"),this.databaseConnection}loadDependencies(){if(ht.type==="browser"){const e=this.options.driver||window.SQL;this.sqlite=e}else try{const e=this.options.driver||ht.load("sql.js");this.sqlite=e}catch{throw new Xs("sql.js","sql.js")}}}class vO extends Zs{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new Ea(this)}async startTransaction(){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive&&typeof this.transaction>"u")throw new rr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive&&typeof this.transaction>"u")throw new rr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async beforeMigration(){const e=await this.connect();return new Promise((t,r)=>{e.exec([{sql:"PRAGMA foreign_keys = OFF",args:[]}],!1,a=>a?r(a):t())})}async afterMigration(){const e=await this.connect();return new Promise((t,r)=>{e.exec([{sql:"PRAGMA foreign_keys = ON",args:[]}],!1,a=>a?r(a):t())})}async query(e,t,r=!1){if(this.isReleased)throw new bn;return new Promise(async(a,i)=>{const s=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=+new Date;s.transaction(async l=>{typeof this.transaction>"u"&&(await this.startTransaction(),this.transaction=l),this.transaction.executeSql(e,t,(c,u)=>{const h=this.driver.options.maxQueryExecutionTime,d=+new Date-o;h&&d>h&&this.driver.connection.logger.logQuerySlow(d,e,t,this);const f=new Qr;if(u!=null&&u.hasOwnProperty("rowsAffected")&&(f.affected=u.rowsAffected),u==null?void 0:u.hasOwnProperty("rows")){let g=[];for(let v=0;v<u.rows.length;v++)g.push(u.rows.item(v));f.raw=g,f.records=g}e.startsWith("INSERT INTO")&&(f.raw=u.insertId),a(r?f:f.raw)},(c,u)=>{this.driver.connection.logger.logQueryError(u,e,t,this),i(new Kr(e,t,u))})},async l=>{await this.rollbackTransaction(),i(l)},()=>{this.isTransactionActive=!1,this.transaction=void 0})})}}class EO extends $l{constructor(e){super(e),this.database=this.options.database,this.sqlite=this.options.driver}async disconnect(){return new Promise((e,t)=>{try{this.queryRunner=void 0,this.databaseConnection._db.close(),this.databaseConnection=void 0,e()}catch(r){t(r)}})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new vO(this)),this.queryRunner}createDatabaseConnection(){return new Promise((e,t)=>{try{const r=this.sqlite.openDatabase(this.options.database);r.transaction(a=>{a.executeSql("PRAGMA foreign_keys = ON",[],(i,s)=>{e(r)},(i,s)=>{t({transaction:i,error:s})})},a=>{t(a)})}catch(r){t(r)}})}}class wO extends gh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.client=t,this.broadcaster=new Ea(this)}async connect(){return{}}release(){return this.isReleased=!0,this.databaseConnection&&this.databaseConnection.release(),Promise.resolve()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?await this.client.startTransaction():await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new bn;const a=await this.client.query(e,t),i=new Qr;return i.raw=a,a!=null&&a.hasOwnProperty("records")&&Array.isArray(a.records)&&(i.records=a.records),a!=null&&a.hasOwnProperty("numberOfRecordsUpdated")&&(i.affected=a.numberOfRecordsUpdated),r?i:i.raw}stream(e,t,r,a){if(this.isReleased)throw new bn;return new Promise(async(i,s)=>{try{const o=(await this.connect()).query(e,t);r&&o.on("end",r),a&&o.on("error",a),i(o)}catch(o){s(o)}})}async getDatabases(){return Promise.resolve([])}async getSchemas(e){throw new $("MySql driver does not support table schemas")}async hasDatabase(e){return!!(await this.query(`SELECT * FROM \`INFORMATION_SCHEMA\`.\`SCHEMATA\` WHERE \`SCHEMA_NAME\` = '${e}'`)).length}async getCurrentDatabase(){return(await this.query("SELECT DATABASE() AS `db_name`"))[0].db_name}async hasSchema(e){throw new $("MySql driver does not support table schemas")}async getCurrentSchema(){return(await this.query("SELECT SCHEMA() AS `schema_name`"))[0].schema_name}async hasTable(e){const t=this.driver.parseTableName(e),r=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${t.database}' AND \`TABLE_NAME\` = '${t.tableName}'`;return!!(await this.query(r)).length}async hasColumn(e,t){const r=this.driver.parseTableName(e),a=F.isTableColumn(t)?t.name:t,i=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${r.database}' AND \`TABLE_NAME\` = '${r.tableName}' AND \`COLUMN_NAME\` = '${a}'`;return!!(await this.query(i)).length}async createDatabase(e,t){const r=t?`CREATE DATABASE IF NOT EXISTS \`${e}\``:`CREATE DATABASE \`${e}\``,a=`DROP DATABASE \`${e}\``;await this.executeQueries(new x(r),new x(a))}async dropDatabase(e,t){const r=t?`DROP DATABASE IF EXISTS \`${e}\``:`DROP DATABASE \`${e}\``,a=`CREATE DATABASE \`${e}\``;await this.executeQueries(new x(r),new x(a))}async createSchema(e,t){throw new $("Schema create queries are not supported by MySql driver.")}async dropSchema(e,t){throw new $("Schema drop queries are not supported by MySql driver.")}async createTable(e,t=!1,r=!0){if(t&&await this.hasTable(e))return Promise.resolve();const a=[],i=[];return a.push(this.createTableSql(e,r)),i.push(this.dropTableSql(e)),e.indices.forEach(s=>i.push(this.dropIndexSql(e,s))),r&&e.foreignKeys.forEach(s=>i.push(this.dropForeignKeySql(e,s))),this.executeQueries(a,i)}async dropTable(e,t,r=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const a=r,i=this.getTablePath(e),s=await this.getCachedTable(i),o=[],l=[];r&&s.foreignKeys.forEach(c=>o.push(this.dropForeignKeySql(s,c))),s.indices.forEach(c=>o.push(this.dropIndexSql(s,c))),o.push(this.dropTableSql(s)),l.push(this.createTableSql(s,a)),await this.executeQueries(o,l)}async createView(e,t=!1){const r=[],a=[];r.push(this.createViewSql(e)),t&&r.push(await this.insertViewDefinitionSql(e)),a.push(this.dropViewSql(e)),t&&a.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(r,a)}async dropView(e){const t=F.isView(e)?e.name:e,r=await this.getCachedView(t),a=[],i=[];a.push(await this.deleteViewDefinitionSql(r)),a.push(this.dropViewSql(r)),i.push(await this.insertViewDefinitionSql(r)),i.push(this.createViewSql(r)),await this.executeQueries(a,i)}async renameTable(e,t){const r=[],a=[],i=F.isTable(e)?e:await this.getCachedTable(e),s=i.clone(),{database:o}=this.driver.parseTableName(i);s.name=o?`${o}.${t}`:t,r.push(new x(`RENAME TABLE ${this.escapePath(i)} TO ${this.escapePath(s)}`)),a.push(new x(`RENAME TABLE ${this.escapePath(s)} TO ${this.escapePath(i)}`)),s.indices.forEach(l=>{const c=l.columnNames.map(d=>`\`${d}\``).join(", "),u=this.connection.namingStrategy.indexName(s,l.columnNames,l.where);let h="";l.isUnique&&(h+="UNIQUE "),l.isSpatial&&(h+="SPATIAL "),l.isFulltext&&(h+="FULLTEXT "),r.push(new x(`ALTER TABLE ${this.escapePath(s)} DROP INDEX \`${l.name}\`, ADD ${h}INDEX \`${u}\` (${c})`)),a.push(new x(`ALTER TABLE ${this.escapePath(s)} DROP INDEX \`${u}\`, ADD ${h}INDEX \`${l.name}\` (${c})`)),l.name=u}),s.foreignKeys.forEach(l=>{const c=l.columnNames.map(g=>`\`${g}\``).join(", "),u=l.referencedColumnNames.map(g=>`\`${g}\``).join(","),h=this.connection.namingStrategy.foreignKeyName(s,l.columnNames);let d=`ALTER TABLE ${this.escapePath(s)} DROP FOREIGN KEY \`${l.name}\`, ADD CONSTRAINT \`${h}\` FOREIGN KEY (${c}) REFERENCES ${this.escapePath(this.getTablePath(l))}(${u})`;l.onDelete&&(d+=` ON DELETE ${l.onDelete}`),l.onUpdate&&(d+=` ON UPDATE ${l.onUpdate}`);let f=`ALTER TABLE ${this.escapePath(s)} DROP FOREIGN KEY \`${h}\`, ADD CONSTRAINT \`${l.name}\` FOREIGN KEY (${c}) REFERENCES ${this.escapePath(this.getTablePath(l))}(${u})`;l.onDelete&&(f+=` ON DELETE ${l.onDelete}`),l.onUpdate&&(f+=` ON UPDATE ${l.onUpdate}`),r.push(new x(d)),a.push(new x(f)),l.name=h}),await this.executeQueries(r,a),i.name=s.name,this.replaceCachedTable(i,s)}async addColumn(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone(),i=[],s=[],o=a.primaryColumns.length>0;if(i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(t,o,!1)}`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN \`${t.name}\``)),t.isPrimary&&o){const c=a.columns.find(d=>d.isGenerated&&d.generationStrategy==="increment");if(c){const d=c.clone();d.isGenerated=!1,d.generationStrategy=void 0,i.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(d,!0)}`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(t,!0)}`))}const u=a.primaryColumns;let h=u.map(d=>`\`${d.name}\``).join(", ");if(i.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${h})`)),u.push(t),h=u.map(d=>`\`${d.name}\``).join(", "),i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${h})`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),c){const d=c.clone();d.isGenerated=!1,d.generationStrategy=void 0,i.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(t,!0)}`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(d,!0)}`))}}const l=a.indices.find(c=>c.columnNames.length===1&&c.columnNames[0]===t.name);if(l)i.push(this.createIndexSql(r,l)),s.push(this.dropIndexSql(r,l));else if(t.isUnique){const c=new Ct({name:this.connection.namingStrategy.indexName(r,[t.name]),columnNames:[t.name],isUnique:!0});a.indices.push(c),a.uniques.push(new cn({name:c.name,columnNames:c.columnNames})),i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD UNIQUE INDEX \`${c.name}\` (\`${t.name}\`)`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${c.name}\``))}await this.executeQueries(i,s),a.addColumn(t),this.replaceCachedTable(r,a)}async addColumns(e,t){for(const r of t)await this.addColumn(e,r)}async renameColumn(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e),i=F.isTableColumn(t)?t:a.columns.find(o=>o.name===t);if(!i)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);let s;F.isTableColumn(r)?s=r:(s=i.clone(),s.name=r),await this.changeColumn(a,i,s)}async changeColumn(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e);let i=a.clone();const s=[],o=[],l=F.isTableColumn(t)?t:a.columns.find(c=>c.name===t);if(!l)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);if(r.isGenerated!==l.isGenerated&&r.generationStrategy!=="uuid"||l.type!==r.type||l.length!==r.length||l.generatedType!==r.generatedType)await this.dropColumn(a,l),await this.addColumn(a,r),i=a.clone();else{if(r.name!==l.name){s.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${l.name}\` \`${r.name}\` ${this.buildCreateColumnSql(l,!0,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${r.name}\` \`${l.name}\` ${this.buildCreateColumnSql(l,!0,!0)}`)),i.findColumnIndices(l).forEach(u=>{u.columnNames.splice(u.columnNames.indexOf(l.name),1),u.columnNames.push(r.name);const h=u.columnNames.map(g=>`\`${g}\``).join(", "),d=this.connection.namingStrategy.indexName(i,u.columnNames,u.where);let f="";u.isUnique&&(f+="UNIQUE "),u.isSpatial&&(f+="SPATIAL "),u.isFulltext&&(f+="FULLTEXT "),s.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${u.name}\`, ADD ${f}INDEX \`${d}\` (${h})`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${d}\`, ADD ${f}INDEX \`${u.name}\` (${h})`)),u.name=d}),i.findColumnForeignKeys(l).forEach(u=>{u.columnNames.splice(u.columnNames.indexOf(l.name),1),u.columnNames.push(r.name);const h=u.columnNames.map(C=>`\`${C}\``).join(", "),d=u.referencedColumnNames.map(C=>`\`${C}\``).join(","),f=this.connection.namingStrategy.foreignKeyName(i,u.columnNames);let g=`ALTER TABLE ${this.escapePath(a)} DROP FOREIGN KEY \`${u.name}\`, ADD CONSTRAINT \`${f}\` FOREIGN KEY (${h}) REFERENCES ${this.escapePath(this.getTablePath(u))}(${d})`;u.onDelete&&(g+=` ON DELETE ${u.onDelete}`),u.onUpdate&&(g+=` ON UPDATE ${u.onUpdate}`);let v=`ALTER TABLE ${this.escapePath(a)} DROP FOREIGN KEY \`${f}\`, ADD CONSTRAINT \`${u.name}\` FOREIGN KEY (${h}) REFERENCES ${this.escapePath(this.getTablePath(u))}(${d})`;u.onDelete&&(v+=` ON DELETE ${u.onDelete}`),u.onUpdate&&(v+=` ON UPDATE ${u.onUpdate}`),s.push(new x(g)),o.push(new x(v)),u.name=f});const c=i.columns.find(u=>u.name===l.name);i.columns[i.columns.indexOf(c)].name=r.name,l.name=r.name}if(this.isColumnChanged(l,r,!0)&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${l.name}\` ${this.buildCreateColumnSql(r,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${r.name}\` ${this.buildCreateColumnSql(l,!0)}`))),r.isPrimary!==l.isPrimary){const c=i.columns.find(h=>h.isGenerated&&h.generationStrategy==="increment");if(c){const h=c.clone();h.isGenerated=!1,h.generationStrategy=void 0,s.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(h,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(c,!0)}`))}const u=i.primaryColumns;if(u.length>0){const h=u.map(d=>`\`${d.name}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP PRIMARY KEY`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD PRIMARY KEY (${h})`))}if(r.isPrimary===!0){u.push(r);const h=i.columns.find(f=>f.name===r.name);h.isPrimary=!0;const d=u.map(f=>`\`${f.name}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD PRIMARY KEY (${d})`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP PRIMARY KEY`))}else{const h=u.find(f=>f.name===r.name);u.splice(u.indexOf(h),1);const d=i.columns.find(f=>f.name===r.name);if(d.isPrimary=!1,u.length>0){const f=u.map(g=>`\`${g.name}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD PRIMARY KEY (${f})`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP PRIMARY KEY`))}}if(c){const h=c.clone();h.isGenerated=!1,h.generationStrategy=void 0,s.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(c,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(h,!0)}`))}}if(r.isUnique!==l.isUnique)if(r.isUnique===!0){const c=new Ct({name:this.connection.namingStrategy.indexName(a,[r.name]),columnNames:[r.name],isUnique:!0});i.indices.push(c),i.uniques.push(new cn({name:c.name,columnNames:c.columnNames})),s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD UNIQUE INDEX \`${c.name}\` (\`${r.name}\`)`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${c.name}\``))}else{const c=i.indices.find(h=>h.columnNames.length===1&&h.isUnique===!0&&!!h.columnNames.find(d=>d===r.name));i.indices.splice(i.indices.indexOf(c),1);const u=i.uniques.find(h=>h.name===c.name);i.uniques.splice(i.uniques.indexOf(u),1),s.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${c.name}\``)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD UNIQUE INDEX \`${c.name}\` (\`${r.name}\`)`))}}await this.executeQueries(s,o),this.replaceCachedTable(a,i)}async changeColumns(e,t){for(const{oldColumn:r,newColumn:a}of t)await this.changeColumn(e,r,a)}async dropColumn(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableColumn(t)?t:r.findColumnByName(t);if(!a)throw new $(`Column "${t}" was not found in table "${r.name}"`);const i=r.clone(),s=[],o=[];if(a.isPrimary){const c=i.columns.find(d=>d.isGenerated&&d.generationStrategy==="increment");if(c){const d=c.clone();d.isGenerated=!1,d.generationStrategy=void 0,s.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(d,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(c,!0)}`))}const u=i.primaryColumns.map(d=>`\`${d.name}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`)),o.push(new x(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${u})`));const h=i.findColumnByName(a.name);if(h.isPrimary=!1,i.primaryColumns.length>0){const d=i.primaryColumns.map(f=>`\`${f.name}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${d})`)),o.push(new x(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`))}if(c&&c.name!==a.name){const d=c.clone();d.isGenerated=!1,d.generationStrategy=void 0,s.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(c,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(d,!0)}`))}}const l=i.indices.find(c=>c.columnNames.length===1&&c.columnNames[0]===a.name);if(l)i.indices.splice(i.indices.indexOf(l),1),s.push(this.dropIndexSql(r,l)),o.push(this.createIndexSql(r,l));else if(a.isUnique){const c=this.connection.namingStrategy.uniqueConstraintName(r,[a.name]),u=i.uniques.find(f=>f.name===c);u&&i.uniques.splice(i.uniques.indexOf(u),1);const h=this.connection.namingStrategy.indexName(r,[a.name]),d=i.indices.find(f=>f.name===h);d&&i.indices.splice(i.indices.indexOf(d),1),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${h}\``)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD UNIQUE INDEX \`${h}\` (\`${a.name}\`)`))}s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN \`${a.name}\``)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(a,!0)}`)),await this.executeQueries(s,o),i.removeColumn(a),this.replaceCachedTable(r,i)}async dropColumns(e,t){for(const r of t)await this.dropColumn(e,r)}async createPrimaryKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone(),i=this.createPrimaryKeySql(r,t),s=this.dropPrimaryKeySql(r);await this.executeQueries(i,s),a.columns.forEach(o=>{t.find(l=>l===o.name)&&(o.isPrimary=!0)}),this.replaceCachedTable(r,a)}async updatePrimaryKeys(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone(),i=t.map(d=>d.name),s=[],o=[],l=a.columns.find(d=>d.isGenerated&&d.generationStrategy==="increment");if(l){const d=l.clone();d.isGenerated=!1,d.generationStrategy=void 0,s.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${l.name}\` ${this.buildCreateColumnSql(d,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(l,!0)}`))}const c=a.primaryColumns;if(c.length>0){const d=c.map(f=>`\`${f.name}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${d})`))}a.columns.filter(d=>i.indexOf(d.name)!==-1).forEach(d=>d.isPrimary=!0);const u=i.map(d=>`\`${d}\``).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${u})`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`));const h=l||t.find(d=>d.isGenerated&&d.generationStrategy==="increment");if(h){const d=h.clone();d.isGenerated=!1,d.generationStrategy=void 0,s.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${d.name}\` ${this.buildCreateColumnSql(h,!0)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(d,!0)}`));const f=a.columns.find(g=>g.name===h.name);f.isGenerated=!0,f.generationStrategy="increment"}await this.executeQueries(s,o),this.replaceCachedTable(r,a)}async dropPrimaryKey(e){const t=F.isTable(e)?e:await this.getCachedTable(e),r=this.dropPrimaryKeySql(t),a=this.createPrimaryKeySql(t,t.primaryColumns.map(i=>i.name));await this.executeQueries(r,a),t.primaryColumns.forEach(i=>{i.isPrimary=!1})}async createUniqueConstraint(e,t){throw new $("MySql does not support unique constraints. Use unique index instead.")}async createUniqueConstraints(e,t){throw new $("MySql does not support unique constraints. Use unique index instead.")}async dropUniqueConstraint(e,t){throw new $("MySql does not support unique constraints. Use unique index instead.")}async dropUniqueConstraints(e,t){throw new $("MySql does not support unique constraints. Use unique index instead.")}async createCheckConstraint(e,t){throw new $("MySql does not support check constraints.")}async createCheckConstraints(e,t){throw new $("MySql does not support check constraints.")}async dropCheckConstraint(e,t){throw new $("MySql does not support check constraints.")}async dropCheckConstraints(e,t){throw new $("MySql does not support check constraints.")}async createExclusionConstraint(e,t){throw new $("MySql does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new $("MySql does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new $("MySql does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new $("MySql does not support exclusion constraints.")}async createForeignKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames));const a=this.createForeignKeySql(r,t),i=this.dropForeignKeySql(r,t);await this.executeQueries(a,i),r.addForeignKey(t)}async createForeignKeys(e,t){const r=t.map(a=>this.createForeignKey(e,a));await Promise.all(r)}async dropForeignKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableForeignKey(t)?t:r.foreignKeys.find(o=>o.name===t);if(!a)throw new $(`Supplied foreign key was not found in table ${r.name}`);const i=this.dropForeignKeySql(r,a),s=this.createForeignKeySql(r,a);await this.executeQueries(i,s),r.removeForeignKey(a)}async dropForeignKeys(e,t){const r=t.map(a=>this.dropForeignKey(e,a));await Promise.all(r)}async createIndex(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const a=this.createIndexSql(r,t),i=this.dropIndexSql(r,t);await this.executeQueries(a,i),r.addIndex(t,!0)}async createIndices(e,t){const r=t.map(a=>this.createIndex(e,a));await Promise.all(r)}async dropIndex(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!a)throw new $(`Supplied index ${t} was not found in table ${r.name}`);a.name||(a.name=this.generateIndexName(r,a));const i=this.dropIndexSql(r,a),s=this.createIndexSql(r,a);await this.executeQueries(i,s),r.removeIndex(a,!0)}async dropIndices(e,t){const r=t.map(a=>this.dropIndex(e,a));await Promise.all(r)}async clearTable(e){await this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)}async clearDatabase(e){const t=e||this.driver.database;if(t){if(!await this.hasDatabase(t))return Promise.resolve()}else throw new $("Can not clear database. No database is specified");const r=this.isTransactionActive;r||await this.startTransaction();try{const a=`SELECT concat('DROP VIEW IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`VIEWS\` WHERE \`TABLE_SCHEMA\` = '${t}'`,i=await this.query(a);await Promise.all(i.map(u=>this.query(u.query)));const s="SET FOREIGN_KEY_CHECKS = 0;",o=`SELECT concat('DROP TABLE IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_SCHEMA\` = '${t}'`,l="SET FOREIGN_KEY_CHECKS = 1;";await this.query(s);const c=await this.query(o);await Promise.all(c.map(u=>this.query(u.query))),await this.query(l),r||await this.commitTransaction()}catch(a){try{r||await this.rollbackTransaction()}catch{}throw a}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const t=await this.getCurrentDatabase(),r=e.map(i=>{let{database:s,tableName:o}=this.driver.parseTableName(i);return s||(s=t),`(\`t\`.\`schema\` = '${s}' AND \`t\`.\`name\` = '${o}')`}).join(" OR "),a=`SELECT \`t\`.*, \`v\`.\`check_option\` FROM ${this.escapePath(this.getTypeormMetadataTableName())} \`t\` INNER JOIN \`information_schema\`.\`views\` \`v\` ON \`v\`.\`table_schema\` = \`t\`.\`schema\` AND \`v\`.\`table_name\` = \`t\`.\`name\` WHERE \`t\`.\`type\` = '${Ie.VIEW}' ${r?`AND (${r})`:""}`;return(await this.query(a)).map(i=>{const s=new va,o=i.schema===t?void 0:i.schema;return s.database=i.schema,s.name=this.driver.buildTableName(i.name,void 0,o),s.expression=i.value,s})}async loadTables(e){if(e&&e.length===0)return[];const t=[],r=await this.getCurrentDatabase();if(!e)t.push(...await this.query("SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES`"));else{const v="SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES` WHERE "+e.map(C=>{let[w,T]=C.split(".");return T||(T=w,w=this.driver.database||r),`(\`TABLE_SCHEMA\` = '${w}' AND \`TABLE_NAME\` = '${T}')`}).join(" OR ");t.push(...await this.query(v))}if(t.length===0)return[];const a=t.map(({TABLE_NAME:v,TABLE_SCHEMA:C})=>`(\`TABLE_SCHEMA\` = '${C}' AND \`TABLE_NAME\` = '${v}')`).join(" OR "),i="SELECT * FROM `INFORMATION_SCHEMA`.`COLUMNS` WHERE "+a,s=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` WHERE \`CONSTRAINT_NAME\` = 'PRIMARY' AND (${a})`,o="SELECT `SCHEMA_NAME`, `DEFAULT_CHARACTER_SET_NAME` as `CHARSET`, `DEFAULT_COLLATION_NAME` AS `COLLATION` FROM `INFORMATION_SCHEMA`.`SCHEMATA`",l=`SELECT \`s\`.* FROM \`INFORMATION_SCHEMA\`.\`STATISTICS\` \`s\` LEFT JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`rc\` ON \`s\`.\`INDEX_NAME\` = \`rc\`.\`CONSTRAINT_NAME\` WHERE (${t.map(({TABLE_NAME:v,TABLE_SCHEMA:C})=>`(\`s\`.\`TABLE_SCHEMA\` = '${C}' AND \`s\`.\`TABLE_NAME\` = '${v}')`).join(" OR ")}) AND \`s\`.\`INDEX_NAME\` != 'PRIMARY' AND \`rc\`.\`CONSTRAINT_NAME\` IS NULL`,c="SELECT `kcu`.`TABLE_SCHEMA`, `kcu`.`TABLE_NAME`, `kcu`.`CONSTRAINT_NAME`, `kcu`.`COLUMN_NAME`, `kcu`.`REFERENCED_TABLE_SCHEMA`, `kcu`.`REFERENCED_TABLE_NAME`, `kcu`.`REFERENCED_COLUMN_NAME`, `rc`.`DELETE_RULE` `ON_DELETE`, `rc`.`UPDATE_RULE` `ON_UPDATE` FROM `INFORMATION_SCHEMA`.`KEY_COLUMN_USAGE` `kcu` INNER JOIN `INFORMATION_SCHEMA`.`REFERENTIAL_CONSTRAINTS` `rc` ON `rc`.`constraint_name` = `kcu`.`constraint_name` WHERE "+t.map(({TABLE_NAME:v,TABLE_SCHEMA:C})=>`(\`kcu\`.\`TABLE_SCHEMA\` = '${C}' AND \`kcu\`.\`TABLE_NAME\` = '${v}')`).join(" OR "),[u,h,d,f,g]=await Promise.all([this.query(i),this.query(s),this.query(o),this.query(l),this.query(c)]);return Promise.all(t.map(async v=>{const C=new _t,w=d.find(D=>D.SCHEMA_NAME===v.TABLE_SCHEMA),T=w.COLLATION,S=w.CHARSET,O=v.TABLE_SCHEMA===r?void 0:v.TABLE_SCHEMA;C.database=v.TABLE_SCHEMA,C.name=this.driver.buildTableName(v.TABLE_NAME,void 0,O),C.columns=u.filter(D=>D.TABLE_NAME===v.TABLE_NAME&&D.TABLE_SCHEMA===v.TABLE_SCHEMA).map(D=>{const V=f.filter(H=>H.TABLE_NAME===v.TABLE_NAME&&H.TABLE_SCHEMA===v.TABLE_SCHEMA&&H.COLUMN_NAME===D.COLUMN_NAME&&parseInt(H.NON_UNIQUE,10)===0),q=this.connection.entityMetadatas.find(H=>this.getTablePath(C)===this.getTablePath(H)),K=V.length>0&&q&&q.indices.some(H=>V.some(se=>H.name===se.INDEX_NAME&&H.synchronize===!1)),I=V.every(H=>f.some(se=>se.INDEX_NAME===H.INDEX_NAME&&se.COLUMN_NAME!==D.COLUMN_NAME)),G=new Sn;if(G.name=D.COLUMN_NAME,G.type=D.DATA_TYPE.toLowerCase(),G.unsigned=G.zerofill?!0:D.COLUMN_TYPE.indexOf("unsigned")!==-1,this.driver.withWidthColumnTypes.indexOf(G.type)!==-1){const H=D.COLUMN_TYPE.substring(D.COLUMN_TYPE.indexOf("(")+1,D.COLUMN_TYPE.indexOf(")"));G.width=H&&!this.isDefaultColumnWidth(C,G,parseInt(H))?parseInt(H):void 0}if(D.COLUMN_DEFAULT===null||D.COLUMN_DEFAULT===void 0?G.default=void 0:G.default=D.COLUMN_DEFAULT==="CURRENT_TIMESTAMP"?D.COLUMN_DEFAULT:`'${D.COLUMN_DEFAULT}'`,D.EXTRA.indexOf("on update")!==-1&&(G.onUpdate=D.EXTRA.substring(D.EXTRA.indexOf("on update")+10)),D.GENERATION_EXPRESSION&&(G.asExpression=D.GENERATION_EXPRESSION,G.generatedType=D.EXTRA.indexOf("VIRTUAL")!==-1?"VIRTUAL":"STORED"),G.isUnique=V.length>0&&!K&&!I,G.isNullable=D.IS_NULLABLE==="YES",G.isPrimary=h.some(H=>H.TABLE_NAME===D.TABLE_NAME&&H.TABLE_SCHEMA===D.TABLE_SCHEMA&&H.COLUMN_NAME===D.COLUMN_NAME),G.zerofill=D.COLUMN_TYPE.indexOf("zerofill")!==-1,G.isGenerated=D.EXTRA.indexOf("auto_increment")!==-1,G.isGenerated&&(G.generationStrategy="increment"),G.comment=typeof D.COLUMN_COMMENT=="string"&&D.COLUMN_COMMENT.length===0?void 0:D.COLUMN_COMMENT,D.CHARACTER_SET_NAME&&(G.charset=D.CHARACTER_SET_NAME===S?void 0:D.CHARACTER_SET_NAME),D.COLLATION_NAME&&(G.collation=D.COLLATION_NAME===T?void 0:D.COLLATION_NAME),this.driver.withLengthColumnTypes.indexOf(G.type)!==-1&&D.CHARACTER_MAXIMUM_LENGTH){const H=D.CHARACTER_MAXIMUM_LENGTH.toString();G.length=this.isDefaultColumnLength(C,G,H)?"":H}if((G.type==="decimal"||G.type==="double"||G.type==="float")&&(D.NUMERIC_PRECISION!==null&&!this.isDefaultColumnPrecision(C,G,D.NUMERIC_PRECISION)&&(G.precision=parseInt(D.NUMERIC_PRECISION)),D.NUMERIC_SCALE!==null&&!this.isDefaultColumnScale(C,G,D.NUMERIC_SCALE)&&(G.scale=parseInt(D.NUMERIC_SCALE))),G.type==="enum"||G.type==="simple-enum"||G.type==="set"){const H=D.COLUMN_TYPE,se=H.substring(H.indexOf("(")+1,H.lastIndexOf(")")).split(",");G.enum=se.map(re=>re.substring(1,re.length-1)),G.length=""}return(G.type==="datetime"||G.type==="time"||G.type==="timestamp")&&D.DATETIME_PRECISION!==null&&D.DATETIME_PRECISION!==void 0&&!this.isDefaultColumnPrecision(C,G,parseInt(D.DATETIME_PRECISION))&&(G.precision=parseInt(D.DATETIME_PRECISION)),G});const k=Ee.uniq(g.filter(D=>D.TABLE_NAME===v.TABLE_NAME&&D.TABLE_SCHEMA===v.TABLE_SCHEMA),D=>D.CONSTRAINT_NAME);C.foreignKeys=k.map(D=>{const V=g.filter(I=>I.CONSTRAINT_NAME===D.CONSTRAINT_NAME),q=D.REFERENCED_TABLE_SCHEMA===r?void 0:D.REFERENCED_TABLE_SCHEMA,K=this.driver.buildTableName(D.REFERENCED_TABLE_NAME,void 0,q);return new ar({name:D.CONSTRAINT_NAME,columnNames:V.map(I=>I.COLUMN_NAME),referencedDatabase:D.REFERENCED_TABLE_SCHEMA,referencedTableName:K,referencedColumnNames:V.map(I=>I.REFERENCED_COLUMN_NAME),onDelete:D.ON_DELETE,onUpdate:D.ON_UPDATE})});const B=Ee.uniq(f.filter(D=>D.TABLE_NAME===v.TABLE_NAME&&D.TABLE_SCHEMA===v.TABLE_SCHEMA),D=>D.INDEX_NAME);return C.indices=B.map(D=>{const V=f.filter(K=>K.TABLE_SCHEMA===D.TABLE_SCHEMA&&K.TABLE_NAME===D.TABLE_NAME&&K.INDEX_NAME===D.INDEX_NAME),q=parseInt(D.NON_UNIQUE,10);return new Ct({table:C,name:D.INDEX_NAME,columnNames:V.map(K=>K.COLUMN_NAME),isUnique:q===0,isSpatial:D.INDEX_TYPE==="SPATIAL",isFulltext:D.INDEX_TYPE==="FULLTEXT"})}),C}))}createTableSql(e,t){const r=e.columns.map(i=>this.buildCreateColumnSql(i,!0)).join(", ");let a=`CREATE TABLE ${this.escapePath(e)} (${r}`;if(e.columns.filter(i=>i.isUnique).forEach(i=>{const s=e.indices.some(l=>l.columnNames.length===1&&!!l.isUnique&&l.columnNames.indexOf(i.name)!==-1),o=e.uniques.some(l=>l.columnNames.length===1&&l.columnNames.indexOf(i.name)!==-1);!s&&!o&&e.indices.push(new Ct({name:this.connection.namingStrategy.uniqueConstraintName(e,[i.name]),columnNames:[i.name],isUnique:!0}))}),e.uniques.length>0&&e.uniques.forEach(i=>{e.indices.some(s=>s.name===i.name)||e.indices.push(new Ct({name:i.name,columnNames:i.columnNames,isUnique:!0}))}),e.indices.length>0){const i=e.indices.map(s=>{const o=s.columnNames.map(c=>`\`${c}\``).join(", ");s.name||(s.name=this.connection.namingStrategy.indexName(e,s.columnNames,s.where));let l="";return s.isUnique&&(l+="UNIQUE "),s.isSpatial&&(l+="SPATIAL "),s.isFulltext&&(l+="FULLTEXT "),`${l}INDEX \`${s.name}\` (${o})`}).join(", ");a+=`, ${i}`}if(e.foreignKeys.length>0&&t){const i=e.foreignKeys.map(s=>{const o=s.columnNames.map(u=>`\`${u}\``).join(", ");s.name||(s.name=this.connection.namingStrategy.foreignKeyName(e,s.columnNames));const l=s.referencedColumnNames.map(u=>`\`${u}\``).join(", ");let c=`CONSTRAINT \`${s.name}\` FOREIGN KEY (${o}) REFERENCES ${this.escapePath(this.getTablePath(s))} (${l})`;return s.onDelete&&(c+=` ON DELETE ${s.onDelete}`),s.onUpdate&&(c+=` ON UPDATE ${s.onUpdate}`),c}).join(", ");a+=`, ${i}`}if(e.primaryColumns.length>0){const i=e.primaryColumns.map(s=>`\`${s.name}\``).join(", ");a+=`, PRIMARY KEY (${i})`}return a+=`) ENGINE=${e.engine||"InnoDB"}`,new x(a)}dropTableSql(e){return new x(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){return typeof e.expression=="string"?new x(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression}`):new x(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression(this.connection).getQuery()}`)}async insertViewDefinitionSql(e){const t=await this.getCurrentDatabase(),r=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:Ie.VIEW,schema:t,name:e.name,value:r})}dropViewSql(e){return new x(`DROP VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){const t=await this.getCurrentDatabase(),r=F.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:Ie.VIEW,schema:t,name:r})}createIndexSql(e,t){const r=t.columnNames.map(i=>`\`${i}\``).join(", ");let a="";return t.isUnique&&(a+="UNIQUE "),t.isSpatial&&(a+="SPATIAL "),t.isFulltext&&(a+="FULLTEXT "),new x(`CREATE ${a}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${r})`)}dropIndexSql(e,t){let r=F.isTableIndex(t)?t.name:t;return new x(`DROP INDEX \`${r}\` ON ${this.escapePath(e)}`)}createPrimaryKeySql(e,t){const r=t.map(a=>`\`${a}\``).join(", ");return new x(`ALTER TABLE ${this.escapePath(e)} ADD PRIMARY KEY (${r})`)}dropPrimaryKeySql(e){return new x(`ALTER TABLE ${this.escapePath(e)} DROP PRIMARY KEY`)}createForeignKeySql(e,t){const r=t.columnNames.map(s=>`\`${s}\``).join(", "),a=t.referencedColumnNames.map(s=>`\`${s}\``).join(",");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${r}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${a})`;return t.onDelete&&(i+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(i+=` ON UPDATE ${t.onUpdate}`),new x(i)}dropForeignKeySql(e,t){const r=F.isTableForeignKey(t)?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP FOREIGN KEY \`${r}\``)}escapeComment(e){return!e||e.length===0?"''":(e=e.replace(/\\/g,"\\\\").replace(/'/g,"''").replace(/\u0000/g,""),`'${e}'`)}escapePath(e){const{database:t,tableName:r}=this.driver.parseTableName(e);return t&&t!==this.driver.database?`\`${t}\`.\`${r}\``:`\`${r}\``}buildCreateColumnSql(e,t,r=!1){let a="";return r?a=this.connection.driver.createFullType(e):a=`\`${e.name}\` ${this.connection.driver.createFullType(e)}`,e.asExpression&&(a+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`),e.zerofill?a+=" ZEROFILL":e.unsigned&&(a+=" UNSIGNED"),e.enum&&(a+=` (${e.enum.map(i=>"'"+i+"'").join(", ")})`),e.charset&&(a+=` CHARACTER SET "${e.charset}"`),e.collation&&(a+=` COLLATE "${e.collation}"`),e.isNullable||(a+=" NOT NULL"),e.isNullable&&(a+=" NULL"),e.isPrimary&&!t&&(a+=" PRIMARY KEY"),e.isGenerated&&e.generationStrategy==="increment"&&(a+=" AUTO_INCREMENT"),e.comment&&(a+=` COMMENT ${this.escapeComment(e.comment)}`),e.default!==void 0&&e.default!==null&&(a+=` DEFAULT ${e.default}`),e.onUpdate&&(a+=` ON UPDATE ${e.onUpdate}`),a}isDefaultColumnWidth(e,t,r){if(this.connection.hasMetadata(e.name)){const i=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(i&&i.width)return!1}const a=this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].width;if(a){const i=["int","tinyint","smallint","mediumint"].indexOf(t.type)!==-1;return t.unsigned&&i?a-1===r:a===r}return!1}}class TO{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["bit","int","integer","tinyint","smallint","mediumint","bigint","float","double","double precision","real","decimal","dec","numeric","fixed","bool","boolean","date","datetime","timestamp","time","year","char","nchar","national char","varchar","nvarchar","national varchar","blob","text","tinyblob","tinytext","mediumblob","mediumtext","longblob","longtext","enum","set","binary","varbinary","json","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.supportedUpsertTypes=["on-duplicate-key-update"],this.spatialTypes=["geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.withLengthColumnTypes=["char","varchar","nvarchar","binary","varbinary"],this.withWidthColumnTypes=["bit","tinyint","smallint","mediumint","int","integer","bigint"],this.withPrecisionColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real","time","datetime","timestamp"],this.withScaleColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real"],this.unsignedAndZerofillTypes=["int","integer","smallint","tinyint","mediumint","bigint","decimal","dec","numeric","fixed","float","double","double precision","real"],this.mappedDataTypes={createDate:"datetime",createDatePrecision:6,createDateDefault:"CURRENT_TIMESTAMP(6)",updateDate:"datetime",updateDatePrecision:6,updateDateDefault:"CURRENT_TIMESTAMP(6)",deleteDate:"datetime",deleteDatePrecision:6,deleteDateNullable:!0,version:"int",treeLevel:"int",migrationId:"int",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.dataTypeDefaults={varchar:{length:255},nvarchar:{length:255},"national varchar":{length:255},char:{length:1},binary:{length:1},varbinary:{length:255},decimal:{precision:10,scale:0},dec:{precision:10,scale:0},numeric:{precision:10,scale:0},fixed:{precision:10,scale:0},float:{precision:12},double:{precision:22},time:{precision:0},datetime:{precision:0},timestamp:{precision:0},bit:{width:1},int:{width:11},integer:{width:11},tinyint:{width:4},smallint:{width:6},mediumint:{width:9},bigint:{width:20}},this.maxAliasLength=63,this.cteCapabilities={enabled:!1},this.connection=e,this.options=e.options,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions),this.database=pe.buildDriverOptions(this.options).database}async connect(){if(!this.database){const e=await this.createQueryRunner("master");this.database=await e.getCurrentDatabase(),await e.release()}}afterConnect(){return Promise.resolve()}async disconnect(){}createSchemaBuilder(){return new fh(this.connection)}createQueryRunner(e){return new wO(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions))}escapeQueryWithParameters(e,t,r){const a=Object.keys(r).map(i=>r[i]);return!t||!Object.keys(t).length?[e,a]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(i,s,o)=>{if(!t.hasOwnProperty(o))return i;let l=t[o];return s?l.map(c=>(a.push(c),this.createParameter(o,a.length-1))).join(", "):typeof l=="function"?l():(a.push(l),this.createParameter(o,a.length-1))}),[e,a])}escape(e){return"`"+e+"`"}buildTableName(e,t,r){let a=[e];return r&&a.unshift(r),a.join(".")}parseTableName(e){const t=this.database,r=void 0;if(F.isTable(e)||F.isView(e)){const i=this.parseTableName(e.name);return{database:e.database||i.database||t,schema:e.schema||i.schema||r,tableName:i.tableName}}if(F.isTableForeignKey(e)){const i=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||i.database||t,schema:e.referencedSchema||i.schema||r,tableName:i.tableName}}if(F.isEntityMetadata(e))return{database:e.database||t,schema:e.schema||r,tableName:e.tableName};const a=e.split(".");return{database:(a.length>1?a[0]:void 0)||t,schema:r,tableName:a.length>1?a[1]:a[0]}}preparePersistentValue(e,t){return t.transformer&&(e=qt.transformTo(t.transformer,e)),!this.options.formatOptions||this.options.formatOptions.castParameters!==!1?this.client.preparePersistentValue(e,t):e==null?e:t.type===Boolean?e===!0?1:0:t.type==="date"?Pe.mixedDateToDateString(e):t.type==="time"?Pe.mixedDateToTimeString(e):t.type==="json"?JSON.stringify(e):t.type==="timestamp"||t.type==="datetime"||t.type===Date?Pe.mixedDateToDate(e):t.type==="simple-array"||t.type==="set"?Pe.simpleArrayToString(e):t.type==="simple-json"?Pe.simpleJsonToString(e):t.type==="enum"||t.type==="simple-enum"?""+e:e}prepareHydratedValue(e,t){return e==null?t.transformer?qt.transformFrom(t.transformer,e):e:!this.options.formatOptions||this.options.formatOptions.castParameters!==!1?this.client.prepareHydratedValue(e,t):(t.type===Boolean||t.type==="bool"||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?e=Pe.normalizeHydratedDate(e):t.type==="date"?e=Pe.mixedDateToDateString(e):t.type==="json"?e=typeof e=="string"?JSON.parse(e):e:t.type==="time"?e=Pe.mixedTimeToString(e):t.type==="simple-array"||t.type==="set"?e=Pe.stringToSimpleArray(e):t.type==="simple-json"?e=Pe.stringToSimpleJson(e):(t.type==="enum"||t.type==="simple-enum")&&t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0?e=parseInt(e):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=qt.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number||e.type==="integer"?"int":e.type===String?"varchar":e.type===Date?"datetime":e.type===Buffer?"blob":e.type===Boolean?"tinyint":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"enum":e.type==="double precision"||e.type==="real"?"double":e.type==="dec"||e.type==="numeric"||e.type==="fixed"?"decimal":e.type==="bool"||e.type==="boolean"?"tinyint":e.type==="nvarchar"||e.type==="national varchar"?"varchar":e.type==="nchar"||e.type==="national char"?"char":e.type||""}normalizeDefault(e){const t=e.default;if(t!==null){if((e.type==="enum"||e.type==="simple-enum")&&t!==void 0)return`'${t}'`;if(e.type==="set"&&t!==void 0)return`'${Pe.simpleArrayToString(t)}'`;if(typeof t=="number")return`${t}`;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!==void 0)return`${t}`}}normalizeIsUnique(e){return e.entityMetadata.indices.some(t=>t.isUnique&&t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){if(e.length)return e.length.toString();if(e.generationStrategy==="uuid")return"36";switch(e.type){case String:case"varchar":case"nvarchar":case"national varchar":return"255";case"varbinary":return"255";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+=`(${e.precision},${e.scale})`:e.precision!==null&&e.precision!==void 0&&(t+=`(${e.precision})`),e.isArray&&(t+=" array"),t}obtainMasterConnection(){return new Promise((e,t)=>{this.poolCluster?this.poolCluster.getConnection("MASTER",(r,a)=>{r?t(r):e(this.prepareDbConnection(a))}):this.pool?this.pool.getConnection((r,a)=>{r?t(r):e(this.prepareDbConnection(a))}):t(new $("Connection is not established with mysql database"))})}obtainSlaveConnection(){return this.poolCluster?new Promise((e,t)=>{this.poolCluster.getConnection("SLAVE*",(r,a)=>{r?t(r):e(this.prepareDbConnection(a))})}):this.obtainMasterConnection()}createGeneratedMap(e,t,r){const a=e.generatedColumns.reduce((i,s)=>{let o;return s.generationStrategy==="increment"&&t.insertId&&(o=t.insertId+r),Ee.mergeDeep(i,s.createValueMap(o))},{});return Object.keys(a).length>0?a:void 0}findChangedColumns(e,t){return t.filter(r=>{const a=e.find(s=>s.name===r.databaseName);if(!a)return!1;let i=r.length;return!i&&r.generationStrategy==="uuid"&&(i=this.getColumnLength(r)),a.name!==r.databaseName||a.type!==this.normalizeType(r)||a.length!==i||a.width!==r.width||a.precision!==r.precision||a.scale!==r.scale||a.zerofill!==r.zerofill||a.unsigned!==r.unsigned||a.asExpression!==r.asExpression||a.generatedType!==r.generatedType||a.comment!==this.escapeComment(r.comment)||!this.compareDefaultValues(this.normalizeDefault(r),a.default)||a.enum&&r.enum&&!Ee.isArraysEqual(a.enum,r.enum.map(s=>s+""))||a.onUpdate!==r.onUpdate||a.isPrimary!==r.isPrimary||a.isNullable!==r.isNullable||a.isUnique!==this.normalizeIsUnique(r)||r.generationStrategy!=="uuid"&&a.isGenerated!==r.isGenerated})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!0}createParameter(e,t){return"?"}loadDependencies(){const e=this.options.driver||ht.load("typeorm-aurora-data-api-driver");this.DataApiDriver=e,this.DataApiDriver=this.DataApiDriver.default||this.DataApiDriver}createConnectionOptions(e,t){return t=Object.assign({},t,pe.buildDriverOptions(t)),Object.assign({},{resourceArn:e.resourceArn,secretArn:e.secretArn,database:e.database,region:e.region,type:e.type},{host:t.host,user:t.username,password:t.password,database:t.database,port:t.port,ssl:e.ssl},e.extra||{})}async createPool(e){return{}}prepareDbConnection(e){const{logger:t}=this.connection;return e.listeners("error").length===0&&e.on("error",r=>t.log("warn",`MySQL connection raised an error. ${r}`)),e}compareDefaultValues(e,t){return typeof e=="string"&&typeof t=="string"&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}escapeComment(e){return e&&(e=e.replace(/\u0000/g,""),e)}}class NO extends gh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new Ea(this)}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:(this.mode==="slave"&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const r=a=>this.releasePostgresConnection(a);return this.releaseCallback=a=>{this.databaseConnection.removeListener("error",r),t(a)},this.databaseConnection.on("error",r),this.databaseConnection}):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const r=a=>this.releasePostgresConnection(a);return this.releaseCallback=a=>{this.databaseConnection.removeListener("error",r),t(a)},this.databaseConnection.on("error",r),this.databaseConnection}),this.databaseConnectionPromise)}async releasePostgresConnection(e){if(this.isReleased)return;this.isReleased=!0,this.releaseCallback&&(this.releaseCallback(e),this.releaseCallback=void 0);const t=this.driver.connectedQueryRunners.indexOf(this);t!==-1&&this.driver.connectedQueryRunners.splice(t,1)}release(){return this.releasePostgresConnection()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?(await this.query("START TRANSACTION"),e&&await this.query("SET TRANSACTION ISOLATION LEVEL "+e)):await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new bn;const a=await this.connect();this.driver.connection.logger.logQuery(e,t,this);try{const i=+new Date,s=await a.query(e,t),o=this.driver.options.maxQueryExecutionTime,l=+new Date-i;o&&l>o&&this.driver.connection.logger.logQuerySlow(l,e,t,this);const c=new Qr;if(s){switch(s.hasOwnProperty("rows")&&(c.records=s.rows),s.hasOwnProperty("rowCount")&&(c.affected=s.rowCount),s.command){case"DELETE":case"UPDATE":c.raw=[s.rows,s.rowCount];break;default:c.raw=s.rows}if(!r)return c.raw}return c}catch(i){throw this.driver.connection.logger.logQueryError(i,e,t,this),new Kr(e,t,i)}}async stream(e,t,r,a){const i=this.driver.loadStreamDependency();if(this.isReleased)throw new bn;const s=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=s.query(new i(e,t));return r&&o.on("end",r),a&&o.on("error",a),o}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){return!!(await this.query(`SELECT * FROM pg_database WHERE datname='${e}';`)).length}async getCurrentDatabase(){return(await this.query("SELECT * FROM current_database()"))[0].current_database}async hasSchema(e){return!!(await this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length}async getCurrentSchema(){return(await this.query("SELECT * FROM current_schema()"))[0].current_schema}async hasTable(e){const t=this.driver.parseTableName(e);t.schema||(t.schema=await this.getCurrentSchema());const r=`SELECT * FROM "information_schema"."tables" WHERE "table_schema" = '${t.schema}' AND "table_name" = '${t.tableName}'`;return!!(await this.query(r)).length}async hasColumn(e,t){const r=this.driver.parseTableName(e);r.schema||(r.schema=await this.getCurrentSchema());const a=`SELECT * FROM "information_schema"."columns" WHERE "table_schema" = '${r.schema}' AND "table_name" = '${r.tableName}' AND "column_name" = '${t}'`;return!!(await this.query(a)).length}async createDatabase(e,t){if(t&&await this.hasDatabase(e))return Promise.resolve();const r=`CREATE DATABASE "${e}"`,a=`DROP DATABASE "${e}"`;await this.executeQueries(new x(r),new x(a))}async dropDatabase(e,t){const r=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,a=`CREATE DATABASE "${e}"`;await this.executeQueries(new x(r),new x(a))}async createSchema(e,t){const r=e.indexOf(".")===-1?e:e.split(".")[1],a=t?`CREATE SCHEMA IF NOT EXISTS "${r}"`:`CREATE SCHEMA "${r}"`,i=`DROP SCHEMA "${r}" CASCADE`;await this.executeQueries(new x(a),new x(i))}async dropSchema(e,t,r){const a=e.indexOf(".")===-1?e:e.split(".")[1],i=t?`DROP SCHEMA IF EXISTS "${a}" ${r?"CASCADE":""}`:`DROP SCHEMA "${a}" ${r?"CASCADE":""}`,s=`CREATE SCHEMA "${a}"`;await this.executeQueries(new x(i),new x(s))}async createTable(e,t=!1,r=!0,a=!0){if(t&&await this.hasTable(e))return Promise.resolve();const i=[],s=[],o=e.columns.filter(u=>u.type==="enum"||u.type==="simple-enum"),l=[];for(const u of o){const h=await this.hasEnumType(e,u),d=this.buildEnumName(e,u);!h&&l.indexOf(d)===-1&&(l.push(d),i.push(this.createEnumTypeSql(e,u,d)),s.push(this.dropEnumTypeSql(e,u,d)))}const c=e.columns.filter(u=>u.generatedType==="STORED"&&u.asExpression);for(const u of c){const h=(await this.getTableNameWithSchema(e.name)).split("."),d=h[1],f=h[0],g=this.insertTypeormMetadataSql({database:this.driver.database,schema:f,table:d,type:Ie.GENERATED_COLUMN,name:u.name,value:u.asExpression}),v=this.deleteTypeormMetadataSql({database:this.driver.database,schema:f,table:d,type:Ie.GENERATED_COLUMN,name:u.name});i.push(g),s.push(v)}i.push(this.createTableSql(e,r)),s.push(this.dropTableSql(e)),r&&e.foreignKeys.forEach(u=>s.push(this.dropForeignKeySql(e,u))),a&&e.indices.forEach(u=>{u.name||(u.name=this.connection.namingStrategy.indexName(e,u.columnNames,u.where)),i.push(this.createIndexSql(e,u)),s.push(this.dropIndexSql(e,u))}),await this.executeQueries(i,s)}async dropTable(e,t,r=!0,a=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const i=r,s=this.getTablePath(e),o=await this.getCachedTable(s),l=[],c=[];a&&o.indices.forEach(h=>{l.push(this.dropIndexSql(o,h)),c.push(this.createIndexSql(o,h))}),r&&o.foreignKeys.forEach(h=>l.push(this.dropForeignKeySql(o,h))),l.push(this.dropTableSql(o)),c.push(this.createTableSql(o,i));const u=o.columns.filter(h=>h.generatedType&&h.asExpression);for(const h of u){const d=(await this.getTableNameWithSchema(o.name)).split("."),f=d[1],g=d[0],v=this.deleteTypeormMetadataSql({database:this.driver.database,schema:g,table:f,type:Ie.GENERATED_COLUMN,name:h.name}),C=this.insertTypeormMetadataSql({database:this.driver.database,schema:g,table:f,type:Ie.GENERATED_COLUMN,name:h.name,value:h.asExpression});l.push(v),c.push(C)}await this.executeQueries(l,c)}async createView(e,t=!1){const r=[],a=[];r.push(this.createViewSql(e)),t&&r.push(await this.insertViewDefinitionSql(e)),a.push(this.dropViewSql(e)),t&&a.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(r,a)}async dropView(e){const t=F.isView(e)?e.name:e,r=await this.getCachedView(t),a=[],i=[];a.push(await this.deleteViewDefinitionSql(r)),a.push(this.dropViewSql(r)),i.push(await this.insertViewDefinitionSql(r)),i.push(this.createViewSql(r)),await this.executeQueries(a,i)}async renameTable(e,t){const r=[],a=[],i=F.isTable(e)?e:await this.getCachedTable(e),s=i.clone(),{schema:o,tableName:l}=this.driver.parseTableName(i);if(s.name=o?`${o}.${t}`:t,r.push(new x(`ALTER TABLE ${this.escapePath(i)} RENAME TO "${t}"`)),a.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME TO "${l}"`)),s.primaryColumns.length>0&&!s.primaryColumns[0].primaryKeyConstraintName){const u=s.primaryColumns.map(f=>f.name),h=this.connection.namingStrategy.primaryKeyName(i,u),d=this.connection.namingStrategy.primaryKeyName(s,u);r.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${h}" TO "${d}"`)),a.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${d}" TO "${h}"`))}s.columns.map(u=>{if(u.isGenerated&&u.generationStrategy==="increment"){const h=this.buildSequencePath(i,u.name),d=this.buildSequenceName(i,u.name),f=this.buildSequencePath(s,u.name),g=this.buildSequenceName(s,u.name),v=`ALTER SEQUENCE ${this.escapePath(h)} RENAME TO "${g}"`,C=`ALTER SEQUENCE ${this.escapePath(f)} RENAME TO "${d}"`;r.push(new x(v)),a.push(new x(C))}}),s.uniques.forEach(u=>{const h=this.connection.namingStrategy.uniqueConstraintName(i,u.columnNames);if(u.name!==h)return;const d=this.connection.namingStrategy.uniqueConstraintName(s,u.columnNames);r.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${u.name}" TO "${d}"`)),a.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${d}" TO "${u.name}"`)),u.name=d}),s.indices.forEach(u=>{const h=this.connection.namingStrategy.indexName(i,u.columnNames,u.where);if(u.name!==h)return;const{schema:d}=this.driver.parseTableName(s),f=this.connection.namingStrategy.indexName(s,u.columnNames,u.where),g=d?`ALTER INDEX "${d}"."${u.name}" RENAME TO "${f}"`:`ALTER INDEX "${u.name}" RENAME TO "${f}"`,v=d?`ALTER INDEX "${d}"."${f}" RENAME TO "${u.name}"`:`ALTER INDEX "${f}" RENAME TO "${u.name}"`;r.push(new x(g)),a.push(new x(v)),u.name=f}),s.foreignKeys.forEach(u=>{const h=this.connection.namingStrategy.foreignKeyName(i,u.columnNames,this.getTablePath(u),u.referencedColumnNames);if(u.name!==h)return;const d=this.connection.namingStrategy.foreignKeyName(s,u.columnNames,this.getTablePath(u),u.referencedColumnNames);r.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${u.name}" TO "${d}"`)),a.push(new x(`ALTER TABLE ${this.escapePath(s)} RENAME CONSTRAINT "${d}" TO "${u.name}"`)),u.name=d});const c=s.columns.filter(u=>u.type==="enum"||u.type==="simple-enum");for(let u of c){if(u.enumName)continue;const h=await this.getUserDefinedTypeName(i,u);r.push(new x(`ALTER TYPE "${h.schema}"."${h.name}" RENAME TO ${this.buildEnumName(s,u,!1)}`)),a.push(new x(`ALTER TYPE ${this.buildEnumName(s,u)} RENAME TO "${h.name}"`))}await this.executeQueries(r,a)}async addColumn(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=r.clone(),i=[],s=[];if((t.type==="enum"||t.type==="simple-enum")&&(await this.hasEnumType(r,t)||(i.push(this.createEnumTypeSql(r,t)),s.push(this.dropEnumTypeSql(r,t)))),i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(r,t)}`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN "${t.name}"`)),t.isPrimary){const l=a.primaryColumns;if(l.length>0){const h=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,l.map(f=>f.name)),d=l.map(f=>`"${f.name}"`).join(", ");i.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${h}"`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${h}" PRIMARY KEY (${d})`))}l.push(t);const c=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(a,l.map(h=>h.name)),u=l.map(h=>`"${h.name}"`).join(", ");i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${c}" PRIMARY KEY (${u})`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${c}"`))}const o=a.indices.find(l=>l.columnNames.length===1&&l.columnNames[0]===t.name);if(o&&(i.push(this.createIndexSql(r,o)),s.push(this.dropIndexSql(r,o))),t.isUnique){const l=new cn({name:this.connection.namingStrategy.uniqueConstraintName(r,[t.name]),columnNames:[t.name]});a.uniques.push(l),i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${l.name}" UNIQUE ("${t.name}")`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${l.name}"`))}if(t.generatedType==="STORED"&&t.asExpression){const l=(await this.getTableNameWithSchema(r.name)).split("."),c=l[1],u=l[0],h=this.insertTypeormMetadataSql({database:this.driver.database,schema:u,table:c,type:Ie.GENERATED_COLUMN,name:t.name,value:t.asExpression}),d=this.deleteTypeormMetadataSql({database:this.driver.database,schema:u,table:c,type:Ie.GENERATED_COLUMN,name:t.name});i.push(h),s.push(d)}t.comment&&(i.push(new x(`COMMENT ON COLUMN ${this.escapePath(r)}."${t.name}" IS ${this.escapeComment(t.comment)}`)),s.push(new x(`COMMENT ON COLUMN ${this.escapePath(r)}."${t.name}" IS ${this.escapeComment(t.comment)}`))),await this.executeQueries(i,s),a.addColumn(t),this.replaceCachedTable(r,a)}async addColumns(e,t){for(const r of t)await this.addColumn(e,r)}async renameColumn(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e),i=F.isTableColumn(t)?t:a.columns.find(o=>o.name===t);if(!i)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);let s;return F.isTableColumn(r)?s=r:(s=i.clone(),s.name=r),this.changeColumn(a,i,s)}async changeColumn(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e);let i=a.clone();const s=[],o=[];let l=!1;const c=F.isTableColumn(t)?t:a.columns.find(u=>u.name===t);if(!c)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);if(c.type!==r.type||c.length!==r.length||r.isArray!==c.isArray||!c.generatedType&&r.generatedType==="STORED"||c.asExpression!==r.asExpression&&r.generatedType==="STORED")await this.dropColumn(a,c),await this.addColumn(a,r),i=a.clone();else{if(c.name!==r.name){if(s.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME COLUMN "${c.name}" TO "${r.name}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME COLUMN "${r.name}" TO "${c.name}"`)),c.type==="enum"||c.type==="simple-enum"){const h=await this.getUserDefinedTypeName(a,c);s.push(new x(`ALTER TYPE "${h.schema}"."${h.name}" RENAME TO ${this.buildEnumName(a,r,!1)}`)),o.push(new x(`ALTER TYPE ${this.buildEnumName(a,r)} RENAME TO "${h.name}"`))}if(c.isPrimary===!0&&!c.primaryKeyConstraintName){const h=i.primaryColumns.map(g=>g.name),d=this.connection.namingStrategy.primaryKeyName(i,h);h.splice(h.indexOf(c.name),1),h.push(r.name);const f=this.connection.namingStrategy.primaryKeyName(i,h);s.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${d}" TO "${f}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${f}" TO "${d}"`))}if(c.isGenerated===!0&&r.generationStrategy==="increment"){const h=this.buildSequencePath(a,c.name),d=this.buildSequenceName(a,c.name),f=this.buildSequencePath(a,r.name),g=this.buildSequenceName(a,r.name),v=`ALTER SEQUENCE ${this.escapePath(h)} RENAME TO "${g}"`,C=`ALTER SEQUENCE ${this.escapePath(f)} RENAME TO "${d}"`;s.push(new x(v)),o.push(new x(C))}i.findColumnUniques(c).forEach(h=>{const d=this.connection.namingStrategy.uniqueConstraintName(i,h.columnNames);if(h.name!==d)return;h.columnNames.splice(h.columnNames.indexOf(c.name),1),h.columnNames.push(r.name);const f=this.connection.namingStrategy.uniqueConstraintName(i,h.columnNames);s.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${h.name}" TO "${f}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${f}" TO "${h.name}"`)),h.name=f}),i.findColumnIndices(c).forEach(h=>{const d=this.connection.namingStrategy.indexName(i,h.columnNames,h.where);if(h.name!==d)return;h.columnNames.splice(h.columnNames.indexOf(c.name),1),h.columnNames.push(r.name);const{schema:f}=this.driver.parseTableName(a),g=this.connection.namingStrategy.indexName(i,h.columnNames,h.where),v=f?`ALTER INDEX "${f}"."${h.name}" RENAME TO "${g}"`:`ALTER INDEX "${h.name}" RENAME TO "${g}"`,C=f?`ALTER INDEX "${f}"."${g}" RENAME TO "${h.name}"`:`ALTER INDEX "${g}" RENAME TO "${h.name}"`;s.push(new x(v)),o.push(new x(C)),h.name=g}),i.findColumnForeignKeys(c).forEach(h=>{const d=this.connection.namingStrategy.foreignKeyName(i,h.columnNames,this.getTablePath(h),h.referencedColumnNames);if(h.name!==d)return;h.columnNames.splice(h.columnNames.indexOf(c.name),1),h.columnNames.push(r.name);const f=this.connection.namingStrategy.foreignKeyName(i,h.columnNames,this.getTablePath(h),h.referencedColumnNames);s.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${h.name}" TO "${f}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${f}" TO "${h.name}"`)),h.name=f});const u=i.columns.find(h=>h.name===c.name);i.columns[i.columns.indexOf(u)].name=r.name,c.name=r.name}if((r.precision!==c.precision||r.scale!==c.scale)&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(r)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(c)}`))),(r.type==="enum"||r.type==="simple-enum")&&(c.type==="enum"||c.type==="simple-enum")&&(!Ee.isArraysEqual(r.enum,c.enum)||r.enumName!==c.enumName)){const u=r.isArray?"[]":"",h=this.buildEnumName(a,r),d=this.buildEnumName(a,c),f=this.buildEnumName(a,c,!1),g=this.buildEnumName(a,c,!0,!1,!0),v=this.buildEnumName(a,c,!1,!1,!0);s.push(new x(`ALTER TYPE ${d} RENAME TO ${v}`)),o.push(new x(`ALTER TYPE ${g} RENAME TO ${f}`)),s.push(this.createEnumTypeSql(a,r,h)),o.push(this.dropEnumTypeSql(a,r,h)),c.default!==null&&c.default!==void 0&&(l=!0,s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" DROP DEFAULT`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" SET DEFAULT ${c.default}`)));const C=`${h}${u} USING "${r.name}"::"text"::${h}${u}`,w=`${g}${u} USING "${r.name}"::"text"::${g}${u}`;s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${C}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${w}`)),r.default!==null&&r.default!==void 0&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT ${r.default}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`))),s.push(this.dropEnumTypeSql(a,c,g)),o.push(this.createEnumTypeSql(a,c,g))}if(c.isNullable!==r.isNullable&&(r.isNullable?(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" DROP NOT NULL`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" SET NOT NULL`))):(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" SET NOT NULL`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" DROP NOT NULL`)))),c.comment!==r.comment&&(s.push(new x(`COMMENT ON COLUMN ${this.escapePath(a)}."${c.name}" IS ${this.escapeComment(r.comment)}`)),o.push(new x(`COMMENT ON COLUMN ${this.escapePath(a)}."${r.name}" IS ${this.escapeComment(c.comment)}`))),r.isPrimary!==c.isPrimary){const u=i.primaryColumns;if(u.length>0){const h=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,u.map(f=>f.name)),d=u.map(f=>`"${f.name}"`).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${h}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${h}" PRIMARY KEY (${d})`))}if(r.isPrimary===!0){u.push(r);const h=i.columns.find(g=>g.name===r.name);h.isPrimary=!0;const d=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,u.map(g=>g.name)),f=u.map(g=>`"${g.name}"`).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${d}" PRIMARY KEY (${f})`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${d}"`))}else{const h=u.find(f=>f.name===r.name);u.splice(u.indexOf(h),1);const d=i.columns.find(f=>f.name===r.name);if(d.isPrimary=!1,u.length>0){const f=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,u.map(v=>v.name)),g=u.map(v=>`"${v.name}"`).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${f}" PRIMARY KEY (${g})`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${f}"`))}}}if(r.isUnique!==c.isUnique)if(r.isUnique===!0){const u=new cn({name:this.connection.namingStrategy.uniqueConstraintName(a,[r.name]),columnNames:[r.name]});i.uniques.push(u),s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${u.name}" UNIQUE ("${r.name}")`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${u.name}"`))}else{const u=i.uniques.find(h=>h.columnNames.length===1&&!!h.columnNames.find(d=>d===r.name));i.uniques.splice(i.uniques.indexOf(u),1),s.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${u.name}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${u.name}" UNIQUE ("${r.name}")`))}if(c.isGenerated!==r.isGenerated&&(c.isGenerated&&(c.generationStrategy==="uuid"?(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" DROP DEFAULT`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${c.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):c.generationStrategy==="increment"&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(a,r))}')`)),s.push(new x(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(a,r))}`)),o.push(new x(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(a,r))} OWNED BY ${this.escapePath(a)}."${r.name}"`)))),r.generationStrategy==="uuid"?r.isGenerated===!0?(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT ${this.driver.uuidGenerator}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`))):(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):r.generationStrategy==="increment"&&(r.isGenerated===!0?(s.push(new x(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(a,r))} OWNED BY ${this.escapePath(a)}."${r.name}"`)),o.push(new x(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(a,r))}`)),s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(a,r))}')`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`))):(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(a,r))}')`)),s.push(new x(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(a,r))}`)),o.push(new x(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(a,r))} OWNED BY ${this.escapePath(a)}."${r.name}"`))))),r.default!==c.default&&!l&&(r.default!==null&&r.default!==void 0?(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT ${r.default}`)),c.default!==null&&c.default!==void 0?o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT ${c.default}`)):o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`))):c.default!==null&&c.default!==void 0&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" DROP DEFAULT`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" SET DEFAULT ${c.default}`)))),((r.spatialFeatureType||"").toLowerCase()!==(c.spatialFeatureType||"").toLowerCase()||r.srid!==c.srid)&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(r)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(c)}`))),r.generatedType!==c.generatedType&&(!r.generatedType||r.generatedType==="VIRTUAL")){const u=(await this.getTableNameWithSchema(a.name)).split("."),h=u[1],d=u[0];s.push(new x(`ALTER TABLE ${this.escapePath(a)} RENAME COLUMN "${c.name}" TO "TEMP_OLD_${c.name}"`)),s.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD ${this.buildCreateColumnSql(a,r)}`)),s.push(new x(`UPDATE ${this.escapePath(a)} SET "${r.name}" = "TEMP_OLD_${c.name}"`)),s.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP COLUMN "TEMP_OLD_${c.name}"`)),s.push(this.deleteTypeormMetadataSql({database:this.driver.database,schema:d,table:h,type:Ie.GENERATED_COLUMN,name:c.name})),o.push(this.insertTypeormMetadataSql({database:this.driver.database,schema:d,table:h,type:Ie.GENERATED_COLUMN,name:c.name,value:c.asExpression})),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD ${this.buildCreateColumnSql(a,c)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP COLUMN "${r.name}"`))}}await this.executeQueries(s,o),this.replaceCachedTable(a,i)}async changeColumns(e,t){for(const{oldColumn:r,newColumn:a}of t)await this.changeColumn(e,r,a)}async dropColumn(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableColumn(t)?t:r.findColumnByName(t);if(!a)throw new $(`Column "${t}" was not found in table "${r.name}"`);const i=r.clone(),s=[],o=[];if(a.isPrimary){const h=a.primaryKeyConstraintName?a.primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,i.primaryColumns.map(g=>g.name)),d=i.primaryColumns.map(g=>`"${g.name}"`).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${h}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${h}" PRIMARY KEY (${d})`));const f=i.findColumnByName(a.name);if(f.isPrimary=!1,i.primaryColumns.length>0){const g=i.primaryColumns[0].primaryKeyConstraintName?i.primaryColumns[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,i.primaryColumns.map(C=>C.name)),v=i.primaryColumns.map(C=>`"${C.name}"`).join(", ");s.push(new x(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${g}" PRIMARY KEY (${v})`)),o.push(new x(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${g}"`))}}const l=i.indices.find(h=>h.columnNames.length===1&&h.columnNames[0]===a.name);l&&(i.indices.splice(i.indices.indexOf(l),1),s.push(this.dropIndexSql(r,l)),o.push(this.createIndexSql(r,l)));const c=i.checks.find(h=>!!h.columnNames&&h.columnNames.length===1&&h.columnNames[0]===a.name);c&&(i.checks.splice(i.checks.indexOf(c),1),s.push(this.dropCheckConstraintSql(r,c)),o.push(this.createCheckConstraintSql(r,c)));const u=i.uniques.find(h=>h.columnNames.length===1&&h.columnNames[0]===a.name);if(u&&(i.uniques.splice(i.uniques.indexOf(u),1),s.push(this.dropUniqueConstraintSql(r,u)),o.push(this.createUniqueConstraintSql(r,u))),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN "${a.name}"`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(r,a)}`)),(a.type==="enum"||a.type==="simple-enum")&&await this.hasEnumType(r,a)){const h=await this.getUserDefinedTypeName(r,a),d=`"${h.schema}"."${h.name}"`;s.push(this.dropEnumTypeSql(r,a,d)),o.push(this.createEnumTypeSql(r,a,d))}if(a.generatedType==="STORED"){const h=(await this.getTableNameWithSchema(r.name)).split("."),d=h[1],f=h[0],g=this.deleteTypeormMetadataSql({database:this.driver.database,schema:f,table:d,type:Ie.GENERATED_COLUMN,name:a.name}),v=this.insertTypeormMetadataSql({database:this.driver.database,schema:f,table:d,type:Ie.GENERATED_COLUMN,name:a.name,value:a.asExpression});s.push(g),o.push(v)}await this.executeQueries(s,o),i.removeColumn(a),this.replaceCachedTable(r,i)}async dropColumns(e,t){for(const r of t)await this.dropColumn(e,r)}async createPrimaryKey(e,t,r){const a=F.isTable(e)?e:await this.getCachedTable(e),i=a.clone(),s=this.createPrimaryKeySql(a,t,r);i.columns.forEach(l=>{t.find(c=>c===l.name)&&(l.isPrimary=!0)});const o=this.dropPrimaryKeySql(i);await this.executeQueries(s,o),this.replaceCachedTable(a,i)}async updatePrimaryKeys(e,t){var r;const a=F.isTable(e)?e:await this.getCachedTable(e),i=a.clone(),s=t.map(d=>d.name),o=[],l=[],c=i.primaryColumns;if(c.length>0){const d=c[0].primaryKeyConstraintName?c[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,c.map(g=>g.name)),f=c.map(g=>`"${g.name}"`).join(", ");o.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${d}"`)),l.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${d}" PRIMARY KEY (${f})`))}i.columns.filter(d=>s.indexOf(d.name)!==-1).forEach(d=>d.isPrimary=!0);const u=!((r=c[0])===null||r===void 0)&&r.primaryKeyConstraintName?c[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,s),h=s.map(d=>`"${d}"`).join(", ");o.push(new x(`ALTER TABLE ${this.escapePath(a)} ADD CONSTRAINT "${u}" PRIMARY KEY (${h})`)),l.push(new x(`ALTER TABLE ${this.escapePath(a)} DROP CONSTRAINT "${u}"`)),await this.executeQueries(o,l),this.replaceCachedTable(a,i)}async dropPrimaryKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=this.dropPrimaryKeySql(r),i=this.createPrimaryKeySql(r,r.primaryColumns.map(s=>s.name),t);await this.executeQueries(a,i),r.primaryColumns.forEach(s=>{s.isPrimary=!1})}async createUniqueConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(r,t.columnNames));const a=this.createUniqueConstraintSql(r,t),i=this.dropUniqueConstraintSql(r,t);await this.executeQueries(a,i),r.addUniqueConstraint(t)}async createUniqueConstraints(e,t){for(const r of t)await this.createUniqueConstraint(e,r)}async dropUniqueConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableUnique(t)?t:r.uniques.find(o=>o.name===t);if(!a)throw new $(`Supplied unique constraint was not found in table ${r.name}`);const i=this.dropUniqueConstraintSql(r,a),s=this.createUniqueConstraintSql(r,a);await this.executeQueries(i,s),r.removeUniqueConstraint(a)}async dropUniqueConstraints(e,t){for(const r of t)await this.dropUniqueConstraint(e,r)}async createCheckConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r,t.expression));const a=this.createCheckConstraintSql(r,t),i=this.dropCheckConstraintSql(r,t);await this.executeQueries(a,i),r.addCheckConstraint(t)}async createCheckConstraints(e,t){const r=t.map(a=>this.createCheckConstraint(e,a));await Promise.all(r)}async dropCheckConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableCheck(t)?t:r.checks.find(o=>o.name===t);if(!a)throw new $(`Supplied check constraint was not found in table ${r.name}`);const i=this.dropCheckConstraintSql(r,a),s=this.createCheckConstraintSql(r,a);await this.executeQueries(i,s),r.removeCheckConstraint(a)}async dropCheckConstraints(e,t){const r=t.map(a=>this.dropCheckConstraint(e,a));await Promise.all(r)}async createExclusionConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.exclusionConstraintName(r,t.expression));const a=this.createExclusionConstraintSql(r,t),i=this.dropExclusionConstraintSql(r,t);await this.executeQueries(a,i),r.addExclusionConstraint(t)}async createExclusionConstraints(e,t){const r=t.map(a=>this.createExclusionConstraint(e,a));await Promise.all(r)}async dropExclusionConstraint(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableExclusion(t)?t:r.exclusions.find(o=>o.name===t);if(!a)throw new $(`Supplied exclusion constraint was not found in table ${r.name}`);const i=this.dropExclusionConstraintSql(r,a),s=this.createExclusionConstraintSql(r,a);await this.executeQueries(i,s),r.removeExclusionConstraint(a)}async dropExclusionConstraints(e,t){const r=t.map(a=>this.dropExclusionConstraint(e,a));await Promise.all(r)}async createForeignKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const a=this.createForeignKeySql(r,t),i=this.dropForeignKeySql(r,t);await this.executeQueries(a,i),r.addForeignKey(t)}async createForeignKeys(e,t){for(const r of t)await this.createForeignKey(e,r)}async dropForeignKey(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableForeignKey(t)?t:r.foreignKeys.find(o=>o.name===t);if(!a)throw new $(`Supplied foreign key was not found in table ${r.name}`);a.name||(a.name=this.connection.namingStrategy.foreignKeyName(r,a.columnNames,this.getTablePath(a),a.referencedColumnNames));const i=this.dropForeignKeySql(r,a),s=this.createForeignKeySql(r,a);await this.executeQueries(i,s),r.removeForeignKey(a)}async dropForeignKeys(e,t){for(const r of t)await this.dropForeignKey(e,r)}async createIndex(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const a=this.createIndexSql(r,t),i=this.dropIndexSql(r,t);await this.executeQueries(a,i),r.addIndex(t)}async createViewIndex(e,t){const r=F.isView(e)?e:await this.getCachedView(e);t.name||(t.name=this.generateIndexName(r,t));const a=this.createViewIndexSql(r,t),i=this.dropIndexSql(r,t);await this.executeQueries(a,i),r.addIndex(t)}async createIndices(e,t){for(const r of t)await this.createIndex(e,r)}async createViewIndices(e,t){for(const r of t)await this.createViewIndex(e,r)}async dropIndex(e,t){const r=F.isTable(e)?e:await this.getCachedTable(e),a=F.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!a)throw new $(`Supplied index ${t} was not found in table ${r.name}`);a.name||(a.name=this.generateIndexName(r,a));const i=this.dropIndexSql(r,a),s=this.createIndexSql(r,a);await this.executeQueries(i,s),r.removeIndex(a)}async dropViewIndex(e,t){const r=F.isView(e)?e:await this.getCachedView(e),a=F.isTableIndex(t)?t:r.indices.find(o=>o.name===t);if(!a)throw new $(`Supplied index ${t} was not found in view ${r.name}`);a.name||(a.name=this.generateIndexName(r,a));const i=this.dropIndexSql(r,a),s=this.createViewIndexSql(r,a);await this.executeQueries(i,s),r.removeIndex(a)}async dropIndices(e,t){for(const r of t)await this.dropIndex(e,r)}async clearTable(e){await this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)}async clearDatabase(){const e=[];this.connection.entityMetadatas.filter(a=>a.schema).forEach(a=>{e.find(i=>i===a.schema)||e.push(a.schema)}),e.push(this.driver.options.schema||"current_schema()");const t=e.map(a=>a==="current_schema()"?a:"'"+a+"'").join(", "),r=this.isTransactionActive;r||await this.startTransaction();try{const a=await this.getVersion(),i=`SELECT 'DROP VIEW IF EXISTS "' || schemaname || '"."' || viewname || '" CASCADE;' as "query" FROM "pg_views" WHERE "schemaname" IN (${t}) AND "viewname" NOT IN ('geography_columns', 'geometry_columns', 'raster_columns', 'raster_overviews')`,s=await this.query(i);if(await Promise.all(s.map(c=>this.query(c.query))),bw.isGreaterOrEqual(a,"9.3")){const c=`SELECT 'DROP MATERIALIZED VIEW IF EXISTS "' || schemaname || '"."' || matviewname || '" CASCADE;' as "query" FROM "pg_matviews" WHERE "schemaname" IN (${t})`,u=await this.query(c);await Promise.all(u.map(h=>this.query(h.query)))}const o=`SELECT 'DROP TABLE IF EXISTS "' || schemaname || '"."' || tablename || '" CASCADE;' as "query" FROM "pg_tables" WHERE "schemaname" IN (${t}) AND "tablename" NOT IN ('spatial_ref_sys')`,l=await this.query(o);await Promise.all(l.map(c=>this.query(c.query))),await this.dropEnumTypes(t),r||await this.commitTransaction()}catch(a){try{r||await this.rollbackTransaction()}catch{}throw a}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const t=await this.getCurrentDatabase(),r=await this.getCurrentSchema(),a=e.length===0?"1=1":e.map(c=>this.driver.parseTableName(c)).map(({schema:c,tableName:u})=>(c||(c=this.driver.options.schema||r),`("t"."schema" = '${c}' AND "t"."name" = '${u}')`)).join(" OR "),i=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('m') AND "cnst"."contype" IS NULL AND (${e.length===0?"1=1":e.map(c=>this.driver.parseTableName(c)).map(({schema:c,tableName:u})=>(c||(c=this.driver.options.schema||r),`("ns"."nspname" = '${c}' AND "t"."relname" = '${u}')`)).join(" OR ")})`,s=`SELECT "t".* FROM ${this.escapePath(this.getTypeormMetadataTableName())} "t" INNER JOIN "pg_catalog"."pg_class" "c" ON "c"."relname" = "t"."name" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "c"."relnamespace" AND "n"."nspname" = "t"."schema" WHERE "t"."type" IN ('${Ie.VIEW}', '${Ie.MATERIALIZED_VIEW}') ${a?`AND (${a})`:""}`,o=await this.query(s),l=await this.query(i);return o.map(c=>{const u=Ee.uniq(l.filter(f=>f.table_name===c.name&&f.table_schema===c.schema),f=>f.constraint_name),h=new va,d=c.schema===r&&!this.driver.options.schema?void 0:c.schema;return h.database=t,h.schema=c.schema,h.name=this.driver.buildTableName(c.name,d),h.expression=c.value,h.materialized=c.type===Ie.MATERIALIZED_VIEW,h.indices=u.map(f=>{const g=l.filter(v=>v.table_schema===f.table_schema&&v.table_name===f.table_name&&v.constraint_name===f.constraint_name);return new Ct({view:h,name:f.constraint_name,columnNames:g.map(v=>v.column_name),isUnique:f.is_unique==="TRUE",where:f.condition,isFulltext:!1})}),h})}async loadTables(e){if(e&&e.length===0)return[];const t=await this.getCurrentSchema(),r=await this.getCurrentDatabase(),a=[];if(!e)a.push(...await this.query('SELECT "table_schema", "table_name" FROM "information_schema"."tables"'));else{const C='SELECT "table_schema", "table_name" FROM "information_schema"."tables" WHERE '+e.map(w=>this.driver.parseTableName(w)).map(({schema:w,tableName:T})=>`("table_schema" = '${w||t}' AND "table_name" = '${T}')`).join(" OR ");a.push(...await this.query(C))}if(a.length===0)return[];const i=`SELECT columns.*, pg_catalog.col_description(('"' || table_catalog || '"."' || table_schema || '"."' || table_name || '"')::regclass::oid, ordinal_position) AS description, ('"' || "udt_schema" || '"."' || "udt_name" || '"')::"regtype" AS "regtype", pg_catalog.format_type("col_attr"."atttypid", "col_attr"."atttypmod") AS "format_type" FROM "information_schema"."columns" LEFT JOIN "pg_catalog"."pg_attribute" AS "col_attr" ON "col_attr"."attname" = "columns"."column_name" AND "col_attr"."attrelid" = ( SELECT "cls"."oid" FROM "pg_catalog"."pg_class" AS "cls" LEFT JOIN "pg_catalog"."pg_namespace" AS "ns" ON "ns"."oid" = "cls"."relnamespace" WHERE "cls"."relname" = "columns"."table_name" AND "ns"."nspname" = "columns"."table_schema" ) WHERE `+a.map(({table_schema:C,table_name:w})=>`("table_schema" = '${C}' AND "table_name" = '${w}')`).join(" OR "),s=a.map(({table_schema:C,table_name:w})=>`("ns"."nspname" = '${C}' AND "t"."relname" = '${w}')`).join(" OR "),o=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", pg_get_constraintdef("cnst"."oid") AS "expression", CASE "cnst"."contype" WHEN 'p' THEN 'PRIMARY' WHEN 'u' THEN 'UNIQUE' WHEN 'c' THEN 'CHECK' WHEN 'x' THEN 'EXCLUDE' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" IN ('r', 'p') AND (${s})`,l=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('r', 'p') AND "cnst"."contype" IS NULL AND (${s})`,c=a.map(({table_schema:C,table_name:w})=>`("ns"."nspname" = '${C}' AND "cl"."relname" = '${w}')`).join(" OR "),u=await this.hasSupportForPartitionedTables()?` AND "cl"."relispartition" = 'f'`:"",h=`SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update", "con"."condeferrable" AS "deferrable", "con"."condeferred" AS "deferred" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", "con1"."condeferrable", CASE WHEN "con1"."condeferred" THEN 'INITIALLY DEFERRED' ELSE 'INITIALLY IMMEDIATE' END as condeferred, CASE "con1"."confdeltype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confdeltype", CASE "con1"."confupdtype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = 'f' AND (${c}) ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" ${u}INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"`,[d,f,g,v]=await Promise.all([this.query(i),this.query(o),this.query(l),this.query(h)]);return Promise.all(a.map(async C=>{const w=new _t,T=(q,K)=>q[K]===t&&(!this.driver.options.schema||this.driver.options.schema===t)?void 0:q[K],S=T(C,"table_schema");w.database=r,w.schema=C.table_schema,w.name=this.driver.buildTableName(C.table_name,S),w.columns=await Promise.all(d.filter(q=>q.table_name===C.table_name&&q.table_schema===C.table_schema).map(async q=>{const K=f.filter(re=>re.table_name===q.table_name&&re.table_schema===q.table_schema&&re.column_name===q.column_name),I=new Sn;if(I.name=q.column_name,I.type=q.regtype.toLowerCase(),(I.type==="numeric"||I.type==="decimal"||I.type==="float")&&(q.numeric_precision!==null&&!this.isDefaultColumnPrecision(w,I,q.numeric_precision)?I.precision=q.numeric_precision:q.numeric_scale!==null&&!this.isDefaultColumnScale(w,I,q.numeric_scale)&&(I.precision=void 0),q.numeric_scale!==null&&!this.isDefaultColumnScale(w,I,q.numeric_scale)?I.scale=q.numeric_scale:q.numeric_precision!==null&&!this.isDefaultColumnPrecision(w,I,q.numeric_precision)&&(I.scale=void 0)),(I.type==="interval"||I.type==="time without time zone"||I.type==="time with time zone"||I.type==="timestamp without time zone"||I.type==="timestamp with time zone")&&(I.precision=this.isDefaultColumnPrecision(w,I,q.datetime_precision)?void 0:q.datetime_precision),q.data_type==="USER-DEFINED"||q.data_type==="ARRAY"){const{name:re}=await this.getUserDefinedTypeName(w,I),ue=this.buildEnumName(w,I,!1,!0)!==re?re:void 0,Se=`SELECT "e"."enumlabel" AS "value" FROM "pg_enum" "e" INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${C.table_schema}' AND "t"."typname" = '${ue||re}'`,ie=await this.query(Se);if(ie.length&&(I.type="enum",I.enum=ie.map(fe=>fe.value),I.enumName=ue),q.data_type==="ARRAY"){I.isArray=!0;const fe=I.type.replace("[]","");I.type=this.connection.driver.normalizeType({type:fe})}}if(I.type==="geometry"||I.type==="geography"){const re=`SELECT * FROM (SELECT "f_table_schema" "table_schema", "f_table_name" "table_name", "f_${I.type}_column" "column_name", "srid", "type" FROM "${I.type}_columns") AS _ WHERE "column_name" = '${q.column_name}' AND "table_schema" = '${q.table_schema}' AND "table_name" = '${q.table_name}'`,ue=await this.query(re);ue.length>0&&(I.spatialFeatureType=ue[0].type,I.srid=ue[0].srid)}if(this.driver.withLengthColumnTypes.indexOf(I.type)!==-1){let re;if(I.isArray){const ue=/\((\d+)\)/.exec(q.format_type);re=ue?ue[1]:void 0}else q.character_maximum_length&&(re=q.character_maximum_length.toString());re&&(I.length=this.isDefaultColumnLength(w,I,re)?"":re)}I.isNullable=q.is_nullable==="YES";const G=K.find(re=>re.constraint_type==="PRIMARY");if(G){I.isPrimary=!0;const re=f.filter(Se=>Se.table_name===q.table_name&&Se.table_schema===q.table_schema&&Se.column_name!==q.column_name&&Se.constraint_type==="PRIMARY").map(Se=>Se.column_name);re.push(q.column_name);const ue=this.connection.namingStrategy.primaryKeyName(w,re);G.constraint_name!==ue&&(I.primaryKeyConstraintName=G.constraint_name)}const H=K.filter(re=>re.constraint_type==="UNIQUE"),se=H.every(re=>f.some(ue=>ue.constraint_type==="UNIQUE"&&ue.constraint_name===re.constraint_name&&ue.column_name!==q.column_name));if(I.isUnique=H.length>0&&!se,q.is_identity==="YES")I.isGenerated=!0,I.generationStrategy="identity",I.generatedIdentity=q.identity_generation;else if(q.column_default!==null&&q.column_default!==void 0){const re=`nextval('${this.buildSequenceName(w,q.column_name)}'::regclass)`,ue=`nextval('${this.buildSequencePath(w,q.column_name)}'::regclass)`,Se=q.column_default.replace(/"/g,"");Se===re||Se===ue?(I.isGenerated=!0,I.generationStrategy="increment"):q.column_default==="gen_random_uuid()"||/^uuid_generate_v\d\(\)/.test(q.column_default)?I.type==="uuid"?(I.isGenerated=!0,I.generationStrategy="uuid"):I.default=q.column_default:q.column_default==="now()"||q.column_default.indexOf("'now'::text")!==-1?I.default=q.column_default:(I.default=q.column_default.replace(/::[\w\s.\[\]\-"]+/g,""),I.default=I.default.replace(/^(-?\d+)$/,"'$1'"))}if(q.is_generated==="ALWAYS"&&q.generation_expression){I.generatedType="STORED";const re=await this.selectTypeormMetadataSql({database:r,schema:C.table_schema,table:C.table_name,type:Ie.GENERATED_COLUMN,name:I.name}),ue=await this.query(re.query,re.parameters);ue[0]&&ue[0].value?I.asExpression=ue[0].value:I.asExpression=""}return I.comment=q.description?q.description:void 0,q.character_set_name&&(I.charset=q.character_set_name),q.collation_name&&(I.collation=q.collation_name),I}));const O=Ee.uniq(f.filter(q=>q.table_name===C.table_name&&q.table_schema===C.table_schema&&q.constraint_type==="UNIQUE"),q=>q.constraint_name);w.uniques=O.map(q=>{const K=f.filter(I=>I.constraint_name===q.constraint_name);return new cn({name:q.constraint_name,columnNames:K.map(I=>I.column_name),deferrable:q.deferrable?q.deferred:void 0})});const k=Ee.uniq(f.filter(q=>q.table_name===C.table_name&&q.table_schema===C.table_schema&&q.constraint_type==="CHECK"),q=>q.constraint_name);w.checks=k.map(q=>{const K=f.filter(I=>I.constraint_name===q.constraint_name);return new Sr({name:q.constraint_name,columnNames:K.map(I=>I.column_name),expression:q.expression.replace(/^\s*CHECK\s*\((.*)\)\s*$/i,"$1")})});const B=Ee.uniq(f.filter(q=>q.table_name===C.table_name&&q.table_schema===C.table_schema&&q.constraint_type==="EXCLUDE"),q=>q.constraint_name);w.exclusions=B.map(q=>new Wi({name:q.constraint_name,expression:q.expression.substring(8)}));const D=Ee.uniq(v.filter(q=>q.table_name===C.table_name&&q.table_schema===C.table_schema),q=>q.constraint_name);w.foreignKeys=D.map(q=>{const K=v.filter(H=>H.constraint_name===q.constraint_name),I=T(q,"referenced_table_schema"),G=this.driver.buildTableName(q.referenced_table_name,I);return new ar({name:q.constraint_name,columnNames:K.map(H=>H.column_name),referencedSchema:q.referenced_table_schema,referencedTableName:G,referencedColumnNames:K.map(H=>H.referenced_column_name),onDelete:q.on_delete,onUpdate:q.on_update,deferrable:q.deferrable?q.deferred:void 0})});const V=Ee.uniq(g.filter(q=>q.table_name===C.table_name&&q.table_schema===C.table_schema),q=>q.constraint_name);return w.indices=V.map(q=>{const K=g.filter(I=>I.table_schema===q.table_schema&&I.table_name===q.table_name&&I.constraint_name===q.constraint_name);return new Ct({table:w,name:q.constraint_name,columnNames:K.map(I=>I.column_name),isUnique:q.is_unique==="TRUE",where:q.condition,isSpatial:K.every(I=>this.driver.spatialTypes.indexOf(I.type_name)>=0),isFulltext:!1})}),w}))}createTableSql(e,t){const r=e.columns.map(s=>this.buildCreateColumnSql(e,s)).join(", ");let a=`CREATE TABLE ${this.escapePath(e)} (${r}`;if(e.columns.filter(s=>s.isUnique).forEach(s=>{e.uniques.some(o=>o.columnNames.length===1&&o.columnNames[0]===s.name)||e.uniques.push(new cn({name:this.connection.namingStrategy.uniqueConstraintName(e,[s.name]),columnNames:[s.name]}))}),e.uniques.length>0){const s=e.uniques.map(o=>{const l=o.name?o.name:this.connection.namingStrategy.uniqueConstraintName(e,o.columnNames),c=o.columnNames.map(h=>`"${h}"`).join(", ");let u=`CONSTRAINT "${l}" UNIQUE (${c})`;return o.deferrable&&(u+=` DEFERRABLE ${o.deferrable}`),u}).join(", ");a+=`, ${s}`}if(e.checks.length>0){const s=e.checks.map(o=>`CONSTRAINT "${o.name?o.name:this.connection.namingStrategy.checkConstraintName(e,o.expression)}" CHECK (${o.expression})`).join(", ");a+=`, ${s}`}if(e.exclusions.length>0){const s=e.exclusions.map(o=>`CONSTRAINT "${o.name?o.name:this.connection.namingStrategy.exclusionConstraintName(e,o.expression)}" EXCLUDE ${o.expression}`).join(", ");a+=`, ${s}`}if(e.foreignKeys.length>0&&t){const s=e.foreignKeys.map(o=>{const l=o.columnNames.map(h=>`"${h}"`).join(", ");o.name||(o.name=this.connection.namingStrategy.foreignKeyName(e,o.columnNames,this.getTablePath(o),o.referencedColumnNames));const c=o.referencedColumnNames.map(h=>`"${h}"`).join(", ");let u=`CONSTRAINT "${o.name}" FOREIGN KEY (${l}) REFERENCES ${this.escapePath(this.getTablePath(o))} (${c})`;return o.onDelete&&(u+=` ON DELETE ${o.onDelete}`),o.onUpdate&&(u+=` ON UPDATE ${o.onUpdate}`),o.deferrable&&(u+=` DEFERRABLE ${o.deferrable}`),u}).join(", ");a+=`, ${s}`}const i=e.columns.filter(s=>s.isPrimary);if(i.length>0){const s=i[0].primaryKeyConstraintName?i[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(e,i.map(l=>l.name)),o=i.map(l=>`"${l.name}"`).join(", ");a+=`, CONSTRAINT "${s}" PRIMARY KEY (${o})`}return a+=")",e.columns.filter(s=>s.comment).forEach(s=>a+=`; COMMENT ON COLUMN ${this.escapePath(e)}."${s.name}" IS ${this.escapeComment(s.comment)}`),new x(a)}async getVersion(){return(await this.query("SELECT version()"))[0].version.replace(/^PostgreSQL ([\d\.]+) .*$/,"$1")}dropTableSql(e){return new x(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",r=this.escapePath(e);return typeof e.expression=="string"?new x(`CREATE ${t}VIEW ${r} AS ${e.expression}`):new x(`CREATE ${t}VIEW ${r} AS ${e.expression(this.connection).getQuery()}`)}async insertViewDefinitionSql(e){const t=await this.getCurrentSchema();let{schema:r,tableName:a}=this.driver.parseTableName(e);r||(r=t);const i=e.materialized?Ie.MATERIALIZED_VIEW:Ie.VIEW,s=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:i,schema:r,name:a,value:s})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new x(`DROP ${t}VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){const t=await this.getCurrentSchema();let{schema:r,tableName:a}=this.driver.parseTableName(e);r||(r=t);const i=e.materialized?Ie.MATERIALIZED_VIEW:Ie.VIEW;return this.deleteTypeormMetadataSql({type:i,schema:r,name:a})}async dropEnumTypes(e){const t=`SELECT 'DROP TYPE IF EXISTS "' || n.nspname || '"."' || t.typname || '" CASCADE;' as "query" FROM "pg_type" "t" INNER JOIN "pg_enum" "e" ON "e"."enumtypid" = "t"."oid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" IN (${e}) GROUP BY "n"."nspname", "t"."typname"`,r=await this.query(t);await Promise.all(r.map(a=>this.query(a.query)))}async hasEnumType(e,t){let{schema:r}=this.driver.parseTableName(e);r||(r=await this.getCurrentSchema());const a=this.buildEnumName(e,t,!1,!0),i=`SELECT "n"."nspname", "t"."typname" FROM "pg_type" "t" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${r}' AND "t"."typname" = '${a}'`;return!!(await this.query(i)).length}createEnumTypeSql(e,t,r){r||(r=this.buildEnumName(e,t));const a=t.enum.map(i=>`'${i.replace("'","''")}'`).join(", ");return new x(`CREATE TYPE ${r} AS ENUM(${a})`)}dropEnumTypeSql(e,t,r){return r||(r=this.buildEnumName(e,t)),new x(`DROP TYPE ${r}`)}createIndexSql(e,t){const r=t.columnNames.map(a=>`"${a}"`).join(", ");return new x(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX "${t.name}" ON ${this.escapePath(e)} ${t.isSpatial?"USING GiST ":""}(${r}) ${t.where?"WHERE "+t.where:""}`)}createViewIndexSql(e,t){const r=t.columnNames.map(a=>`"${a}"`).join(", ");return new x(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX "${t.name}" ON ${this.escapePath(e)} (${r}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e,t){let r=F.isTableIndex(t)?t.name:t;const{schema:a}=this.driver.parseTableName(e);return a?new x(`DROP INDEX "${a}"."${r}"`):new x(`DROP INDEX "${r}"`)}createPrimaryKeySql(e,t,r){const a=r||this.connection.namingStrategy.primaryKeyName(e,t),i=t.map(s=>`"${s}"`).join(", ");return new x(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${a}" PRIMARY KEY (${i})`)}dropPrimaryKeySql(e){if(!e.primaryColumns.length)throw new $(`Table ${e} has no primary keys.`);const t=e.primaryColumns.map(i=>i.name),r=e.primaryColumns[0].primaryKeyConstraintName,a=r||this.connection.namingStrategy.primaryKeyName(e,t);return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${a}"`)}createUniqueConstraintSql(e,t){const r=t.columnNames.map(i=>'"'+i+'"').join(", ");let a=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" UNIQUE (${r})`;return t.deferrable&&(a+=` DEFERRABLE ${t.deferrable}`),new x(a)}dropUniqueConstraintSql(e,t){const r=F.isTableUnique(t)?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createCheckConstraintSql(e,t){return new x(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const r=F.isTableCheck(t)?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createExclusionConstraintSql(e,t){return new x(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" EXCLUDE ${t.expression}`)}dropExclusionConstraintSql(e,t){const r=F.isTableExclusion(t)?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createForeignKeySql(e,t){const r=t.columnNames.map(s=>'"'+s+'"').join(", "),a=t.referencedColumnNames.map(s=>'"'+s+'"').join(",");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" FOREIGN KEY (${r}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${a})`;return t.onDelete&&(i+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(i+=` ON UPDATE ${t.onUpdate}`),t.deferrable&&(i+=` DEFERRABLE ${t.deferrable}`),new x(i)}dropForeignKeySql(e,t){const r=F.isTableForeignKey(t)?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}buildSequenceName(e,t){const{tableName:r}=this.driver.parseTableName(e),a=F.isTableColumn(t)?t.name:t;let i=`${r}_${a}_seq`;return i.length>this.connection.driver.maxAliasLength&&(i=`${r.substring(0,29)}_${a.substring(0,Math.max(29,63-e.name.length-5))}_seq`),i}buildSequencePath(e,t){const{schema:r}=this.driver.parseTableName(e);return r?`${r}.${this.buildSequenceName(e,t)}`:this.buildSequenceName(e,t)}buildEnumName(e,t,r=!0,a,i){const{schema:s,tableName:o}=this.driver.parseTableName(e);let l=t.enumName?t.enumName:`${o}_${t.name.toLowerCase()}_enum`;return s&&r&&(l=`${s}.${l}`),i&&(l=l+"_old"),l.split(".").map(c=>a?c:`"${c}"`).join(".")}async getUserDefinedTypeName(e,t){let{schema:r,tableName:a}=this.driver.parseTableName(e);r||(r=await this.getCurrentSchema());const i=await this.query(`SELECT "udt_schema", "udt_name" FROM "information_schema"."columns" WHERE "table_schema" = '${r}' AND "table_name" = '${a}' AND "column_name"='${t.name}'`);let s=i[0].udt_name;return s.indexOf("_")===0&&(s=s.substr(1,s.length)),{schema:i[0].udt_schema,name:s}}escapeComment(e){return!e||e.length===0?"NULL":(e=e.replace(/'/g,"''").replace(/\u0000/g,""),`'${e}'`)}escapePath(e){const{schema:t,tableName:r}=this.driver.parseTableName(e);return t&&t!==this.driver.searchSchema?`"${t}"."${r}"`:`"${r}"`}async getTableNameWithSchema(e){const t=F.isTable(e)?e.name:e;return t.indexOf(".")===-1?`${(await this.query("SELECT current_schema()"))[0].current_schema}.${t}`:`${t.split(".")[0]}.${t.split(".")[1]}`}buildCreateColumnSql(e,t){let r='"'+t.name+'"';if(t.isGenerated===!0&&t.generationStrategy!=="uuid")if(t.generationStrategy==="identity"){const a=t.generatedIdentity||"BY DEFAULT";r+=` ${t.type} GENERATED ${a} AS IDENTITY`}else(t.type==="integer"||t.type==="int"||t.type==="int4")&&(r+=" SERIAL"),(t.type==="smallint"||t.type==="int2")&&(r+=" SMALLSERIAL"),(t.type==="bigint"||t.type==="int8")&&(r+=" BIGSERIAL");return t.type==="enum"||t.type==="simple-enum"?(r+=" "+this.buildEnumName(e,t),t.isArray&&(r+=" array")):(!t.isGenerated||t.type==="uuid")&&(r+=" "+this.connection.driver.createFullType(t)),t.generatedType==="STORED"&&t.asExpression&&(r+=` GENERATED ALWAYS AS (${t.asExpression}) STORED`),t.charset&&(r+=' CHARACTER SET "'+t.charset+'"'),t.collation&&(r+=' COLLATE "'+t.collation+'"'),t.isNullable!==!0&&(r+=" NOT NULL"),t.default!==void 0&&t.default!==null&&(r+=" DEFAULT "+t.default),t.isGenerated&&t.generationStrategy==="uuid"&&!t.default&&(r+=` DEFAULT ${this.driver.uuidGenerator}`),r}async hasSupportForPartitionedTables(){return!!(await this.query("SELECT TRUE FROM information_schema.columns WHERE table_name = 'pg_class' and column_name = 'relispartition'")).length}}class CO extends NO{constructor(e,t){super(e,t)}}class AO extends CO{constructor(e,t,r){super(e,r),this.client=t}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:(this.mode==="slave"&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)),this.databaseConnectionPromise)}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?await this.client.startTransaction():await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new rr;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(await this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new bn;const a=await this.client.query(e,t),i=new Qr;return i.raw=a,a!=null&&a.hasOwnProperty("records")&&Array.isArray(a.records)&&(i.records=a.records),a!=null&&a.hasOwnProperty("numberOfRecordsUpdated")&&(i.affected=a.numberOfRecordsUpdated),r?i:i.raw}}class SO extends Ew{}class RO extends SO{constructor(e){super(),this.transactionSupport="nested",this.connection=e,this.options=e.options,this.isReplicated=!1,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions),this.database=pe.buildDriverOptions(this.options).database}async connect(){}async disconnect(){}createQueryRunner(e){return new AO(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,r)=>this.connection.logger.logQuery(t,r),this.options.serviceConfigOptions,this.options.formatOptions),e)}preparePersistentValue(e,t){return this.options.formatOptions&&this.options.formatOptions.castParameters===!1?super.preparePersistentValue(e,t):(t.transformer&&(e=qt.transformTo(t.transformer,e)),this.client.preparePersistentValue(e,t))}prepareHydratedValue(e,t){return this.options.formatOptions&&this.options.formatOptions.castParameters===!1?super.prepareHydratedValue(e,t):(t.transformer&&(e=qt.transformFrom(t.transformer,e)),this.client.prepareHydratedValue(e,t))}loadDependencies(){const e=this.options.driver||ht.load("typeorm-aurora-data-api-driver"),{pg:t}=e;this.DataApiDriver=t}executeQuery(e,t){return this.connection.query(t)}async afterConnect(){const e=await this.checkMetadataForExtensions();return e.hasExtensions&&await this.enableExtensions(e,this.connection),Promise.resolve()}}class MO extends Zs{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new Ea(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async executeSet(e){if(this.isReleased)throw new bn;return(await this.connect()).executeSet(e,!1)}async query(e,t,r=!1){if(this.isReleased)throw new bn;const a=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const i=e.substr(0,e.indexOf(" "));try{let s;["BEGIN","ROLLBACK","COMMIT","CREATE","ALTER","DROP"].indexOf(i)!==-1?s=await a.execute(e,!1):["INSERT","UPDATE","DELETE"].indexOf(i)!==-1?s=await a.run(e,t,!1):s=await a.query(e,t||[]);const o=new Qr;return s!=null&&s.hasOwnProperty("values")&&(o.raw=s.values,o.records=s.values),s!=null&&s.hasOwnProperty("changes")&&(o.affected=s.changes.changes,o.raw=s.changes.lastId||s.changes.changes),r?o:o.raw}catch(s){throw this.driver.connection.logger.logQueryError(s,e,t,this),new Kr(e,t,s)}}parametrize(e){return Object.keys(e).map(t=>`"${t}"=?`)}}class OO extends $l{constructor(e){super(e),this.database=this.options.database,this.driver=this.options.driver,this.sqlite=this.options.driver}async connect(){this.databaseConnection=this.createDatabaseConnection(),await this.databaseConnection}async disconnect(){return this.queryRunner=void 0,(await this.databaseConnection).close().then(()=>{this.databaseConnection=void 0})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new MO(this)),this.queryRunner}async createDatabaseConnection(){const e=this.options.mode||"no-encryption",t=e!=="no-encryption",r=typeof this.options.version>"u"?1:this.options.version,a=await this.sqlite.createConnection(this.options.database,t,e,r);return await a.open(),await a.query("PRAGMA foreign_keys = ON"),this.options.journalMode&&["DELETE","TRUNCATE","PERSIST","MEMORY","WAL","OFF"].indexOf(this.options.journalMode)!==-1&&await a.query(`PRAGMA journal_mode = ${this.options.journalMode}`),a}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new Xs("Capacitor","@capacitor-community/sqlite")}}class _O extends gh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new Ea(this)}async connect(){if(this.session)return Promise.resolve(this.session);const[e]=await this.driver.instanceDatabase.createSession({});return this.session=e,this.sessionTransaction=await e.transaction(),this.session}async release(){return this.isReleased=!0,this.session&&await this.session.delete(),this.session=void 0,Promise.resolve()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}await this.connect(),await this.sessionTransaction.begin(),this.connection.logger.logQuery("START TRANSACTION"),await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive||!this.sessionTransaction)throw new rr;await this.broadcaster.broadcast("BeforeTransactionCommit"),await this.sessionTransaction.commit(),this.connection.logger.logQuery("COMMIT"),this.isTransactionActive=!1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive||!this.sessionTransaction)throw new rr;await this.broadcaster.broadcast("BeforeTransactionRollback"),await this.sessionTransaction.rollback(),this.connection.logger.logQuery("ROLLBACK"),this.isTransactionActive=!1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,r=!1){if(this.isReleased)throw new bn;try{const a=+new Date;await this.connect();let i;const s=e.startsWith("SELECT"),o=s&&!this.isTransactionActive?this.driver.instanceDatabase:this.sessionTransaction;!this.isTransactionActive&&!s&&await this.sessionTransaction.begin();try{this.driver.connection.logger.logQuery(e,t,this),i=await o.run({sql:e,params:t?t.reduce((h,d,f)=>(h["param"+f]=d,h),{}):void 0,json:!0}),!this.isTransactionActive&&!s&&await this.sessionTransaction.commit()}catch(h){try{!this.isTransactionActive&&!s&&await this.sessionTransaction.rollback()}catch{}throw h}const l=this.driver.options.maxQueryExecutionTime,c=+new Date-a;l&&c>l&&this.driver.connection.logger.logQuerySlow(c,e,t,this);const u=new Qr;return u.raw=i,u.records=i?i[0]:[],i&&i[1]&&i[1].rowCountExact&&(u.affected=parseInt(i[1].rowCountExact)),r?u:u.records}catch(a){throw this.driver.connection.logger.logQueryError(a,e,t,this),new Kr(e,t,a)}finally{}}async updateDDL(e,t){if(this.isReleased)throw new bn;this.driver.connection.logger.logQuery(e,t,this);try{const r=+new Date,[a]=await this.driver.instanceDatabase.updateSchema(e);await a.promise();const i=this.driver.options.maxQueryExecutionTime,s=+new Date-r;i&&s>i&&this.driver.connection.logger.logQuerySlow(s,e,t,this)}catch(r){throw this.driver.connection.logger.logQueryError(r,e,t,this),new Kr(e,t,r)}}async stream(e,t,r,a){if(this.isReleased)throw new bn;try{this.driver.connection.logger.logQuery(e,t,this);const i={sql:e,params:t?t.reduce((o,l,c)=>(o["param"+c]=l,o),{}):void 0,json:!0},s=this.driver.instanceDatabase.runStream(i);return r&&s.on("end",r),a&&s.on("error",a),s}catch(i){throw this.driver.connection.logger.logQueryError(i,e,t,this),new Kr(e,t,i)}}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){throw new $("Check database queries are not supported by Spanner driver.")}async getCurrentDatabase(){throw new $("Check database queries are not supported by Spanner driver.")}async hasSchema(e){return!!(await this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length}async getCurrentSchema(){throw new $("Check schema queries are not supported by Spanner driver.")}async hasTable(e){const t=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` = '${e instanceof _t?e.name:e}'`;return!!(await this.query(t)).length}async hasColumn(e,t){const r=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` = '${e instanceof _t?e.name:e}' AND \`COLUMN_NAME\` = '${t}'`;return!!(await this.query(r)).length}async createDatabase(e,t){if(t&&await this.hasDatabase(e))return Promise.resolve();const r=`CREATE DATABASE "${e}"`,a=`DROP DATABASE "${e}"`;await this.executeQueries(new x(r),new x(a))}async dropDatabase(e,t){const r=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,a=`CREATE DATABASE "${e}"`;await this.executeQueries(new x(r),new x(a))}async createSchema(e,t){return Promise.resolve()}async dropSchema(e,t,r){return Promise.resolve()}async createTable(e,t=!1,r=!0,a=!0){if(t&&await this.hasTable(e))return Promise.resolve();const i=[],s=[];i.push(this.createTableSql(e,r)),s.push(this.dropTableSql(e)),r&&e.foreignKeys.forEach(l=>s.push(this.dropForeignKeySql(e,l))),a&&e.indices.forEach(l=>{l.name||(l.name=this.connection.namingStrategy.indexName(e,l.columnNames,l.where)),i.push(this.createIndexSql(e,l)),s.push(this.dropIndexSql(e,l))});const o=e.columns.filter(l=>l.generatedType&&l.asExpression);for(const l of o){const c=this.insertTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:l.name,value:l.asExpression}),u=this.deleteTypeormMetadataSql({table:e.name,type:Ie.GENERATED_COLUMN,name:l.name});i.push(c),s.push(u)}await this.executeQueries(i,s)}async dropTable(e,t,r=!0,a=!0){if(t&&!await this.hasTable(e))return Promise.resolve();const i=r,s=this.getTablePath(e),o=await this.getCachedTable(s),l=[],c=[];a&&o.indices.forEach(h=>{l.push(this.dropIndexSql(o,h)),c.push(this.createIndexSql(o,h))}),r&&o.foreignKeys.forEach(h=>l.push(this.dropForeignKeySql(o,h))),l.push(this.dropTableSql(o)),c.push(this.createTableSql(o,i));const u=o.columns.filter(h=>h.generatedType&&h.asExpression);for(const h of u){const d=this.deleteTypeormMetadataSql({table:o.name,type:Ie.GENERATED_COLUMN,name:h.name}),f=this.insertTypeormMetadataSql({table:o.name,type:Ie.GENERATED_COLUMN,name:h.name,value:h.asExpression});l.push(d),c.push(f)}await this.executeQueries(l,c)}async createView(e){const t=[],r=[];t.push(this.createViewSql(e)),t.push(await this.insertViewDefinitionSql(e)),r.push(this.dropViewSql(e)),r.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(t,r)}async dropView(e){const t=e instanceof va?e.name:e,r=await this.getCachedView(t),a=[],i=[];a.push(await this.deleteViewDefinitionSql(r)),a.push(this.dropViewSql(r)),i.push(await this.insertViewDefinitionSql(r)),i.push(this.createViewSql(r)),await this.executeQueries(a,i)}async renameTable(e,t){throw new $("Rename table queries are not supported by Spanner driver.")}async addColumn(e,t){const r=e instanceof _t?e:await this.getCachedTable(e),a=r.clone(),i=[],s=[];i.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(t)}`)),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN ${this.driver.escape(t.name)}`));const o=a.indices.find(l=>l.columnNames.length===1&&l.columnNames[0]===t.name);if(o)i.push(this.createIndexSql(r,o)),s.push(this.dropIndexSql(r,o));else if(t.isUnique){const l=new Ct({name:this.connection.namingStrategy.indexName(r,[t.name]),columnNames:[t.name],isUnique:!0});a.indices.push(l),a.uniques.push(new cn({name:l.name,columnNames:l.columnNames})),i.push(this.createIndexSql(r,l)),s.push(this.dropIndexSql(r,l))}if(t.generatedType&&t.asExpression){const l=this.insertTypeormMetadataSql({table:r.name,type:Ie.GENERATED_COLUMN,name:t.name,value:t.asExpression}),c=this.deleteTypeormMetadataSql({table:r.name,type:Ie.GENERATED_COLUMN,name:t.name});i.push(l),s.push(c)}await this.executeQueries(i,s),a.addColumn(t),this.replaceCachedTable(r,a)}async addColumns(e,t){for(const r of t)await this.addColumn(e,r)}async renameColumn(e,t,r){const a=e instanceof _t?e:await this.getCachedTable(e),i=t instanceof Sn?t:a.columns.find(o=>o.name===t);if(!i)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);let s;return r instanceof Sn?s=r:(s=i.clone(),s.name=r),this.changeColumn(a,i,s)}async changeColumn(e,t,r){const a=e instanceof _t?e:await this.getCachedTable(e);let i=a.clone();const s=[],o=[],l=t instanceof Sn?t:a.columns.find(c=>c.name===t);if(!l)throw new $(`Column "${t}" was not found in the "${a.name}" table.`);if(l.name!==r.name||l.type!==r.type||l.length!==r.length||l.isArray!==r.isArray||l.generatedType!==r.generatedType||l.asExpression!==r.asExpression)await this.dropColumn(a,l),await this.addColumn(a,r),i=a.clone();else if((r.precision!==l.precision||r.scale!==l.scale)&&(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(r)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${r.name}" TYPE ${this.driver.createFullType(l)}`))),l.isNullable!==r.isNullable&&(r.isNullable?(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${l.name}" DROP NOT NULL`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${l.name}" SET NOT NULL`))):(s.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${l.name}" SET NOT NULL`)),o.push(new x(`ALTER TABLE ${this.escapePath(a)} ALTER COLUMN "${l.name}" DROP NOT NULL`)))),r.isUnique!==l.isUnique)if(r.isUnique===!0){const c=new Ct({name:this.connection.namingStrategy.indexName(a,[r.name]),columnNames:[r.name],isUnique:!0});i.indices.push(c),i.uniques.push(new cn({name:c.name,columnNames:c.columnNames})),s.push(this.createIndexSql(a,c)),o.push(this.dropIndexSql(a,c))}else{const c=i.indices.find(h=>h.columnNames.length===1&&h.isUnique===!0&&!!h.columnNames.find(d=>d===r.name));i.indices.splice(i.indices.indexOf(c),1);const u=i.uniques.find(h=>h.name===c.name);i.uniques.splice(i.uniques.indexOf(u),1),s.push(this.dropIndexSql(a,c)),o.push(this.createIndexSql(a,c))}await this.executeQueries(s,o),this.replaceCachedTable(a,i)}async changeColumns(e,t){for(const{oldColumn:r,newColumn:a}of t)await this.changeColumn(e,r,a)}async dropColumn(e,t){const r=e instanceof _t?e:await this.getCachedTable(e),a=t instanceof Sn?t:r.findColumnByName(t);if(!a)throw new $(`Column "${t}" was not found in table "${r.name}"`);const i=r.clone(),s=[],o=[],l=i.indices.find(u=>u.columnNames.length===1&&u.columnNames[0]===a.name);l&&(i.indices.splice(i.indices.indexOf(l),1),s.push(this.dropIndexSql(r,l)),o.push(this.createIndexSql(r,l)));const c=i.checks.find(u=>!!u.columnNames&&u.columnNames.length===1&&u.columnNames[0]===a.name);if(c&&(i.checks.splice(i.checks.indexOf(c),1),s.push(this.dropCheckConstraintSql(r,c)),o.push(this.createCheckConstraintSql(r,c))),s.push(new x(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN ${this.driver.escape(a.name)}`)),o.push(new x(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(a)}`)),a.generatedType&&a.asExpression){const u=this.deleteTypeormMetadataSql({table:r.name,type:Ie.GENERATED_COLUMN,name:a.name}),h=this.insertTypeormMetadataSql({table:r.name,type:Ie.GENERATED_COLUMN,name:a.name,value:a.asExpression});s.push(u),o.push(h)}await this.executeQueries(s,o),i.removeColumn(a),this.replaceCachedTable(r,i)}async dropColumns(e,t){for(const r of t)await this.dropColumn(e,r)}async createPrimaryKey(e,t){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async updatePrimaryKeys(e,t){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async dropPrimaryKey(e){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async createUniqueConstraint(e,t){throw new $("Spanner does not support unique constraints. Use unique index instead.")}async createUniqueConstraints(e,t){throw new $("Spanner does not support unique constraints. Use unique index instead.")}async dropUniqueConstraint(e,t){throw new $("Spanner does not support unique constraints. Use unique index instead.")}async dropUniqueConstraints(e,t){throw new $("Spanner does not support unique constraints. Use unique index instead.")}async createCheckConstraint(e,t){const r=e instanceof _t?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(r,t.expression));const a=this.createCheckConstraintSql(r,t),i=this.dropCheckConstraintSql(r,t);await this.executeQueries(a,i),r.addCheckConstraint(t)}async createCheckConstraints(e,t){const r=t.map(a=>this.createCheckConstraint(e,a));await Promise.all(r)}async dropCheckConstraint(e,t){const r=e instanceof _t?e:await this.getCachedTable(e),a=t instanceof Sr?t:r.checks.find(o=>o.name===t);if(!a)throw new $(`Supplied check constraint was not found in table ${r.name}`);const i=this.dropCheckConstraintSql(r,a),s=this.createCheckConstraintSql(r,a);await this.executeQueries(i,s),r.removeCheckConstraint(a)}async dropCheckConstraints(e,t){const r=t.map(a=>this.dropCheckConstraint(e,a));await Promise.all(r)}async createExclusionConstraint(e,t){throw new $("Spanner does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new $("Spanner does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new $("Spanner does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new $("Spanner does not support exclusion constraints.")}async createForeignKey(e,t){const r=e instanceof _t?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const a=this.createForeignKeySql(r,t),i=this.dropForeignKeySql(r,t);await this.executeQueries(a,i),r.addForeignKey(t)}async createForeignKeys(e,t){for(const r of t)await this.createForeignKey(e,r)}async dropForeignKey(e,t){const r=e instanceof _t?e:await this.getCachedTable(e),a=t instanceof ar?t:r.foreignKeys.find(o=>o.name===t);if(!a)throw new $(`Supplied foreign key was not found in table ${r.name}`);const i=this.dropForeignKeySql(r,a),s=this.createForeignKeySql(r,a);await this.executeQueries(i,s),r.removeForeignKey(a)}async dropForeignKeys(e,t){for(const r of t)await this.dropForeignKey(e,r)}async createIndex(e,t){const r=e instanceof _t?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(r,t));const a=this.createIndexSql(r,t),i=this.dropIndexSql(r,t);await this.executeQueries(a,i),r.addIndex(t)}async createIndices(e,t){for(const r of t)await this.createIndex(e,r)}async dropIndex(e,t){const r=e instanceof _t?e:await this.getCachedTable(e),a=t instanceof Ct?t:r.indices.find(o=>o.name===t);if(!a)throw new $(`Supplied index ${t} was not found in table ${r.name}`);a.name||(a.name=this.generateIndexName(r,a));const i=this.dropIndexSql(r,a),s=this.createIndexSql(r,a);await this.executeQueries(i,s),r.removeIndex(a)}async dropIndices(e,t){for(const r of t)await this.dropIndex(e,r)}async clearTable(e){await this.query(`DELETE FROM ${this.escapePath(e)} WHERE true`)}async clearDatabase(){const e=await this.query("SELECT concat('DROP INDEX `', INDEX_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`INDEXES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `INDEX_TYPE` = 'INDEX' AND `SPANNER_IS_MANAGED` = false"),t=await this.query("SELECT concat('ALTER TABLE `', TABLE_NAME, '`', ' DROP CONSTRAINT `', CONSTRAINT_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLE_CONSTRAINTS` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `CONSTRAINT_TYPE` = 'FOREIGN KEY'"),r=await this.query("SELECT concat('DROP TABLE `', TABLE_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'");if(!e.length&&!t.length&&!r.length)return;const a=this.isTransactionActive;a||await this.startTransaction();try{for(let i of e)await this.updateDDL(i.query);for(let i of t)await this.updateDDL(i.query);for(let i of r)await this.updateDDL(i.query);await this.commitTransaction()}catch(i){try{a||await this.rollbackTransaction()}catch{}throw i}}async executeMemoryUpSql(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)this.isDMLQuery(e)?await this.query(e,t):await this.updateDDL(e,t)}async executeMemoryDownSql(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())this.isDMLQuery(e)?await this.query(e,t):await this.updateDDL(e,t)}async loadViews(e){return Promise.resolve([])}async loadTables(e){if(e&&e.length===0)return[];const t=[];if(!e||!e.length)t.push(...await this.query("SELECT `TABLE_NAME` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'"));else{const g=`SELECT \`TABLE_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` IN (${e.map(v=>`'${v}'`).join(", ")})`;t.push(...await this.query(g))}if(!t.length)return[];const r=t.map(g=>`'${g.TABLE_NAME}'`).join(", "),a=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` IN (${r})`,i=`SELECT \`KCU\`.\`TABLE_NAME\`, \`KCU\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'PRIMARY KEY' AND \`TC\`.\`TABLE_NAME\` IN (${r})`,s=`SELECT \`I\`.\`TABLE_NAME\`, \`I\`.\`INDEX_NAME\`, \`I\`.\`IS_UNIQUE\`, \`I\`.\`IS_NULL_FILTERED\`, \`IC\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`INDEXES\` \`I\` INNER JOIN \`INFORMATION_SCHEMA\`.\`INDEX_COLUMNS\` \`IC\` ON \`IC\`.\`INDEX_NAME\` = \`I\`.\`INDEX_NAME\` AND \`IC\`.\`TABLE_NAME\` = \`I\`.\`TABLE_NAME\` WHERE \`I\`.\`TABLE_CATALOG\` = '' AND \`I\`.\`TABLE_SCHEMA\` = '' AND \`I\`.\`TABLE_NAME\` IN (${r}) AND \`I\`.\`INDEX_TYPE\` = 'INDEX' AND \`I\`.\`SPANNER_IS_MANAGED\` = false`,o=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`CC\`.\`CHECK_CLAUSE\`, \`CCU\`.\`COLUMN_NAME\`FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CHECK_CONSTRAINTS\` \`CC\` ON \`CC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'CHECK' AND \`TC\`.\`TABLE_NAME\` IN (${r}) AND \`TC\`.\`CONSTRAINT_NAME\` NOT LIKE 'CK_IS_NOT_NULL%'`,l=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`KCU\`.\`COLUMN_NAME\`, \`CTU\`.\`TABLE_NAME\` AS \`REFERENCED_TABLE_NAME\`, \`CCU\`.\`COLUMN_NAME\` AS \`REFERENCED_COLUMN_NAME\`, \`RC\`.\`UPDATE_RULE\`, \`RC\`.\`DELETE_RULE\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_TABLE_USAGE\` \`CTU\` ON \`CTU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`RC\` ON \`RC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'FOREIGN KEY' AND \`TC\`.\`TABLE_NAME\` IN (${r})`,[c,u,h,d,f]=await Promise.all([this.query(a),this.query(i),this.query(s),this.query(o),this.query(l)]);return Promise.all(t.map(async g=>{const v=new _t;v.name=this.driver.buildTableName(g.TABLE_NAME),v.columns=await Promise.all(c.filter(S=>S.TABLE_NAME===g.TABLE_NAME).map(async S=>{const O=h.filter(K=>K.TABLE_NAME===g.TABLE_NAME&&K.COLUMN_NAME===S.COLUMN_NAME&&K.IS_UNIQUE===!0),k=this.connection.entityMetadatas.find(K=>this.getTablePath(v)===this.getTablePath(K)),B=O.length>0&&k&&k.indices.some(K=>O.some(I=>K.name===I.INDEX_NAME&&K.synchronize===!1)),D=O.every(K=>h.some(I=>I.INDEX_NAME===K.INDEX_NAME&&I.COLUMN_NAME!==S.COLUMN_NAME)),V=new Sn;V.name=S.COLUMN_NAME;let q=S.SPANNER_TYPE.toLowerCase();if(q.indexOf("array")!==-1&&(V.isArray=!0,q=q.substring(q.indexOf("<")+1,q.indexOf(">"))),q.indexOf("(")!==-1?V.type=q.substring(0,q.indexOf("(")):V.type=q,this.driver.withLengthColumnTypes.indexOf(V.type)!==-1&&(V.length=q.substring(q.indexOf("(")+1,q.indexOf(")"))),S.IS_GENERATED==="ALWAYS"){V.asExpression=S.GENERATION_EXPRESSION,V.generatedType="STORED";const K=await this.selectTypeormMetadataSql({table:g.TABLE_NAME,type:Ie.GENERATED_COLUMN,name:V.name}),I=await this.query(K.query,K.parameters);I[0]&&I[0].value?V.asExpression=I[0].value:V.asExpression=""}return V.isUnique=O.length>0&&!B&&!D,V.isNullable=S.IS_NULLABLE==="YES",V.isPrimary=u.some(K=>K.TABLE_NAME===S.TABLE_NAME&&K.COLUMN_NAME===S.COLUMN_NAME),V}));const C=f.filter(S=>S.TABLE_NAME===g.TABLE_NAME);v.foreignKeys=Ee.uniq(C,S=>S.CONSTRAINT_NAME).map(S=>{const O=C.filter(k=>k.CONSTRAINT_NAME===S.CONSTRAINT_NAME);return new ar({name:S.CONSTRAINT_NAME,columnNames:Ee.uniq(O.map(k=>k.COLUMN_NAME)),referencedDatabase:S.REFERENCED_TABLE_SCHEMA,referencedTableName:S.REFERENCED_TABLE_NAME,referencedColumnNames:Ee.uniq(O.map(k=>k.REFERENCED_COLUMN_NAME)),onDelete:S.DELETE_RULE,onUpdate:S.UPDATE_RULE})});const w=h.filter(S=>S.TABLE_NAME===g.TABLE_NAME);v.indices=Ee.uniq(w,S=>S.INDEX_NAME).map(S=>{const O=w.filter(k=>k.INDEX_NAME===S.INDEX_NAME);return new Ct({table:v,name:S.INDEX_NAME,columnNames:O.map(k=>k.COLUMN_NAME),isUnique:S.IS_UNIQUE,isNullFiltered:S.IS_NULL_FILTERED})});const T=d.filter(S=>S.TABLE_NAME===g.TABLE_NAME);return v.checks=Ee.uniq(T,S=>S.CONSTRAINT_NAME).map(S=>{const O=T.filter(k=>k.CONSTRAINT_NAME===S.CONSTRAINT_NAME);return new Sr({name:S.CONSTRAINT_NAME,columnNames:O.map(k=>k.COLUMN_NAME),expression:S.CHECK_CLAUSE})}),v}))}createTableSql(e,t){const r=e.columns.map(s=>this.buildCreateColumnSql(s)).join(", ");let a=`CREATE TABLE ${this.escapePath(e)} (${r}`;if(e.columns.filter(s=>s.isUnique).forEach(s=>{const o=e.indices.some(c=>c.columnNames.length===1&&!!c.isUnique&&c.columnNames.indexOf(s.name)!==-1),l=e.uniques.some(c=>c.columnNames.length===1&&c.columnNames.indexOf(s.name)!==-1);!o&&!l&&e.indices.push(new Ct({name:this.connection.namingStrategy.uniqueConstraintName(e,[s.name]),columnNames:[s.name],isUnique:!0}))}),e.uniques.length>0&&e.uniques.forEach(s=>{e.indices.some(o=>o.name===s.name)||e.indices.push(new Ct({name:s.name,columnNames:s.columnNames,isUnique:!0}))}),e.checks.length>0){const s=e.checks.map(o=>`CONSTRAINT \`${o.name?o.name:this.connection.namingStrategy.checkConstraintName(e,o.expression)}\` CHECK (${o.expression})`).join(", ");a+=`, ${s}`}if(e.foreignKeys.length>0&&t){const s=e.foreignKeys.map(o=>{const l=o.columnNames.map(u=>`\`${u}\``).join(", ");o.name||(o.name=this.connection.namingStrategy.foreignKeyName(e,o.columnNames,this.getTablePath(o),o.referencedColumnNames));const c=o.referencedColumnNames.map(u=>`\`${u}\``).join(", ");return`CONSTRAINT \`${o.name}\` FOREIGN KEY (${l}) REFERENCES ${this.escapePath(this.getTablePath(o))} (${c})`}).join(", ");a+=`, ${s}`}a+=")";const i=e.columns.filter(s=>s.isPrimary);if(i.length>0){const s=i.map(o=>this.driver.escape(o.name)).join(", ");a+=` PRIMARY KEY (${s})`}return new x(a)}dropTableSql(e){return new x(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",r=this.escapePath(e),a=typeof e.expression=="string"?e.expression:e.expression(this.connection).getQuery();return new x(`CREATE ${t}VIEW ${r} SQL SECURITY INVOKER AS ${a}`)}async insertViewDefinitionSql(e){let{schema:t,tableName:r}=this.driver.parseTableName(e);const a=e.materialized?Ie.MATERIALIZED_VIEW:Ie.VIEW,i=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:a,schema:t,name:r,value:i})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new x(`DROP ${t}VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){let{schema:t,tableName:r}=this.driver.parseTableName(e);const a=e.materialized?Ie.MATERIALIZED_VIEW:Ie.VIEW;return this.deleteTypeormMetadataSql({type:a,schema:t,name:r})}createIndexSql(e,t){const r=t.columnNames.map(i=>this.driver.escape(i)).join(", ");let a="";return t.isUnique&&(a+="UNIQUE "),t.isNullFiltered&&(a+="NULL_FILTERED "),new x(`CREATE ${a}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${r})`)}dropIndexSql(e,t){let r=t instanceof Ct?t.name:t;return new x(`DROP INDEX \`${r}\``)}createCheckConstraintSql(e,t){return new x(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const r=t instanceof Sr?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${r}\``)}createForeignKeySql(e,t){const r=t.columnNames.map(s=>this.driver.escape(s)).join(", "),a=t.referencedColumnNames.map(s=>this.driver.escape(s)).join(",");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${r}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${a})`;return new x(i)}dropForeignKeySql(e,t){const r=t instanceof ar?t.name:t;return new x(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${r}\``)}escapePath(e){const{tableName:t}=this.driver.parseTableName(e);return`\`${t}\``}buildCreateColumnSql(e){let t=`${this.driver.escape(e.name)} ${this.connection.driver.createFullType(e)}`;return e.generatedType==="STORED"&&e.asExpression?t+=` AS (${e.asExpression}) STORED`:e.isNullable||(t+=" NOT NULL"),t}async executeQueries(e,t){if(e instanceof x&&(e=[e]),t instanceof x&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),this.sqlMemoryMode===!0)return Promise.resolve();for(const{query:r,parameters:a}of e)this.isDMLQuery(r)?await this.query(r,a):await this.updateDDL(r,a)}isDMLQuery(e){return e.startsWith("INSERT")||e.startsWith("UPDATE")||e.startsWith("DELETE")}}class xO{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="none",this.supportedDataTypes=["bool","int64","float64","numeric","string","json","bytes","date","timestamp","array"],this.supportedUpsertTypes=[],this.spatialTypes=[],this.withLengthColumnTypes=["string","bytes"],this.withWidthColumnTypes=[],this.withPrecisionColumnTypes=[],this.withScaleColumnTypes=[],this.mappedDataTypes={createDate:"timestamp",createDateDefault:"",updateDate:"timestamp",updateDateDefault:"",deleteDate:"timestamp",deleteDateNullable:!0,version:"int64",treeLevel:"int64",migrationId:"int64",migrationName:"string",migrationTimestamp:"int64",cacheId:"string",cacheIdentifier:"string",cacheTime:"int64",cacheDuration:"int64",cacheQuery:"string",cacheResult:"string",metadataType:"string",metadataDatabase:"string",metadataSchema:"string",metadataTable:"string",metadataName:"string",metadataValue:"string"},this.dataTypeDefaults={},this.maxAliasLength=63,this.cteCapabilities={enabled:!0},this._isReturningSqlSupported={delete:!1,insert:!1,update:!1},this.connection=e,this.options=e.options,this.isReplicated=!!this.options.replication,this.loadDependencies()}async connect(){this.instance=this.spanner.instance(this.options.instanceId),this.instanceDatabase=this.instance.database(this.options.databaseId)}afterConnect(){return Promise.resolve()}async disconnect(){this.instanceDatabase.close()}createSchemaBuilder(){return new fh(this.connection)}createQueryRunner(e){return new _O(this,e)}escapeQueryWithParameters(e,t,r){const a=Object.keys(r).map(i=>r[i]);return!t||!Object.keys(t).length?[e,a]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(i,s,o)=>{if(!t.hasOwnProperty(o))return i;let l=t[o];return l===null?i:s?l.map(c=>(a.push(c),this.createParameter(o,a.length-1))).join(", "):l instanceof Function?l():(a.push(l),this.createParameter(o,a.length-1))}),e=e.replace(/([ ]+)?=([ ]+)?:(\.\.\.)?([A-Za-z0-9_.]+)/g,(i,s,o,l,c)=>t.hasOwnProperty(c)&&t[c]===null?" IS NULL":i),[e,a])}escape(e){return`\`${e}\``}buildTableName(e,t,r){let a=[e];return r&&a.unshift(r),a.join(".")}parseTableName(e){const t=this.database,r=void 0;if(e instanceof _t||e instanceof va){const i=this.parseTableName(e.name);return{database:e.database||i.database||t,schema:e.schema||i.schema||r,tableName:i.tableName}}if(e instanceof ar){const i=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||i.database||t,schema:e.referencedSchema||i.schema||r,tableName:i.tableName}}if(e instanceof Mr)return{database:e.database||t,schema:e.schema||r,tableName:e.tableName};const a=e.split(".");return{database:(a.length>1?a[0]:void 0)||t,schema:r,tableName:a.length>1?a[1]:a[0]}}preparePersistentValue(e,t){return t.transformer&&(e=qt.transformTo(t.transformer,e)),e==null?e:t.type==="numeric"?(this.options.driver||ht.load("spanner")).Spanner.numeric(e):t.type==="date"?Pe.mixedDateToDateString(e):t.type==="json"?e:t.type==="timestamp"||t.type===Date?Pe.mixedDateToDate(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?qt.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="bool"?e=!!e:t.type==="timestamp"||t.type===Date?e=new Date(e):t.type==="numeric"?e=e.value:t.type==="date"?e=Pe.mixedDateToDateString(e):t.type==="json"?e=typeof e=="string"?JSON.parse(e):e:t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=qt.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number?"int64":e.type===String||e.type==="uuid"?"string":e.type===Date?"timestamp":e.type===Buffer?"bytes":e.type===Boolean?"bool":e.type||""}normalizeDefault(e){return e.default===""?`"${e.default}"`:`${e.default}`}normalizeIsUnique(e){return e.entityMetadata.indices.some(t=>t.isUnique&&t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){if(e.length)return e.length.toString();if(e.generationStrategy==="uuid")return"36";switch(e.type){case String:case"string":case"bytes":return"max";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+=`(${e.precision},${e.scale})`:e.precision!==null&&e.precision!==void 0&&(t+=`(${e.precision})`),e.isArray&&(t=`array<${t}>`),t}obtainMasterConnection(){return this.instanceDatabase}obtainSlaveConnection(){return this.instanceDatabase}createGeneratedMap(e,t,r){if(!t)return;if(t.insertId===void 0)return Object.keys(t).reduce((i,s)=>{const o=e.findColumnWithDatabaseName(s);return o&&Ee.mergeDeep(i,o.createValueMap(t[s])),i},{});const a=e.generatedColumns.reduce((i,s)=>{let o;return s.generationStrategy==="increment"&&t.insertId&&(o=t.insertId+r),Ee.mergeDeep(i,s.createValueMap(o))},{});return Object.keys(a).length>0?a:void 0}findChangedColumns(e,t){return t.filter(r=>{const a=e.find(i=>i.name===r.databaseName);return a?a.name!==r.databaseName||a.type!==this.normalizeType(r)||a.length!==this.getColumnLength(r)||a.asExpression!==r.asExpression||a.generatedType!==r.generatedType||a.isPrimary!==r.isPrimary||!this.compareNullableValues(r,a)||a.isUnique!==this.normalizeIsUnique(r):!1})}isReturningSqlSupported(e){return this._isReturningSqlSupported[e]}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"@param"+t}loadDependencies(){try{const e=this.options.driver||ht.load("spanner");this.spanner=new e.Spanner({projectId:this.options.projectId})}catch(e){throw console.error(e),new Xs("Spanner","@google-cloud/spanner")}}compareNullableValues(e,t){return e.generatedType?!0:e.isNullable===t.isNullable}compareDefaultValues(e,t){return typeof e=="string"&&typeof t=="string"&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}normalizeDatetimeFunction(e){if(!e)return e;if(e.toUpperCase().indexOf("CURRENT_TIMESTAMP")!==-1||e.toUpperCase().indexOf("NOW")!==-1){const t=e.match(/\(\d+\)/);return t?`CURRENT_TIMESTAMP${t[0]}`:"CURRENT_TIMESTAMP"}else return e}escapeComment(e){return e&&(e=e.replace(/\u0000/g,""),e)}}class PO{create(e){const{type:t}=e.options;switch(t){case"mysql":return new ww(e);case"postgres":return new Ew(e);case"cockroachdb":return new NM(e);case"sap":return new AM(e);case"mariadb":return new ww(e);case"sqlite":return new RM(e);case"better-sqlite3":return new MM(e);case"cordova":return new dO(e);case"nativescript":return new yO(e);case"react-native":return new mO(e);case"sqljs":return new bO(e);case"oracle":return new SM(e);case"mssql":return new CM(e);case"mongodb":return new EM(e);case"expo":return new EO(e);case"aurora-mysql":return new TO(e);case"aurora-postgres":return new RO(e);case"capacitor":return new OO(e);case"spanner":return new xO(e);default:throw new sM(t,["aurora-mysql","aurora-postgres","better-sqlite3","capacitor","cockroachdb","cordova","expo","mariadb","mongodb","mssql","mysql","nativescript","oracle","postgres","react-native","sap","sqlite","sqljs","spanner"])}}}function cf(n,e,t=[".js",".cjs",".ts"]){return[]}const IO=new class{constructor(){this.instances=[]}get(n){let e=this.instances.find(t=>t.type===n);return e||(e={type:n,object:new n},this.instances.push(e)),e.object}};function Iw(n){return IO.get(n)}class ir{constructor(e){this["@instanceof"]=Symbol.for("ColumnMetadata"),this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isVirtualProperty=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isDeleteDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),e.args.options.default===null&&(this.isNullable=!0),e.args.options.nullable!==void 0&&(this.isNullable=e.args.options.nullable),e.args.options.select!==void 0&&(this.isSelect=e.args.options.select),e.args.options.insert!==void 0&&(this.isInsert=e.args.options.insert),e.args.options.update!==void 0&&(this.isUpdate=e.args.options.update),e.args.options.readonly!==void 0&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),e.args.options.default!==void 0&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),e.args.options.generatedIdentity&&(this.generatedIdentity=e.args.options.generatedIdentity),e.args.options.scale!==null&&e.args.options.scale!==void 0&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),e.args.options.precision!==null&&(this.precision=e.args.options.precision),e.args.options.enum&&(Ue.isObject(e.args.options.enum)&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter(t=>isNaN(+t)&&typeof e.args.options.enum[t]!="function").map(t=>e.args.options.enum[t]):this.enum=e.args.options.enum),e.args.options.enumName&&(this.enumName=e.args.options.enumName),e.args.options.primaryKeyConstraintName&&(this.primaryKeyConstraintName=e.args.options.primaryKeyConstraintName),e.args.options.foreignKeyConstraintName&&(this.foreignKeyConstraintName=e.args.options.foreignKeyConstraintName),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtualProperty=e.args.mode==="virtual-property",this.isVirtual=e.args.mode==="virtual",this.isTreeLevel=e.args.mode==="treeLevel",this.isCreateDate=e.args.mode==="createDate",this.isUpdateDate=e.args.mode==="updateDate",this.isDeleteDate=e.args.mode==="deleteDate",this.isVersion=e.args.mode==="version",this.isObjectId=e.args.mode==="objectId"),this.isVirtualProperty&&(this.isInsert=!1,this.isUpdate=!1),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),e.args.options.srid!==void 0&&(this.srid=e.args.options.srid),e.args.options.query&&(this.query=e.args.options.query),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.createDateDefault),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.updateDateDefault),this.onUpdate||(this.onUpdate=e.connection.driver.mappedDataTypes.updateDateDefault),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isDeleteDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.deleteDate),this.isNullable||(this.isNullable=e.connection.driver.mappedDataTypes.deleteDateNullable),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.deleteDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.deleteDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}createValueMap(e,t=!1){if(this.embeddedMetadata){const r=[...this.embeddedMetadata.parentPropertyNames],a=(i,s)=>{const o=i.shift();return o?(s[o]={},a(i,s[o]),s):((this.generationStrategy==="increment"||this.generationStrategy==="rowid")&&this.type==="bigint"&&e!==null&&(e=String(e)),s[t?this.databaseName:this.propertyName]=e,s)};return a(r,{})}else return(this.generationStrategy==="increment"||this.generationStrategy==="rowid")&&this.type==="bigint"&&e!==null&&(e=String(e)),{[t?this.databaseName:this.propertyName]:e}}getEntityValueMap(e,t){var r;if(this.embeddedMetadata){const a=[...this.embeddedMetadata.parentPropertyNames],i=this.embeddedMetadata.isArray,s=(l,c)=>{if(c===void 0)return{};const u=l.shift();if(u){const h=s(l,c[u]);return Object.keys(h).length>0?{[u]:h}:{}}return i&&Array.isArray(c)?c.map(h=>({[this.propertyName]:h[this.propertyName]})):c[this.propertyName]!==void 0?{[this.propertyName]:c[this.propertyName]}:{}},o=s(a,e);return Object.keys(o).length>0?o:void 0}else if(this.relationMetadata&&!(!((r=Object.getOwnPropertyDescriptor(e,this.relationMetadata.propertyName))===null||r===void 0)&&r.get)&&e[this.relationMetadata.propertyName]&&Ue.isObject(e[this.relationMetadata.propertyName])){const a=this.relationMetadata.joinColumns.reduce((i,s)=>{const o=s.referencedColumn.getEntityValueMap(e[this.relationMetadata.propertyName]);return o===void 0?i:Ee.mergeDeep(i,o)},{});return Object.keys(a).length>0?{[this.propertyName]:a}:void 0}else return e[this.propertyName]!==void 0?{[this.propertyName]:e[this.propertyName]}:void 0}getEntityValue(e,t=!1){if(e==null)return;let r;if(this.embeddedMetadata){const a=[...this.embeddedMetadata.parentPropertyNames],i=this.embeddedMetadata.isArray,s=(l,c)=>{const u=l.shift();return u&&c?s(l,c[u]):c},o=s(a,e);if(o)if(this.relationMetadata&&this.referencedColumn){const l=this.relationMetadata.getEntityValue(o);l&&Ue.isObject(l)&&!F.isFindOperator(l)&&!Buffer.isBuffer(l)?r=this.referencedColumn.getEntityValue(l):o[this.propertyName]&&Ue.isObject(o[this.propertyName])&&!F.isFindOperator(o[this.propertyName])&&!Buffer.isBuffer(o[this.propertyName])&&!(o[this.propertyName]instanceof Date)?r=this.referencedColumn.getEntityValue(o[this.propertyName]):r=o[this.propertyName]}else this.referencedColumn?r=this.referencedColumn.getEntityValue(o[this.propertyName]):i&&Array.isArray(o)?r=o.map(l=>l[this.propertyName]):r=o[this.propertyName]}else if(this.relationMetadata&&this.referencedColumn){const a=this.relationMetadata.getEntityValue(e);a&&Ue.isObject(a)&&!F.isFindOperator(a)&&typeof a!="function"&&!Buffer.isBuffer(a)?r=this.referencedColumn.getEntityValue(a):e[this.propertyName]&&Ue.isObject(e[this.propertyName])&&!F.isFindOperator(e[this.propertyName])&&typeof e[this.propertyName]!="function"&&!Buffer.isBuffer(e[this.propertyName])&&!(e[this.propertyName]instanceof Date)?r=this.referencedColumn.getEntityValue(e[this.propertyName]):r=e[this.propertyName]}else this.referencedColumn?r=this.referencedColumn.getEntityValue(e[this.propertyName]):r=e[this.propertyName];return t&&this.transformer&&(r=qt.transformTo(this.transformer,r)),r}setEntityValue(e,t){if(this.embeddedMetadata){const r=(a,i)=>{const s=a.shift();return s?(i[s.propertyName]||(i[s.propertyName]=s.create()),r(a,i[s.propertyName]),i):(i[this.propertyName]=t,i)};return r([...this.embeddedMetadata.embeddedMetadataTree],e)}else!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName?(this.propertyName in e||(e[this.propertyName]={}),e[this.propertyName][this.referencedColumn.propertyName]=t):e[this.propertyName]=t}compareEntityValue(e,t){const r=this.getEntityValue(e);return Ue.isObject(r)?r.equals(t):r===t}build(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this}buildPropertyPath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e}buildDatabasePath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e}buildDatabaseName(e){let t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return e.driver.options.type==="mongodb"&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)}}class Or{constructor(e){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.isNullFiltered=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,e.args.synchronize!==null&&e.args.synchronize!==void 0&&(this.synchronize=e.args.synchronize),this.isUnique=!!e.args.unique,this.isSpatial=!!e.args.spatial,this.isFulltext=!!e.args.fulltext,this.isNullFiltered=!!e.args.nullFiltered,this.parser=e.args.parser,this.where=e.args.where,this.isSparse=e.args.sparse,this.isBackground=e.args.background,this.expireAfterSeconds=e.args.expireAfterSeconds,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}build(e){if(this.synchronize===!1)return this.name=this.givenName,this;const t={};if(this.givenColumnNames){let r=[];if(Array.isArray(this.givenColumnNames))r=this.givenColumnNames.map(a=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+a:a.trim()),r.forEach(a=>t[a]=1);else{const a=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(a)?(r=a.map(i=>String(i)),r.forEach(i=>t[i]=1)):(r=Object.keys(a).map(i=>String(i)),Object.keys(a).forEach(i=>t[i]=a[i]))}this.columns=r.map(a=>{const i=this.entityMetadata.columns.find(c=>c.propertyPath===a);if(i)return[i];const s=this.entityMetadata.relations.find(c=>c.isWithJoinColumn&&c.propertyName===a);if(s)return s.joinColumns;const o=this.givenName?'"'+this.givenName+'" ':"",l=this.entityMetadata.targetName;throw new $(`Index ${o}contains column that is missing in the entity (${l}): `+a)}).reduce((a,i)=>a.concat(i))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce((r,a)=>{const i=this.entityMetadata.columns.find(s=>s.propertyPath===a);return i&&(r[i.databasePath]=t[a]),r},{}),this.name=this.givenName?this.givenName:e.indexName(this.entityMetadata.tableName,this.columns.map(r=>r.databaseName),this.where),this}}class Dw{constructor(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isCascadeSoftRemove=!1,this.isCascadeRecover=!1,this.isNullable=!0,this.createForeignKeyConstraints=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;const t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("insert")!==-1,this.isCascadeUpdate=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("update")!==-1,this.isCascadeRemove=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("remove")!==-1,this.isCascadeSoftRemove=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("soft-remove")!==-1,this.isCascadeRecover=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("recover")!==-1,this.isNullable=!(t.options.nullable===!1||this.isPrimary),this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.createForeignKeyConstraints=t.options.createForeignKeyConstraints!==!1,this.isEager=t.options.eager||!1,this.persistenceEnabled=t.options.persistence!==!1,this.orphanedRowAction=t.options.orphanedRowAction||"nullify",this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,typeof t.type=="function"?this.type=typeof t.type=="function"?t.type():t.type:F.isEntitySchema(t.type)?this.type=t.type.options.name:Ue.isObject(t.type)&&typeof t.type.name=="string"?this.type=t.type.name:this.type=t.type,this.isOneToOne=this.relationType==="one-to-one",this.isOneToMany=this.relationType==="one-to-many",this.isManyToOne=this.relationType==="many-to-one",this.isManyToMany=this.relationType==="many-to-many",this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}getRelationIdMap(e){const t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(r=>r.referencedColumn);return Mr.getValueMap(e,t)}ensureRelationIdMap(e){if(Ue.isObject(e))return e;const t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(r=>r.referencedColumn);if(t.length>1)throw new $("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return t[0].createValueMap(e)}getEntityValue(e,t=!1){if(e!=null)if(this.embeddedMetadata){const r=[...this.embeddedMetadata.parentPropertyNames],a=(s,o)=>{const l=s.shift();return l?o[l]?a(s,o[l]):void 0:o},i=a(r,e);return this.isLazy?i["__"+this.propertyName+"__"]!==void 0?i["__"+this.propertyName+"__"]:t===!0?i[this.propertyName]:void 0:i?i[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}else return this.isLazy?e["__"+this.propertyName+"__"]!==void 0?e["__"+this.propertyName+"__"]:t===!0?e[this.propertyName]:void 0:e[this.propertyName]}setEntityValue(e,t){const r=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){const a=(i,s)=>{const o=i.shift();return o?(s[o.propertyName]||(s[o.propertyName]=o.create()),a(i,s[o.propertyName]),s):(s[r]=t,s)};return a([...this.embeddedMetadata.embeddedMetadataTree],e)}else e[r]=t}createValueMap(e){if(this.embeddedMetadata){const t=[...this.embeddedMetadata.parentPropertyNames],r=(a,i)=>{const s=a.shift();return s?(i[s]={},r(a,i[s]),i):(i[this.propertyName]=e,i)};return r(t,{})}else return{[this.propertyName]:e}}build(){this.propertyPath=this.buildPropertyPath()}registerForeignKeys(...e){this.foreignKeys.push(...e)}registerJoinColumns(e=[],t=[]){this.joinColumns=e,this.inverseJoinColumns=t,this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner}registerJunctionEntityMetadata(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)}buildInverseSidePropertyPath(){if(this.givenInverseSidePropertyFactory){const e=this.inverseEntityMetadata.propertiesMap;if(typeof this.givenInverseSidePropertyFactory=="function")return this.givenInverseSidePropertyFactory(e);if(typeof this.givenInverseSidePropertyFactory=="string")return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""}buildPropertyPath(){return!this.embeddedMetadata||!this.embeddedMetadata.parentPropertyNames.length?this.propertyName:this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName}}class DO{constructor(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isAlwaysUsingConstructor=!0,this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}create(e){return typeof this.type!="function"?{}:e!=null&&e.fromDeserializer||!this.isAlwaysUsingConstructor?Object.create(this.type.prototype):new this.type}build(e){return this.embeddeds.forEach(t=>t.build(e)),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),e.options.entitySkipConstructor&&(this.isAlwaysUsingConstructor=!e.options.entitySkipConstructor),this}buildPartialPrefix(){if(this.customPrefix===void 0||this.customPrefix===!0)return[this.propertyName];if(this.customPrefix===""||this.customPrefix===!1)return[];if(typeof this.customPrefix=="string")return[this.customPrefix];throw new $(`Invalid prefix option given for ${this.entityMetadata.targetName}#${this.propertyName}`)}buildPrefix(e){if(e.driver.options.type==="mongodb")return this.propertyName;let t=[];return this.parentEmbeddedMetadata&&t.push(this.parentEmbeddedMetadata.buildPrefix(e)),t.push(...this.buildPartialPrefix()),t.join("_")}buildParentPropertyNames(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]}buildParentPrefixes(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()}buildEmbeddedMetadataTree(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]}buildColumnsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildColumnsFromTree()),this.columns)}buildRelationsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationsFromTree()),this.relations)}buildListenersFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildListenersFromTree()),this.listeners)}buildIndicesFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildIndicesFromTree()),this.indices)}buildUniquesFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildUniquesFromTree()),this.uniques)}buildRelationIdsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationIdsFromTree()),this.relationIds)}buildRelationCountsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationCountsFromTree()),this.relationCounts)}}class Lw{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}setValue(e){const t=this.relation.getEntityValue(e);if(Array.isArray(t))e[this.propertyName]=t.map(r=>this.relation.inverseEntityMetadata.getEntityIdMixedMap(r)).filter(r=>r!=null);else{const r=this.relation.inverseEntityMetadata.getEntityIdMixedMap(t);r!==void 0&&(e[this.propertyName]=r)}}build(){const e=typeof this.relationNameOrFactory=="function"?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new $(`Cannot find relation ${e}. Wrong relation specified for @RelationId decorator.`);this.relation=t}}class qw{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}build(){const e=typeof this.relationNameOrFactory=="function"?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new $(`Cannot find relation ${e}. Wrong relation specified for @RelationCount decorator.`);this.relation=t}}class At{}At.AFTER_LOAD="after-load",At.BEFORE_INSERT="before-insert",At.AFTER_INSERT="after-insert",At.BEFORE_UPDATE="before-update",At.AFTER_UPDATE="after-update",At.BEFORE_REMOVE="before-remove",At.AFTER_REMOVE="after-remove",At.BEFORE_SOFT_REMOVE="before-soft-remove",At.AFTER_SOFT_REMOVE="after-soft-remove",At.BEFORE_RECOVER="before-recover",At.AFTER_RECOVER="after-recover";class kl{constructor(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,this.givenName=e.name,e.namingStrategy&&this.build(e.namingStrategy)}build(e){this.columnNames=this.columns.map(t=>t.databaseName),this.referencedColumnNames=this.referencedColumns.map(t=>t.databaseName),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=this.givenName?this.givenName:e.foreignKeyName(this.entityMetadata.tableName,this.columnNames,this.referencedEntityMetadata.tableName,this.referencedColumnNames)}}class LO{constructor(e){this.connection=e}build(e,t){var r,a;const i=this.collectReferencedColumns(e,t),s=this.collectInverseReferencedColumns(e,t),o=t.name||this.connection.namingStrategy.joinTableName(e.entityMetadata.tableNameWithoutPrefix,e.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyPath,e.inverseRelation?e.inverseRelation.propertyName:""),l=new Mr({connection:this.connection,args:{target:"",name:o,type:"junction",database:t.database||e.entityMetadata.database,schema:t.schema||e.entityMetadata.schema,synchronize:t.synchronize}});l.build();const c=i.map(h=>{const d=t.joinColumns?t.joinColumns.find(g=>(!g.referencedColumnName||g.referencedColumnName===h.propertyName)&&!!g.name):void 0,f=d&&d.name?d.name:this.connection.namingStrategy.joinTableColumnName(e.entityMetadata.tableNameWithoutPrefix,h.propertyName,h.databaseName);return new ir({connection:this.connection,entityMetadata:l,referencedColumn:h,args:{target:"",mode:"virtual",propertyName:f,options:{name:f,length:!h.length&&(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(h)!=="uuid"&&(h.generationStrategy==="uuid"||h.type==="uuid")?"36":h.length,width:h.width,type:h.type,precision:h.precision,scale:h.scale,charset:h.charset,collation:h.collation,zerofill:h.zerofill,unsigned:h.zerofill?!0:h.unsigned,enum:h.enum,enumName:h.enumName,foreignKeyConstraintName:d==null?void 0:d.foreignKeyConstraintName,nullable:!1,primary:!0}}})}),u=s.map(h=>{const d=t.inverseJoinColumns?t.inverseJoinColumns.find(g=>(!g.referencedColumnName||g.referencedColumnName===h.propertyName)&&!!g.name):void 0,f=d&&d.name?d.name:this.connection.namingStrategy.joinTableInverseColumnName(e.inverseEntityMetadata.tableNameWithoutPrefix,h.propertyName,h.databaseName);return new ir({connection:this.connection,entityMetadata:l,referencedColumn:h,args:{target:"",mode:"virtual",propertyName:f,options:{length:!h.length&&(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(h)!=="uuid"&&(h.generationStrategy==="uuid"||h.type==="uuid")?"36":h.length,width:h.width,type:h.type,precision:h.precision,scale:h.scale,charset:h.charset,collation:h.collation,zerofill:h.zerofill,unsigned:h.zerofill?!0:h.unsigned,enum:h.enum,enumName:h.enumName,foreignKeyConstraintName:d==null?void 0:d.foreignKeyConstraintName,name:f,nullable:!1,primary:!0}}})});return this.changeDuplicatedColumnNames(c,u),l.ownerColumns=c,l.inverseColumns=u,l.ownColumns=[...c,...u],l.ownColumns.forEach(h=>h.relationMetadata=e),l.foreignKeys=e.createForeignKeyConstraints?[new kl({entityMetadata:l,referencedEntityMetadata:e.entityMetadata,columns:c,referencedColumns:i,name:(r=c[0])===null||r===void 0?void 0:r.foreignKeyConstraintName,onDelete:this.connection.driver.options.type==="spanner"?"NO ACTION":e.onDelete||"CASCADE",onUpdate:this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="spanner"?"NO ACTION":e.onUpdate||"CASCADE"}),new kl({entityMetadata:l,referencedEntityMetadata:e.inverseEntityMetadata,columns:u,referencedColumns:s,name:(a=u[0])===null||a===void 0?void 0:a.foreignKeyConstraintName,onDelete:this.connection.driver.options.type==="spanner"?"NO ACTION":e.inverseRelation?e.inverseRelation.onDelete:"CASCADE",onUpdate:this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="spanner"?"NO ACTION":e.inverseRelation?e.inverseRelation.onUpdate:"CASCADE"})]:[],l.ownIndices=[new Or({entityMetadata:l,columns:c,args:{target:l.target,synchronize:!0}}),new Or({entityMetadata:l,columns:u,args:{target:l.target,synchronize:!0}})],l}collectReferencedColumns(e,t){const r=t.joinColumns?t.joinColumns.find(a=>!!a.referencedColumnName):!1;return!t.joinColumns||t.joinColumns&&!r?e.entityMetadata.columns.filter(a=>a.isPrimary):t.joinColumns.map(a=>{const i=e.entityMetadata.columns.find(s=>s.propertyName===a.referencedColumnName);if(!i)throw new $(`Referenced column ${a.referencedColumnName} was not found in entity ${e.entityMetadata.name}`);return i})}collectInverseReferencedColumns(e,t){const r=!!t.inverseJoinColumns,a=r?t.inverseJoinColumns.find(i=>!!i.referencedColumnName):!1;return!r||r&&!a?e.inverseEntityMetadata.primaryColumns:t.inverseJoinColumns.map(i=>{const s=e.inverseEntityMetadata.ownColumns.find(o=>o.propertyName===i.referencedColumnName);if(!s)throw new $(`Referenced column ${i.referencedColumnName} was not found in entity ${e.inverseEntityMetadata.name}`);return s})}changeDuplicatedColumnNames(e,t){e.forEach(r=>{t.forEach(a=>{if(r.givenDatabaseName===a.givenDatabaseName){const i=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(r.propertyName,1);r.propertyName=i,r.givenDatabaseName=i;const s=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(a.propertyName,2);a.propertyName=s,a.givenDatabaseName=s}})})}}class qO{constructor(e){this.connection=e}build(e){const t=new Mr({parentClosureEntityMetadata:e,connection:this.connection,args:{target:"",name:e.treeOptions&&e.treeOptions.closureTableName?e.treeOptions.closureTableName:e.tableNameWithoutPrefix,type:"closure-junction"}});return t.build(),e.primaryColumns.forEach(r=>{t.ownColumns.push(new ir({connection:this.connection,entityMetadata:t,closureType:"ancestor",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.ancestorColumnName?e.treeOptions.ancestorColumnName(r):r.propertyName+"_ancestor",options:{primary:!0,length:r.length,type:r.type}}})),t.ownColumns.push(new ir({connection:this.connection,entityMetadata:t,closureType:"descendant",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.descendantColumnName?e.treeOptions.descendantColumnName(r):r.propertyName+"_descendant",options:{primary:!0,length:r.length,type:r.type}}}))}),t.ownIndices=[new Or({entityMetadata:t,columns:[t.ownColumns[0]],args:{target:t.target,synchronize:!0}}),new Or({entityMetadata:t,columns:[t.ownColumns[1]],args:{target:t.target,synchronize:!0}})],e.treeLevelColumn&&t.ownColumns.push(new ir({connection:this.connection,entityMetadata:t,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),t.foreignKeys=[new kl({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[0]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver.options.type==="mssql"?"NO ACTION":"CASCADE"}),new kl({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[1]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver.options.type==="mssql"?"NO ACTION":"CASCADE"})],t}}class bh{constructor(e){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,this.givenName=e.args.name,this.givenColumnNames=e.args.columns,this.deferrable=e.args.deferrable)}build(e){const t={};if(this.givenColumnNames){let r=[];if(Array.isArray(this.givenColumnNames))r=this.givenColumnNames.map(a=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+a:a.trim()),r.forEach(a=>t[a]=1);else{const a=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(a)?(r=a.map(i=>String(i)),r.forEach(i=>t[i]=1)):(r=Object.keys(a).map(i=>String(i)),Object.keys(a).forEach(i=>t[i]=a[i]))}this.columns=r.map(a=>{const i=this.entityMetadata.columns.find(c=>c.propertyPath===a);if(i)return[i];const s=this.entityMetadata.relations.find(c=>c.isWithJoinColumn&&c.propertyName===a);if(s)return s.joinColumns;const o=this.givenName?'"'+this.givenName+'" ':"",l=this.entityMetadata.targetName;throw new $(`Unique constraint ${o}contains column that is missing in the entity (${l}): `+a)}).reduce((a,i)=>a.concat(i))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce((r,a)=>{const i=this.entityMetadata.columns.find(s=>s.propertyPath===a);return i&&(r[i.databasePath]=t[a]),r},{}),this.name=this.givenName?this.givenName:e.uniqueConstraintName(this.entityMetadata.tableName,this.columns.map(r=>r.databaseName)),this}}class $O{constructor(e){this.connection=e}build(e,t){var r;const a=this.collectReferencedColumns(e,t),i=this.collectColumns(e,t,a);if(!a.length||!t.createForeignKeyConstraints)return{foreignKey:void 0,columns:i,uniqueConstraint:void 0};const s=new kl({name:(r=e[0])===null||r===void 0?void 0:r.foreignKeyConstraintName,entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:i,referencedColumns:a,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if(i.every(l=>l.isPrimary)||!t.isOneToOne)return{foreignKey:s,columns:i,uniqueConstraint:void 0};const o=new bh({entityMetadata:t.entityMetadata,columns:s.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tableName,s.columns.map(l=>l.databaseName)),target:t.entityMetadata.target}});return o.build(this.connection.namingStrategy),{foreignKey:s,columns:i,uniqueConstraint:o}}collectReferencedColumns(e,t){const r=e.find(s=>!!s.referencedColumnName),a=e.length===0&&t.isManyToOne,i=e.length>0&&!r;return a||i?t.inverseEntityMetadata.primaryColumns:e.map(s=>{const o=t.inverseEntityMetadata.ownColumns.find(l=>l.propertyName===s.referencedColumnName);if(!o)throw new $(`Referenced column ${s.referencedColumnName} was not found in entity ${t.inverseEntityMetadata.name}`);return o})}collectColumns(e,t,r){return r.map(a=>{const i=e.find(l=>(!l.referencedColumnName||l.referencedColumnName===a.propertyName)&&!!l.name),s=i?i.name:this.connection.namingStrategy.joinColumnName(t.propertyName,a.propertyName);let o=(t.embeddedMetadata?t.embeddedMetadata.columns:t.entityMetadata.ownColumns).find(l=>l.databaseNameWithoutPrefixes===s);return o||(o=new ir({connection:this.connection,entityMetadata:t.entityMetadata,embeddedMetadata:t.embeddedMetadata,args:{target:"",mode:"virtual",propertyName:t.propertyName,options:{name:s,type:a.type,length:!a.length&&(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(a)!=="uuid"&&(a.generationStrategy==="uuid"||a.type==="uuid")?"36":a.length,width:a.width,charset:a.charset,collation:a.collation,precision:a.precision,scale:a.scale,zerofill:a.zerofill,unsigned:a.unsigned,comment:a.comment,enum:a.enum,enumName:a.enumName,primary:t.isPrimary,nullable:t.isNullable}}}),t.entityMetadata.registerColumn(o)),o.referencedColumn=a,o.type=a.type,o.relationMetadata=t,o.build(this.connection),o})}}class $w{constructor(e){this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.type=e.args.type}isAllowed(e){return this.entityMetadata.target===e.constructor||typeof this.entityMetadata.target=="function"&&e.constructor.prototype instanceof this.entityMetadata.target}execute(e){if(!this.embeddedMetadata)return e[this.propertyName]();this.callEntityEmbeddedMethod(e,this.embeddedMetadata.propertyPath.split("."))}callEntityEmbeddedMethod(e,t){const r=t.shift();!r||!e[r]||(t.length===0?Array.isArray(e[r])?e[r].map(a=>a[this.propertyName]()):e[r][this.propertyName]():e[r]&&this.callEntityEmbeddedMethod(e[r],t))}}class kO{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.checkConstraintName(this.entityMetadata.tableName,this.expression),this}}class jO{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.exclusionConstraintName(this.entityMetadata.tableName,this.expression),this}}class kw{constructor(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new LO(e),this.closureJunctionEntityMetadataBuilder=new qO(e),this.relationJoinColumnBuilder=new $O(e)}build(e){const t=(e?this.metadataArgsStorage.filterTables(e):this.metadataArgsStorage.tables).filter(r=>r.type==="regular"||r.type==="closure"||r.type==="entity-child"||r.type==="view").map(r=>this.createEntityMetadata(r));return t.forEach(r=>this.computeParentEntityMetadata(t,r)),t.forEach(r=>{r.childEntityMetadatas=t.filter(a=>typeof r.target=="function"&&typeof a.target=="function"&&ah.isInherited(a.target,r.target))}),t.filter(r=>r.tableType!=="entity-child").forEach(r=>r.build()),t.filter(r=>r.tableType==="entity-child").forEach(r=>r.build()),t.filter(r=>r.tableType!=="entity-child").forEach(r=>this.computeEntityMetadataStep1(t,r)),t.filter(r=>r.tableType==="entity-child").forEach(r=>this.computeEntityMetadataStep1(t,r)),t.forEach(r=>this.computeEntityMetadataStep2(r)),t.forEach(r=>this.computeInverseProperties(r,t)),t.filter(r=>r.tableType!=="entity-child").forEach(r=>{r.relations.filter(a=>a.isOneToOne||a.isManyToOne).forEach(a=>{const i=this.metadataArgsStorage.filterJoinColumns(a.target,a.propertyName),{foreignKey:s,columns:o,uniqueConstraint:l}=this.relationJoinColumnBuilder.build(i,a);if(s&&(a.registerForeignKeys(s),r.foreignKeys.push(s)),o&&a.registerJoinColumns(o),l)if(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="mssql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){const c=new Or({entityMetadata:l.entityMetadata,columns:l.columns,args:{target:l.target,name:l.name,unique:!0,synchronize:!0}});this.connection.driver.options.type==="mssql"&&(c.where=c.columns.map(u=>`${this.connection.driver.escape(u.databaseName)} IS NOT NULL`).join(" AND ")),this.connection.driver.options.type==="spanner"&&(c.isNullFiltered=!0),a.embeddedMetadata?a.embeddedMetadata.indices.push(c):a.entityMetadata.ownIndices.push(c),this.computeEntityMetadataStep2(r)}else a.embeddedMetadata?a.embeddedMetadata.uniques.push(l):a.entityMetadata.ownUniques.push(l),this.computeEntityMetadataStep2(r);if(s&&this.connection.driver.options.type==="cockroachdb"){const c=new Or({entityMetadata:a.entityMetadata,columns:s.columns,args:{target:a.entityMetadata.target,synchronize:!0}});a.embeddedMetadata?a.embeddedMetadata.indices.push(c):a.entityMetadata.ownIndices.push(c),this.computeEntityMetadataStep2(r)}}),r.relations.filter(a=>a.isManyToMany).forEach(a=>{const i=this.metadataArgsStorage.findJoinTable(a.target,a.propertyName);if(!i)return;const s=this.junctionEntityMetadataBuilder.build(a,i);a.registerForeignKeys(...s.foreignKeys),a.registerJoinColumns(s.ownIndices[0].columns,s.ownIndices[1].columns),a.registerJunctionEntityMetadata(s),this.computeEntityMetadataStep2(s),this.computeInverseProperties(s,t),t.push(s)})}),t.forEach(r=>{r.relationsWithJoinColumns=r.relations.filter(a=>a.isWithJoinColumn),r.hasNonNullableRelations=r.relationsWithJoinColumns.some(a=>!a.isNullable||a.isPrimary)}),t.filter(r=>r.treeType==="closure-table").forEach(r=>{const a=this.closureJunctionEntityMetadataBuilder.build(r);r.closureJunctionTable=a,this.computeEntityMetadataStep2(a),this.computeInverseProperties(a,t),t.push(a)}),t.filter(r=>r.inheritancePattern==="STI"&&r.discriminatorColumn).forEach(r=>this.createKeysForTableInheritance(r)),t.forEach(r=>{r.indices.forEach(a=>a.build(this.connection.namingStrategy))}),t.forEach(r=>{r.uniques.forEach(a=>a.build(this.connection.namingStrategy))}),t.forEach(r=>{r.checks.forEach(a=>a.build(this.connection.namingStrategy))}),t.forEach(r=>{r.exclusions.forEach(a=>a.build(this.connection.namingStrategy))}),t.filter(r=>typeof r.target=="function").forEach(r=>{r.relations.filter(a=>a.isLazy).forEach(a=>{this.connection.relationLoader.enableLazyLoad(a,r.target.prototype)})}),t.forEach(r=>{r.columns.forEach(a=>{const i=this.metadataArgsStorage.findGenerated(a.target,a.propertyName);i&&(a.isGenerated=!0,a.generationStrategy=i.strategy,i.strategy==="uuid"?a.type="uuid":i.strategy==="rowid"?a.type="int":a.type=a.type||Number,a.build(this.connection),this.computeEntityMetadataStep2(r))})}),t}createEntityMetadata(e){const t=typeof e.target=="function"?ah.getInheritanceTree(e.target):[e.target],r=this.metadataArgsStorage.findInheritanceType(e.target),a=this.metadataArgsStorage.findTree(e.target);let i;return(r&&r.pattern==="STI"||e.type==="entity-child")&&(i=this.metadataArgsStorage.filterSingleTableChildren(e.target).map(s=>s.target).filter(s=>typeof s=="function"),t.push(...i)),new Mr({connection:this.connection,args:e,inheritanceTree:t,tableTree:a,inheritancePattern:r?r.pattern:void 0})}computeParentEntityMetadata(e,t){t.tableType==="entity-child"&&(t.parentEntityMetadata=e.find(r=>r.inheritanceTree.indexOf(t.target)!==-1&&r.inheritancePattern==="STI"))}computeEntityMetadataStep1(e,t){const r=this.metadataArgsStorage.findInheritanceType(t.target),a=this.metadataArgsStorage.findDiscriminatorValue(t.target);if(typeof a<"u"?t.discriminatorValue=a.value:t.discriminatorValue=t.target.name,t.embeddeds=this.createEmbeddedsRecursively(t,this.metadataArgsStorage.filterEmbeddeds(t.inheritanceTree)).map(s=>(t.inheritancePattern==="STI"&&(s.columns=s.columns.map(o=>(o.isNullable=!0,o))),s)),t.ownColumns=this.metadataArgsStorage.filterColumns(t.inheritanceTree).map(s=>{if(t.tableType==="entity-child")return t.parentEntityMetadata.ownColumns.find(l=>l.propertyName===s.propertyName);const o=new ir({connection:this.connection,entityMetadata:t,args:s});return e.find(l=>l.tableType==="entity-child"&&l.target===s.target)&&(o.isNullable=!0),o}),r&&r.column){const s=r.column&&r.column.name?r.column.name:"type";let o=t.ownColumns.find(l=>l.propertyName===s);o?o.isDiscriminator=!0:(o=new ir({connection:this.connection,entityMetadata:t,args:{target:t.target,mode:"virtual",propertyName:s,options:r.column||{name:s,type:"varchar",nullable:!1}}}),o.isVirtual=!0,o.isDiscriminator=!0,t.ownColumns.push(o))}if(t.tableType==="entity-child"){const s=t.parentEntityMetadata.ownColumns.find(o=>o.isDiscriminator);s&&!t.ownColumns.find(o=>o===s)&&t.ownColumns.push(s),t.inheritancePattern=t.parentEntityMetadata.inheritancePattern,!t.treeType&&t.parentEntityMetadata.treeType&&(t.treeType=t.parentEntityMetadata.treeType,t.treeOptions=t.parentEntityMetadata.treeOptions,t.treeParentRelation=t.parentEntityMetadata.treeParentRelation,t.treeLevelColumn=t.parentEntityMetadata.treeLevelColumn)}const{namingStrategy:i}=this.connection;if(t.treeType==="materialized-path")t.ownColumns.push(new ir({connection:this.connection,entityMetadata:t,materializedPath:!0,args:{target:t.target,mode:"virtual",propertyName:"mpath",options:{name:i.materializedPathColumnName,type:String,nullable:!0,default:""}}}));else if(t.treeType==="nested-set"){const{left:s,right:o}=i.nestedSetColumnNames;t.ownColumns.push(new ir({connection:this.connection,entityMetadata:t,nestedSetLeft:!0,args:{target:t.target,mode:"virtual",propertyName:s,options:{name:s,type:Number,nullable:!1,default:1}}})),t.ownColumns.push(new ir({connection:this.connection,entityMetadata:t,nestedSetRight:!0,args:{target:t.target,mode:"virtual",propertyName:o,options:{name:o,type:Number,nullable:!1,default:2}}}))}if(t.ownRelations=this.metadataArgsStorage.filterRelations(t.inheritanceTree).map(s=>{if(t.tableType==="entity-child"){const o=t.parentEntityMetadata.ownRelations.find(c=>c.propertyName===s.propertyName),l=typeof s.type=="function"?s.type():s.type;if(o.type!==l){const c=Object.create(o);return c.type=l,c}return o}return new Dw({entityMetadata:t,args:s})}),t.relationIds=this.metadataArgsStorage.filterRelationIds(t.inheritanceTree).map(s=>t.tableType==="entity-child"?t.parentEntityMetadata.relationIds.find(o=>o.propertyName===s.propertyName):new Lw({entityMetadata:t,args:s})),t.relationCounts=this.metadataArgsStorage.filterRelationCounts(t.inheritanceTree).map(s=>t.tableType==="entity-child"?t.parentEntityMetadata.relationCounts.find(o=>o.propertyName===s.propertyName):new qw({entityMetadata:t,args:s})),t.ownListeners=this.metadataArgsStorage.filterListeners(t.inheritanceTree).map(s=>new $w({entityMetadata:t,args:s})),t.checks=this.metadataArgsStorage.filterChecks(t.inheritanceTree).map(s=>new kO({entityMetadata:t,args:s})),this.connection.driver.options.type==="postgres"&&(t.exclusions=this.metadataArgsStorage.filterExclusions(t.inheritanceTree).map(s=>new jO({entityMetadata:t,args:s}))),this.connection.driver.options.type==="cockroachdb"){t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter(o=>!o.unique).map(o=>new Or({entityMetadata:t,args:o}));const s=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter(o=>o.unique).map(o=>new bh({entityMetadata:t,args:{target:o.target,name:o.name,columns:o.columns}}));t.ownUniques.push(...s)}else t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).map(s=>new Or({entityMetadata:t,args:s}));if(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){const s=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map(o=>new Or({entityMetadata:t,args:{target:o.target,name:o.name,columns:o.columns,unique:!0,synchronize:!0}}));t.ownIndices.push(...s)}else{const s=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map(o=>new bh({entityMetadata:t,args:o}));t.ownUniques.push(...s)}}createEmbeddedsRecursively(e,t){return t.map(r=>{const a=new DO({entityMetadata:e,args:r}),i=typeof a.type=="function"?ah.getInheritanceTree(a.type):[a.type];return a.columns=this.metadataArgsStorage.filterColumns(i).map(s=>new ir({connection:this.connection,entityMetadata:e,embeddedMetadata:a,args:s})),a.relations=this.metadataArgsStorage.filterRelations(i).map(s=>new Dw({entityMetadata:e,embeddedMetadata:a,args:s})),a.listeners=this.metadataArgsStorage.filterListeners(i).map(s=>new $w({entityMetadata:e,embeddedMetadata:a,args:s})),a.indices=this.metadataArgsStorage.filterIndices(i).map(s=>new Or({entityMetadata:e,embeddedMetadata:a,args:s})),a.uniques=this.metadataArgsStorage.filterUniques(i).map(s=>new bh({entityMetadata:e,embeddedMetadata:a,args:s})),a.relationIds=this.metadataArgsStorage.filterRelationIds(i).map(s=>new Lw({entityMetadata:e,args:s})),a.relationCounts=this.metadataArgsStorage.filterRelationCounts(i).map(s=>new qw({entityMetadata:e,args:s})),a.embeddeds=this.createEmbeddedsRecursively(e,this.metadataArgsStorage.filterEmbeddeds(i)),a.embeddeds.forEach(s=>s.parentEmbeddedMetadata=a),e.allEmbeddeds.push(a),a})}computeEntityMetadataStep2(e){e.embeddeds.forEach(t=>t.build(this.connection)),e.embeddeds.forEach(t=>{t.columnsFromTree.forEach(r=>r.build(this.connection)),t.relationsFromTree.forEach(r=>r.build())}),e.ownColumns.forEach(t=>t.build(this.connection)),e.ownRelations.forEach(t=>t.build()),e.relations=e.embeddeds.reduce((t,r)=>t.concat(r.relationsFromTree),e.ownRelations),e.eagerRelations=e.relations.filter(t=>t.isEager),e.lazyRelations=e.relations.filter(t=>t.isLazy),e.oneToOneRelations=e.relations.filter(t=>t.isOneToOne),e.oneToManyRelations=e.relations.filter(t=>t.isOneToMany),e.manyToOneRelations=e.relations.filter(t=>t.isManyToOne),e.manyToManyRelations=e.relations.filter(t=>t.isManyToMany),e.ownerOneToOneRelations=e.relations.filter(t=>t.isOneToOneOwner),e.ownerManyToManyRelations=e.relations.filter(t=>t.isManyToManyOwner),e.treeParentRelation=e.relations.find(t=>t.isTreeParent),e.treeChildrenRelation=e.relations.find(t=>t.isTreeChildren),e.columns=e.embeddeds.reduce((t,r)=>t.concat(r.columnsFromTree),e.ownColumns),e.listeners=e.embeddeds.reduce((t,r)=>t.concat(r.listenersFromTree),e.ownListeners),e.afterLoadListeners=e.listeners.filter(t=>t.type===At.AFTER_LOAD),e.afterInsertListeners=e.listeners.filter(t=>t.type===At.AFTER_INSERT),e.afterUpdateListeners=e.listeners.filter(t=>t.type===At.AFTER_UPDATE),e.afterRemoveListeners=e.listeners.filter(t=>t.type===At.AFTER_REMOVE),e.afterSoftRemoveListeners=e.listeners.filter(t=>t.type===At.AFTER_SOFT_REMOVE),e.afterRecoverListeners=e.listeners.filter(t=>t.type===At.AFTER_RECOVER),e.beforeInsertListeners=e.listeners.filter(t=>t.type===At.BEFORE_INSERT),e.beforeUpdateListeners=e.listeners.filter(t=>t.type===At.BEFORE_UPDATE),e.beforeRemoveListeners=e.listeners.filter(t=>t.type===At.BEFORE_REMOVE),e.beforeSoftRemoveListeners=e.listeners.filter(t=>t.type===At.BEFORE_SOFT_REMOVE),e.beforeRecoverListeners=e.listeners.filter(t=>t.type===At.BEFORE_RECOVER),e.indices=e.embeddeds.reduce((t,r)=>t.concat(r.indicesFromTree),e.ownIndices),e.uniques=e.embeddeds.reduce((t,r)=>t.concat(r.uniquesFromTree),e.ownUniques),e.primaryColumns=e.columns.filter(t=>t.isPrimary),e.nonVirtualColumns=e.columns.filter(t=>!t.isVirtual),e.ancestorColumns=e.columns.filter(t=>t.closureType==="ancestor"),e.descendantColumns=e.columns.filter(t=>t.closureType==="descendant"),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter(t=>t.isGenerated||t.isObjectId),e.hasUUIDGeneratedColumns=e.columns.filter(t=>t.isGenerated||t.generationStrategy==="uuid").length>0,e.createDateColumn=e.columns.find(t=>t.isCreateDate),e.updateDateColumn=e.columns.find(t=>t.isUpdateDate),e.deleteDateColumn=e.columns.find(t=>t.isDeleteDate),e.versionColumn=e.columns.find(t=>t.isVersion),e.discriminatorColumn=e.columns.find(t=>t.isDiscriminator),e.treeLevelColumn=e.columns.find(t=>t.isTreeLevel),e.nestedSetLeftColumn=e.columns.find(t=>t.isNestedSetLeft),e.nestedSetRightColumn=e.columns.find(t=>t.isNestedSetRight),e.materializedPathColumn=e.columns.find(t=>t.isMaterializedPath),e.objectIdColumn=e.columns.find(t=>t.isObjectId),e.foreignKeys.forEach(t=>t.build(this.connection.namingStrategy)),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach(t=>t.build()),e.relationCounts.forEach(t=>t.build()),e.embeddeds.forEach(t=>{t.relationIdsFromTree.forEach(r=>r.build()),t.relationCountsFromTree.forEach(r=>r.build())})}computeInverseProperties(e,t){e.relations.forEach(r=>{const a=t.find(i=>i.target===r.type||typeof r.type=="string"&&(i.targetName===r.type||i.givenTableName===r.type));if(!a)throw new $("Entity metadata for "+e.name+"#"+r.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");r.inverseEntityMetadata=a,r.inverseSidePropertyPath=r.buildInverseSidePropertyPath(),r.inverseRelation=a.relations.find(i=>i.propertyPath===r.inverseSidePropertyPath)})}createKeysForTableInheritance(e){e.indices.push(new Or({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))}}class vh extends ${static createEntitySchemaIsRequiredException(e){return new vh(`EntitySchema is required for ${e} embedded field`)}static createTargetIsRequired(e){return new vh(`Target field is required for ${e} embedded EntitySchema`)}constructor(e){super(e)}}class BO{transform(e){const t=new GE;return e.forEach(r=>{var a;const i=r.options,s={target:i.target||i.name,name:i.tableName,database:i.database,schema:i.schema,type:i.type||"regular",orderBy:i.orderBy,synchronize:i.synchronize,withoutRowid:!!i.withoutRowid,expression:i.expression};t.tables.push(s);const{inheritance:o}=i;o&&t.inheritances.push({target:i.target,pattern:(a=o.pattern)!==null&&a!==void 0?a:"STI",column:o.column?typeof o.column=="string"?{name:o.column}:o.column:void 0}),this.transformColumnsRecursive(i,t)}),t}transformColumnsRecursive(e,t){Object.keys(e.columns).forEach(r=>{const a=e.columns[r];let i="regular";a.createDate&&(i="createDate"),a.updateDate&&(i="updateDate"),a.deleteDate&&(i="deleteDate"),a.version&&(i="version"),a.treeChildrenCount&&(i="treeChildrenCount"),a.treeLevel&&(i="treeLevel"),a.objectId&&(i="objectId");const s={target:e.target||e.name,mode:i,propertyName:r,options:{type:a.type,name:a.objectId?"_id":a.name,primaryKeyConstraintName:a.primaryKeyConstraintName,length:a.length,width:a.width,nullable:a.nullable,readonly:a.readonly,update:a.update,select:a.select,insert:a.insert,primary:a.primary,unique:a.unique,comment:a.comment,default:a.default,onUpdate:a.onUpdate,precision:a.precision,scale:a.scale,zerofill:a.zerofill,unsigned:a.unsigned,charset:a.charset,collation:a.collation,enum:a.enum,enumName:a.enumName,asExpression:a.asExpression,generatedType:a.generatedType,hstoreType:a.hstoreType,array:a.array,transformer:a.transformer,spatialFeatureType:a.spatialFeatureType,srid:a.srid}};if(t.columns.push(s),a.generated){const o={target:e.target||e.name,propertyName:r,strategy:typeof a.generated=="string"?a.generated:"increment"};t.generations.push(o)}a.unique&&t.uniques.push({target:e.target||e.name,columns:[r]})}),e.relations&&Object.keys(e.relations).forEach(r=>{const a=e.relations[r],i={target:e.target||e.name,propertyName:r,relationType:a.type,isLazy:a.lazy||!1,type:a.target,inverseSideProperty:a.inverseSide,isTreeParent:a.treeParent,isTreeChildren:a.treeChildren,options:{eager:a.eager||!1,cascade:a.cascade,nullable:a.nullable,onDelete:a.onDelete,onUpdate:a.onUpdate,deferrable:a.deferrable,createForeignKeyConstraints:a.createForeignKeyConstraints,persistence:a.persistence,orphanedRowAction:a.orphanedRowAction}};if(t.relations.push(i),a.joinColumn)if(typeof a.joinColumn=="boolean"){const s={target:e.target||e.name,propertyName:r};t.joinColumns.push(s)}else{const s=Array.isArray(a.joinColumn)?a.joinColumn:[a.joinColumn];for(const o of s){const l={target:e.target||e.name,propertyName:r,name:o.name,referencedColumnName:o.referencedColumnName,foreignKeyConstraintName:o.foreignKeyConstraintName};t.joinColumns.push(l)}}if(a.joinTable)if(typeof a.joinTable=="boolean"){const s={target:e.target||e.name,propertyName:r};t.joinTables.push(s)}else{const s={target:e.target||e.name,propertyName:r,name:a.joinTable.name,database:a.joinTable.database,schema:a.joinTable.schema,joinColumns:a.joinTable.joinColumn?[a.joinTable.joinColumn]:a.joinTable.joinColumns,inverseJoinColumns:a.joinTable.inverseJoinColumn?[a.joinTable.inverseJoinColumn]:a.joinTable.inverseJoinColumns};t.joinTables.push(s)}}),e.relationIds&&Object.keys(e.relationIds).forEach(r=>{const a=e.relationIds[r],i={propertyName:r,relation:a.relationName,target:e.target||e.name,alias:a.alias,queryBuilderFactory:a.queryBuilderFactory};t.relationIds.push(i)}),e.indices&&e.indices.forEach(r=>{const a={target:e.target||e.name,name:r.name,unique:r.unique===!0,spatial:r.spatial===!0,fulltext:r.fulltext===!0,nullFiltered:r.nullFiltered===!0,parser:r.parser,synchronize:r.synchronize!==!1,where:r.where,sparse:r.sparse,columns:r.columns};t.indices.push(a)}),e.uniques&&e.uniques.forEach(r=>{const a={target:e.target||e.name,name:r.name,columns:r.columns,deferrable:r.deferrable};t.uniques.push(a)}),e.checks&&e.checks.forEach(r=>{const a={target:e.target||e.name,name:r.name,expression:r.expression};t.checks.push(a)}),e.exclusions&&e.exclusions.forEach(r=>{const a={target:e.target||e.name,name:r.name,expression:r.expression};t.exclusions.push(a)}),e.embeddeds&&Object.keys(e.embeddeds).forEach(r=>{const a=e.embeddeds[r];if(!a.schema)throw vh.createEntitySchemaIsRequiredException(r);const i=a.schema.options;t.embeddeds.push({target:e.target||e.name,propertyName:r,isArray:a.array===!0,prefix:a.prefix!==void 0?a.prefix:void 0,type:()=>(i==null?void 0:i.target)||i.name}),this.transformColumnsRecursive(i,t)})}}class UO{constructor(e){this.connection=e}async buildMigrations(e){const[t,r]=Ee.splitClassesAndStrings(e);return[...t,...await cf(this.connection.logger)].map(a=>Iw(a))}async buildSubscribers(e){const[t,r]=Ee.splitClassesAndStrings(e||[]),a=[...t,...await cf(this.connection.logger)];return Wt().filterSubscribers(a).map(i=>Iw(i.target))}async buildEntityMetadatas(e){const[t,r]=Ee.splitClassesAndStrings(e||[]),a=t.filter(u=>!F.isEntitySchema(u)),i=t.filter(u=>F.isEntitySchema(u)),s=[...a,...await cf(this.connection.logger)];s.forEach(u=>{F.isEntitySchema(u)&&i.push(u)});const o=new kw(this.connection,Wt()).build(s),l=new BO().transform(i),c=new kw(this.connection,l).build();return[...o,...c]}}class FO{constructor(e,t,r,a,i){this.expressionMap=e,this.driver=t,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=i}transform(e,t){const r=this.group(e,t),a=[];return r.forEach(i=>{const s=this.transformRawResultsGroup(i,t);s!==void 0&&!Object.values(s).every(o=>o===null)&&a.push(s)}),a}group(e,t){const r=new Map,a=[];return t.metadata.tableType==="view"?a.push(...t.metadata.columns.map(i=>pe.buildAlias(this.driver,void 0,t.name,i.databaseName))):a.push(...t.metadata.primaryColumns.map(i=>pe.buildAlias(this.driver,void 0,t.name,i.databaseName))),e.forEach(i=>{const s=a.map(l=>{const c=i[l];return Buffer.isBuffer(c)?c.toString("hex"):Ue.isObject(c)?JSON.stringify(c):c}).join("_"),o=r.get(s);o?o.push(i):r.set(s,[i])}),r}transformRawResultsGroup(e,t){let r=t.metadata;if(r.discriminatorColumn){const c=e.map(h=>h[pe.buildAlias(this.driver,void 0,t.name,t.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(h=>typeof c.find(d=>d===h.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const i=this.transformColumns(e,t,a,r),s=this.transformJoins(e,a,t,r),o=this.transformRelationIds(e,t,a,r),l=this.transformRelationCounts(e,t,a);if(i||r.primaryColumns.filter(c=>c.isVirtual===!1).length===0&&(s||o||l))return a}transformColumns(e,t,r,a){let i=!1;return a.columns.forEach(s=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(l=>l.target===s.target)!==-1)return;const o=e[0][pe.buildAlias(this.driver,void 0,t.name,s.databaseName)];o===void 0||s.isVirtual||this.expressionMap.selects.find(l=>l.selection===t.name||l.selection===t.name+"."+s.propertyPath)&&(s.setEntityValue(r,this.driver.prepareHydratedValue(o,s)),o!==null&&(i=!0))}),i}transformJoins(e,t,r,a){let i=!1;return this.expressionMap.joinAttributes.forEach(s=>{if(!s.metadata||!s.isSelected||s.relation&&!a.relations.find(l=>l===s.relation))return;if(s.mapToProperty){if(s.mapToPropertyParentAlias!==r.name)return}else if(!s.relation||s.parentAlias!==r.name||s.relationPropertyPath!==s.relation.propertyPath)return;let o=this.transform(e,s.alias);o=s.isMany?o:o[0],o=!s.isMany&&o===void 0?null:o,o!==void 0&&(s.mapToPropertyPropertyName?t[s.mapToPropertyPropertyName]=o:s.relation.setEntityValue(t,o),i=!0)}),i}transformRelationIds(e,t,r,a){let i=!1;return this.rawRelationIdResults.forEach((s,o)=>{if(s.relationIdAttribute.parentAlias!==t.name)return;const l=s.relationIdAttribute.relation,c=this.createValueMapFromJoinColumns(l,s.relationIdAttribute.parentAlias,e);if(c==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(l,c),h=this.relationIdMaps[o][u]||[],d=s.relationIdAttribute.mapToPropertyPropertyPath.split("."),f=(g,v,C)=>{const w=g.shift();if(w&&g.length===0)return v[w]=C,v;if(w&&g.length>0)f(g,v[w],C);else return v};l.isOneToOne||l.isManyToOne?h[0]!==void 0&&(f(d,r,h[0]),i=!0):(f(d,r,h),i=i||h.length>0)}),i}transformRelationCounts(e,t,r){let a=!1;return this.rawRelationCountResults.filter(i=>i.relationCountAttribute.parentAlias===t.name).forEach(i=>{const s=i.relationCountAttribute.relation;let o;s.isOneToMany?o=s.inverseRelation.joinColumns[0].referencedColumn.databaseName:o=s.isOwning?s.joinColumns[0].referencedColumn.databaseName:s.inverseRelation.joinColumns[0].referencedColumn.databaseName;const l=e[0][pe.buildAlias(this.driver,void 0,t.name,o)];l!=null&&(r[i.relationCountAttribute.mapToPropertyPropertyName]=0,i.results.filter(c=>c.parentId===l).forEach(c=>{r[i.relationCountAttribute.mapToPropertyPropertyName]=parseInt(c.cnt),a=!0}))}),a}createValueMapFromJoinColumns(e,t,r){let a;return e.isManyToOne||e.isOneToOneOwner?a=e.entityMetadata.primaryColumns.map(i=>i):e.isOneToMany||e.isOneToOneNotOwner?a=e.inverseRelation.joinColumns.map(i=>i):e.isOwning?a=e.joinColumns.map(i=>i):a=e.inverseRelation.inverseJoinColumns.map(i=>i),a.reduce((i,s)=>(r.forEach(o=>{e.isManyToOne||e.isOneToOneOwner?i[s.databaseName]=this.driver.prepareHydratedValue(o[pe.buildAlias(this.driver,void 0,t,s.databaseName)],s):i[s.databaseName]=this.driver.prepareHydratedValue(o[pe.buildAlias(this.driver,void 0,t,s.referencedColumn.databaseName)],s.referencedColumn)}),i),{})}extractEntityPrimaryIds(e,t){let r;return e.isManyToOne||e.isOneToOneOwner?r=e.entityMetadata.primaryColumns.map(a=>a):e.isOneToMany||e.isOneToOneNotOwner?r=e.inverseRelation.joinColumns.map(a=>a):e.isOwning?r=e.joinColumns.map(a=>a):r=e.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,i)=>(a[i.databaseName]=t[i.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(e=>{const t=e.relationIdAttribute.relation;let r;return t.isManyToOne||t.isOneToOneOwner?r=t.joinColumns:t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseEntityMetadata.primaryColumns:t.isOwning?r=t.inverseJoinColumns:r=t.inverseRelation.joinColumns,e.results.reduce((a,i)=>{let s=r.reduce((o,l)=>{let c=i[l.databaseName];return t.isOneToMany||t.isOneToOneNotOwner?(l.isVirtual&&l.referencedColumn&&l.referencedColumn.propertyName!==l.propertyName&&(c=l.referencedColumn.createValueMap(c)),Ee.mergeDeep(o,l.createValueMap(c))):(!l.isPrimary&&l.referencedColumn.referencedColumn&&(c=l.referencedColumn.referencedColumn.createValueMap(c)),Ee.mergeDeep(o,l.referencedColumn.createValueMap(c)))},{});if(r.length===1&&!e.relationIdAttribute.disableMixedMap&&(t.isOneToMany||t.isOneToOneNotOwner?s=r[0].getEntityValue(s):s=r[0].referencedColumn.getEntityValue(s)),s!==void 0){const o=this.hashEntityIds(t,i);a[o]?a[o].push(s):a[o]=[s]}return a},{})}))}hashEntityIds(e,t){const r=this.extractEntityPrimaryIds(e,t);return JSON.stringify(r)}}class Gr{static isAliasProperty(e){if(typeof e!="string"||e.indexOf(".")===-1)return!1;const[t,r]=e.split(".");return!(!t||!r||e.indexOf("(")!==-1||e.indexOf(")")!==-1)}}class jw{constructor(e,t,r){this.connection=e,this.queryExpressionMap=t,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&Ue.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let e=()=>{for(const t of this.queryExpressionMap.selects)if(t.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>t.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=e(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Gr.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Gr.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let e=()=>{if(!Gr.isAliasProperty(this.entityOrProperty))return;const t=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=t.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||t.metadata.parentEntityMetadata&&(r=t.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new $(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=e.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new $("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new $("Junction property is not defined.");const e=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?pe.buildAlias(this.connection.driver,void 0,e,this.alias.name):pe.buildAlias(this.connection.driver,void 0,this.alias.name,e)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class uf{constructor(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,Ue.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value must be a string representation of alias property");const e=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new $(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return e}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class hf{constructor(e,t){this.expressionMap=e,Ue.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rc"}get relation(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value is a string representation of alias property");const[e,t]=this.relationName.split("."),r=this.expressionMap.findAliasByName(e).metadata.findRelationWithPropertyPath(t);if(!r)throw new $(`Relation with property path ${t} in entity was not found.`);return r}get metadata(){if(!Gr.isAliasProperty(this.relationName))throw new $("Given value is a string representation of alias property");const e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}let VO=class{constructor(n,e,t){this.connection=n,this.queryRunner=e,this.relationIdAttributes=t}async load(n){const e=this.relationIdAttributes.map(async t=>{if(t.relation.isManyToOne||t.relation.isOneToOneOwner){if(t.queryBuilderFactory)throw new $("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=n.map(i=>{const s={},o=[];t.relation.joinColumns.forEach(c=>{s[c.databaseName]=this.connection.driver.prepareHydratedValue(i[pe.buildAlias(this.connection.driver,void 0,t.parentAlias,c.databaseName)],c.referencedColumn);const u=`${c.databaseName}:${s[c.databaseName]}`;o.indexOf(u)===-1&&o.push(u)}),t.relation.entityMetadata.primaryColumns.forEach(c=>{s[c.databaseName]=this.connection.driver.prepareHydratedValue(i[pe.buildAlias(this.connection.driver,void 0,t.parentAlias,c.databaseName)],c);const u=`${c.databaseName}:${s[c.databaseName]}`;o.indexOf(u)===-1&&o.push(u)}),o.sort();const l=o.join("::");return r[l]?null:(r[l]=!0,s)}).filter(i=>i);return{relationIdAttribute:t,results:a}}else if(t.relation.isOneToMany||t.relation.isOneToOneNotOwner){const r=t.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,i=r.inverseEntityMetadata.target,s=r.inverseEntityMetadata.tableName,o=t.alias||s,l={},c={},u=n.map((f,g)=>{const v=[],C={},w=a.map(S=>{const O=S.databaseName+g,k=f[pe.buildAlias(this.connection.driver,void 0,t.parentAlias,S.referencedColumn.databaseName)],B=`${o}:${S.propertyPath}:${k}`;return v.indexOf(B)!==-1?"":(v.push(B),C[O]=k,o+"."+S.propertyPath+" = :"+O)}).filter(S=>S).join(" AND ");v.sort();const T=v.join("::");return l[T]?"":(l[T]=!0,Object.assign(c,C),w)}).filter(f=>f).map(f=>"("+f+")").join(" OR ");if(!u)return{relationIdAttribute:t,results:[]};const h=this.connection.createQueryBuilder(this.queryRunner);Ee.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],f=>f.propertyPath).forEach(f=>{h.addSelect(o+"."+f.propertyPath,f.databaseName)}),h.from(i,o).where("("+u+")").setParameters(c),t.queryBuilderFactory&&t.queryBuilderFactory(h);const d=await h.getRawMany();return d.forEach(f=>{a.forEach(g=>{f[g.databaseName]=this.connection.driver.prepareHydratedValue(f[g.databaseName],g.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(g=>{f[g.databaseName]=this.connection.driver.prepareHydratedValue(f[g.databaseName],g)})}),{relationIdAttribute:t,results:d}}else{const r=t.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,i=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,s=t.junctionAlias,o=t.joinInverseSideMetadata.tableName,l=t.alias||o,c=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=n.map(T=>a.reduce((S,O)=>(S[O.propertyPath]=T[pe.buildAlias(this.connection.driver,void 0,t.parentAlias,O.referencedColumn.databaseName)],S),{}));if(u.length===0)return{relationIdAttribute:t,results:[]};const h={},d={},f=u.map((T,S)=>{const O=[],k={},B=Object.keys(T).map(V=>{const q=V+S,K=T[V],I=`${s}:${V}:${K}`;return O.indexOf(I)!==-1?"":(O.push(I),k[q]=K,s+"."+V+" = :"+q)}).filter(V=>V).join(" AND ");O.sort();const D=O.join("::");return d[D]?"":(d[D]=!0,Object.assign(h,k),B)}).filter(T=>T),g=i.map(T=>s+"."+T.propertyPath+" = "+l+"."+T.referencedColumn.propertyPath).join(" AND "),v=f.map(T=>"("+T+" AND "+g+")").join(" OR "),C=this.connection.createQueryBuilder(this.queryRunner);i.forEach(T=>{C.addSelect(s+"."+T.propertyPath,T.databaseName).addOrderBy(s+"."+T.propertyPath)}),a.forEach(T=>{C.addSelect(s+"."+T.propertyPath,T.databaseName).addOrderBy(s+"."+T.propertyPath)}),C.from(o,l).innerJoin(c,s,v).setParameters(h),t.queryBuilderFactory&&t.queryBuilderFactory(C);const w=await C.getRawMany();return w.forEach(T=>{[...a,...i].forEach(S=>{T[S.databaseName]=this.connection.driver.prepareHydratedValue(T[S.databaseName],S.referencedColumn)})}),{relationIdAttribute:t,results:w}}});return Promise.all(e)}};class Bw{constructor(e,t){this.connection=e,this.queryRunner=t}load(e,t,r){const a=Array.isArray(t)?t:[t],i=Array.isArray(r)?r:r?[r]:void 0;return e.isManyToMany?this.loadForManyToMany(e,a,i):e.isManyToOne||e.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(e,a,i):this.loadForOneToManyAndOneToOneNotOwner(e,a,i)}async loadManyToManyRelationIdsAndGroup(e,t,r,a){const i=e.isManyToMany||e.isOneToMany,s=Array.isArray(t)?t:[t];if(!r&&(r=await this.connection.relationLoader.load(e,t,this.queryRunner,a),!r.length))return s.map(h=>({entity:h,related:i?[]:void 0}));const o=await this.load(e,t,r),l=Array.isArray(r)?r:[r];let c=[],u=[];return e.isManyToManyOwner?(c=e.junctionEntityMetadata.inverseColumns.map(h=>h.referencedColumn),u=e.junctionEntityMetadata.ownerColumns.map(h=>h.referencedColumn)):e.isManyToManyNotOwner?(c=e.junctionEntityMetadata.ownerColumns.map(h=>h.referencedColumn),u=e.junctionEntityMetadata.inverseColumns.map(h=>h.referencedColumn)):e.isManyToOne||e.isOneToOneOwner?(c=e.joinColumns.map(h=>h.referencedColumn),u=e.entityMetadata.primaryColumns):(e.isOneToMany||e.isOneToOneNotOwner)&&(c=e.inverseRelation.entityMetadata.primaryColumns,u=e.inverseRelation.joinColumns.map(h=>h.referencedColumn)),s.map(h=>{const d={entity:h,related:i?[]:void 0},f=o.filter(g=>u.every(v=>v.compareEntityValue(h,g[v.entityMetadata.name+"_"+v.propertyAliasName])));return f.length&&l.forEach(g=>{f.forEach(v=>{c.every(C=>C.compareEntityValue(g,v[pe.buildAlias(this.connection.driver,void 0,C.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+C.propertyPath.replace(".","_"))]))&&(i?d.related.push(g):d.related=g)})}),d})}loadForManyToMany(e,t,r){const a=e.junctionEntityMetadata,i=a.name,s=e.isOwning?a.ownerColumns:a.inverseColumns,o=e.isOwning?a.inverseColumns:a.ownerColumns,l=this.connection.createQueryBuilder(this.queryRunner);s.forEach(d=>{const f=pe.buildAlias(this.connection.driver,void 0,d.referencedColumn.entityMetadata.name+"_"+d.referencedColumn.propertyPath.replace(".","_"));l.addSelect(i+"."+d.propertyPath,f)}),o.forEach(d=>{const f=pe.buildAlias(this.connection.driver,void 0,d.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+d.referencedColumn.propertyPath.replace(".","_"));l.addSelect(i+"."+d.propertyPath,f)});let c="";if(s.length===1){const d=t.map(f=>s[0].referencedColumn.getEntityValue(f));d.every(f=>typeof f=="number")?c=`${i}.${s[0].propertyPath} IN (${d.join(", ")})`:(l.setParameter("values1",d),c=i+"."+s[0].propertyPath+" IN (:...values1)")}else c="("+t.map((d,f)=>s.map(g=>{const v="entity1_"+f+"_"+g.propertyName;return l.setParameter(v,g.referencedColumn.getEntityValue(d)),i+"."+g.propertyPath+" = :"+v}).join(" AND ")).map(d=>"("+d+")").join(" OR ")+")";let u="";if(r)if(o.length===1){const d=r.map(f=>o[0].referencedColumn.getEntityValue(f));d.every(f=>typeof f=="number")?u=`${i}.${o[0].propertyPath} IN (${d.join(", ")})`:(l.setParameter("values2",d),u=i+"."+o[0].propertyPath+" IN (:...values2)")}else u="("+r.map((d,f)=>o.map(g=>{const v="entity2_"+f+"_"+g.propertyName;return l.setParameter(v,g.referencedColumn.getEntityValue(d)),i+"."+g.propertyPath+" = :"+v}).join(" AND ")).map(d=>"("+d+")").join(" OR ")+")";const h=[c,u].filter(d=>d.length>0).join(" AND ");return l.from(a.target,i).where(h).getRawMany()}loadForManyToOneAndOneToOneOwner(e,t,r){const a=e.entityMetadata.targetName,i=e.joinColumns.every(l=>!!e.entityMetadata.nonVirtualColumns.find(c=>c===l));if(r&&i){let l=[];if(t.forEach(c=>{let u={};e.entityMetadata.primaryColumns.forEach(h=>{const d=h.entityMetadata.name+"_"+h.propertyPath.replace(".","_");u[d]=h.getEntityValue(c)}),r.forEach(h=>{e.joinColumns.forEach(d=>{const f=d.getEntityValue(c),g=d.referencedColumn.getEntityValue(h);if(!(f===void 0||g===void 0)&&f===g){const v=d.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+d.referencedColumn.propertyPath.replace(".","_");u[v]=g}})}),Object.keys(u).length===e.entityMetadata.primaryColumns.length+e.joinColumns.length&&l.push(u)}),l.length===t.length)return Promise.resolve(l)}const s=this.connection.createQueryBuilder(this.queryRunner);e.entityMetadata.primaryColumns.forEach(l=>{const c=pe.buildAlias(this.connection.driver,void 0,l.entityMetadata.name+"_"+l.propertyPath.replace(".","_"));s.addSelect(a+"."+l.propertyPath,c)}),e.joinColumns.forEach(l=>{const c=pe.buildAlias(this.connection.driver,void 0,l.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+l.referencedColumn.propertyPath.replace(".","_"));s.addSelect(a+"."+l.propertyPath,c)});let o="";if(e.entityMetadata.primaryColumns.length===1){const l=t.map(c=>e.entityMetadata.primaryColumns[0].getEntityValue(c));l.every(c=>typeof c=="number")?o=`${a}.${e.entityMetadata.primaryColumns[0].propertyPath} IN (${l.join(", ")})`:(s.setParameter("values",l),o=a+"."+e.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else o=t.map((l,c)=>e.entityMetadata.primaryColumns.map((u,h)=>{const d="entity"+c+"_"+h;return s.setParameter(d,u.getEntityValue(l)),a+"."+u.propertyPath+" = :"+d}).join(" AND ")).map(l=>"("+l+")").join(" OR ");return s.from(e.entityMetadata.target,a).where(o).getRawMany()}loadForOneToManyAndOneToOneNotOwner(e,t,r){if(e=e.inverseRelation,e.entityMetadata.primaryColumns.length===e.joinColumns.length&&e.entityMetadata.primaryColumns.every(o=>e.joinColumns.indexOf(o)!==-1))return Promise.resolve(t.map(o=>{const l={};return e.joinColumns.forEach(function(c){const u=c.referencedColumn.getEntityValue(o),h=c.referencedColumn.entityMetadata.name+"_"+c.referencedColumn.propertyPath.replace(".","_"),d=c.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+c.propertyPath.replace(".","_");l[h]=u,l[d]=u}),l}));const a=e.entityMetadata.targetName,i=this.connection.createQueryBuilder(this.queryRunner);e.entityMetadata.primaryColumns.forEach(o=>{const l=pe.buildAlias(this.connection.driver,void 0,o.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+o.propertyPath.replace(".","_"));i.addSelect(a+"."+o.propertyPath,l)}),e.joinColumns.forEach(o=>{const l=pe.buildAlias(this.connection.driver,void 0,o.referencedColumn.entityMetadata.name+"_"+o.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+o.propertyPath,l)});let s="";if(e.joinColumns.length===1){const o=t.map(l=>e.joinColumns[0].referencedColumn.getEntityValue(l));o.every(l=>typeof l=="number")?s=`${a}.${e.joinColumns[0].propertyPath} IN (${o.join(", ")})`:(i.setParameter("values",o),s=a+"."+e.joinColumns[0].propertyPath+" IN (:...values)")}else s=t.map((o,l)=>e.joinColumns.map((c,u)=>{const h="entity"+l+"_"+u;return i.setParameter(h,c.referencedColumn.getEntityValue(o)),a+"."+c.propertyPath+" = :"+h}).join(" AND ")).map(o=>"("+o+")").join(" OR ");return i.from(e.entityMetadata.target,a).where(s).getRawMany()}}class zO{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationIdAttributes.push(t)}),this.expressionMap.joinAttributes.forEach(e=>{!e.metadata||e.metadata.isJunction||e.metadata.relationIds.forEach(t=>{const r=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(e,t){return new uf(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class WO{constructor(e,t,r){this.connection=e,this.queryRunner=t,this.relationCountAttributes=r}async load(e){const t=(a,i,s)=>s.indexOf(a)===i,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const i=a.relation,s=i.inverseRelation,o=s.joinColumns[0].referencedColumn.propertyName,l=i.inverseEntityMetadata.target,c=i.inverseEntityMetadata.tableName,u=a.alias||c,h=s.propertyName;let d=e.map(g=>g[a.parentAlias+"_"+o]).filter(g=>!!g);if(d=d.filter(t),d.length===0)return{relationCountAttribute:a,results:[]};const f=this.connection.createQueryBuilder(this.queryRunner);return f.select(u+"."+h,"parentId").addSelect("COUNT(*)","cnt").from(l,u).where(u+"."+h+" IN (:...ids)").addGroupBy(u+"."+h).setParameter("ids",d),a.queryBuilderFactory&&a.queryBuilderFactory(f),{relationCountAttribute:a,results:await f.getRawMany()}}else{let i,s,o,l;a.relation.isOwning?(i=a.relation.joinColumns[0].referencedColumn.databaseName,s=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,o=a.relation.junctionEntityMetadata.columns[0],l=a.relation.junctionEntityMetadata.columns[1]):(i=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,o=a.relation.junctionEntityMetadata.columns[1],l=a.relation.junctionEntityMetadata.columns[0]);let c=e.map(C=>C[a.parentAlias+"_"+i]).filter(C=>!!C);if(c=c.filter(t),c.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,h=a.joinInverseSideMetadata.tableName,d=a.alias||h,f=a.relation.junctionEntityMetadata.tableName,g=u+"."+o.propertyName+" IN ("+c.map(C=>isNaN(C)?"'"+C+"'":C)+") AND "+u+"."+l.propertyName+" = "+d+"."+s,v=this.connection.createQueryBuilder(this.queryRunner);return v.select(u+"."+o.propertyName,"parentId").addSelect("COUNT("+v.escape(d)+"."+v.escape(s)+")","cnt").from(h,d).innerJoin(f,u,g).addGroupBy(u+"."+o.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(v),{relationCountAttribute:a,results:await v.getRawMany()}}});return Promise.all(r)}}class HO{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationCountAttributes.push(t)}),this.expressionMap.joinAttributes.forEach(e=>{!e.metadata||e.metadata.isJunction||e.metadata.relationCounts.forEach(t=>{const r=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(e,t){return new hf(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class Uw{constructor(e){Ue.assign(this,e||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(e){this._metadata=e}get metadata(){if(!this._metadata)throw new $(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class df{constructor(e){var t;this.connection=e,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.cache=!1,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],e.options.relationLoadStrategy&&(this.relationLoadStrategy=e.options.relationLoadStrategy),this.timeTravel=((t=e.options)===null||t===void 0?void 0:t.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const e=this.mainAlias.metadata.orderBy||{};return Object.keys(e).reduce((t,r)=>(t[this.mainAlias.name+"."+r]=e[r],t),{})}return this.orderBys}setMainAlias(e){return this.mainAlias=e,e}createAlias(e){let t=e.name;!t&&e.tablePath&&(t=e.tablePath),!t&&typeof e.target=="function"&&(t=e.target.name),!t&&typeof e.target=="string"&&(t=e.target);const r=new Uw;return r.type=e.type,t&&(r.name=t),e.metadata&&(r.metadata=e.metadata),e.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(e.target)),e.tablePath&&(r.tablePath=e.tablePath),e.subQuery&&(r.subQuery=e.subQuery),this.aliases.push(r),r}findAliasByName(e){const t=this.aliases.find(r=>r.name===e);if(!t)throw new $(`"${e}" alias was not found. Maybe you forgot to join it?`);return t}findColumnByAliasExpression(e){const[t,r]=e.split(".");return this.findAliasByName(t).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new $("Entity to work with is not specified!");const e=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new $(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return e}clone(){const e=new df(this.connection);return e.queryType=this.queryType,e.selects=this.selects.map(t=>t),e.maxExecutionTime=this.maxExecutionTime,e.selectDistinct=this.selectDistinct,e.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(t=>e.aliases.push(new Uw(t))),e.relationLoadStrategy=this.relationLoadStrategy,e.mainAlias=this.mainAlias,e.valuesSet=this.valuesSet,e.returning=this.returning,e.onConflict=this.onConflict,e.onIgnore=this.onIgnore,e.onUpdate=this.onUpdate,e.joinAttributes=this.joinAttributes.map(t=>new jw(this.connection,this,t)),e.relationIdAttributes=this.relationIdAttributes.map(t=>new uf(this,t)),e.relationCountAttributes=this.relationCountAttributes.map(t=>new hf(this,t)),e.wheres=this.wheres.map(t=>({...t})),e.havings=this.havings.map(t=>({...t})),e.orderBys=Object.assign({},this.orderBys),e.groupBys=this.groupBys.map(t=>t),e.limit=this.limit,e.offset=this.offset,e.skip=this.skip,e.take=this.take,e.lockMode=this.lockMode,e.onLocked=this.onLocked,e.lockVersion=this.lockVersion,e.lockTables=this.lockTables,e.withDeleted=this.withDeleted,e.parameters=Object.assign({},this.parameters),e.disableEscaping=this.disableEscaping,e.enableRelationIdValues=this.enableRelationIdValues,e.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,e.subQuery=this.subQuery,e.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,e.cache=this.cache,e.cacheId=this.cacheId,e.cacheDuration=this.cacheDuration,e.relationPropertyPath=this.relationPropertyPath,e.of=this.of,e.insertColumns=this.insertColumns,e.whereEntities=this.whereEntities,e.updateEntity=this.updateEntity,e.callListeners=this.callListeners,e.useTransaction=this.useTransaction,e.timeTravel=this.timeTravel,e.nativeParameters=Object.assign({},this.nativeParameters),e.comment=this.comment,e.commonTableExpressions=this.commonTableExpressions.map(t=>({alias:t.alias,queryBuilder:typeof t.queryBuilder=="string"?t.queryBuilder:t.queryBuilder.clone(),options:t.options})),e}}class jl{constructor(e,t,r=!0,a=!1,i,s){this["@instanceof"]=Symbol.for("FindOperator"),this._type=e,this._value=t,this._useParameter=r,this._multipleParameters=a,this._getSql=i,this._objectLiteralParameters=s}get useParameter(){return F.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return F.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return F.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return F.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(F.isFindOperator(this._value))return this._value}get getSql(){return F.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(e){this._value instanceof jl?this._value.transformValue(e):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(t=>e&&qt.transformTo(e,t)):qt.transformTo(e,this._value)}}function KO(n){return new jl("in",n,!0,!0)}const QO=/[.*+\-?^${}()|[\]\\]/g,GO=n=>n.replace(QO,"\\$&");class YO{constructor(e,t){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,F.isDataSource(e)?(this.connection=e,this.queryRunner=t,this.expressionMap=new df(this.connection)):(this.connection=e.connection,this.queryRunner=e.queryRunner,this.expressionMap=e.expressionMap.clone())}get alias(){if(!this.expressionMap.mainAlias)throw new $("Main alias is not set");return this.expressionMap.mainAlias.name}select(e,t){this.expressionMap.queryType="select",Array.isArray(e)?this.expressionMap.selects=e.map(a=>({selection:a})):e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);const r=require("./SelectQueryBuilder").SelectQueryBuilder;return F.isSelectQueryBuilder(this)?this:new r(this)}insert(){this.expressionMap.queryType="insert";const e=require("./InsertQueryBuilder").InsertQueryBuilder;return F.isInsertQueryBuilder(this)?this:new e(this)}update(e,t){const r=t||e;if(e=F.isEntitySchema(e)?e.options.name:e,typeof e=="function"||typeof e=="string"){const i=this.createFromAlias(e);this.expressionMap.setMainAlias(i)}this.expressionMap.queryType="update",this.expressionMap.valuesSet=r;const a=require("./UpdateQueryBuilder").UpdateQueryBuilder;return F.isUpdateQueryBuilder(this)?this:new a(this)}delete(){this.expressionMap.queryType="delete";const e=require("./DeleteQueryBuilder").DeleteQueryBuilder;return F.isDeleteQueryBuilder(this)?this:new e(this)}softDelete(){this.expressionMap.queryType="soft-delete";const e=require("./SoftDeleteQueryBuilder").SoftDeleteQueryBuilder;return F.isSoftDeleteQueryBuilder(this)?this:new e(this)}restore(){this.expressionMap.queryType="restore";const e=require("./SoftDeleteQueryBuilder").SoftDeleteQueryBuilder;return F.isSoftDeleteQueryBuilder(this)?this:new e(this)}relation(e,t){const r=arguments.length===2?e:void 0,a=arguments.length===2?t:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const s=this.createFromAlias(r);this.expressionMap.setMainAlias(s)}const i=require("./RelationQueryBuilder").RelationQueryBuilder;return F.isRelationQueryBuilder(this)?this:new i(this)}hasRelation(e,t){const r=this.connection.getMetadata(e);return(Array.isArray(t)?t:[t]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(e){var t;return((t=this.parentQueryBuilder)===null||t===void 0?void 0:t.hasParameter(e))||e in this.expressionMap.parameters}setParameter(e,t){if(typeof t=="function")throw new $(`Function parameter isn't supported in the parameters. Please check "${e}" parameter.`);if(!e.match(/^([A-Za-z0-9_.]+)$/))throw new $("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(e,t),this.expressionMap.parameters[e]=t,this}setParameters(e){for(const[t,r]of Object.entries(e))this.setParameter(t,r);return this}createParameter(e){let t;do t=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(t));return this.setParameter(t,e),`:${t}`}setNativeParameters(e){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach(t=>{this.expressionMap.nativeParameters[t]=e[t]}),this}getParameters(){const e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const t=this.expressionMap.mainAlias.metadata;if(t.discriminatorColumn&&t.parentEntityMetadata){const r=t.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(t.discriminatorValue),e.discriminatorColumnValues=r}}return e}printSql(){const[e,t]=this.getQueryAndParameters();return this.connection.logger.logQuery(e,t),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const e=this.getQuery(),t=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,t,this.expressionMap.nativeParameters)}async execute(){const[e,t]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(e,t)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(){return new this.constructor(this.connection,this.queryRunner)}clone(){return new this.constructor(this)}comment(e){return this.expressionMap.comment=e,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e}setQueryRunner(e){return this.queryRunner=e,this}callListeners(e){return this.expressionMap.callListeners=e,this}useTransaction(e){return this.expressionMap.useTransaction=e,this}addCommonTableExpression(e,t,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:e,alias:t,options:r||{}}),this}getTableName(e){return e.split(".").map(t=>t===""?t:this.escape(t)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new $('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(e,t){if(this.connection.hasMetadata(e)){const r=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:t,metadata:this.connection.getMetadata(e),tablePath:r.tablePath})}else{if(typeof e=="string"){const i=e.substr(0,1)==="("&&e.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:t,tablePath:i?void 0:e,subQuery:i?e:void 0})}const r=e(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:t,subQuery:a})}}replacePropertyNames(e){return e}replacePropertyNamesForTheWholeQuery(e){const t={};for(const i of this.expressionMap.aliases){if(!i.hasMetadata)continue;const s=this.expressionMap.aliasNamePrefixingEnabled&&i.name?`${i.name}.`:"";t[s]||(t[s]={});for(const o of i.metadata.relations)o.joinColumns.length>0&&(t[s][o.propertyPath]=o.joinColumns[0].databaseName);for(const o of i.metadata.relations){const l=[...o.joinColumns,...o.inverseJoinColumns];for(const c of l){const u=`${o.propertyPath}.${c.referencedColumn.propertyPath}`;t[s][u]=c.databaseName}}for(const o of i.metadata.columns)t[s][o.databaseName]=o.databaseName;for(const o of i.metadata.columns)t[s][o.propertyName]=o.databaseName;for(const o of i.metadata.columns)t[s][o.propertyPath]=o.databaseName}const r=Object.keys(t),a=r.map(i=>GO(i)).join("|");return r.length>0&&(e=e.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...i)=>{let s,o,l;if(a){if(s=i[0],o=i[1],l=i[3],t[i[2]][l])return`${o}${this.escape(i[2].substring(0,i[2].length-1))}.${this.escape(t[i[2]][l])}`}else if(s=i[0],o=i[1],l=i[2],t[""][l])return`${o}${this.escape(t[""][l])}`;return s})),e}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace("*/","")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const e=[],t=this.createWhereClausesExpression(this.expressionMap.wheres);if(t.length>0&&t!=="1=1"&&e.push(this.replacePropertyNames(t)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const i=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,s=`${this.replacePropertyNames(i)} IS NULL`;e.push(s)}if(a.discriminatorColumn&&a.parentEntityMetadata){const i=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,s=`${this.replacePropertyNames(i)} IN (:...discriminatorColumnValues)`;e.push(s)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);e.push(a)}let r="";return r+=this.createTimeTravelQuery(),e.length?e.length===1?r+=` WHERE ${e[0]}`:r+=` WHERE ( ${e.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(e){const t=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(e)&&t.push(...this.expressionMap.extraReturningColumns.filter(a=>t.indexOf(a)===-1)),t.length){let a=t.map(i=>{const s=this.escape(i.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+s:this.escape(this.getMainTableName())+"."+s:s}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+t.map(i=>this.createParameter({type:r.columnTypeToNativeParameter(i.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const e=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(t=>{this.expressionMap.mainAlias.hasMetadata&&e.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(t))}),e}createWhereClausesExpression(e){return e.map((t,r)=>{const a=this.createWhereConditionExpression(t.condition);switch(t.type){case"and":return(r>0?"AND ":"")+a;case"or":return(r>0?"OR ":"")+a}return a}).join(" ").trim()}createWhereConditionExpression(e,t=!1){if(typeof e=="string")return e;if(Array.isArray(e))return e.length===0?"1=1":e.length===1&&!t?this.createWhereClausesExpression(e):"("+this.createWhereClausesExpression(e)+")";const{driver:r}=this.connection;switch(e.operator){case"lessThan":return`${e.parameters[0]} < ${e.parameters[1]}`;case"lessThanOrEqual":return`${e.parameters[0]} <= ${e.parameters[1]}`;case"arrayContains":return`${e.parameters[0]} @> ${e.parameters[1]}`;case"jsonContains":return`${e.parameters[0]} ::jsonb @> ${e.parameters[1]}`;case"arrayContainedBy":return`${e.parameters[0]} <@ ${e.parameters[1]}`;case"arrayOverlap":return`${e.parameters[0]} && ${e.parameters[1]}`;case"moreThan":return`${e.parameters[0]} > ${e.parameters[1]}`;case"moreThanOrEqual":return`${e.parameters[0]} >= ${e.parameters[1]}`;case"notEqual":return`${e.parameters[0]} != ${e.parameters[1]}`;case"equal":return`${e.parameters[0]} = ${e.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${e.parameters[0]} ILIKE ${e.parameters[1]}`:`UPPER(${e.parameters[0]}) LIKE UPPER(${e.parameters[1]})`;case"like":return`${e.parameters[0]} LIKE ${e.parameters[1]}`;case"between":return`${e.parameters[0]} BETWEEN ${e.parameters[1]} AND ${e.parameters[2]}`;case"in":return e.parameters.length<=1?"0=1":`${e.parameters[0]} IN (${e.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${e.parameters[0]}::STRING = ANY(${e.parameters[1]}::STRING[])`:`${e.parameters[0]} = ANY(${e.parameters[1]})`;case"isNull":return`${e.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(e.condition)})`;case"brackets":return`${this.createWhereConditionExpression(e.condition,!0)}`;case"and":return e.parameters.join(" AND ")}throw new TypeError(`Unsupported FindOperator ${jl.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const e=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(t=>{const r=typeof t.queryBuilder=="string"?t.queryBuilder:t.queryBuilder.getQuery();if(typeof t.queryBuilder!="string"){if(t.queryBuilder.hasCommonTableExpressions())throw new $(`Nested CTEs aren't supported (CTE: ${t.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!F.isSelectQueryBuilder(t.queryBuilder))throw new $(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${t.alias})`);this.setParameters(t.queryBuilder.getParameters())}let a=this.escape(t.alias);if(t.options.columnNames){const o=t.options.columnNames.map(l=>this.escape(l));if(F.isSelectQueryBuilder(t.queryBuilder)&&t.queryBuilder.expressionMap.selects.length&&t.options.columnNames.length!==t.queryBuilder.expressionMap.selects.length)throw new $(`cte.options.columnNames length (${t.options.columnNames.length}) doesn't match subquery select list length ${t.queryBuilder.expressionMap.selects.length} (CTE: ${t.alias})`);a+=`(${o.join(", ")})`}const i=t.options.recursive&&e?"RECURSIVE":"";let s="";return this.connection.driver.cteCapabilities.materializedHint&&t.options.materialized!==void 0&&(s=t.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[i,a,"AS",s,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(e){const t=this.expressionMap.mainAlias.metadata,r=(Array.isArray(e)?e:[e]).map(a=>t.ensureEntityIdMap(a));if(!t.hasMultiplePrimaryKeys){const a=t.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:KO(r.map(i=>a.getEntityValue(i,!1)))}}return new ph(a=>{for(const i of r)a.orWhere(new ph(s=>s.where(i)))})}getExistsCondition(e){const t=e.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${t.getQuery()})`,t.getParameters()]}findColumnsForPropertyPath(e){let t=this.expressionMap.mainAlias;const r=[],a=e.split(".");for(;a.length>1;){const o=a[0];if(!(t!=null&&t.hasMetadata))break;if(t.metadata.hasEmbeddedWithPropertyPath(o)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(t.metadata.hasRelationWithPropertyPath(o)){const l=this.expressionMap.joinAttributes.find(c=>c.relationPropertyPath===o);if(!(l!=null&&l.alias)){const c=r.length>0?`${r.join(".")}.${o}`:o;throw new Error(`Cannot find alias for relation at ${c}`)}t=l.alias,r.push(...o.split(".")),a.shift();continue}break}if(!t)throw new Error(`Cannot find alias for property ${e}`);const i=a.join("."),s=t.metadata.findColumnsWithPropertyPath(i);if(!s.length)throw new Hr(e,t.metadata);return[t,r,s]}createPropertyPath(e,t,r=""){const a=[];for(const i of Object.keys(t)){const s=r?`${r}.${i}`:i;if(t[i]===null||typeof t[i]!="object"||F.isFindOperator(t[i])){a.push(s);continue}if(e.hasEmbeddedWithPropertyPath(s)){const o=this.createPropertyPath(e,t[i],s);a.push(...o);continue}if(e.hasRelationWithPropertyPath(s)){const o=e.findRelationWithPropertyPath(s);if(o.relationType==="one-to-one"||o.relationType==="many-to-one"){const u=o.joinColumns.map(h=>h.referencedColumn).filter(h=>!!h);if(u.length>0&&u.every(h=>h.getEntityValue(t[i],!1))){a.push(s);continue}}if(o.relationType==="one-to-many"||o.relationType==="many-to-many")throw new Error(`Cannot query across ${o.relationType} for property ${s}`);const l=o.inverseEntityMetadata.primaryColumns;if(l.length>0&&l.every(u=>u.getEntityValue(t[i],!1))){const u=l.map(h=>`${s}.${h.propertyPath}`);a.push(...u);continue}const c=this.createPropertyPath(o.inverseEntityMetadata,t[i]).map(u=>`${s}.${u}`);a.push(...c);continue}a.push(s)}return a}*getPredicates(e){if(this.expressionMap.mainAlias.hasMetadata){const t=this.createPropertyPath(this.expressionMap.mainAlias.metadata,e);for(const r of t){const[a,i,s]=this.findColumnsForPropertyPath(r);for(const o of s){let l=e;for(const h of i){if(!l||!(h in l)){l={};break}l=l[h]}const c=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${o.propertyPath}`:o.propertyPath,u=o.getEntityValue(l,!0);yield[c,u]}}}else for(const t of Object.keys(e)){const r=e[t];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${t}`:t,r]}}getWherePredicateCondition(e,t){if(F.isFindOperator(t)){let r=[];if(t.useParameter)if(t.objectLiteralParameters)this.setParameters(t.objectLiteralParameters);else if(t.multipleParameters)for(const a of t.value)r.push(this.createParameter(a));else r.push(this.createParameter(t.value));if(t.type==="raw")return t.getSql?t.getSql(e):{operator:"equal",parameters:[e,t.value]};if(t.type==="not")return t.child?{operator:t.type,condition:this.getWherePredicateCondition(e,t.child)}:{operator:"notEqual",parameters:[e,...r]};if(t.type==="and"){const a=t.value;return{operator:t.type,parameters:a.map(i=>this.createWhereConditionExpression(this.getWherePredicateCondition(e,i)))}}else return{operator:t.type,parameters:[e,...r]}}else return{operator:"equal",parameters:[e,this.createParameter(t)]}}getWhereCondition(e){if(typeof e=="string")return e;if(F.isBrackets(e)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],e.whereFactory(a),{operator:F.isNotBrackets(e)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof e=="function")return e(this);const t=Array.isArray(e)?e:[e],r=[];for(const a of t){const i=[];for(const[s,o]of this.getPredicates(a))i.push({type:"and",condition:this.getWherePredicateCondition(s,o)});r.push({type:"or",condition:i})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}class Eh extends YO{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createSelectExpression(),e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e+=this.createLockExpression(),e=e.trim(),this.expressionMap.subQuery&&(e="("+e+")"),this.replacePropertyNamesForTheWholeQuery(e)}setFindOptions(e){return this.findOptions=e,this.applyFindOptions(),this}subQuery(){const e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.parentQueryBuilder=this,e}select(e,t){if(this.expressionMap.queryType="select",Array.isArray(e))this.expressionMap.selects=e.map(r=>({selection:r}));else if(typeof e=="function"){const r=e(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this}addSelect(e,t){if(!e)return this;if(Array.isArray(e))this.expressionMap.selects=this.expressionMap.selects.concat(e.map(r=>({selection:r})));else if(typeof e=="function"){const r=e(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this}maxExecutionTime(e){return this.expressionMap.maxExecutionTime=e,this}distinct(e=!0){return this.expressionMap.selectDistinct=e,this}distinctOn(e){return this.expressionMap.selectDistinctOn=e,this}fromDummy(){var e;return this.from((e=this.connection.driver.dummyTableName)!==null&&e!==void 0?e:"(SELECT 1 AS dummy_column)","dummy_table")}from(e,t){const r=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(r),this}addFrom(e,t){const r=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(e,t,r,a){return this.join("INNER",e,t,r,a),this}leftJoin(e,t,r,a){return this.join("LEFT",e,t,r,a),this}innerJoinAndSelect(e,t,r,a){return this.addSelect(t),this.innerJoin(e,t,r,a),this}leftJoinAndSelect(e,t,r,a){return this.addSelect(t),this.leftJoin(e,t,r,a),this}innerJoinAndMapMany(e,t,r,a,i){return this.addSelect(r),this.join("INNER",t,r,a,i,e,!0),this}innerJoinAndMapOne(e,t,r,a,i,s){return this.addSelect(r),this.join("INNER",t,r,a,i,e,!1,s),this}leftJoinAndMapMany(e,t,r,a,i){return this.addSelect(r),this.join("LEFT",t,r,a,i,e,!0),this}leftJoinAndMapOne(e,t,r,a,i,s){return this.addSelect(r),this.join("LEFT",t,r,a,i,e,!1,s),this}loadRelationIdAndMap(e,t,r,a){const i=new uf(this.expressionMap);return i.mapToProperty=e,i.relationName=t,typeof r=="string"&&(i.alias=r),typeof r=="object"&&r.disableMixedMap&&(i.disableMixedMap=!0),i.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(i),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(e,t,r,a){const i=new hf(this.expressionMap);return i.mapToProperty=e,i.relationName=t,i.alias=r,i.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(i),this.expressionMap.createAlias({type:"other",name:i.junctionAlias}),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this}loadAllRelationIds(e){return this.expressionMap.mainAlias.metadata.relations.forEach(t=>{e!==void 0&&e.relations!==void 0&&e.relations.indexOf(t.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+t.propertyPath,this.expressionMap.mainAlias.name+"."+t.propertyPath,e)}),this}where(e,t){this.expressionMap.wheres=[];const r=this.getWhereCondition(e);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereExists(e){return this.where(...this.getExistsCondition(e))}andWhereExists(e){return this.andWhere(...this.getExistsCondition(e))}orWhereExists(e){return this.orWhere(...this.getExistsCondition(e))}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}having(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this}andHaving(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this}orHaving(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this}groupBy(e){return e?this.expressionMap.groupBys=[e]:this.expressionMap.groupBys=[],this}addGroupBy(e){return this.expressionMap.groupBys.push(e),this}timeTravelQuery(e){return this.connection.driver.options.type==="cockroachdb"&&(e===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=e),this}orderBy(e,t="ASC",r){if(t!==void 0&&t!=="ASC"&&t!=="DESC")throw new $('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new $('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return e?typeof e=="object"?this.expressionMap.orderBys=e:r?this.expressionMap.orderBys={[e]:{order:t,nulls:r}}:this.expressionMap.orderBys={[e]:t}:this.expressionMap.orderBys={},this}addOrderBy(e,t="ASC",r){if(t!==void 0&&t!=="ASC"&&t!=="DESC")throw new $('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new $('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[e]={order:t,nulls:r}:this.expressionMap.orderBys[e]=t,this}limit(e){if(this.expressionMap.limit=this.normalizeNumber(e),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new $('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(e){if(this.expressionMap.offset=this.normalizeNumber(e),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new $('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(e){if(this.expressionMap.take=this.normalizeNumber(e),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new $('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(e){if(this.expressionMap.skip=this.normalizeNumber(e),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new $('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(e){return this.expressionMap.useIndex=e,this}setLock(e,t,r){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this.expressionMap.lockTables=r,this}setOnLocked(e){return this.expressionMap.onLocked=e,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new Il;this.expressionMap.queryEntity=!1;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0);const r=await this.loadRawResults(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getRawAndEntities(){const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getOne(){const e=(await this.getRawAndEntities()).entities[0];if(e&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const t=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=t.updateDateColumn.getEntityValue(e);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new pw(t.name,this.expressionMap.lockVersion,r)}else{const r=t.versionColumn.getEntityValue(e);if(r!==this.expressionMap.lockVersion)throw new pw(t.name,this.expressionMap.lockVersion,r)}}return e===void 0?null:e}async getOneOrFail(){const e=await this.getOne();if(!e)throw new ef(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return e}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new Il;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new Il;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new Il;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(e);return t&&await e.commitTransaction(),r}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new Il;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(e);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const i=await this.executeCountQuery(e),s=[r.entities,i];return t&&await e.commitTransaction(),s}catch(r){if(t)try{await e.rollbackTransaction()}catch{}throw r}finally{e!==this.queryRunner&&await e.release()}}async stream(){this.expressionMap.queryEntity=!1;const[e,t]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const i=()=>{if(r!==this.queryRunner)return r.release()},s=r.stream(e,t,i,i);return a&&await r.commitTransaction(),s}catch(i){if(a)try{await r.rollbackTransaction()}catch{}throw i}}cache(e,t){return typeof e=="boolean"?this.expressionMap.cache=e:typeof e=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):(typeof e=="string"||typeof e=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this}setOption(e){return this.expressionMap.options.push(e),this}join(e,t,r,a,i,s,o,l){i&&this.setParameters(i);const c=new jw(this.connection,this.expressionMap);c.direction=e,c.mapAsEntity=l,c.mapToProperty=s,c.isMappingMany=o,c.entityOrProperty=t,c.condition=a,this.expressionMap.joinAttributes.push(c);const u=c.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const h=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;c.condition=c.condition?` ${c.condition} AND ${h}`:`${h}`}c.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),c.relation&&c.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:c.junctionAlias,metadata:c.relation.junctionEntityMetadata})}else{let h="";if(typeof t=="function"){const f=t(this.subQuery());this.setParameters(f.getParameters()),h=f.getQuery()}else h=t;const d=typeof t=="function"||t.substr(0,1)==="("&&t.substr(-1)===")";c.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:d===!1?t:void 0,subQuery:d===!0?h:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new $("Cannot build query because main alias is not set (call qb#from method)");const e=[],t=[];if(this.expressionMap.mainAlias.hasMetadata){const o=this.expressionMap.mainAlias.metadata;e.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,o)),t.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,o))}this.expressionMap.joinAttributes.forEach(o=>{if(o.metadata)e.push(...this.buildEscapedEntityColumnSelects(o.alias.name,o.metadata)),t.push(...this.findEntityColumnSelects(o.alias.name,o.metadata));else if(this.expressionMap.selects.some(l=>l.selection===o.alias.name)){e.push({selection:this.escape(o.alias.name)+".*"});const l=this.expressionMap.selects.find(c=>c.selection===o.alias.name);t.push(l)}}),this.expressionMap.selects.filter(o=>t.indexOf(o)===-1).forEach(o=>e.push({selection:this.replacePropertyNames(o.selection),aliasName:o.aliasName})),e.length===0&&e.push({selection:"*"});let r="";this.expressionMap.useIndex&&pe.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(o=>o.type==="from"&&(o.tablePath||o.subQuery)).map(o=>o.subQuery?o.subQuery+" "+this.escape(o.name):this.getTableName(o.tablePath)+" "+this.escape(o.name)),i=this.createSelectDistinctExpression(),s=e.map(o=>o.selection+(o.aliasName?" AS "+this.escape(o.aliasName):"")).join(", ");return i+s+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:e,selectDistinctOn:t,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let i="SELECT ";return r>0&&pe.isMySQLFamily(a)&&(i+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),pe.isPostgresFamily(a)&&t.length>0?i=`SELECT DISTINCT ON (${t.map(s=>this.replacePropertyNames(s)).join(", ")}) `:e&&(i="SELECT DISTINCT "),i}createJoinExpression(){return this.expressionMap.joinAttributes.map(e=>{const t=e.relation,r=e.tablePath,a=e.alias.name;let i=e.condition?" AND ("+e.condition+")":"";const s=e.parentAlias;if(!s||!t){const o=e.alias.subQuery?e.alias.subQuery:this.getTableName(r);return" "+e.direction+" JOIN "+o+" "+this.escape(a)+this.createTableLockExpression()+(e.condition?" ON "+this.replacePropertyNames(e.condition):"")}if(t.isManyToOne||t.isOneToOneOwner){const o=t.joinColumns.map(l=>a+"."+l.referencedColumn.propertyPath+"="+s+"."+t.propertyPath+"."+l.referencedColumn.propertyPath).join(" AND ");return" "+e.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(o+i)}else if(t.isOneToMany||t.isOneToOneNotOwner){const o=t.inverseRelation.joinColumns.map(l=>(t.inverseEntityMetadata.tableType==="entity-child"&&t.inverseEntityMetadata.discriminatorColumn&&(i+=" AND "+a+"."+t.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+t.inverseEntityMetadata.discriminatorValue+"'"),a+"."+t.inverseRelation.propertyPath+"."+l.referencedColumn.propertyPath+"="+s+"."+l.referencedColumn.propertyPath)).join(" AND ");return" "+e.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(o+i)}else{const o=t.junctionEntityMetadata.tablePath,l=e.junctionAlias;let c="",u="";return t.isOwning?(c=t.joinColumns.map(h=>l+"."+h.propertyPath+"="+s+"."+h.referencedColumn.propertyPath).join(" AND "),u=t.inverseJoinColumns.map(h=>a+"."+h.referencedColumn.propertyPath+"="+l+"."+h.propertyPath).join(" AND ")):(c=t.inverseRelation.inverseJoinColumns.map(h=>l+"."+h.propertyPath+"="+s+"."+h.referencedColumn.propertyPath).join(" AND "),u=t.inverseRelation.joinColumns.map(h=>a+"."+h.referencedColumn.propertyPath+"="+l+"."+h.propertyPath).join(" AND "))," "+e.direction+" JOIN "+this.getTableName(o)+" "+this.escape(l)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(c)+" "+e.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+i)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const e=this.expressionMap.allOrderBys;return Object.keys(e).length===0?"":" ORDER BY "+Object.keys(e).map(t=>{const r=typeof e[t]=="string"?e[t]:e[t].order+" "+e[t].nulls,a=this.expressionMap.selects.find(i=>i.selection===t);if(a&&!a.aliasName&&t.indexOf(".")!==-1){const i=t.split("."),s=i[0],o=i.slice(1).join("."),l=this.expressionMap.aliases.find(c=>c.name===s);if(l){const c=l.metadata.findColumnWithPropertyPath(o);if(c){const u=pe.buildAlias(this.connection.driver,void 0,s,c.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(t)+" "+r}).join(", ")}createLimitOffsetExpression(){let e=this.expressionMap.offset,t=this.expressionMap.limit;if(!e&&!t&&this.expressionMap.joinAttributes.length===0&&(e=this.expressionMap.skip,t=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((t||e)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),t&&e)return r+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return r+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(e)return r+" OFFSET "+e+" ROWS"}else if(pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)throw new fM}else if(pe.isSQLiteFamily(this.connection.driver)){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" LIMIT -1 OFFSET "+e}else if(this.connection.driver.options.type==="oracle"){if(t&&e)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return" FETCH NEXT "+t+" ROWS ONLY";if(e)return" OFFSET "+e+" ROWS"}else{if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" OFFSET "+e}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const e=this.connection.driver;let t="";if(this.expressionMap.lockTables){if(!(pe.isPostgresFamily(e)||e.options.type==="cockroachdb"))throw new $("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new $("lockTables cannot be an empty array");t=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(e.options.type==="mysql"||e.options.type==="aurora-mysql")return pe.isReleaseVersionOrGreater(e,"8.0.0")?" FOR SHARE"+t+r:" LOCK IN SHARE MODE";if(e.options.type==="mariadb")return" LOCK IN SHARE MODE";if(pe.isPostgresFamily(e))return" FOR SHARE"+t+r;if(e.options.type==="oracle")return" FOR UPDATE";if(e.options.type==="mssql")return"";throw new Js;case"pessimistic_write":if(pe.isMySQLFamily(e)||e.options.type==="aurora-mysql"||e.options.type==="oracle")return" FOR UPDATE"+r;if(pe.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR UPDATE"+t+r;if(e.options.type==="mssql")return"";throw new Js;case"pessimistic_partial_write":if(pe.isPostgresFamily(e))return" FOR UPDATE"+t+" SKIP LOCKED";if(pe.isMySQLFamily(e))return" FOR UPDATE SKIP LOCKED";throw new Js;case"pessimistic_write_or_fail":if(pe.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR UPDATE"+t+" NOWAIT";if(pe.isMySQLFamily(e))return" FOR UPDATE NOWAIT";throw new Js;case"for_no_key_update":if(pe.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+t+r;throw new Js;case"for_key_share":if(pe.isPostgresFamily(e))return" FOR KEY SHARE"+t+r;throw new Js;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const e=this.expressionMap.havings.map((t,r)=>{switch(t.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(t.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(t.condition);default:return this.replacePropertyNames(t.condition)}}).join(" ");return e.length?" HAVING "+e:""}buildEscapedEntityColumnSelects(e,t){const r=this.expressionMap.selects.some(c=>c.selection===e),a=[];if(r&&a.push(...t.columns.filter(c=>c.isSelect===!0)),a.push(...t.columns.filter(c=>this.expressionMap.selects.some(u=>u.selection===e+"."+c.propertyPath))),a.length===0)return[];const i=this.expressionMap.queryEntity?t.primaryColumns.filter(c=>a.indexOf(c)===-1):[],s=[...a,...i],o=[],l=this.escape(e);return s.forEach(c=>{let u=l+"."+this.escape(c.databaseName);c.isVirtualProperty&&c.query&&(u=`(${c.query(l)})`),this.connection.driver.spatialTypes.indexOf(c.type)!==-1&&((pe.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),pe.isPostgresFamily(this.connection.driver)&&(c.precision?u=`ST_AsGeoJSON(${u}, ${c.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const h=this.expressionMap.selects.filter(d=>d.selection===e+"."+c.propertyPath);h.length?h.forEach(d=>{o.push({selection:u,aliasName:d.aliasName?d.aliasName:pe.buildAlias(this.connection.driver,void 0,e,c.databaseName),virtual:d.virtual})}):o.push({selection:u,aliasName:pe.buildAlias(this.connection.driver,void 0,e,c.databaseName),virtual:r})}),o}findEntityColumnSelects(e,t){const r=this.expressionMap.selects.find(a=>a.selection===e);return r?[r]:this.expressionMap.selects.filter(a=>t.columns.some(i=>a.selection===e+"."+i.propertyPath))}computeCountExpression(){const e=this.expressionMap.mainAlias.name,t=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(e);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||pe.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+t.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(pe.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+t.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=t.map(i=>`${r}.${this.escape(i.databaseName)}`).join(", '|;|', ");return t.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?t.length===1?`COUNT(DISTINCT(${r}.${this.escape(t[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${t.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+t.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(e){const t=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(t,"cnt").setOption("disable-global-order").loadRawResults(e);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(e){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(e)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const e=Array.isArray(this.findOptions.select)?Ee.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(e,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const e=Array.isArray(this.findOptions.relations)?Ee.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(e,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(e,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(e=>{e.select&&!e.selection?e.type==="inner"?this.innerJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):e.type==="inner"?this.innerJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(e=>{this.leftJoin(this.findOptions.join.leftJoin[e],e)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(e=>{this.innerJoin(this.findOptions.join.innerJoin[e],e)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(e=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[e],e)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(e=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[e],e)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const e=this.findOptions.lock.tables?this.findOptions.lock.tables.map(t=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===t);if(!r)throw new $(`"${t}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,e),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&un.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(e){this.relationMetadatas.push(e)}async executeEntitiesAndRawResults(e){if(!this.expressionMap.mainAlias)throw new $('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!e.isTransactionActive)throw new uM;if(this.expressionMap.lockMode==="optimistic"){const s=this.expressionMap.mainAlias.metadata;if(!s.versionColumn&&!s.updateDateColumn)throw new oM(s.name)}const t=new VO(this.connection,e,this.expressionMap.relationIdAttributes),r=new WO(this.connection,e,this.expressionMap.relationCountAttributes);new zO(this.expressionMap).transform(),new HO(this.expressionMap).transform();let a=[],i=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[s,o]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),l=this.expressionMap.mainAlias.metadata,c=this.expressionMap.mainAlias.name,u=l.primaryColumns.map(f=>{const g=this.escape("distinctAlias"),v=this.escape(pe.buildAlias(this.connection.driver,void 0,c,f.databaseName));o[v]||(o[v]="ASC");const C=pe.buildAlias(this.connection.driver,void 0,"ids_"+c,f.databaseName);return`${g}.${v} AS ${this.escape(C)}`}),h=this.clone(),d=h.expressionMap.timeTravel;if(a=await new Eh(this.connection,e).select(`DISTINCT ${u.join(", ")}`).addSelect(s).from(`(${h.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(d).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(o).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let f="";const g={};if(l.hasMultiplePrimaryKeys)f=a.map((v,C)=>l.primaryColumns.map(w=>{const T=`orm_distinct_ids_${C}_${w.databaseName}`,S=pe.buildAlias(this.connection.driver,void 0,"ids_"+c,w.databaseName);return g[T]=v[S],`${c}.${w.propertyPath}=:${T}`}).join(" AND ")).join(" OR ");else{const v=pe.buildAlias(this.connection.driver,void 0,"ids_"+c,l.primaryColumns[0].databaseName),C=a.map(w=>w[v]);C.every(w=>typeof w=="number")?f=`${c}.${l.primaryColumns[0].propertyPath} IN (${C.join(", ")})`:(g.orm_distinct_ids=C,f=c+"."+l.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:f}).setParameters(g).loadRawResults(e)}}else a=await this.loadRawResults(e);if(a.length>0){const s=await t.load(a),o=await r.load(a);i=new FO(this.expressionMap,this.connection.driver,s,o,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await e.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,i)}if(this.expressionMap.relationLoadStrategy==="query"){const s=new Bw(this.connection,e);await Promise.all(this.relationMetadatas.map(async o=>{const l=o.inverseEntityMetadata.target,c=o.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?Ee.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,h=Array.isArray(this.findOptions.relations)?Ee.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,d=this.createQueryBuilder().select(c).from(l,c).setFindOptions({select:u?Ee.deepValue(u,o.propertyPath):void 0,order:this.findOptions.order?Ee.deepValue(this.findOptions.order,o.propertyPath):void 0,relations:h?Ee.deepValue(h,o.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(i.length>0){const f=await s.loadManyToManyRelationIdsAndGroup(o,i,void 0,d);i.forEach(g=>{const v=f.find(C=>C.entity===g);if(v){const C=v.related===void 0?null:v.related;o.setEntityValue(g,C)}})}}))}return{raw:a,entities:i}}createOrderByCombinedWithSelectExpression(e){const t=this.expressionMap.allOrderBys,r=Object.keys(t).map(i=>{if(i.indexOf(".")!==-1){const s=i.split("."),o=s[0],l=s.slice(1).join("."),c=this.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyPath(l);return this.escape(e)+"."+this.escape(pe.buildAlias(this.connection.driver,void 0,o,c.databaseName))}else return this.expressionMap.selects.find(s=>s.selection===i||s.aliasName===i)?this.escape(e)+"."+this.escape(i):""}).join(", "),a={};return Object.keys(t).forEach(i=>{if(i.indexOf(".")!==-1){const s=i.split("."),o=s[0],l=s.slice(1).join("."),c=this.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyPath(l);a[this.escape(e)+"."+this.escape(pe.buildAlias(this.connection.driver,void 0,o,c.databaseName))]=t[i]}else this.expressionMap.selects.find(s=>s.selection===i||s.aliasName===i)?a[this.escape(e)+"."+this.escape(i)]=t[i]:a[i]=t[i]}),[r,a]}async loadRawResults(e){const[t,r]=this.getQueryAndParameters(),a=t+" -- PARAMETERS: "+JSON.stringify(r),i=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let s;const o=i.alwaysEnabled&&this.expressionMap.cache||this.expressionMap.cache;let l=!1;if(this.connection.queryResultCache&&o)try{if(s=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||i.duration||1e3},e),s&&!this.connection.queryResultCache.isExpired(s))return JSON.parse(s.result)}catch(u){if(!i.ignoreErrors)throw u;l=!0}const c=await e.query(t,r,!0);if(!l&&this.connection.queryResultCache&&o)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||i.duration||1e3,result:JSON.stringify(c.records)},s,e)}catch(u){if(!i.ignoreErrors)throw u}return c.records}mergeExpressionMap(e){return Ue.assign(this.expressionMap,e),this}normalizeNumber(e){return typeof e=="number"||e===void 0||e===null?e:Number(e)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner("slave")}buildSelect(e,t,r,a){for(let i in e){if(e[i]===void 0||e[i]===!1)continue;const s=a?a+"."+i:i,o=t.findColumnWithPropertyPathStrict(s),l=t.findEmbeddedWithPropertyPath(s),c=t.findRelationWithPropertyPath(s);if(!l&&!o&&!c)throw new Hr(s,t);o?this.selects.push(r+"."+s):l&&this.buildSelect(e[i],t,r,s)}}buildRelations(e,t,r,a,i){e&&Object.keys(e).forEach(s=>{const o=e[s],l=i?i+"."+s:s,c=r.findEmbeddedWithPropertyPath(l),u=r.findRelationWithPropertyPath(l);if(!c&&!u)throw new Hr(l,r);if(c)this.buildRelations(o,typeof t=="object"?Ee.deepValue(t,c.propertyPath):void 0,r,a,l);else if(u){let h=a+"_"+l.replace(".","_");h=pe.buildAlias(this.connection.driver,{joiner:"__"},a,h),(o===!0||typeof o=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:t&&typeof t[s]=="object"?t[s]:void 0,alias:h,parentAlias:a,relationMetadata:u}),t&&typeof t[s]=="object"&&this.buildSelect(t[s],u.inverseEntityMetadata,h))),typeof o=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(o,typeof t=="object"?Ee.deepValue(t,u.propertyPath):void 0,u.inverseEntityMetadata,h,void 0)}})}buildEagerRelations(e,t,r,a,i){e&&Object.keys(e).forEach(s=>{const o=e[s],l=i?i+"."+s:s,c=r.findEmbeddedWithPropertyPath(l),u=r.findRelationWithPropertyPath(l);if(!c&&!u)throw new Hr(l,r);if(c)this.buildEagerRelations(o,typeof t=="object"?Ee.deepValue(t,c.propertyPath):void 0,r,a,l);else if(u){let h=a+"_"+l.replace(".","_");h=pe.buildAlias(this.connection.driver,{joiner:"__"},a,h),(o===!0||typeof o=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(d=>{let f=h+"_"+d.propertyPath.replace(".","_");f=pe.buildAlias(this.connection.driver,{joiner:"__"},h,f),this.joins.find(g=>g.alias===f)||this.joins.push({type:"left",select:!0,alias:f,parentAlias:h,selection:void 0,relationMetadata:d}),t&&typeof t[s]=="object"&&this.buildSelect(t[s],u.inverseEntityMetadata,h)}),typeof o=="object"&&this.buildEagerRelations(o,typeof t=="object"?Ee.deepValue(t,u.propertyPath):void 0,u.inverseEntityMetadata,h,void 0)}})}buildOrder(e,t,r,a){for(let i in e){if(e[i]===void 0)continue;const s=a?a+"."+i:i,o=t.findColumnWithPropertyPathStrict(s),l=t.findEmbeddedWithPropertyPath(s),c=t.findRelationWithPropertyPath(s);if(!l&&!o&&!c)throw new Hr(s,t);if(o){let u=typeof e[i]=="object"?e[i].direction:e[i];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let h=typeof e[i]=="object"?e[i].nulls:void 0;h=(h==null?void 0:h.toLowerCase())==="first"?"NULLS FIRST":(h==null?void 0:h.toLowerCase())==="last"?"NULLS LAST":void 0;let d=`${r}.${s}`;this.addOrderBy(d,u,h)}else if(l)this.buildOrder(e[i],t,r,s);else if(c){let u=r+"_"+s.replace(".","_");u=pe.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(h=>h.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:c}),this.buildOrder(e[i],c.inverseEntityMetadata,u)}}}buildWhere(e,t,r,a){let i="";if(Array.isArray(e)&&e.length)i="("+e.map(s=>this.buildWhere(s,t,r,a)).filter(s=>!!s).map(s=>"("+s+")").join(" OR ")+")";else{let s=[];for(let o in e){if(e[o]===void 0||e[o]===null)continue;const l=a?a+"."+o:o,c=t.findColumnWithPropertyPathStrict(l),u=t.findEmbeddedWithPropertyPath(l),h=t.findRelationWithPropertyPath(l);if(!u&&!c&&!h)throw new Hr(l,t);if(c){let d=`${r}.${l}`;c.isVirtualProperty&&c.query&&(d=`(${c.query(r)})`);let f=e[o];F.isEqualOperator(e[o])&&(f=e[o].value),c.transformer&&(f instanceof jl?f.transformValue(c.transformer):f=qt.transformTo(c.transformer,f)),s.push(this.createWhereConditionExpression(this.getWherePredicateCondition(d,f)))}else if(u){const d=this.buildWhere(e[o],t,r,l);d&&s.push(d)}else if(h){if(typeof e[o]=="object"&&Object.keys(e[o]).every(d=>e[o][d]===void 0))continue;if(F.isFindOperator(e[o]))if(e[o].type==="moreThan"||e[o].type==="lessThan"||e[o].type==="moreThanOrEqual"||e[o].type==="lessThanOrEqual"){let d="";e[o].type==="moreThan"?d=">":e[o].type==="lessThan"?d="<":e[o].type==="moreThanOrEqual"?d=">=":e[o].type==="lessThanOrEqual"&&(d="<=");const f=this.subQuery();if(h.isManyToManyOwner)f.select("COUNT(*)").from(h.joinTableName,h.joinTableName).where(h.joinColumns.map(g=>`${h.joinTableName}.${g.propertyName} = ${r}.${g.referencedColumn.propertyName}`).join(" AND "));else if(h.isManyToManyNotOwner)f.select("COUNT(*)").from(h.inverseRelation.joinTableName,h.inverseRelation.joinTableName).where(h.inverseRelation.inverseJoinColumns.map(g=>`${h.inverseRelation.joinTableName}.${g.propertyName} = ${r}.${g.referencedColumn.propertyName}`).join(" AND "));else if(h.isOneToMany)f.select("COUNT(*)").from(h.inverseEntityMetadata.target,h.inverseEntityMetadata.tableName).where(h.inverseRelation.joinColumns.map(g=>`${h.inverseEntityMetadata.tableName}.${g.propertyName} = ${r}.${g.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(f.getSql()+" "+d+" "+parseInt(e[o].value))}else if(h.isManyToOne||h.isOneToOne&&h.isOneToOneOwner){const d=`${r}.${l}`;s.push(this.createWhereConditionExpression(this.getWherePredicateCondition(d,e[o])))}else throw new Error("This relation isn't supported by given find operator");else{let d=r+"_"+h.propertyPath.replace(".","_");d=pe.buildAlias(this.connection.driver,{joiner:"__"},r,d),this.joins.find(g=>g.alias===d)||this.joins.push({type:"left",select:!1,selection:void 0,alias:d,parentAlias:r,relationMetadata:h});const f=this.buildWhere(e[o],h.inverseEntityMetadata,d);f&&s.push(f)}}}i=s.join(" AND ")}return i}}class pf{constructor(e){this.options=e}logQuery(e,t,r){this.isLogEnabledFor("query")&&this.writeLog("query",{type:"query",prefix:"query",message:e,format:"sql",parameters:t},r)}logQueryError(e,t,r,a){this.isLogEnabledFor("query-error")&&this.writeLog("warn",[{type:"query-error",prefix:"query failed",message:t,format:"sql",parameters:r},{type:"query-error",prefix:"error",message:e}],a)}logQuerySlow(e,t,r,a){this.isLogEnabledFor("query-slow")&&this.writeLog("warn",[{type:"query-slow",prefix:"query is slow",message:t,format:"sql",parameters:r,additionalInfo:{time:e}},{type:"query-slow",prefix:"execution time",message:e}],a)}logSchemaBuild(e,t){this.isLogEnabledFor("schema-build")&&this.writeLog("schema",{type:"schema-build",message:e},t)}logMigration(e,t){this.isLogEnabledFor("migration")||this.writeLog("log",{type:"migration",message:e},t)}log(e,t,r){switch(e){case"log":if(!this.isLogEnabledFor("log"))return;this.writeLog("log",{type:"log",message:t},r);break;case"info":if(!this.isLogEnabledFor("info"))return;this.writeLog("info",{type:"info",prefix:"info",message:t},r);break;case"warn":if(!this.isLogEnabledFor("warn"))return;this.writeLog("warn",{type:"warn",message:t},r);break}}isLogEnabledFor(e){switch(e){case"query":return this.options==="all"||this.options===!0||Array.isArray(this.options)&&this.options.indexOf("query")!==-1;case"error":case"query-error":return this.options==="all"||this.options===!0||Array.isArray(this.options)&&this.options.indexOf("error")!==-1;case"query-slow":return!0;case"schema":case"schema-build":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("schema")!==-1;case"migration":return!0;case"log":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("log")!==-1;case"info":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("info")!==-1;case"warn":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("warn")!==-1;default:return!1}}prepareLogMessages(e,t){t={addColonToPrefix:!0,appendParameterAsComment:!0,highlightSql:!0,...t};const r=Array.isArray(e)?e:[e];for(let a of r){if(typeof a!="object"&&(a={message:a}),a.format==="sql"){let i=String(a.message);t.appendParameterAsComment&&a.parameters&&a.parameters.length&&(i+=` -- PARAMETERS: ${this.stringifyParams(a.parameters)}`),t.highlightSql&&(i=ht.highlightSql(i)),a.message=i}t.addColonToPrefix&&a.prefix&&(a.prefix+=":")}return r}stringifyParams(e){try{return JSON.stringify(e)}catch{return e}}}class JO extends pf{writeLog(e,t,r){var a;const i=this.prepareLogMessages(t,{highlightSql:!1});for(let s of i)switch((a=s.type)!==null&&a!==void 0?a:e){case"log":case"schema-build":case"migration":console.log(s.message);break;case"info":case"query":s.prefix?console.info(s.prefix,s.message):console.info(s.message);break;case"warn":case"query-slow":s.prefix?console.warn(s.prefix,s.message):console.warn(s.message);break;case"error":case"query-error":s.prefix?console.error(s.prefix,s.message):console.error(s.message);break}}}class Fw extends pf{writeLog(e,t,r){var a;const i=this.prepareLogMessages(t);for(let s of i)switch((a=s.type)!==null&&a!==void 0?a:e){case"log":case"schema-build":case"migration":ht.log(String(s.message));break;case"info":case"query":s.prefix?ht.logInfo(s.prefix,s.message):ht.log(String(s.message));break;case"warn":case"query-slow":s.prefix?ht.logWarn(s.prefix,s.message):console.warn(ht.warn(String(s.message)));break;case"error":case"query-error":s.prefix?ht.logError(s.prefix,String(s.message)):console.error(ht.error(String(s.message)));break}}}class XO{logQuery(){throw new Error("This logger is not applicable in a browser context")}logQueryError(){throw new Error("This logger is not applicable in a browser context")}logQuerySlow(){throw new Error("This logger is not applicable in a browser context")}logSchemaBuild(){throw new Error("This logger is not applicable in a browser context")}logMigration(){throw new Error("This logger is not applicable in a browser context")}log(){throw new Error("This logger is not applicable in a browser context")}}class ZO extends XO{}var mf={exports:{}},ff,Vw;function e_(){if(Vw)return ff;Vw=1;var n=1e3,e=n*60,t=e*60,r=t*24,a=r*7,i=r*365.25;ff=function(u,h){h=h||{};var d=typeof u;if(d==="string"&&u.length>0)return s(u);if(d==="number"&&isFinite(u))return h.long?l(u):o(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function s(u){if(u=String(u),!(u.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(h){var d=parseFloat(h[1]),f=(h[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return d*i;case"weeks":case"week":case"w":return d*a;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*t;case"minutes":case"minute":case"mins":case"min":case"m":return d*e;case"seconds":case"second":case"secs":case"sec":case"s":return d*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function o(u){var h=Math.abs(u);return h>=r?Math.round(u/r)+"d":h>=t?Math.round(u/t)+"h":h>=e?Math.round(u/e)+"m":h>=n?Math.round(u/n)+"s":u+"ms"}function l(u){var h=Math.abs(u);return h>=r?c(u,h,r,"day"):h>=t?c(u,h,t,"hour"):h>=e?c(u,h,e,"minute"):h>=n?c(u,h,n,"second"):u+" ms"}function c(u,h,d,f){var g=h>=d*1.5;return Math.round(u/d)+" "+f+(g?"s":"")}return ff}function t_(n){t.debug=t,t.default=t,t.coerce=l,t.disable=i,t.enable=a,t.enabled=s,t.humanize=e_(),t.destroy=c,Object.keys(n).forEach(u=>{t[u]=n[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let h=0;for(let d=0;d<u.length;d++)h=(h<<5)-h+u.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(u){let h,d=null,f,g;function v(...C){if(!v.enabled)return;const w=v,T=Number(new Date),S=T-(h||T);w.diff=S,w.prev=h,w.curr=T,h=T,C[0]=t.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let O=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(k,B)=>{if(k==="%%")return"%";O++;const D=t.formatters[B];if(typeof D=="function"){const V=C[O];k=D.call(w,V),C.splice(O,1),O--}return k}),t.formatArgs.call(w,C),(w.log||t.log).apply(w,C)}return v.namespace=u,v.useColors=t.useColors(),v.color=t.selectColor(u),v.extend=r,v.destroy=t.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(f!==t.namespaces&&(f=t.namespaces,g=t.enabled(u)),g),set:C=>{d=C}}),typeof t.init=="function"&&t.init(v),v}function r(u,h){const d=t(this.namespace+(typeof h>"u"?":":h)+u);return d.log=this.log,d}function a(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let h;const d=(typeof u=="string"?u:"").split(/[\s,]+/),f=d.length;for(h=0;h<f;h++)d[h]&&(u=d[h].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.slice(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function i(){const u=[...t.names.map(o),...t.skips.map(o).map(h=>"-"+h)].join(",");return t.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(u))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var n_=t_;(function(n,e){var t={};e.formatArgs=a,e.save=i,e.load=s,e.useColors=r,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let h=0,d=0;c[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(h++,f==="%c"&&(d=h))}),c.splice(d,0,u)}e.log=console.debug||console.log||(()=>{});function i(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function s(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=t.DEBUG),c}function o(){try{return localStorage}catch{}}n.exports=n_(e);const{formatters:l}=n.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(mf,mf.exports);var wa=mf.exports;class r_ extends pf{constructor(){super(...arguments),this.logger={log:wa.debug("typeorm:log"),info:wa.debug("typeorm:info"),warn:wa.debug("typeorm:warn"),error:wa.debug("typeorm:error"),query:wa.debug("typeorm:query:log"),"query-error":wa.debug("typeorm:query:error"),"query-slow":wa.debug("typeorm:query:slow"),"schema-build":wa.debug("typeorm:schema"),migration:wa.debug("typeorm:migration")}}isLogEnabledFor(e){switch(e){case"query":return this.logger.query.enabled;case"query-error":return this.logger["query-error"].enabled;case"query-slow":return!0;case"schema":case"schema-build":return this.logger["schema-build"].enabled;case"migration":return this.logger.migration.enabled;case"log":return this.logger.log.enabled;case"info":return this.logger.info.enabled;case"warn":return this.logger.warn.enabled;default:return!1}}writeLog(e,t,r){var a;const i=this.prepareLogMessages(t,{appendParameterAsComment:!1});for(let s of i){const o=(a=s.type)!==null&&a!==void 0?a:e;o in this.logger&&(s.prefix?this.logger[o](s.prefix,s.message):this.logger[o](s.message),s.parameters&&s.parameters.length&&this.logger[o]("parameters:",s.parameters))}}}class zw{create(e,t){if(Ue.isObject(e))return e;if(e)switch(e){case"simple-console":return new JO(t);case"file":return new ZO(t);case"advanced-console":return new Fw(t);case"debug":return new r_}return new Fw(t)}}class a_{constructor(e,t){this.connection=e,this.clientType=t,this.redis=this.loadRedis()}async connect(){const e=this.connection.options.cache;if(this.clientType==="redis")this.client=this.redis.createClient({...e==null?void 0:e.options,legacyMode:!0}),typeof this.connection.options.cache=="object"&&this.connection.options.cache.ignoreErrors&&this.client.on("error",t=>{this.connection.logger.log("warn",t)}),"connect"in this.client&&await this.client.connect();else if(this.clientType==="ioredis")e&&e.port?e.options?this.client=new this.redis(e.port,e.options):this.client=new this.redis(e.port):e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if(this.clientType==="ioredis/cluster")if(e&&e.options&&Array.isArray(e.options))this.client=new this.redis.Cluster(e.options);else if(e&&e.options&&e.options.startupNodes)this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options);else throw new $(`options.startupNodes required for ${this.clientType}.`)}async disconnect(){return new Promise((e,t)=>{this.client.quit((r,a)=>{if(r)return t(r);e(),this.client=void 0})})}async synchronize(e){}getFromCache(e,t){return new Promise((r,a)=>{e.identifier?this.client.get(e.identifier,(i,s)=>{if(i)return a(i);r(JSON.parse(s))}):e.query?this.client.get(e.query,(i,s)=>{if(i)return a(i);r(JSON.parse(s))}):r(void 0)})}isExpired(e){return e.time+e.duration<new Date().getTime()}async storeInCache(e,t,r){return new Promise((a,i)=>{e.identifier?this.client.set(e.identifier,JSON.stringify(e),"PX",e.duration,(s,o)=>{if(s)return i(s);a()}):e.query&&this.client.set(e.query,JSON.stringify(e),"PX",e.duration,(s,o)=>{if(s)return i(s);a()})})}async clear(e){return new Promise((t,r)=>{this.client.flushdb((a,i)=>{if(a)return r(a);t()})})}async remove(e,t){await Promise.all(e.map(r=>this.deleteKey(r)))}deleteKey(e){return new Promise((t,r)=>{this.client.del(e,(a,i)=>{if(a)return r(a);t()})})}loadRedis(){try{return this.clientType==="ioredis/cluster"?ht.load("ioredis"):ht.load(this.clientType)}catch{throw new $(`Cannot use cache because ${this.clientType} is not installed. Please run "npm i ${this.clientType} --save".`)}}}let wh;const i_=new Uint8Array(16);function s_(){if(!wh&&(wh=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!wh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return wh(i_)}const Xt=[];for(let n=0;n<256;++n)Xt.push((n+256).toString(16).slice(1));function o_(n,e=0){return Xt[n[e+0]]+Xt[n[e+1]]+Xt[n[e+2]]+Xt[n[e+3]]+"-"+Xt[n[e+4]]+Xt[n[e+5]]+"-"+Xt[n[e+6]]+Xt[n[e+7]]+"-"+Xt[n[e+8]]+Xt[n[e+9]]+"-"+Xt[n[e+10]]+Xt[n[e+11]]+Xt[n[e+12]]+Xt[n[e+13]]+Xt[n[e+14]]+Xt[n[e+15]]}const l_=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ww={randomUUID:l_};function c_(n,e,t){if(Ww.randomUUID&&!e&&!n)return Ww.randomUUID();n=n||{};const r=n.random||(n.rng||s_)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let a=0;a<16;++a)e[t+a]=r[a];return e}return o_(r)}class u_{constructor(e){this.connection=e;const{schema:t}=this.connection.driver.options,r=this.connection.driver.database,a=(typeof this.connection.options.cache=="object"?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheDatabase=r,this.queryResultCacheSchema=t,this.queryResultCacheTable=this.connection.driver.buildTableName(a,t,r)}async connect(){}async disconnect(){}async synchronize(e){e=this.getQueryRunner(e);const t=this.connection.driver;await e.hasTable(this.queryResultCacheTable)||await e.createTable(new _t({database:this.queryResultCacheDatabase,schema:this.queryResultCacheSchema,name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:t.normalizeType({type:t.mappedDataTypes.cacheId}),generationStrategy:t.options.type==="spanner"?"uuid":"increment",isGenerated:!0},{name:"identifier",type:t.normalizeType({type:t.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:t.normalizeType({type:t.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:t.normalizeType({type:t.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:t.normalizeType({type:t.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:t.normalizeType({type:t.mappedDataTypes.cacheResult}),isNullable:!1}]}))}getFromCache(e,t){t=this.getQueryRunner(t);const r=this.connection.createQueryBuilder(t).select().from(this.queryResultCacheTable,"cache");return e.identifier?r.where(`${r.escape("cache")}.${r.escape("identifier")} = :identifier`).setParameters({identifier:this.connection.driver.options.type==="mssql"?new Rr(e.identifier,"nvarchar"):e.identifier}).getRawOne():e.query?this.connection.driver.options.type==="oracle"?r.where(`dbms_lob.compare(${r.escape("cache")}.${r.escape("query")}, :query) = 0`,{query:e.query}).getRawOne():r.where(`${r.escape("cache")}.${r.escape("query")} = :query`).setParameters({query:this.connection.driver.options.type==="mssql"?new Rr(e.query,"nvarchar"):e.query}).getRawOne():Promise.resolve(void 0)}isExpired(e){const t=typeof e.duration=="string"?parseInt(e.duration):e.duration;return(typeof e.time=="string"?parseInt(e.time):e.time)+t<new Date().getTime()}async storeInCache(e,t,r){const a=r===void 0||(r==null?void 0:r.getReplicationMode())==="slave";(r===void 0||a)&&(r=this.connection.createQueryRunner("master"));let i=e;if(this.connection.driver.options.type==="mssql"&&(i={identifier:new Rr(e.identifier,"nvarchar"),time:new Rr(e.time,"bigint"),duration:new Rr(e.duration,"int"),query:new Rr(e.query,"nvarchar"),result:new Rr(e.result,"nvarchar")}),t&&t.identifier){const s=r.manager.createQueryBuilder().update(this.queryResultCacheTable).set(i);s.where(`${s.escape("identifier")} = :condition`,{condition:i.identifier}),await s.execute()}else if(t&&t.query){const s=r.manager.createQueryBuilder().update(this.queryResultCacheTable).set(i);this.connection.driver.options.type==="oracle"?s.where('dbms_lob.compare("query", :condition) = 0',{condition:i.query}):s.where(`${s.escape("query")} = :condition`,{condition:i.query}),await s.execute()}else this.connection.driver.options.type==="spanner"&&!i.id&&(i.id=c_()),await r.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(i).execute();a&&await r.release()}async clear(e){return this.getQueryRunner(e).clearTable(this.queryResultCacheTable)}async remove(e,t){let r=t||this.getQueryRunner();await Promise.all(e.map(a=>{const i=r.manager.createQueryBuilder();return i.delete().from(this.queryResultCacheTable).where(`${i.escape("identifier")} = :identifier`,{identifier:a}).execute()})),t||await r.release()}getQueryRunner(e){return e||this.connection.createQueryRunner()}}class Hw{constructor(e){this.connection=e}create(){if(!this.connection.options.cache)throw new $("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");const e=this.connection.options.cache;return e.provider&&typeof e.provider=="function"?e.provider(this.connection):e.type==="redis"||e.type==="ioredis"||e.type==="ioredis/cluster"?new a_(this.connection,e.type):new u_(this.connection)}}class h_{constructor(e){this.connection=e}load(e,t,r,a){return r&&r.isReleased&&(r=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,t,r,a):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,t,r,a):e.isManyToManyOwner?this.loadManyToManyOwner(e,t,r,a):this.loadManyToManyNotOwner(e,t,r,a)}loadManyToOneOrOneToOneOwner(e,t,r,a){const i=Array.isArray(t)?t:[t],s=e.entityMetadata.name,o=a||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.type,e.propertyName),l=o.expressionMap.mainAlias.name,c=e.entityMetadata.primaryColumns,u=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map(h=>`${e.entityMetadata.name}.${h.propertyName} = ${l}.${h.referencedColumn.propertyName}`).join(" AND ");if(o.innerJoin(e.entityMetadata.target,s,u),c.length===1)o.where(`${s}.${c[0].propertyPath} IN (:...${s+"_"+c[0].propertyName})`),o.setParameter(s+"_"+c[0].propertyName,i.map(h=>c[0].getEntityValue(h,!0)));else{const h=i.map((d,f)=>c.map((g,v)=>{const C=s+"_entity_"+f+"_"+v;return o.setParameter(C,g.getEntityValue(d,!0)),s+"."+g.propertyPath+" = :"+C}).join(" AND ")).map(d=>"("+d+")").join(" OR ");o.where(h)}return un.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadOneToManyOrOneToOneNotOwner(e,t,r,a){const i=Array.isArray(t)?t:[t],s=e.inverseRelation.joinColumns,o=a||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.inverseRelation.entityMetadata.target,e.propertyName),l=o.expressionMap.mainAlias.name;if(s.length===1)o.where(`${l}.${s[0].propertyPath} IN (:...${l+"_"+s[0].propertyName})`),o.setParameter(l+"_"+s[0].propertyName,i.map(c=>s[0].referencedColumn.getEntityValue(c,!0)));else{const c=i.map((u,h)=>s.map((d,f)=>{const g=l+"_entity_"+h+"_"+f;return o.setParameter(g,d.referencedColumn.getEntityValue(u,!0)),l+"."+d.propertyPath+" = :"+g}).join(" AND ")).map(u=>"("+u+")").join(" OR ");o.where(c)}return un.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadManyToManyOwner(e,t,r,a){const i=Array.isArray(t)?t:[t],s=e.joinColumns.reduce((d,f)=>(d[f.propertyName]=i.map(g=>f.referencedColumn.getEntityValue(g,!0)),d),{}),o=a||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.type,e.propertyName),l=o.expressionMap.mainAlias.name,c=e.junctionEntityMetadata.tableName,u=e.joinColumns.map(d=>`${c}.${d.propertyName} IN (:...${d.propertyName})`),h=e.inverseJoinColumns.map(d=>`${c}.${d.propertyName}=${l}.${d.referencedColumn.propertyName}`);return o.innerJoin(c,c,[...u,...h].join(" AND ")).setParameters(s),un.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadManyToManyNotOwner(e,t,r,a){const i=Array.isArray(t)?t:[t],s=a||this.connection.createQueryBuilder(r).select(e.propertyName).from(e.type,e.propertyName),o=s.expressionMap.mainAlias.name,l=e.junctionEntityMetadata.tableName,c=e.inverseRelation.joinColumns.map(d=>`${l}.${d.propertyName} = ${o}.${d.referencedColumn.propertyName}`),u=e.inverseRelation.inverseJoinColumns.map(d=>`${l}.${d.propertyName} IN (:...${d.propertyName})`),h=e.inverseRelation.inverseJoinColumns.reduce((d,f)=>(d[f.propertyName]=i.map(g=>f.referencedColumn.getEntityValue(g,!0)),d),{});return s.innerJoin(l,l,[...c,...u].join(" AND ")).setParameters(h),un.joinEagerRelations(s,s.alias,s.expressionMap.mainAlias.metadata),s.getMany()}enableLazyLoad(e,t,r){const a=this,i="__"+e.propertyName+"__",s="__promise_"+e.propertyName+"__",o="__has_"+e.propertyName+"__",l=(u,h)=>(u[i]=h,u[o]=!0,delete u[s],h),c=(u,h)=>(delete u[o],delete u[i],u[s]=h,h.then(d=>u[s]===h?l(u,d):d),h);Object.defineProperty(t,e.propertyName,{get:function(){if(this[o]===!0||this[i]!==void 0)return Promise.resolve(this[i]);if(this[s])return this[s];const u=a.load(e,this,r).then(h=>e.isOneToOne||e.isManyToOne?h.length===0?null:h[0]:h);return c(this,u)},set:function(u){u instanceof Promise?c(this,u):l(this,u)},configurable:!0,enumerable:!1})}}class d_{constructor(e){this["@instanceof"]=Symbol.for("DataSource"),this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.entityMetadatasMap=new Map,this.name=e.name||"default",this.options=e,this.logger=new zw().create(this.options.logger,this.options.logging),this.driver=new PO().create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new GR,this.metadataTableName=e.metadataTableName||"typeorm_metadata",this.queryResultCache=e.cache?new Hw(this).create():void 0,this.relationLoader=new h_(this),this.relationIdLoader=new Bw(this),this.isInitialized=!1}get isConnected(){return this.isInitialized}get mongoManager(){if(!F.isMongoEntityManager(this.manager))throw new $("MongoEntityManager is only available for MongoDB databases.");return this.manager}get sqljsManager(){if(!F.isSqljsEntityManager(this.manager))throw new $("SqljsEntityManager is only available for Sqljs databases.");return this.manager}setOptions(e){return Object.assign(this.options,e),(e.logger||e.logging)&&(this.logger=new zw().create(e.logger||this.options.logger,e.logging||this.options.logging)),e.namingStrategy&&(this.namingStrategy=e.namingStrategy),e.cache&&(this.queryResultCache=new Hw(this).create()),e.database&&(this.driver.database=pe.buildDriverOptions(this.options).database),this}async initialize(){if(this.isInitialized)throw new YR(this.name);await this.driver.connect(),this.queryResultCache&&await this.queryResultCache.connect(),Ue.assign(this,{isInitialized:!0});try{await this.buildMetadatas(),await this.driver.afterConnect(),this.options.dropSchema&&await this.dropDatabase(),this.options.migrationsRun&&await this.runMigrations({transaction:this.options.migrationsTransactionMode}),this.options.synchronize&&await this.synchronize()}catch(e){throw await this.destroy(),e}return this}async connect(){return this.initialize()}async destroy(){if(!this.isInitialized)throw new Dl(this.name);await this.driver.disconnect(),this.queryResultCache&&await this.queryResultCache.disconnect(),Ue.assign(this,{isInitialized:!1})}async close(){return this.destroy()}async synchronize(e=!1){if(!this.isInitialized)throw new Dl(this.name);e&&await this.dropDatabase(),await this.driver.createSchemaBuilder().build()}async dropDatabase(){const e=this.createQueryRunner();try{if(this.driver.options.type==="mssql"||pe.isMySQLFamily(this.driver)||this.driver.options.type==="aurora-mysql"||pe.isSQLiteFamily(this.driver)){const t=[];if(this.entityMetadatas.forEach(r=>{r.database&&t.indexOf(r.database)===-1&&t.push(r.database)}),t.length===0&&this.driver.database&&t.push(this.driver.database),t.length===0)await e.clearDatabase();else for(const r of t)await e.clearDatabase(r)}else await e.clearDatabase()}finally{await e.release()}}async runMigrations(e){if(!this.isInitialized)throw new Dl(this.name);const t=new nf(this);return t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1,await t.executePendingMigrations()}async undoLastMigration(e){if(!this.isInitialized)throw new Dl(this.name);const t=new nf(this);t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1,await t.undoLastMigration()}async showMigrations(){if(!this.isInitialized)throw new Dl(this.name);return await new nf(this).showMigrations()}hasMetadata(e){return!!this.findMetadata(e)}getMetadata(e){const t=this.findMetadata(e);if(!t)throw new tM(e);return t}getRepository(e){return this.manager.getRepository(e)}getTreeRepository(e){return this.manager.getTreeRepository(e)}getMongoRepository(e){if(this.driver.options.type!=="mongodb")throw new $("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)}getCustomRepository(e){return this.manager.getCustomRepository(e)}async transaction(e,t){return this.manager.transaction(e,t)}async query(e,t,r){if(F.isMongoEntityManager(this.manager))throw new $("Queries aren't supported by MongoDB.");if(r&&r.isReleased)throw new mw;const a=r||this.createQueryRunner();try{return await a.query(e,t)}finally{r||await a.release()}}createQueryBuilder(e,t,r){if(F.isMongoEntityManager(this.manager))throw new $("Query Builder is not supported by MongoDB.");if(t){t=pe.buildAlias(this.driver,void 0,t);const a=this.getMetadata(e);return new Eh(this,r).select(t).from(a.target,t)}else return new Eh(this,e)}createQueryRunner(e="master"){const t=this.driver.createQueryRunner(e),r=this.createEntityManager(t);return Object.assign(t,{manager:r}),t}getManyToManyMetadata(e,t){const r=this.getMetadata(e).findRelationWithPropertyPath(t);if(!r)throw new $(`Relation "${t}" was not found in ${e} entity.`);if(!r.isManyToMany)throw new $(`Relation "${e}#${t}" does not have a many-to-many relationship.You can use this method only on many-to-many relations.`);return r.junctionEntityMetadata}createEntityManager(e){return new uO().create(this,e)}findMetadata(e){const t=this.entityMetadatasMap.get(e);if(t)return t;for(let[r,a]of this.entityMetadatasMap){if(F.isEntitySchema(e)&&a.name===e.options.name)return a;if(typeof e=="string"){if(e.indexOf(".")!==-1){if(a.tablePath===e)return a}else if(a.name===e||a.tableName===e)return a}if(Ue.isObjectWithName(e)&&typeof e.name=="string"){if(e.name.indexOf(".")!==-1){if(a.tablePath===e.name)return a}else if(a.name===e.name||a.tableName===e.name)return a}}}async buildMetadatas(){const e=new UO(this),t=new vM,r=Ue.mixedListToArray(this.options.subscribers||[]),a=await e.buildSubscribers(r);Ue.assign(this,{subscribers:a});const i=Ue.mixedListToArray(this.options.entities||[]),s=await e.buildEntityMetadatas(i);Ue.assign(this,{entityMetadatas:s,entityMetadatasMap:new Map(s.map(c=>[c.target,c]))});const o=Ue.mixedListToArray(this.options.migrations||[]),l=await e.buildMigrations(o);Ue.assign(this,{migrations:l}),t.validateMany(this.entityMetadatas.filter(c=>c.tableType!=="view"),this.driver);for(let c of s)F.isBaseEntityConstructor(c.target)&&c.target.useDataSource(this)}}function Wt(){const n=ht.getGlobalVariable();return n.typeormMetadataArgsStorage||(n.typeormMetadataArgsStorage=new GE),n.typeormMetadataArgsStorage}function ft(n,e){return function(t,r){let a;typeof n=="string"||typeof n=="function"?a=n:n&&(e=n,a=n.type),e||(e={});const i=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,r):void 0;if(!a&&i&&(a=i),!e.type&&a&&(e.type=a),e.type==="hstore"&&!e.hstoreType&&(e.hstoreType=i===Object?"object":"string"),typeof n=="function")Wt().embeddeds.push({target:t.constructor,propertyName:r,isArray:i===Array||e.array===!0,prefix:e.prefix!==void 0?e.prefix:void 0,type:n});else{if(!e.type)throw new yw(t,r);e.unique===!0&&Wt().uniques.push({target:t.constructor,columns:[r]}),Wt().columns.push({target:t.constructor,propertyName:r,mode:"regular",options:e}),e.generated&&Wt().generations.push({target:t.constructor,propertyName:r,strategy:typeof e.generated=="string"?e.generated:"increment"})}}}function _r(n,e){const t={};let r;return n?(typeof n=="string"&&(r=n),Ue.isObject(n)&&(r="increment",Object.assign(t,n))):r="increment",Ue.isObject(e)&&Object.assign(t,e),function(a,i){t.type||(r==="increment"||r==="identity"?t.type=Number:r==="uuid"?t.type="uuid":r==="rowid"&&(t.type="int")),t.primary=!0,Wt().columns.push({target:a.constructor,propertyName:i,mode:"regular",options:t}),Wt().generations.push({target:a.constructor,propertyName:i,strategy:r})}}function Ta(n,e){return function(t,r){let a;if(typeof n=="string"?a=n:(e=n,a=e.type),!(e!=null&&e.query))throw new Error("Column options must be defined for calculated columns.");const i=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,r):void 0;if(!a&&i&&(a=i),a&&(e.type=a),e.type==="hstore"&&!e.hstoreType&&(e.hstoreType=i===Object?"object":"string"),!e.type)throw new yw(t,r);Wt().columns.push({target:t.constructor,propertyName:r,mode:"virtual-property",options:e||{}})}}function eo(n){return function(e,t){(Array.isArray(n)?n:[n||{}]).forEach(r=>{Wt().joinColumns.push({target:e.constructor,propertyName:t,name:r.name,referencedColumnName:r.referencedColumnName,foreignKeyConstraintName:r.foreignKeyConstraintName})})}}function Yr(n){return function(e,t){n=n||{},Wt().joinTables.push({target:e.constructor,propertyName:t,name:n.name,joinColumns:n&&n.joinColumn?[n.joinColumn]:n.joinColumns,inverseJoinColumns:n&&n.inverseJoinColumn?[n.inverseJoinColumn]:n.inverseJoinColumns,schema:n&&n.schema?n.schema:void 0,database:n&&n.database?n.database:void 0,synchronize:!(n&&n.synchronize===!1)})}}function Jr(n,e,t){let r;return Ue.isObject(e)?t=e:r=e,function(a,i){t||(t={});let s=t.lazy===!0;if(!s&&Reflect&&Reflect.getMetadata){const o=Reflect.getMetadata("design:type",a,i);o&&typeof o.name=="string"&&o.name.toLowerCase()==="promise"&&(s=!0)}Wt().relations.push({target:a.constructor,propertyName:i,relationType:"many-to-many",isLazy:s,type:n,inverseSideProperty:r,options:t})}}function to(n,e,t){let r;return Ue.isObject(e)?t=e:r=e,function(a,i){t||(t={});let s=t&&t.lazy===!0;if(!s&&Reflect&&Reflect.getMetadata){const o=Reflect.getMetadata("design:type",a,i);o&&typeof o.name=="string"&&o.name.toLowerCase()==="promise"&&(s=!0)}Wt().relations.push({target:a.constructor,propertyName:i,relationType:"many-to-one",isLazy:s,type:n,inverseSideProperty:r,options:t})}}function no(n,e,t){return function(r,a){t||(t={});let i=t&&t.lazy===!0;if(!i&&Reflect&&Reflect.getMetadata){const s=Reflect.getMetadata("design:type",r,a);s&&typeof s.name=="string"&&s.name.toLowerCase()==="promise"&&(i=!0)}Wt().relations.push({target:r.constructor,propertyName:a,isLazy:i,relationType:"one-to-many",type:n,inverseSideProperty:e,options:t})}}function yf(n,e,t){return function(r,a){Wt().relationIds.push({target:r.constructor,propertyName:a,relation:n,alias:e,queryBuilderFactory:t})}}function xr(n,e){const t=(Ue.isObject(n)?n:e)||{},r=typeof n=="string"?n:t.name;return function(a){Wt().tables.push({target:a,name:r,type:"regular",orderBy:t.orderBy?t.orderBy:void 0,engine:t.engine?t.engine:void 0,database:t.database?t.database:void 0,schema:t.schema?t.schema:void 0,synchronize:t.synchronize,withoutRowid:t.withoutRowid})}}var p_=Object.defineProperty,m_=Object.getOwnPropertyDescriptor,oi=(n,e,t,r)=>{for(var a=r>1?void 0:r?m_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&p_(e,t,a),a};let sr=class{constructor(){ve(this,"id");ve(this,"origName");ve(this,"loclName");ve(this,"engine");ve(this,"aliases");ve(this,"__songs");ve(this,"numSongs")}};oi([_r()],sr.prototype,"id",2),oi([ft({type:"varchar",name:"original_name"})],sr.prototype,"origName",2),oi([ft({type:"varchar",name:"localized_name"})],sr.prototype,"loclName",2),oi([Ta({type:"string",query:n=>`SELECT "engine" FROM "SynthEngines" WHERE "id" = ${n}.engine_id`})],sr.prototype,"engine",2),oi([Ta({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "SynthAlias" WHERE "synth_id" = ${n}.id`})],sr.prototype,"aliases",2),oi([Jr(()=>or),Yr({name:"TranslationSingers",joinColumn:{name:"synth_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],sr.prototype,"__songs",2),oi([Ta({type:"int",query:()=>'COUNT("song"."id")'})],sr.prototype,"numSongs",2),sr=oi([xr("Synths")],sr);var f_=Object.defineProperty,y_=Object.getOwnPropertyDescriptor,li=(n,e,t,r)=>{for(var a=r>1?void 0:r?y_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&f_(e,t,a),a};let Rn=class{constructor(){ve(this,"id");ve(this,"origName");ve(this,"loclName");ve(this,"aliases");ve(this,"__songsMade");ve(this,"__songsSung");ve(this,"numSongs")}};li([_r()],Rn.prototype,"id",2),li([ft({type:"varchar",name:"original_name"})],Rn.prototype,"origName",2),li([ft({type:"varchar",name:"localized_name"})],Rn.prototype,"loclName",2),li([Ta({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "ProducerAlias" WHERE "producer_id" = ${n}.id`})],Rn.prototype,"aliases",2),li([Jr(()=>or),Yr({name:"TranslationProducers",joinColumn:{name:"producer_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],Rn.prototype,"__songsMade",2),li([Jr(()=>or),Yr({name:"TranslationSingers",joinColumn:{name:"vocalist_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],Rn.prototype,"__songsSung",2),li([Ta({type:"int",query:()=>'COUNT("song"."id")'})],Rn.prototype,"numSongs",2),Rn=li([xr("Producers")],Rn);var g_=Object.defineProperty,b_=Object.getOwnPropertyDescriptor,ro=(n,e,t,r)=>{for(var a=r>1?void 0:r?b_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&g_(e,t,a),a};let or=class{constructor(){ve(this,"id");ve(this,"synths");ve(this,"vocalists");ve(this,"producers");ve(this,"circles")}};ro([_r()],or.prototype,"id",2),ro([Jr(()=>sr),Yr({name:"TranslationSingers",joinColumn:{name:"synth_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],or.prototype,"synths",2),ro([Jr(()=>Rn),Yr({name:"TranslationSingers",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"vocalist_id"}})],or.prototype,"vocalists",2),ro([Jr(()=>Rn),Yr({name:"TranslationProducers",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"producer_id"}})],or.prototype,"producers",2),ro([Jr(()=>Xr),Yr({name:"TranslationCircles",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"circle_id"}})],or.prototype,"circles",2),or=ro([xr("Translations")],or);var v_=Object.defineProperty,E_=Object.getOwnPropertyDescriptor,ao=(n,e,t,r)=>{for(var a=r>1?void 0:r?E_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&v_(e,t,a),a};let Xr=class{constructor(){ve(this,"id");ve(this,"origName");ve(this,"loclName");ve(this,"__songs");ve(this,"numSongs")}};ao([_r()],Xr.prototype,"id",2),ao([ft({type:"varchar",name:"original_name"})],Xr.prototype,"origName",2),ao([ft({type:"varchar",name:"localized_name"})],Xr.prototype,"loclName",2),ao([Jr(()=>or),Yr({name:"TranslationCircles",joinColumn:{name:"circle_id",referencedColumnName:"id"},inverseJoinColumn:{name:"translation_id",referencedColumnName:"id"}})],Xr.prototype,"__songs",2),ao([Ta({type:"int",query:()=>'COUNT("song"."id")'})],Xr.prototype,"numSongs",2),Xr=ao([xr("Circles")],Xr);var w_=Object.defineProperty,T_=Object.getOwnPropertyDescriptor,Ki=(n,e,t,r)=>{for(var a=r>1?void 0:r?T_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&w_(e,t,a),a};let Zr=class{constructor(){ve(this,"id");ve(this,"origName");ve(this,"loclName");ve(this,"engine");ve(this,"aliases");ve(this,"__songToSynths")}};Ki([_r()],Zr.prototype,"id",2),Ki([ft({type:"varchar",name:"original_name"})],Zr.prototype,"origName",2),Ki([ft({type:"varchar",name:"localized_name"})],Zr.prototype,"loclName",2),Ki([Ta({type:"string",query:n=>`SELECT "engine" FROM "SynthEngines" WHERE "id" = ${n}.engine_id`})],Zr.prototype,"engine",2),Ki([Ta({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "SynthAlias" WHERE "synth_id" = ${n}.id`})],Zr.prototype,"aliases",2),Ki([no(()=>jn,n=>n.__synthProps)],Zr.prototype,"__songToSynths",2),Zr=Ki([xr("Synths")],Zr);var N_=Object.defineProperty,C_=Object.getOwnPropertyDescriptor,Bl=(n,e,t,r)=>{for(var a=r>1?void 0:r?C_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&N_(e,t,a),a};let Na=class{constructor(){ve(this,"__jnId");ve(this,"__song");ve(this,"__props");ve(this,"role")}};Bl([_r({name:"id"})],Na.prototype,"__jnId",2),Bl([to(()=>St,n=>n.producers),eo({name:"translation_id"})],Na.prototype,"__song",2),Bl([to(()=>Pr,n=>n.__songToProducers),eo({name:"producer_id"})],Na.prototype,"__props",2),Bl([ft({type:"varchar",name:"role"})],Na.prototype,"role",2),Na=Bl([xr("TranslationProducers")],Na);var A_=Object.defineProperty,S_=Object.getOwnPropertyDescriptor,Qi=(n,e,t,r)=>{for(var a=r>1?void 0:r?S_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&A_(e,t,a),a};let Pr=class{constructor(){ve(this,"id");ve(this,"origName");ve(this,"loclName");ve(this,"aliases");ve(this,"__songToVocalists");ve(this,"__songToProducers")}};Qi([_r()],Pr.prototype,"id",2),Qi([ft({type:"varchar",name:"original_name"})],Pr.prototype,"origName",2),Qi([ft({type:"varchar",name:"localized_name"})],Pr.prototype,"loclName",2),Qi([Ta({type:"json",query:n=>`SELECT IIF(alias IS NULL, NULL, JSON_GROUP_ARRAY(alias)) FROM "ProducerAlias" WHERE "producer_id" = ${n}.id`})],Pr.prototype,"aliases",2),Qi([no(()=>jn,n=>n.__vocalistProps)],Pr.prototype,"__songToVocalists",2),Qi([no(()=>Na,n=>n.__props)],Pr.prototype,"__songToProducers",2),Pr=Qi([xr("Producers")],Pr);var R_=Object.defineProperty,M_=Object.getOwnPropertyDescriptor,ci=(n,e,t,r)=>{for(var a=r>1?void 0:r?M_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&R_(e,t,a),a};let jn=class{constructor(){ve(this,"__jnId");ve(this,"__songId");ve(this,"__synthId");ve(this,"__song");ve(this,"__synthProps");ve(this,"__vocalistProps");ve(this,"ver")}};ci([_r({name:"id"})],jn.prototype,"__jnId",2),ci([yf(n=>n.__song)],jn.prototype,"__songId",2),ci([yf(n=>n.__synthProps)],jn.prototype,"__synthId",2),ci([to(()=>St,n=>n.singers),eo({name:"translation_id"})],jn.prototype,"__song",2),ci([to(()=>Zr,n=>n.__songToSynths),eo({name:"synth_id"})],jn.prototype,"__synthProps",2),ci([to(()=>Pr,n=>n.__songToVocalists),eo({name:"vocalist_id"})],jn.prototype,"__vocalistProps",2),ci([ft({type:"int",name:"ver"})],jn.prototype,"ver",2),jn=ci([xr("TranslationSingers")],jn);var O_=Object.defineProperty,__=Object.getOwnPropertyDescriptor,Ul=(n,e,t,r)=>{for(var a=r>1?void 0:r?__(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&O_(e,t,a),a};let ui=class{constructor(){ve(this,"id");ve(this,"origName");ve(this,"loclName");ve(this,"__songs")}};Ul([_r()],ui.prototype,"id",2),Ul([ft({type:"varchar",name:"original_name"})],ui.prototype,"origName",2),Ul([ft({type:"varchar",name:"localized_name"})],ui.prototype,"loclName",2),Ul([Jr(()=>St),Yr({name:"TranslationCircles",joinColumn:{name:"circle_id"},inverseJoinColumn:{name:"translation_id"}})],ui.prototype,"__songs",2),ui=Ul([xr("Circles")],ui);var x_=Object.defineProperty,P_=Object.getOwnPropertyDescriptor,io=(n,e,t,r)=>{for(var a=r>1?void 0:r?P_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&x_(e,t,a),a};let Ca=class{constructor(){ve(this,"id");ve(this,"__translation_id");ve(this,"__song");ve(this,"subUrl");ve(this,"description")}};io([_r()],Ca.prototype,"id",2),io([yf(n=>n.__song)],Ca.prototype,"__translation_id",2),io([to(()=>St,n=>n.subs),eo({name:"translation_id"})],Ca.prototype,"__song",2),io([ft({type:"varchar",name:"sub_url"})],Ca.prototype,"subUrl",2),io([ft({type:"varchar",name:"description"})],Ca.prototype,"description",2),Ca=io([xr("TranslationSubs")],Ca);var I_=Object.defineProperty,D_=Object.getOwnPropertyDescriptor,Mn=(n,e,t,r)=>{for(var a=r>1?void 0:r?D_(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(a=(r?s(e,t,a):s(a))||a);return r&&a&&I_(e,t,a),a};let St=class{constructor(){ve(this,"id");ve(this,"orgTitle");ve(this,"romTitle");ve(this,"engTitle");ve(this,"lang");ve(this,"series");ve(this,"pageUrl");ve(this,"singers");ve(this,"producers");ve(this,"circles");ve(this,"subs");ve(this,"translatedDate");ve(this,"releasedDate")}};Mn([_r()],St.prototype,"id",2),Mn([ft({type:"varchar",name:"original_title"})],St.prototype,"orgTitle",2),Mn([ft({type:"varchar",name:"romanized_title"})],St.prototype,"romTitle",2),Mn([ft({type:"varchar",name:"english_title"})],St.prototype,"engTitle",2),Mn([ft({type:"varchar"})],St.prototype,"lang",2),Mn([ft({type:"varchar"})],St.prototype,"series",2),Mn([ft({type:"varchar",name:"pageurl"})],St.prototype,"pageUrl",2),Mn([no(()=>jn,n=>n.__song)],St.prototype,"singers",2),Mn([no(()=>Na,n=>n.__song)],St.prototype,"producers",2),Mn([Jr(()=>ui),Yr({name:"TranslationCircles",joinColumn:{name:"translation_id"},inverseJoinColumn:{name:"circle_id"}})],St.prototype,"circles",2),Mn([no(()=>Ca,n=>n.__song)],St.prototype,"subs",2),Mn([ft({type:"text",name:"translated_date"})],St.prototype,"translatedDate",2),Mn([ft({type:"text",name:"released_date"})],St.prototype,"releasedDate",2),St=Mn([xr("Translations")],St);var Kw={exports:{}};const L_={},q_=Object.freeze(Object.defineProperty({__proto__:null,default:L_},Symbol.toStringTag,{value:"Module"})),gf=QC(q_);(function(n,e){var t=void 0,r=function(a){return t||(t=new Promise(function(i,s){var o=typeof a<"u"?a:{},l=o.onAbort;o.onAbort=function(p){s(new Error(p)),l&&l(p)},o.postRun=o.postRun||[],o.postRun.push(function(){i(o)}),n=void 0;var c;c||(c=typeof o<"u"?o:{}),c.onRuntimeInitialized=function(){function p(W,ae){switch(typeof ae){case"boolean":HB(W,ae?1:0);break;case"number":VB(W,ae);break;case"string":zB(W,ae,-1,-1);break;case"object":if(ae===null)HC(W);else if(ae.length!=null){var Oe=Od(ae,Md);WB(W,Oe,ae.length,-1),Pd(Oe)}else Dd(W,"Wrong API use : tried to return a value of an unknown type ("+ae+").",-1);break;default:HC(W)}}function y(W,ae){for(var Oe=[],Be=0;Be<W;Be+=1){var He=jt(ae+4*Be,"i32"),lt=kB(He);if(lt===1||lt===2)He=FB(He);else if(lt===3)He=BB(He);else if(lt===4){lt=He,He=jB(lt),lt=UB(lt);for(var kr=new Uint8Array(He),br=0;br<He;br+=1)kr[br]=K[lt+br];He=kr}else He=null;Oe.push(He)}return Oe}function E(W,ae){this.La=W,this.db=ae,this.Ja=1,this.fb=[]}function M(W,ae){if(this.db=ae,ae=N(W)+1,this.Ya=xd(ae),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");_(W,I,this.Ya,ae),this.eb=this.Ya,this.Ua=this.ib=null}function L(W){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),W!=null){var ae=this.filename,Oe="/",Be=ae;if(Oe&&(Oe=typeof Oe=="string"?Oe:ps(Oe),Be=ae?st(Oe+"/"+ae):Oe),ae=me(!0,!0),Be=Td(Be,(ae!==void 0?ae:438)&4095|32768,0),W){if(typeof W=="string"){Oe=Array(W.length);for(var He=0,lt=W.length;He<lt;++He)Oe[He]=W.charCodeAt(He);W=Oe}Cd(Be,ae|146),Oe=qo(Be,577),PC(Oe,W,0,W.length,0),og(Oe),Cd(Be,ae)}}this.handleError(je(this.filename,J)),this.db=jt(J,"i32"),KB(this.db),this.Za={},this.Na={}}var J=Si(4),ee=c.cwrap,je=ee("sqlite3_open","number",["string","number"]),et=ee("sqlite3_close_v2","number",["number"]),Ve=ee("sqlite3_exec","number",["number","string","number","number","number"]),Ut=ee("sqlite3_changes","number",["number"]),nn=ee("sqlite3_prepare_v2","number",["number","string","number","number","number"]),EB=ee("sqlite3_sql","string",["number"]),wB=ee("sqlite3_normalized_sql","string",["number"]),FC=ee("sqlite3_prepare_v2","number",["number","number","number","number","number"]),TB=ee("sqlite3_bind_text","number",["number","number","number","number","number"]),VC=ee("sqlite3_bind_blob","number",["number","number","number","number","number"]),NB=ee("sqlite3_bind_double","number",["number","number","number"]),CB=ee("sqlite3_bind_int","number",["number","number","number"]),AB=ee("sqlite3_bind_parameter_index","number",["number","string"]),SB=ee("sqlite3_step","number",["number"]),RB=ee("sqlite3_errmsg","string",["number"]),MB=ee("sqlite3_column_count","number",["number"]),OB=ee("sqlite3_data_count","number",["number"]),_B=ee("sqlite3_column_double","number",["number","number"]),zC=ee("sqlite3_column_text","string",["number","number"]),xB=ee("sqlite3_column_blob","number",["number","number"]),PB=ee("sqlite3_column_bytes","number",["number","number"]),IB=ee("sqlite3_column_type","number",["number","number"]),DB=ee("sqlite3_column_name","string",["number","number"]),LB=ee("sqlite3_reset","number",["number"]),qB=ee("sqlite3_clear_bindings","number",["number"]),$B=ee("sqlite3_finalize","number",["number"]),WC=ee("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),kB=ee("sqlite3_value_type","number",["number"]),jB=ee("sqlite3_value_bytes","number",["number"]),BB=ee("sqlite3_value_text","string",["number"]),UB=ee("sqlite3_value_blob","number",["number"]),FB=ee("sqlite3_value_double","number",["number"]),VB=ee("sqlite3_result_double","",["number","number"]),HC=ee("sqlite3_result_null","",["number"]),zB=ee("sqlite3_result_text","",["number","string","number","number"]),WB=ee("sqlite3_result_blob","",["number","number","number","number"]),HB=ee("sqlite3_result_int","",["number","number"]),Dd=ee("sqlite3_result_error","",["number","string","number"]),KC=ee("sqlite3_aggregate_context","number",["number","number"]),KB=ee("RegisterExtensionFunctions","number",["number"]);E.prototype.bind=function(W){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(W)?this.wb(W):W!=null&&typeof W=="object"?this.xb(W):!0},E.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var W=SB(this.La);switch(W){case 100:return!0;case 101:return!1;default:throw this.db.handleError(W)}},E.prototype.rb=function(W){return W==null&&(W=this.Ja,this.Ja+=1),_B(this.La,W)},E.prototype.Ab=function(W){if(W==null&&(W=this.Ja,this.Ja+=1),W=zC(this.La,W),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(W)},E.prototype.Bb=function(W){return W==null&&(W=this.Ja,this.Ja+=1),zC(this.La,W)},E.prototype.getBlob=function(W){W==null&&(W=this.Ja,this.Ja+=1);var ae=PB(this.La,W);W=xB(this.La,W);for(var Oe=new Uint8Array(ae),Be=0;Be<ae;Be+=1)Oe[Be]=K[W+Be];return Oe},E.prototype.get=function(W,ae){ae=ae||{},W!=null&&this.bind(W)&&this.step(),W=[];for(var Oe=OB(this.La),Be=0;Be<Oe;Be+=1)switch(IB(this.La,Be)){case 1:var He=ae.useBigInt?this.Ab(Be):this.rb(Be);W.push(He);break;case 2:W.push(this.rb(Be));break;case 3:W.push(this.Bb(Be));break;case 4:W.push(this.getBlob(Be));break;default:W.push(null)}return W},E.prototype.getColumnNames=function(){for(var W=[],ae=MB(this.La),Oe=0;Oe<ae;Oe+=1)W.push(DB(this.La,Oe));return W},E.prototype.getAsObject=function(W,ae){W=this.get(W,ae),ae=this.getColumnNames();for(var Oe={},Be=0;Be<ae.length;Be+=1)Oe[ae[Be]]=W[Be];return Oe},E.prototype.getSQL=function(){return EB(this.La)},E.prototype.getNormalizedSQL=function(){return wB(this.La)},E.prototype.run=function(W){return W!=null&&this.bind(W),this.step(),this.reset()},E.prototype.nb=function(W,ae){ae==null&&(ae=this.Ja,this.Ja+=1),W=A(W);var Oe=Od(W,Md);this.fb.push(Oe),this.db.handleError(TB(this.La,ae,Oe,W.length-1,0))},E.prototype.vb=function(W,ae){ae==null&&(ae=this.Ja,this.Ja+=1);var Oe=Od(W,Md);this.fb.push(Oe),this.db.handleError(VC(this.La,ae,Oe,W.length,0))},E.prototype.mb=function(W,ae){ae==null&&(ae=this.Ja,this.Ja+=1),this.db.handleError((W===(W|0)?CB:NB)(this.La,ae,W))},E.prototype.yb=function(W){W==null&&(W=this.Ja,this.Ja+=1),VC(this.La,W,0,0,0)},E.prototype.ob=function(W,ae){switch(ae==null&&(ae=this.Ja,this.Ja+=1),typeof W){case"string":this.nb(W,ae);return;case"number":this.mb(W,ae);return;case"bigint":this.nb(W.toString(),ae);return;case"boolean":this.mb(W+0,ae);return;case"object":if(W===null){this.yb(ae);return}if(W.length!=null){this.vb(W,ae);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+W+")."},E.prototype.xb=function(W){var ae=this;return Object.keys(W).forEach(function(Oe){var Be=AB(ae.La,Oe);Be!==0&&ae.ob(W[Oe],Be)}),!0},E.prototype.wb=function(W){for(var ae=0;ae<W.length;ae+=1)this.ob(W[ae],ae+1);return!0},E.prototype.reset=function(){return this.freemem(),qB(this.La)===0&&LB(this.La)===0},E.prototype.freemem=function(){for(var W;(W=this.fb.pop())!==void 0;)Pd(W)},E.prototype.free=function(){this.freemem();var W=$B(this.La)===0;return delete this.db.Za[this.La],this.La=0,W},M.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var W=kc(),ae=Si(4);tn(J),tn(ae);try{this.db.handleError(FC(this.db.db,this.eb,-1,J,ae)),this.eb=jt(ae,"i32");var Oe=jt(J,"i32");return Oe===0?(this.gb(),{done:!0}):(this.Ua=new E(Oe,this.db),this.db.Za[Oe]=this.Ua,{value:this.Ua,done:!1})}catch(Be){throw this.ib=Bt(this.eb),this.gb(),Be}finally{jc(W)}},M.prototype.gb=function(){Pd(this.Ya),this.Ya=null},M.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:Bt(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(M.prototype[Symbol.iterator]=function(){return this}),L.prototype.run=function(W,ae){if(!this.db)throw"Database closed";if(ae){W=this.prepare(W,ae);try{W.step()}finally{W.free()}}else this.handleError(Ve(this.db,W,0,0,J));return this},L.prototype.exec=function(W,ae,Oe){if(!this.db)throw"Database closed";var Be=kc(),He=null;try{var lt=hg(W),kr=Si(4);for(W=[];jt(lt,"i8")!==0;){tn(J),tn(kr),this.handleError(FC(this.db,lt,-1,J,kr));var br=jt(J,"i32");if(lt=jt(kr,"i32"),br!==0){var Gn=null;for(He=new E(br,this),ae!=null&&He.bind(ae);He.step();)Gn===null&&(Gn={columns:He.getColumnNames(),values:[]},W.push(Gn)),Gn.values.push(He.get(null,Oe));He.free()}}return W}catch(jr){throw He&&He.free(),jr}finally{jc(Be)}},L.prototype.each=function(W,ae,Oe,Be,He){typeof ae=="function"&&(Be=Oe,Oe=ae,ae=void 0),W=this.prepare(W,ae);try{for(;W.step();)Oe(W.getAsObject(null,He))}finally{W.free()}if(typeof Be=="function")return Be()},L.prototype.prepare=function(W,ae){if(tn(J),this.handleError(nn(this.db,W,-1,J,0)),W=jt(J,"i32"),W===0)throw"Nothing to prepare";var Oe=new E(W,this);return ae!=null&&Oe.bind(ae),this.Za[W]=Oe},L.prototype.iterateStatements=function(W){return new M(W,this)},L.prototype.export=function(){Object.values(this.Za).forEach(function(ae){ae.free()}),Object.values(this.Na).forEach($o),this.Na={},this.handleError(et(this.db));var W=fB(this.filename);return this.handleError(je(this.filename,J)),this.db=jt(J,"i32"),W},L.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(W){W.free()}),Object.values(this.Na).forEach($o),this.Na={},this.handleError(et(this.db)),SC("/"+this.filename),this.db=null)},L.prototype.handleError=function(W){if(W===0)return null;throw W=RB(this.db),Error(W)},L.prototype.getRowsModified=function(){return Ut(this.db)},L.prototype.create_function=function(W,ae){Object.prototype.hasOwnProperty.call(this.Na,W)&&($o(this.Na[W]),delete this.Na[W]);var Oe=_d(function(Be,He,lt){He=y(He,lt);try{var kr=ae.apply(null,He)}catch(br){Dd(Be,br,-1);return}p(Be,kr)},"viii");return this.Na[W]=Oe,this.handleError(WC(this.db,W,ae.length,1,0,Oe,0,0,0)),this},L.prototype.create_aggregate=function(W,ae){var Oe=ae.init||function(){return null},Be=ae.finalize||function(Gn){return Gn},He=ae.step;if(!He)throw"An aggregate function must have a step function in "+W;var lt={};Object.hasOwnProperty.call(this.Na,W)&&($o(this.Na[W]),delete this.Na[W]),ae=W+"__finalize",Object.hasOwnProperty.call(this.Na,ae)&&($o(this.Na[ae]),delete this.Na[ae]);var kr=_d(function(Gn,jr,pg){var gs=KC(Gn,1);Object.hasOwnProperty.call(lt,gs)||(lt[gs]=Oe()),jr=y(jr,pg),jr=[lt[gs]].concat(jr);try{lt[gs]=He.apply(null,jr)}catch(QB){delete lt[gs],Dd(Gn,QB,-1)}},"viii"),br=_d(function(Gn){var jr=KC(Gn,1);try{var pg=Be(lt[jr])}catch(gs){delete lt[jr],Dd(Gn,gs,-1);return}p(Gn,pg),delete lt[jr]},"vi");return this.Na[W]=kr,this.Na[ae]=br,this.handleError(WC(this.db,W,He.length-1,1,0,0,kr,br,0)),this},c.Database=L};var u=Object.assign({},c),h="./this.program",d=typeof window=="object",f=typeof importScripts=="function",g=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",v="",C,w,T;if(g){var S=gf,O=gf;v=f?O.dirname(v)+"/":__dirname+"/",C=(p,y)=>(p=ze(p)?new URL(p):O.normalize(p),S.readFileSync(p,y?void 0:"utf8")),T=p=>(p=C(p,!0),p.buffer||(p=new Uint8Array(p)),p),w=(p,y,E,M=!0)=>{p=ze(p)?new URL(p):O.normalize(p),S.readFile(p,M?void 0:"utf8",(L,J)=>{L?E(L):y(M?J.buffer:J)})},!c.thisProgram&&1<process.argv.length&&(h=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.exports=c,c.inspect=()=>"[Emscripten Module object]"}else(d||f)&&(f?v=self.location.href:typeof document<"u"&&document.currentScript&&(v=document.currentScript.src),v=v.indexOf("blob:")!==0?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",C=p=>{var y=new XMLHttpRequest;return y.open("GET",p,!1),y.send(null),y.responseText},f&&(T=p=>{var y=new XMLHttpRequest;return y.open("GET",p,!1),y.responseType="arraybuffer",y.send(null),new Uint8Array(y.response)}),w=(p,y,E)=>{var M=new XMLHttpRequest;M.open("GET",p,!0),M.responseType="arraybuffer",M.onload=()=>{M.status==200||M.status==0&&M.response?y(M.response):E()},M.onerror=E,M.send(null)});var k=c.print||console.log.bind(console),B=c.printErr||console.error.bind(console);Object.assign(c,u),u=null,c.thisProgram&&(h=c.thisProgram);var D;c.wasmBinary&&(D=c.wasmBinary),typeof WebAssembly!="object"&&xe("no native wasm support detected");var V,q=!1,K,I,G,H,se,re,ue;function Se(){var p=V.buffer;c.HEAP8=K=new Int8Array(p),c.HEAP16=G=new Int16Array(p),c.HEAPU8=I=new Uint8Array(p),c.HEAPU16=new Uint16Array(p),c.HEAP32=H=new Int32Array(p),c.HEAPU32=se=new Uint32Array(p),c.HEAPF32=re=new Float32Array(p),c.HEAPF64=ue=new Float64Array(p)}var ie=[],fe=[],Me=[];function ge(){var p=c.preRun.shift();ie.unshift(p)}var ne=0,Ye=null;function xe(p){throw c.onAbort&&c.onAbort(p),p="Aborted("+p+")",B(p),q=!0,new WebAssembly.RuntimeError(p+". Build with -sASSERTIONS for more info.")}var ke=p=>p.startsWith("data:application/octet-stream;base64,"),ze=p=>p.startsWith("file://"),Ze;if(Ze="sql-wasm.wasm",!ke(Ze)){var bt=Ze;Ze=c.locateFile?c.locateFile(bt,v):v+bt}function Rt(p){if(p==Ze&&D)return new Uint8Array(D);if(T)return T(p);throw"both async and sync fetching of the wasm failed"}function It(p){if(!D&&(d||f)){if(typeof fetch=="function"&&!ze(p))return fetch(p,{credentials:"same-origin"}).then(y=>{if(!y.ok)throw"failed to load wasm binary file at '"+p+"'";return y.arrayBuffer()}).catch(()=>Rt(p));if(w)return new Promise((y,E)=>{w(p,M=>y(new Uint8Array(M)),E)})}return Promise.resolve().then(()=>Rt(p))}function Kt(p,y,E){return It(p).then(M=>WebAssembly.instantiate(M,y)).then(M=>M).then(E,M=>{B(`failed to asynchronously prepare wasm: ${M}`),xe(M)})}function dn(p,y){var E=Ze;D||typeof WebAssembly.instantiateStreaming!="function"||ke(E)||ze(E)||g||typeof fetch!="function"?Kt(E,p,y):fetch(E,{credentials:"same-origin"}).then(M=>WebAssembly.instantiateStreaming(M,p).then(y,function(L){return B(`wasm streaming compile failed: ${L}`),B("falling back to ArrayBuffer instantiation"),Kt(E,p,y)}))}var Ae,Ke,Qn=p=>{for(;0<p.length;)p.shift()(c)};function jt(p,y="i8"){switch(y.endsWith("*")&&(y="*"),y){case"i1":return K[p>>0];case"i8":return K[p>>0];case"i16":return G[p>>1];case"i32":return H[p>>2];case"i64":xe("to do getValue(i64) use WASM_BIGINT");case"float":return re[p>>2];case"double":return ue[p>>3];case"*":return se[p>>2];default:xe(`invalid type for getValue: ${y}`)}}function tn(p){var y="i32";switch(y.endsWith("*")&&(y="*"),y){case"i1":K[p>>0]=0;break;case"i8":K[p>>0]=0;break;case"i16":G[p>>1]=0;break;case"i32":H[p>>2]=0;break;case"i64":xe("to do setValue(i64) use WASM_BIGINT");case"float":re[p>>2]=0;break;case"double":ue[p>>3]=0;break;case"*":se[p>>2]=0;break;default:xe(`invalid type for setValue: ${y}`)}}var $r=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,tt=(p,y,E)=>{var M=y+E;for(E=y;p[E]&&!(E>=M);)++E;if(16<E-y&&p.buffer&&$r)return $r.decode(p.subarray(y,E));for(M="";y<E;){var L=p[y++];if(L&128){var J=p[y++]&63;if((L&224)==192)M+=String.fromCharCode((L&31)<<6|J);else{var ee=p[y++]&63;L=(L&240)==224?(L&15)<<12|J<<6|ee:(L&7)<<18|J<<12|ee<<6|p[y++]&63,65536>L?M+=String.fromCharCode(L):(L-=65536,M+=String.fromCharCode(55296|L>>10,56320|L&1023))}}else M+=String.fromCharCode(L)}return M},Bt=(p,y)=>p?tt(I,p,y):"",Qt=(p,y)=>{for(var E=0,M=p.length-1;0<=M;M--){var L=p[M];L==="."?p.splice(M,1):L===".."?(p.splice(M,1),E++):E&&(p.splice(M,1),E--)}if(y)for(;E;E--)p.unshift("..");return p},st=p=>{var y=p.charAt(0)==="/",E=p.substr(-1)==="/";return(p=Qt(p.split("/").filter(M=>!!M),!y).join("/"))||y||(p="."),p&&E&&(p+="/"),(y?"/":"")+p},xn=p=>{var y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(p).slice(1);return p=y[0],y=y[1],!p&&!y?".":(y&&(y=y.substr(0,y.length-1)),p+y)},z=p=>{if(p==="/")return"/";p=st(p),p=p.replace(/\/$/,"");var y=p.lastIndexOf("/");return y===-1?p:p.substr(y+1)},X=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return E=>crypto.getRandomValues(E);if(g)try{var p=gf;if(p.randomFillSync)return E=>p.randomFillSync(E);var y=p.randomBytes;return E=>(E.set(y(E.byteLength)),E)}catch{}xe("initRandomDevice")},te=p=>(te=X())(p);function m(){for(var p="",y=!1,E=arguments.length-1;-1<=E&&!y;E--){if(y=0<=E?arguments[E]:"/",typeof y!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!y)return"";p=y+"/"+p,y=y.charAt(0)==="/"}return p=Qt(p.split("/").filter(M=>!!M),!y).join("/"),(y?"/":"")+p||"."}var b=[],N=p=>{for(var y=0,E=0;E<p.length;++E){var M=p.charCodeAt(E);127>=M?y++:2047>=M?y+=2:55296<=M&&57343>=M?(y+=4,++E):y+=3}return y},_=(p,y,E,M)=>{if(!(0<M))return 0;var L=E;M=E+M-1;for(var J=0;J<p.length;++J){var ee=p.charCodeAt(J);if(55296<=ee&&57343>=ee){var je=p.charCodeAt(++J);ee=65536+((ee&1023)<<10)|je&1023}if(127>=ee){if(E>=M)break;y[E++]=ee}else{if(2047>=ee){if(E+1>=M)break;y[E++]=192|ee>>6}else{if(65535>=ee){if(E+2>=M)break;y[E++]=224|ee>>12}else{if(E+3>=M)break;y[E++]=240|ee>>18,y[E++]=128|ee>>12&63}y[E++]=128|ee>>6&63}y[E++]=128|ee&63}}return y[E]=0,E-L};function A(p,y){var E=Array(N(p)+1);return p=_(p,E,0,E.length),y&&(E.length=p),E}var R=[];function P(p,y){R[p]={input:[],output:[],Xa:y},ig(p,Q)}var Q={open(p){var y=R[p.node.rdev];if(!y)throw new le(43);p.tty=y,p.seekable=!1},close(p){p.tty.Xa.fsync(p.tty)},fsync(p){p.tty.Xa.fsync(p.tty)},read(p,y,E,M){if(!p.tty||!p.tty.Xa.sb)throw new le(60);for(var L=0,J=0;J<M;J++){try{var ee=p.tty.Xa.sb(p.tty)}catch{throw new le(29)}if(ee===void 0&&L===0)throw new le(6);if(ee==null)break;L++,y[E+J]=ee}return L&&(p.node.timestamp=Date.now()),L},write(p,y,E,M){if(!p.tty||!p.tty.Xa.jb)throw new le(60);try{for(var L=0;L<M;L++)p.tty.Xa.jb(p.tty,y[E+L])}catch{throw new le(29)}return M&&(p.node.timestamp=Date.now()),L}},de={sb(){e:{if(!b.length){var p=null;if(g){var y=Buffer.alloc(256),E=0,M=process.stdin.fd;try{E=S.readSync(M,y)}catch(L){if(L.toString().includes("EOF"))E=0;else throw L}0<E?p=y.slice(0,E).toString("utf-8"):p=null}else typeof window<"u"&&typeof window.prompt=="function"?(p=window.prompt("Input: "),p!==null&&(p+=`
`)):typeof readline=="function"&&(p=readline(),p!==null&&(p+=`
`));if(!p){p=null;break e}b=A(p,!0)}p=b.shift()}return p},jb(p,y){y===null||y===10?(k(tt(p.output,0)),p.output=[]):y!=0&&p.output.push(y)},fsync(p){p.output&&0<p.output.length&&(k(tt(p.output,0)),p.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},Le={jb(p,y){y===null||y===10?(B(tt(p.output,0)),p.output=[]):y!=0&&p.output.push(y)},fsync(p){p.output&&0<p.output.length&&(B(tt(p.output,0)),p.output=[])}};function qe(p,y){var E=p.Ia?p.Ia.length:0;E>=y||(y=Math.max(y,E*(1048576>E?2:1.125)>>>0),E!=0&&(y=Math.max(y,256)),E=p.Ia,p.Ia=new Uint8Array(y),0<p.Ma&&p.Ia.set(E.subarray(0,p.Ma),0))}var oe={Qa:null,Ra(){return oe.createNode(null,"/",16895,0)},createNode(p,y,E,M){if((E&61440)===24576||(E&61440)===4096)throw new le(63);return oe.Qa||(oe.Qa={dir:{node:{Pa:oe.Ga.Pa,Oa:oe.Ga.Oa,lookup:oe.Ga.lookup,ab:oe.Ga.ab,rename:oe.Ga.rename,unlink:oe.Ga.unlink,rmdir:oe.Ga.rmdir,readdir:oe.Ga.readdir,symlink:oe.Ga.symlink},stream:{Ta:oe.Ha.Ta}},file:{node:{Pa:oe.Ga.Pa,Oa:oe.Ga.Oa},stream:{Ta:oe.Ha.Ta,read:oe.Ha.read,write:oe.Ha.write,lb:oe.Ha.lb,bb:oe.Ha.bb,cb:oe.Ha.cb}},link:{node:{Pa:oe.Ga.Pa,Oa:oe.Ga.Oa,readlink:oe.Ga.readlink},stream:{}},pb:{node:{Pa:oe.Ga.Pa,Oa:oe.Ga.Oa},stream:mB}}),E=vC(p,y,E,M),gr(E.mode)?(E.Ga=oe.Qa.dir.node,E.Ha=oe.Qa.dir.stream,E.Ia={}):(E.mode&61440)===32768?(E.Ga=oe.Qa.file.node,E.Ha=oe.Qa.file.stream,E.Ma=0,E.Ia=null):(E.mode&61440)===40960?(E.Ga=oe.Qa.link.node,E.Ha=oe.Qa.link.stream):(E.mode&61440)===8192&&(E.Ga=oe.Qa.pb.node,E.Ha=oe.Qa.pb.stream),E.timestamp=Date.now(),p&&(p.Ia[y]=E,p.timestamp=E.timestamp),E},Lb(p){return p.Ia?p.Ia.subarray?p.Ia.subarray(0,p.Ma):new Uint8Array(p.Ia):new Uint8Array(0)},Ga:{Pa(p){var y={};return y.dev=(p.mode&61440)===8192?p.id:1,y.ino=p.id,y.mode=p.mode,y.nlink=1,y.uid=0,y.gid=0,y.rdev=p.rdev,gr(p.mode)?y.size=4096:(p.mode&61440)===32768?y.size=p.Ma:(p.mode&61440)===40960?y.size=p.link.length:y.size=0,y.atime=new Date(p.timestamp),y.mtime=new Date(p.timestamp),y.ctime=new Date(p.timestamp),y.zb=4096,y.blocks=Math.ceil(y.size/y.zb),y},Oa(p,y){if(y.mode!==void 0&&(p.mode=y.mode),y.timestamp!==void 0&&(p.timestamp=y.timestamp),y.size!==void 0&&(y=y.size,p.Ma!=y))if(y==0)p.Ia=null,p.Ma=0;else{var E=p.Ia;p.Ia=new Uint8Array(y),E&&p.Ia.set(E.subarray(0,Math.min(y,p.Ma))),p.Ma=y}},lookup(){throw Do[44]},ab(p,y,E,M){return oe.createNode(p,y,E,M)},rename(p,y,E){if(gr(p.mode)){try{var M=ms(y,E)}catch{}if(M)for(var L in M.Ia)throw new le(55)}delete p.parent.Ia[p.name],p.parent.timestamp=Date.now(),p.name=E,y.Ia[E]=p,y.timestamp=p.parent.timestamp,p.parent=y},unlink(p,y){delete p.Ia[y],p.timestamp=Date.now()},rmdir(p,y){var E=ms(p,y),M;for(M in E.Ia)throw new le(55);delete p.Ia[y],p.timestamp=Date.now()},readdir(p){var y=[".",".."],E;for(E in p.Ia)p.Ia.hasOwnProperty(E)&&y.push(E);return y},symlink(p,y,E){return p=oe.createNode(p,y,41471,0),p.link=E,p},readlink(p){if((p.mode&61440)!==40960)throw new le(28);return p.link}},Ha:{read(p,y,E,M,L){var J=p.node.Ia;if(L>=p.node.Ma)return 0;if(p=Math.min(p.node.Ma-L,M),8<p&&J.subarray)y.set(J.subarray(L,L+p),E);else for(M=0;M<p;M++)y[E+M]=J[L+M];return p},write(p,y,E,M,L,J){if(y.buffer===K.buffer&&(J=!1),!M)return 0;if(p=p.node,p.timestamp=Date.now(),y.subarray&&(!p.Ia||p.Ia.subarray)){if(J)return p.Ia=y.subarray(E,E+M),p.Ma=M;if(p.Ma===0&&L===0)return p.Ia=y.slice(E,E+M),p.Ma=M;if(L+M<=p.Ma)return p.Ia.set(y.subarray(E,E+M),L),M}if(qe(p,L+M),p.Ia.subarray&&y.subarray)p.Ia.set(y.subarray(E,E+M),L);else for(J=0;J<M;J++)p.Ia[L+J]=y[E+J];return p.Ma=Math.max(p.Ma,L+M),M},Ta(p,y,E){if(E===1?y+=p.position:E===2&&(p.node.mode&61440)===32768&&(y+=p.node.Ma),0>y)throw new le(28);return y},lb(p,y,E){qe(p.node,y+E),p.node.Ma=Math.max(p.node.Ma,y+E)},bb(p,y,E,M,L){if((p.node.mode&61440)!==32768)throw new le(43);if(p=p.node.Ia,L&2||p.buffer!==K.buffer){if((0<E||E+y<p.length)&&(p.subarray?p=p.subarray(E,E+y):p=Array.prototype.slice.call(p,E,E+y)),E=!0,y=65536*Math.ceil(y/65536),(L=BC(65536,y))?(I.fill(0,L,L+y),y=L):y=0,!y)throw new le(48);K.set(p,y)}else E=!1,y=p.byteOffset;return{Db:y,ub:E}},cb(p,y,E,M){return oe.Ha.write(p,y,0,M,E,!1),0}}},me=(p,y)=>{var E=0;return p&&(E|=365),y&&(E|=146),E},Ce=null,Te={},Ne=[],We=1,Je=null,Tt=!0,le=null,Do={};function pn(p,y={}){if(p=m(p),!p)return{path:"",node:null};if(y=Object.assign({qb:!0,kb:0},y),8<y.kb)throw new le(32);p=p.split("/").filter(ee=>!!ee);for(var E=Ce,M="/",L=0;L<p.length;L++){var J=L===p.length-1;if(J&&y.parent)break;if(E=ms(E,p[L]),M=st(M+"/"+p[L]),E.Va&&(!J||J&&y.qb)&&(E=E.Va.root),!J||y.Sa){for(J=0;(E.mode&61440)===40960;)if(E=RC(M),M=m(xn(M),E),E=pn(M,{kb:y.kb+1}).node,40<J++)throw new le(32)}}return{path:M,node:E}}function ps(p){for(var y;;){if(p===p.parent)return p=p.Ra.tb,y?p[p.length-1]!=="/"?`${p}/${y}`:p+y:p;y=y?`${p.name}/${y}`:p.name,p=p.parent}}function ag(p,y){for(var E=0,M=0;M<y.length;M++)E=(E<<5)-E+y.charCodeAt(M)|0;return(p+E>>>0)%Je.length}function bC(p){var y=ag(p.parent.id,p.name);if(Je[y]===p)Je[y]=p.Wa;else for(y=Je[y];y;){if(y.Wa===p){y.Wa=p.Wa;break}y=y.Wa}}function ms(p,y){var E;if(E=(E=Lo(p,"x"))?E:p.Ga.lookup?0:2)throw new le(E,p);for(E=Je[ag(p.id,y)];E;E=E.Wa){var M=E.name;if(E.parent.id===p.id&&M===y)return E}return p.Ga.lookup(p,y)}function vC(p,y,E,M){return p=new kC(p,y,E,M),y=ag(p.parent.id,p.name),p.Wa=Je[y],Je[y]=p}function gr(p){return(p&61440)===16384}function EC(p){var y=["r","w","rw"][p&3];return p&512&&(y+="w"),y}function Lo(p,y){if(Tt)return 0;if(!y.includes("r")||p.mode&292){if(y.includes("w")&&!(p.mode&146)||y.includes("x")&&!(p.mode&73))return 2}else return 2;return 0}function wC(p,y){try{return ms(p,y),20}catch{}return Lo(p,"wx")}function TC(p,y,E){try{var M=ms(p,y)}catch(L){return L.Ka}if(p=Lo(p,"wx"))return p;if(E){if(!gr(M.mode))return 54;if(M===M.parent||ps(M)==="/")return 10}else if(gr(M.mode))return 31;return 0}function pB(){for(var p=0;4096>=p;p++)if(!Ne[p])return p;throw new le(33)}function En(p){if(p=Ne[p],!p)throw new le(8);return p}function NC(p,y=-1){return qc||(qc=function(){this.$a={}},qc.prototype={},Object.defineProperties(qc.prototype,{object:{get(){return this.node},set(E){this.node=E}},flags:{get(){return this.$a.flags},set(E){this.$a.flags=E}},position:{get(){return this.$a.position},set(E){this.$a.position=E}}})),p=Object.assign(new qc,p),y==-1&&(y=pB()),p.fd=y,Ne[y]=p}var mB={open(p){p.Ha=Te[p.node.rdev].Ha,p.Ha.open&&p.Ha.open(p)},Ta(){throw new le(70)}};function ig(p,y){Te[p]={Ha:y}}function CC(p,y){var E=y==="/",M=!y;if(E&&Ce)throw new le(10);if(!E&&!M){var L=pn(y,{qb:!1});if(y=L.path,L=L.node,L.Va)throw new le(10);if(!gr(L.mode))throw new le(54)}y={type:p,Pb:{},tb:y,Cb:[]},p=p.Ra(y),p.Ra=y,y.root=p,E?Ce=p:L&&(L.Va=y,L.Ra&&L.Ra.Cb.push(y))}function Td(p,y,E){var M=pn(p,{parent:!0}).node;if(p=z(p),!p||p==="."||p==="..")throw new le(28);var L=wC(M,p);if(L)throw new le(L);if(!M.Ga.ab)throw new le(63);return M.Ga.ab(M,p,y,E)}function oa(p,y){return Td(p,(y!==void 0?y:511)&1023|16384,0)}function Nd(p,y,E){typeof E>"u"&&(E=y,y=438),Td(p,y|8192,E)}function sg(p,y){if(!m(p))throw new le(44);var E=pn(y,{parent:!0}).node;if(!E)throw new le(44);y=z(y);var M=wC(E,y);if(M)throw new le(M);if(!E.Ga.symlink)throw new le(63);E.Ga.symlink(E,y,p)}function AC(p){var y=pn(p,{parent:!0}).node;p=z(p);var E=ms(y,p),M=TC(y,p,!0);if(M)throw new le(M);if(!y.Ga.rmdir)throw new le(63);if(E.Va)throw new le(10);y.Ga.rmdir(y,p),bC(E)}function SC(p){var y=pn(p,{parent:!0}).node;if(!y)throw new le(44);p=z(p);var E=ms(y,p),M=TC(y,p,!1);if(M)throw new le(M);if(!y.Ga.unlink)throw new le(63);if(E.Va)throw new le(10);y.Ga.unlink(y,p),bC(E)}function RC(p){if(p=pn(p).node,!p)throw new le(44);if(!p.Ga.readlink)throw new le(28);return m(ps(p.parent),p.Ga.readlink(p))}function Dc(p,y){if(p=pn(p,{Sa:!y}).node,!p)throw new le(44);if(!p.Ga.Pa)throw new le(63);return p.Ga.Pa(p)}function MC(p){return Dc(p,!0)}function Cd(p,y){if(p=typeof p=="string"?pn(p,{Sa:!0}).node:p,!p.Ga.Oa)throw new le(63);p.Ga.Oa(p,{mode:y&4095|p.mode&-4096,timestamp:Date.now()})}function OC(p,y){if(0>y)throw new le(28);if(p=typeof p=="string"?pn(p,{Sa:!0}).node:p,!p.Ga.Oa)throw new le(63);if(gr(p.mode))throw new le(31);if((p.mode&61440)!==32768)throw new le(28);var E=Lo(p,"w");if(E)throw new le(E);p.Ga.Oa(p,{size:y,timestamp:Date.now()})}function qo(p,y,E){if(p==="")throw new le(44);if(typeof y=="string"){var M={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[y];if(typeof M>"u")throw Error(`Unknown file open mode: ${y}`);y=M}if(E=y&64?(typeof E>"u"?438:E)&4095|32768:0,typeof p=="object")var L=p;else{p=st(p);try{L=pn(p,{Sa:!(y&131072)}).node}catch{}}if(M=!1,y&64)if(L){if(y&128)throw new le(20)}else L=Td(p,E,0),M=!0;if(!L)throw new le(44);if((L.mode&61440)===8192&&(y&=-513),y&65536&&!gr(L.mode))throw new le(54);if(!M&&(E=L?(L.mode&61440)===40960?32:gr(L.mode)&&(EC(y)!=="r"||y&512)?31:Lo(L,EC(y)):44))throw new le(E);return y&512&&!M&&OC(L,0),y&=-131713,L=NC({node:L,path:ps(L),flags:y,seekable:!0,position:0,Ha:L.Ha,Fb:[],error:!1}),L.Ha.open&&L.Ha.open(L),!c.logReadFiles||y&1||(lg||(lg={}),p in lg||(lg[p]=1)),L}function og(p){if(p.fd===null)throw new le(8);p.hb&&(p.hb=null);try{p.Ha.close&&p.Ha.close(p)}catch(y){throw y}finally{Ne[p.fd]=null}p.fd=null}function _C(p,y,E){if(p.fd===null)throw new le(8);if(!p.seekable||!p.Ha.Ta)throw new le(70);if(E!=0&&E!=1&&E!=2)throw new le(28);p.position=p.Ha.Ta(p,y,E),p.Fb=[]}function xC(p,y,E,M,L){if(0>M||0>L)throw new le(28);if(p.fd===null)throw new le(8);if((p.flags&2097155)===1)throw new le(8);if(gr(p.node.mode))throw new le(31);if(!p.Ha.read)throw new le(28);var J=typeof L<"u";if(!J)L=p.position;else if(!p.seekable)throw new le(70);return y=p.Ha.read(p,y,E,M,L),J||(p.position+=y),y}function PC(p,y,E,M,L){if(0>M||0>L)throw new le(28);if(p.fd===null)throw new le(8);if(!(p.flags&2097155))throw new le(8);if(gr(p.node.mode))throw new le(31);if(!p.Ha.write)throw new le(28);p.seekable&&p.flags&1024&&_C(p,0,2);var J=typeof L<"u";if(!J)L=p.position;else if(!p.seekable)throw new le(70);return y=p.Ha.write(p,y,E,M,L,void 0),J||(p.position+=y),y}function fB(p){var y,E=qo(p,E||0);p=Dc(p).size;var M=new Uint8Array(p);return xC(E,M,0,p,0),y=M,og(E),y}function IC(){le||(le=function(p,y){this.name="ErrnoError",this.node=y,this.Eb=function(E){this.Ka=E},this.Eb(p),this.message="FS error"},le.prototype=Error(),le.prototype.constructor=le,[44].forEach(p=>{Do[p]=new le(p),Do[p].stack="<generic error, no stack>"}))}var DC;function Lc(p,y,E){p=st("/dev/"+p);var M=me(!!y,!!E);LC||(LC=64);var L=LC++<<8|0;ig(L,{open(J){J.seekable=!1},close(){E&&E.buffer&&E.buffer.length&&E(10)},read(J,ee,je,et){for(var Ve=0,Ut=0;Ut<et;Ut++){try{var nn=y()}catch{throw new le(29)}if(nn===void 0&&Ve===0)throw new le(6);if(nn==null)break;Ve++,ee[je+Ut]=nn}return Ve&&(J.node.timestamp=Date.now()),Ve},write(J,ee,je,et){for(var Ve=0;Ve<et;Ve++)try{E(ee[je+Ve])}catch{throw new le(29)}return et&&(J.node.timestamp=Date.now()),Ve}}),Nd(p,M,L)}var LC,pt={},qc,lg;function fs(p,y,E){if(y.charAt(0)==="/")return y;if(p=p===-100?"/":En(p).path,y.length==0){if(!E)throw new le(44);return p}return st(p+"/"+y)}function Ad(p,y,E){try{var M=p(y)}catch(J){if(J&&J.node&&st(y)!==st(ps(J.node)))return-54;throw J}H[E>>2]=M.dev,H[E+4>>2]=M.mode,se[E+8>>2]=M.nlink,H[E+12>>2]=M.uid,H[E+16>>2]=M.gid,H[E+20>>2]=M.rdev,Ke=[M.size>>>0,(Ae=M.size,1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[E+24>>2]=Ke[0],H[E+28>>2]=Ke[1],H[E+32>>2]=4096,H[E+36>>2]=M.blocks,p=M.atime.getTime(),y=M.mtime.getTime();var L=M.ctime.getTime();return Ke=[Math.floor(p/1e3)>>>0,(Ae=Math.floor(p/1e3),1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[E+40>>2]=Ke[0],H[E+44>>2]=Ke[1],se[E+48>>2]=p%1e3*1e3,Ke=[Math.floor(y/1e3)>>>0,(Ae=Math.floor(y/1e3),1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[E+56>>2]=Ke[0],H[E+60>>2]=Ke[1],se[E+64>>2]=y%1e3*1e3,Ke=[Math.floor(L/1e3)>>>0,(Ae=Math.floor(L/1e3),1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[E+72>>2]=Ke[0],H[E+76>>2]=Ke[1],se[E+80>>2]=L%1e3*1e3,Ke=[M.ino>>>0,(Ae=M.ino,1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[E+88>>2]=Ke[0],H[E+92>>2]=Ke[1],0}var Sd=void 0;function Rd(){var p=H[+Sd>>2];return Sd+=4,p}var $c=(p,y)=>y+2097152>>>0<4194305-!!p?(p>>>0)+4294967296*y:NaN,yB=[0,31,60,91,121,152,182,213,244,274,305,335],gB=[0,31,59,90,120,151,181,212,243,273,304,334],qC=p=>{var y=N(p)+1,E=xd(y);return E&&_(p,I,E,y),E},cg={},$C=()=>{if(!ug){var p={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:h||"./this.program"},y;for(y in cg)cg[y]===void 0?delete p[y]:p[y]=cg[y];var E=[];for(y in p)E.push(`${y}=${p[y]}`);ug=E}return ug},ug,hg=p=>{var y=N(p)+1,E=Si(y);return _(p,I,E,y),E},bB=(p,y,E,M)=>{var L={string:Ve=>{var Ut=0;return Ve!=null&&Ve!==0&&(Ut=hg(Ve)),Ut},array:Ve=>{var Ut=Si(Ve.length);return K.set(Ve,Ut),Ut}};p=c["_"+p];var J=[],ee=0;if(M)for(var je=0;je<M.length;je++){var et=L[E[je]];et?(ee===0&&(ee=kc()),J[je]=et(M[je])):J[je]=M[je]}return E=p.apply(null,J),E=function(Ve){return ee!==0&&jc(ee),y==="string"?Ve?tt(I,Ve):"":y==="boolean"?!!Ve:Ve}(E)},Md=0,Od=(p,y)=>(y=y==1?Si(p.length):xd(p.length),p.subarray||p.slice||(p=new Uint8Array(p)),I.set(p,y),y),ys,dg=[],ka,$o=p=>{ys.delete(ka.get(p)),ka.set(p,null),dg.push(p)},_d=(p,y)=>{if(!ys){ys=new WeakMap;var E=ka.length;if(ys)for(var M=0;M<0+E;M++){var L=ka.get(M);L&&ys.set(L,M)}}if(E=ys.get(p)||0)return E;if(dg.length)E=dg.pop();else{try{ka.grow(1)}catch(je){throw je instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":je}E=ka.length-1}try{ka.set(E,p)}catch(je){if(!(je instanceof TypeError))throw je;if(typeof WebAssembly.Function=="function"){M=WebAssembly.Function,L={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var J={parameters:[],results:y[0]=="v"?[]:[L[y[0]]]},ee=1;ee<y.length;++ee)J.parameters.push(L[y[ee]]);y=new M(J,p)}else{for(M=[1],L=y.slice(0,1),y=y.slice(1),J={i:127,p:127,j:126,f:125,d:124,e:111},M.push(96),ee=y.length,128>ee?M.push(ee):M.push(ee%128|128,ee>>7),ee=0;ee<y.length;++ee)M.push(J[y[ee]]);L=="v"?M.push(0):M.push(1,J[L]),y=[0,97,115,109,1,0,0,0,1],L=M.length,128>L?y.push(L):y.push(L%128|128,L>>7),y.push.apply(y,M),y.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),y=new WebAssembly.Module(new Uint8Array(y)),y=new WebAssembly.Instance(y,{e:{f:p}}).exports.f}ka.set(E,y)}return ys.set(p,E),E};function kC(p,y,E,M){p||(p=this),this.parent=p,this.Ra=p.Ra,this.Va=null,this.id=We++,this.name=y,this.mode=E,this.Ga={},this.Ha={},this.rdev=M}Object.defineProperties(kC.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(p){p?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(p){p?this.mode|=146:this.mode&=-147}}}),IC(),Je=Array(4096),CC(oe,"/"),oa("/tmp"),oa("/home"),oa("/home/web_user"),function(){oa("/dev"),ig(259,{read:()=>0,write:(M,L,J,ee)=>ee}),Nd("/dev/null",259),P(1280,de),P(1536,Le),Nd("/dev/tty",1280),Nd("/dev/tty1",1536);var p=new Uint8Array(1024),y=0,E=()=>(y===0&&(y=te(p).byteLength),p[--y]);Lc("random",E),Lc("urandom",E),oa("/dev/shm"),oa("/dev/shm/tmp")}(),function(){oa("/proc");var p=oa("/proc/self");oa("/proc/self/fd"),CC({Ra(){var y=vC(p,"fd",16895,73);return y.Ga={lookup(E,M){var L=En(+M);return E={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>L.path}},E.parent=E}},y}},"/proc/self/fd")}();var vB={a:(p,y,E,M)=>{xe(`Assertion failed: ${p?tt(I,p):""}, at: `+[y?y?tt(I,y):"":"unknown filename",E,M?M?tt(I,M):"":"unknown function"])},h:function(p,y){try{return p=p?tt(I,p):"",Cd(p,y),0}catch(E){if(typeof pt>"u"||E.name!=="ErrnoError")throw E;return-E.Ka}},H:function(p,y,E){try{if(y=y?tt(I,y):"",y=fs(p,y),E&-8)return-28;var M=pn(y,{Sa:!0}).node;return M?(p="",E&4&&(p+="r"),E&2&&(p+="w"),E&1&&(p+="x"),p&&Lo(M,p)?-2:0):-44}catch(L){if(typeof pt>"u"||L.name!=="ErrnoError")throw L;return-L.Ka}},i:function(p,y){try{var E=En(p);return Cd(E.node,y),0}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},g:function(p){try{var y=En(p).node,E=typeof y=="string"?pn(y,{Sa:!0}).node:y;if(!E.Ga.Oa)throw new le(63);return E.Ga.Oa(E,{timestamp:Date.now()}),0}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},b:function(p,y,E){Sd=E;try{var M=En(p);switch(y){case 0:var L=Rd();if(0>L)return-28;for(;Ne[L];)L++;return NC(M,L).fd;case 1:case 2:return 0;case 3:return M.flags;case 4:return L=Rd(),M.flags|=L,0;case 5:return L=Rd(),G[L+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return H[jC()>>2]=28,-1;default:return-28}}catch(J){if(typeof pt>"u"||J.name!=="ErrnoError")throw J;return-J.Ka}},f:function(p,y){try{var E=En(p);return Ad(Dc,E.path,y)}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},n:function(p,y,E){y=$c(y,E);try{if(isNaN(y))return 61;var M=En(p);if(!(M.flags&2097155))throw new le(28);return OC(M.node,y),0}catch(L){if(typeof pt>"u"||L.name!=="ErrnoError")throw L;return-L.Ka}},C:function(p,y){try{if(y===0)return-28;var E=N("/")+1;return y<E?-68:(_("/",I,p,y),E)}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},F:function(p,y){try{return p=p?tt(I,p):"",Ad(MC,p,y)}catch(E){if(typeof pt>"u"||E.name!=="ErrnoError")throw E;return-E.Ka}},z:function(p,y,E){try{return y=y?tt(I,y):"",y=fs(p,y),y=st(y),y[y.length-1]==="/"&&(y=y.substr(0,y.length-1)),oa(y,E),0}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},E:function(p,y,E,M){try{y=y?tt(I,y):"";var L=M&256;return y=fs(p,y,M&4096),Ad(L?MC:Dc,y,E)}catch(J){if(typeof pt>"u"||J.name!=="ErrnoError")throw J;return-J.Ka}},y:function(p,y,E,M){Sd=M;try{y=y?tt(I,y):"",y=fs(p,y);var L=M?Rd():0;return qo(y,E,L).fd}catch(J){if(typeof pt>"u"||J.name!=="ErrnoError")throw J;return-J.Ka}},w:function(p,y,E,M){try{if(y=y?tt(I,y):"",y=fs(p,y),0>=M)return-28;var L=RC(y),J=Math.min(M,N(L)),ee=K[E+J];return _(L,I,E,M+1),K[E+J]=ee,J}catch(je){if(typeof pt>"u"||je.name!=="ErrnoError")throw je;return-je.Ka}},v:function(p){try{return p=p?tt(I,p):"",AC(p),0}catch(y){if(typeof pt>"u"||y.name!=="ErrnoError")throw y;return-y.Ka}},G:function(p,y){try{return p=p?tt(I,p):"",Ad(Dc,p,y)}catch(E){if(typeof pt>"u"||E.name!=="ErrnoError")throw E;return-E.Ka}},r:function(p,y,E){try{return y=y?tt(I,y):"",y=fs(p,y),E===0?SC(y):E===512?AC(y):xe("Invalid flags passed to unlinkat"),0}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},q:function(p,y,E){try{if(y=y?tt(I,y):"",y=fs(p,y,!0),E){var M=se[E>>2]+4294967296*H[E+4>>2],L=H[E+8>>2];J=1e3*M+L/1e6,E+=16,M=se[E>>2]+4294967296*H[E+4>>2],L=H[E+8>>2],ee=1e3*M+L/1e6}else var J=Date.now(),ee=J;p=J;var je=pn(y,{Sa:!0}).node;return je.Ga.Oa(je,{timestamp:Math.max(p,ee)}),0}catch(et){if(typeof pt>"u"||et.name!=="ErrnoError")throw et;return-et.Ka}},l:function(p,y,E){p=new Date(1e3*$c(p,y)),H[E>>2]=p.getSeconds(),H[E+4>>2]=p.getMinutes(),H[E+8>>2]=p.getHours(),H[E+12>>2]=p.getDate(),H[E+16>>2]=p.getMonth(),H[E+20>>2]=p.getFullYear()-1900,H[E+24>>2]=p.getDay(),y=p.getFullYear(),H[E+28>>2]=(y%4!==0||y%100===0&&y%400!==0?gB:yB)[p.getMonth()]+p.getDate()-1|0,H[E+36>>2]=-(60*p.getTimezoneOffset()),y=new Date(p.getFullYear(),6,1).getTimezoneOffset();var M=new Date(p.getFullYear(),0,1).getTimezoneOffset();H[E+32>>2]=(y!=M&&p.getTimezoneOffset()==Math.min(M,y))|0},j:function(p,y,E,M,L,J,ee,je){L=$c(L,J);try{if(isNaN(L))return 61;var et=En(M);if(y&2&&!(E&2)&&(et.flags&2097155)!==2)throw new le(2);if((et.flags&2097155)===1)throw new le(2);if(!et.Ha.bb)throw new le(43);var Ve=et.Ha.bb(et,p,L,y,E),Ut=Ve.Db;return H[ee>>2]=Ve.ub,se[je>>2]=Ut,0}catch(nn){if(typeof pt>"u"||nn.name!=="ErrnoError")throw nn;return-nn.Ka}},k:function(p,y,E,M,L,J,ee){J=$c(J,ee);try{if(isNaN(J))return 61;var je=En(L);if(E&2){if((je.node.mode&61440)!==32768)throw new le(43);if(!(M&2)){var et=I.slice(p,p+y);je.Ha.cb&&je.Ha.cb(je,et,J,y,M)}}}catch(Ve){if(typeof pt>"u"||Ve.name!=="ErrnoError")throw Ve;return-Ve.Ka}},s:(p,y,E)=>{function M(et){return(et=et.toTimeString().match(/\(([A-Za-z ]+)\)$/))?et[1]:"GMT"}var L=new Date().getFullYear(),J=new Date(L,0,1),ee=new Date(L,6,1);L=J.getTimezoneOffset();var je=ee.getTimezoneOffset();se[p>>2]=60*Math.max(L,je),H[y>>2]=+(L!=je),p=M(J),y=M(ee),p=qC(p),y=qC(y),je<L?(se[E>>2]=p,se[E+4>>2]=y):(se[E>>2]=y,se[E+4>>2]=p)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:p=>{var y=I.length;if(p>>>=0,2147483648<p)return!1;for(var E=1;4>=E;E*=2){var M=y*(1+.2/E);M=Math.min(M,p+100663296);var L=Math;M=Math.max(p,M);e:{L=(L.min.call(L,2147483648,M+(65536-M%65536)%65536)-V.buffer.byteLength+65535)/65536;try{V.grow(L),Se();var J=1;break e}catch{}J=void 0}if(J)return!0}return!1},A:(p,y)=>{var E=0;return $C().forEach((M,L)=>{var J=y+E;for(L=se[p+4*L>>2]=J,J=0;J<M.length;++J)K[L++>>0]=M.charCodeAt(J);K[L>>0]=0,E+=M.length+1}),0},B:(p,y)=>{var E=$C();se[p>>2]=E.length;var M=0;return E.forEach(L=>M+=L.length+1),se[y>>2]=M,0},e:function(p){try{var y=En(p);return og(y),0}catch(E){if(typeof pt>"u"||E.name!=="ErrnoError")throw E;return E.Ka}},p:function(p,y){try{var E=En(p);return K[y>>0]=E.tty?2:gr(E.mode)?3:(E.mode&61440)===40960?7:4,G[y+2>>1]=0,Ke=[0,(Ae=0,1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[y+8>>2]=Ke[0],H[y+12>>2]=Ke[1],Ke=[0,(Ae=0,1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[y+16>>2]=Ke[0],H[y+20>>2]=Ke[1],0}catch(M){if(typeof pt>"u"||M.name!=="ErrnoError")throw M;return M.Ka}},x:function(p,y,E,M){try{e:{var L=En(p);p=y;for(var J,ee=y=0;ee<E;ee++){var je=se[p>>2],et=se[p+4>>2];p+=8;var Ve=xC(L,K,je,et,J);if(0>Ve){var Ut=-1;break e}if(y+=Ve,Ve<et)break;typeof J<"u"&&(J+=Ve)}Ut=y}return se[M>>2]=Ut,0}catch(nn){if(typeof pt>"u"||nn.name!=="ErrnoError")throw nn;return nn.Ka}},m:function(p,y,E,M,L){y=$c(y,E);try{if(isNaN(y))return 61;var J=En(p);return _C(J,y,M),Ke=[J.position>>>0,(Ae=J.position,1<=+Math.abs(Ae)?0<Ae?+Math.floor(Ae/4294967296)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],H[L>>2]=Ke[0],H[L+4>>2]=Ke[1],J.hb&&y===0&&M===0&&(J.hb=null),0}catch(ee){if(typeof pt>"u"||ee.name!=="ErrnoError")throw ee;return ee.Ka}},D:function(p){try{var y=En(p);return y.Ha&&y.Ha.fsync?y.Ha.fsync(y):0}catch(E){if(typeof pt>"u"||E.name!=="ErrnoError")throw E;return E.Ka}},u:function(p,y,E,M){try{e:{var L=En(p);p=y;for(var J,ee=y=0;ee<E;ee++){var je=se[p>>2],et=se[p+4>>2];p+=8;var Ve=PC(L,K,je,et,J);if(0>Ve){var Ut=-1;break e}y+=Ve,typeof J<"u"&&(J+=Ve)}Ut=y}return se[M>>2]=Ut,0}catch(nn){if(typeof pt>"u"||nn.name!=="ErrnoError")throw nn;return nn.Ka}}},_e=function(){function p(E){return _e=E.exports,V=_e.I,Se(),ka=_e.Aa,fe.unshift(_e.J),ne--,c.monitorRunDependencies&&c.monitorRunDependencies(ne),ne==0&&Ye&&(E=Ye,Ye=null,E()),_e}var y={a:vB};if(ne++,c.monitorRunDependencies&&c.monitorRunDependencies(ne),c.instantiateWasm)try{return c.instantiateWasm(y,p)}catch(E){return B(`Module.instantiateWasm callback failed with error: ${E}`),!1}return dn(y,function(E){p(E.instance)}),{}}();c._sqlite3_free=p=>(c._sqlite3_free=_e.K)(p),c._sqlite3_value_text=p=>(c._sqlite3_value_text=_e.L)(p);var jC=()=>(jC=_e.M)();c._sqlite3_prepare_v2=(p,y,E,M,L)=>(c._sqlite3_prepare_v2=_e.N)(p,y,E,M,L),c._sqlite3_step=p=>(c._sqlite3_step=_e.O)(p),c._sqlite3_finalize=p=>(c._sqlite3_finalize=_e.P)(p),c._sqlite3_reset=p=>(c._sqlite3_reset=_e.Q)(p),c._sqlite3_clear_bindings=p=>(c._sqlite3_clear_bindings=_e.R)(p),c._sqlite3_value_blob=p=>(c._sqlite3_value_blob=_e.S)(p),c._sqlite3_value_bytes=p=>(c._sqlite3_value_bytes=_e.T)(p),c._sqlite3_value_double=p=>(c._sqlite3_value_double=_e.U)(p),c._sqlite3_value_int=p=>(c._sqlite3_value_int=_e.V)(p),c._sqlite3_value_type=p=>(c._sqlite3_value_type=_e.W)(p),c._sqlite3_result_blob=(p,y,E,M)=>(c._sqlite3_result_blob=_e.X)(p,y,E,M),c._sqlite3_result_double=(p,y)=>(c._sqlite3_result_double=_e.Y)(p,y),c._sqlite3_result_error=(p,y,E)=>(c._sqlite3_result_error=_e.Z)(p,y,E),c._sqlite3_result_int=(p,y)=>(c._sqlite3_result_int=_e._)(p,y),c._sqlite3_result_int64=(p,y,E)=>(c._sqlite3_result_int64=_e.$)(p,y,E),c._sqlite3_result_null=p=>(c._sqlite3_result_null=_e.aa)(p),c._sqlite3_result_text=(p,y,E,M)=>(c._sqlite3_result_text=_e.ba)(p,y,E,M),c._sqlite3_aggregate_context=(p,y)=>(c._sqlite3_aggregate_context=_e.ca)(p,y),c._sqlite3_column_count=p=>(c._sqlite3_column_count=_e.da)(p),c._sqlite3_data_count=p=>(c._sqlite3_data_count=_e.ea)(p),c._sqlite3_column_blob=(p,y)=>(c._sqlite3_column_blob=_e.fa)(p,y),c._sqlite3_column_bytes=(p,y)=>(c._sqlite3_column_bytes=_e.ga)(p,y),c._sqlite3_column_double=(p,y)=>(c._sqlite3_column_double=_e.ha)(p,y),c._sqlite3_column_text=(p,y)=>(c._sqlite3_column_text=_e.ia)(p,y),c._sqlite3_column_type=(p,y)=>(c._sqlite3_column_type=_e.ja)(p,y),c._sqlite3_column_name=(p,y)=>(c._sqlite3_column_name=_e.ka)(p,y),c._sqlite3_bind_blob=(p,y,E,M,L)=>(c._sqlite3_bind_blob=_e.la)(p,y,E,M,L),c._sqlite3_bind_double=(p,y,E)=>(c._sqlite3_bind_double=_e.ma)(p,y,E),c._sqlite3_bind_int=(p,y,E)=>(c._sqlite3_bind_int=_e.na)(p,y,E),c._sqlite3_bind_text=(p,y,E,M,L)=>(c._sqlite3_bind_text=_e.oa)(p,y,E,M,L),c._sqlite3_bind_parameter_index=(p,y)=>(c._sqlite3_bind_parameter_index=_e.pa)(p,y),c._sqlite3_sql=p=>(c._sqlite3_sql=_e.qa)(p),c._sqlite3_normalized_sql=p=>(c._sqlite3_normalized_sql=_e.ra)(p),c._sqlite3_errmsg=p=>(c._sqlite3_errmsg=_e.sa)(p),c._sqlite3_exec=(p,y,E,M,L)=>(c._sqlite3_exec=_e.ta)(p,y,E,M,L),c._sqlite3_changes=p=>(c._sqlite3_changes=_e.ua)(p),c._sqlite3_close_v2=p=>(c._sqlite3_close_v2=_e.va)(p),c._sqlite3_create_function_v2=(p,y,E,M,L,J,ee,je,et)=>(c._sqlite3_create_function_v2=_e.wa)(p,y,E,M,L,J,ee,je,et),c._sqlite3_open=(p,y)=>(c._sqlite3_open=_e.xa)(p,y);var xd=c._malloc=p=>(xd=c._malloc=_e.ya)(p),Pd=c._free=p=>(Pd=c._free=_e.za)(p);c._RegisterExtensionFunctions=p=>(c._RegisterExtensionFunctions=_e.Ba)(p);var BC=(p,y)=>(BC=_e.Ca)(p,y),kc=()=>(kc=_e.Da)(),jc=p=>(jc=_e.Ea)(p),Si=p=>(Si=_e.Fa)(p);c.stackAlloc=Si,c.stackSave=kc,c.stackRestore=jc,c.cwrap=(p,y,E,M)=>{var L=!E||E.every(J=>J==="number"||J==="boolean");return y!=="string"&&L&&!M?c["_"+p]:function(){return bB(p,y,E,arguments)}},c.addFunction=_d,c.removeFunction=$o,c.UTF8ToString=Bt,c.ALLOC_NORMAL=Md,c.allocate=Od,c.allocateUTF8OnStack=hg;var Id;Ye=function p(){Id||UC(),Id||(Ye=p)};function UC(){function p(){if(!Id&&(Id=!0,c.calledRun=!0,!q)){if(c.noFSInit||DC||(DC=!0,IC(),c.stdin=c.stdin,c.stdout=c.stdout,c.stderr=c.stderr,c.stdin?Lc("stdin",c.stdin):sg("/dev/tty","/dev/stdin"),c.stdout?Lc("stdout",null,c.stdout):sg("/dev/tty","/dev/stdout"),c.stderr?Lc("stderr",null,c.stderr):sg("/dev/tty1","/dev/stderr"),qo("/dev/stdin",0),qo("/dev/stdout",1),qo("/dev/stderr",1)),Tt=!1,Qn(fe),c.onRuntimeInitialized&&c.onRuntimeInitialized(),c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;){var y=c.postRun.shift();Me.unshift(y)}Qn(Me)}}if(!(0<ne)){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)ge();Qn(ie),0<ne||(c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),p()},1)):p())}}if(c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();return UC(),o}),t)};n.exports=r,n.exports.default=r})(Kw);var $_=Kw.exports;const k_=Mi($_),j_="/translations/assets/sql-wasm-Ko6OkY9T.wasm",B_="/translations/assets/tl-LnjbQPC7.db",Qw=ye.createContext({AppDataSource:{}});let Th;const U_=({children:n})=>{const{value:e,loading:t}=zS(async()=>{const r=await fetch(B_).then(s=>s.arrayBuffer()),a=new Uint8Array(r),i=await k_({locateFile:()=>j_});Th=new d_({type:"sqljs",driver:i,database:a,entities:[Xr,Rn,sr,or,St,Ca,jn,Na,ui,Zr,Pr],autoSave:!1,cache:!0});try{await Th.initialize(),Th.driver.databaseConnection.create_function("MATCHES",(s,o)=>{s=s||"",s=s.normalize("NFD").replace(/[\u0300-\u036f]/g,""),o=o.replace(/([\\\.\+\*\?\^\$\(\)\[\]\{\}\|\/])/g,"\\$1");const l=new RegExp("\\b"+o,"i");return s.match(l)!==null})}catch(s){console.error(s)}return console.log("Initialized DB connection"),Th},[]);return j.jsx(Qw.Provider,{value:{AppDataSource:e},children:!t&&n})},F_=()=>{const{AppDataSource:n}=ye.useContext(Qw);return n},bf="synthsWithCount/fetchSuccess",vf="synthsWithCount/fetchFailure",Ef="synthsWithCount/fetchLoading",wf="producersWithCount/fetchSuccess",Tf="producersWithCount/fetchFailure",Nf="producersWithCount/fetchLoading",Cf="vocalistsWithCount/fetchSuccess",Af="vocalistsWithCount/fetchFailure",Sf="vocalistsWithCount/fetchLoading",Rf="circlesWithCount/fetchSuccess",Mf="circlesWithCount/fetchFailure",Of="circlesWithCount/fetchLoading",_f="songs/fetchSuccess",xf="songs/fetchFailure",Pf="songs/fetchLoading",If="songs/searchSuccess",Df="songs/searchFailure",Lf="songs/searchLoading",Nh=10;window.Buffer=Ym.Buffer;function Fl(n,e){e.synths&&e.synths.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationSingers" 
        WHERE "synth_id" IN (${e.synths.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("synth_id") = ${e.synths.length}
      )`),e.producers&&e.producers.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationProducers" 
        WHERE "producer_id" IN (${e.producers.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("producer_id") = ${e.producers.length}
      )`),e.vocalists&&e.vocalists.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationSingers" 
        WHERE "vocalist_id" IN (${e.vocalists.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("vocalist_id") = ${e.vocalists.length}
      )`),e.circles&&e.circles.length>0&&n.andWhere(`"song"."id" IN (
        SELECT "translation_id" FROM "TranslationCircles" 
        WHERE "circle_id" IN (${e.circles.join(",")})
        GROUP BY "translation_id"
        HAVING COUNT("circle_id") = ${e.circles.length}
      )`)}function V_(n,e){const t=n.getRepository(sr).createQueryBuilder("synth").innerJoin("synth.__songs","song",e.lang?`song.lang = '${e.lang}'`:void 0);return Fl(t,e),t.groupBy("synth_id").orderBy("synth_numSongs","DESC").addOrderBy("LOWER(synth_localized_name)","ASC"),t.getMany()}function z_(n,e){const t=n.getRepository(Rn).createQueryBuilder("producer").innerJoin("producer.__songsMade","song",e.lang?`song.lang = '${e.lang}'`:void 0);return Fl(t,e),t.groupBy("producer_id").orderBy("producer_numSongs","DESC").addOrderBy("LOWER(producer_localized_name)","ASC"),t.getMany()}function W_(n,e){const t=n.getRepository(Rn).createQueryBuilder("producer").innerJoin("producer.__songsSung","song",e.lang?`song.lang = '${e.lang}'`:void 0);return Fl(t,e),t.groupBy("producer_id").orderBy("producer_numSongs","DESC").addOrderBy("LOWER(producer_localized_name)","ASC"),t.getMany()}function H_(n,e){const t=n.getRepository(Xr).createQueryBuilder("circle").innerJoin("circle.__songs","song",e.lang?`lang = '${e.lang}'`:void 0);return Fl(t,e),t.groupBy("circle_id").orderBy("circle_numSongs","DESC").addOrderBy("LOWER(circle_localized_name)","ASC"),t.getMany()}function K_(n,e){var i,s;const t=n.getRepository(St).createQueryBuilder("song").leftJoinAndSelect("song.singers","singer").leftJoinAndSelect("singer.__synthProps","jnSynth").leftJoinAndSelect("singer.__vocalistProps","jnVocalist").leftJoinAndSelect("song.producers","producer").leftJoinAndSelect("producer.__props","jnProducer").leftJoinAndSelect("song.circles","circle").leftJoinAndSelect("song.subs","sub").where(e.lang?"song.lang=:lang":"TRUE",{lang:e.lang});e.ids?t.andWhere(`"song"."id" IN (${e.ids})`):Fl(t,e);let r=((i=e.sort)==null?void 0:i.field)||null;switch(r){case"song_id":break;case"song_romanized_title":r=`LOWER("${r}")`;break;case"song_english_title":r=`LOWER(COALESCE("${r}", "song_original_title"))`;break;case"song_released_date":r='DATE("song_released_date")';break;case"song_translated_date":default:r='DATE("song_translated_date")'}let a=r?((s=e.sort)==null?void 0:s.order)||"ASC":"DESC";return t.orderBy(r,a).take(Nh).skip(((e.page||1)-1)*Nh),t.getManyAndCount()}function Q_(n,e){return n.getRepository(St).createQueryBuilder("song").select(["song.id","song.orgTitle","song.romTitle","song.engTitle"]).where("MATCHES(song_original_title, :query)").orWhere("MATCHES(song_romanized_title, :query)").orWhere("MATCHES(song_english_title, :query)").setParameter("query",e).getMany()}const G_=n=>({type:bf,payload:n}),Y_=()=>({type:vf}),Gw=n=>({type:Ef,payload:n}),J_=(n,e)=>async t=>{t(Gw(!0));try{const r=await V_(n,e);t(G_(r))}catch(r){t(Y_()),console.error(r)}finally{t(Gw(!1))}},X_=n=>({type:Cf,payload:n}),Z_=()=>({type:Af}),Yw=n=>({type:Sf,payload:n}),ex=(n,e)=>async t=>{t(Yw(!0));try{const r=await W_(n,e);t(X_(r))}catch(r){t(Z_()),console.error(r)}finally{t(Yw(!1))}},tx=n=>({type:wf,payload:n}),nx=()=>({type:Tf}),Jw=n=>({type:Nf,payload:n}),rx=(n,e)=>async t=>{t(Jw(!0));try{const r=await z_(n,e);t(tx(r))}catch(r){t(nx()),console.error(r)}finally{t(Jw(!1))}},ax=n=>({type:Rf,payload:n}),ix=()=>({type:Mf}),Xw=n=>({type:Of,payload:n}),sx=(n,e)=>async t=>{t(Xw(!0));try{const r=await H_(n,e);t(ax(r))}catch(r){t(ix()),console.error(r)}finally{t(Xw(!1))}},ox=n=>({type:_f,payload:n}),lx=()=>({type:xf}),Zw=n=>({type:Pf,payload:n}),cx=(n,e)=>async t=>{t(Zw(!0));try{const[r,a]=await K_(n,e);t(ox({songs:r,count:a}))}catch(r){t(lx()),console.error(r)}finally{t(Zw(!1))}},ux=n=>({type:If,payload:n}),hx=()=>({type:Df}),e0=n=>({type:Lf,payload:n}),dx=(n,e)=>async t=>{t(e0(!0));try{const r=await Q_(n,e);t(ux(r))}catch(r){t(hx()),console.error(r)}finally{t(e0(!1))}};function qf(n,e){if(n==null)return{};var t={},r=Object.keys(n),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}var t0={exports:{}},rt={};/** @license React v16.13.1
* react-is.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Ht=typeof Symbol=="function"&&Symbol.for,$f=Ht?Symbol.for("react.element"):60103,kf=Ht?Symbol.for("react.portal"):60106,Ch=Ht?Symbol.for("react.fragment"):60107,Ah=Ht?Symbol.for("react.strict_mode"):60108,Sh=Ht?Symbol.for("react.profiler"):60114,Rh=Ht?Symbol.for("react.provider"):60109,Mh=Ht?Symbol.for("react.context"):60110,jf=Ht?Symbol.for("react.async_mode"):60111,Oh=Ht?Symbol.for("react.concurrent_mode"):60111,_h=Ht?Symbol.for("react.forward_ref"):60112,xh=Ht?Symbol.for("react.suspense"):60113,px=Ht?Symbol.for("react.suspense_list"):60120,Ph=Ht?Symbol.for("react.memo"):60115,Ih=Ht?Symbol.for("react.lazy"):60116,mx=Ht?Symbol.for("react.block"):60121,fx=Ht?Symbol.for("react.fundamental"):60117,yx=Ht?Symbol.for("react.responder"):60118,gx=Ht?Symbol.for("react.scope"):60119;function Bn(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case $f:switch(n=n.type,n){case jf:case Oh:case Ch:case Sh:case Ah:case xh:return n;default:switch(n=n&&n.$$typeof,n){case Mh:case _h:case Ih:case Ph:case Rh:return n;default:return e}}case kf:return e}}}function n0(n){return Bn(n)===Oh}rt.AsyncMode=jf,rt.ConcurrentMode=Oh,rt.ContextConsumer=Mh,rt.ContextProvider=Rh,rt.Element=$f,rt.ForwardRef=_h,rt.Fragment=Ch,rt.Lazy=Ih,rt.Memo=Ph,rt.Portal=kf,rt.Profiler=Sh,rt.StrictMode=Ah,rt.Suspense=xh,rt.isAsyncMode=function(n){return n0(n)||Bn(n)===jf},rt.isConcurrentMode=n0,rt.isContextConsumer=function(n){return Bn(n)===Mh},rt.isContextProvider=function(n){return Bn(n)===Rh},rt.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===$f},rt.isForwardRef=function(n){return Bn(n)===_h},rt.isFragment=function(n){return Bn(n)===Ch},rt.isLazy=function(n){return Bn(n)===Ih},rt.isMemo=function(n){return Bn(n)===Ph},rt.isPortal=function(n){return Bn(n)===kf},rt.isProfiler=function(n){return Bn(n)===Sh},rt.isStrictMode=function(n){return Bn(n)===Ah},rt.isSuspense=function(n){return Bn(n)===xh},rt.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===Ch||n===Oh||n===Sh||n===Ah||n===xh||n===px||typeof n=="object"&&n!==null&&(n.$$typeof===Ih||n.$$typeof===Ph||n.$$typeof===Rh||n.$$typeof===Mh||n.$$typeof===_h||n.$$typeof===fx||n.$$typeof===yx||n.$$typeof===gx||n.$$typeof===mx)},rt.typeOf=Bn,t0.exports=rt;var bx=t0.exports;function yt(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,rf(n,e)}var ea=function(n,e){if(typeof n=="function"){n(e);return}n!==null&&typeof n=="object"&&(n.current=e)},vx=function(n){return n!==null&&typeof n=="object"&&n.hasOwnProperty("current")},Ex=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.prevNode=void 0,r}var t=e.prototype;return t.componentDidMount=function(){var r=Rl.findDOMNode(this);this.prevNode=r,ea(this.props.innerRef,r)},t.componentDidUpdate=function(r){var a=Rl.findDOMNode(this);this.prevNode!==a&&(this.prevNode=a,ea(this.props.innerRef,a)),r.innerRef!==this.props.innerRef&&ea(this.props.innerRef,a)},t.componentWillUnmount=function(){ea(this.props.innerRef,null),delete this.prevNode},t.render=function(){var r=this.props.children;return r},e}(ye.Component),wx=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.currentNode=void 0,r.handleRefOverride=function(o){var l=r.props,c=l.children,u=l.innerRef;ea(c.ref,o),ea(u,o),r.currentNode=o},r}var t=e.prototype;return t.componentDidUpdate=function(r){r.innerRef!==this.props.innerRef&&ea(this.props.innerRef,this.currentNode)},t.componentWillUnmount=function(){delete this.currentNode},t.render=function(){var r=this.props.children;return ye.cloneElement(r,{ref:this.handleRefOverride})},e}(ye.Component),Tx=["children","innerRef"],Aa=function(n){var e=n.children,t=n.innerRef,r=qf(n,Tx),a=ye.Children.only(e),i=bx.isForwardRef(a)?wx:Ex,s=a&&r&&Object.keys(r).length>0?ye.cloneElement(a,r):a;return ye.createElement(i,{innerRef:t},s)};function Z(){return Z=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Z.apply(this,arguments)}var xt=Array.isArray,r0=typeof global=="object"&&global&&global.Object===Object&&global,Nx=typeof self=="object"&&self&&self.Object===Object&&self,Un=r0||Nx||Function("return this")(),ta=Un.Symbol,a0=Object.prototype,Cx=a0.hasOwnProperty,Ax=a0.toString,Vl=ta?ta.toStringTag:void 0;function Sx(n){var e=Cx.call(n,Vl),t=n[Vl];try{n[Vl]=void 0;var r=!0}catch{}var a=Ax.call(n);return r&&(e?n[Vl]=t:delete n[Vl]),a}var Rx=Object.prototype,Mx=Rx.toString;function Ox(n){return Mx.call(n)}var _x="[object Null]",xx="[object Undefined]",i0=ta?ta.toStringTag:void 0;function na(n){return n==null?n===void 0?xx:_x:i0&&i0 in Object(n)?Sx(n):Ox(n)}function Fn(n){return n!=null&&typeof n=="object"}var Px="[object Symbol]";function Dh(n){return typeof n=="symbol"||Fn(n)&&na(n)==Px}var Ix=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dx=/^\w*$/;function Bf(n,e){if(xt(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||Dh(n)?!0:Dx.test(n)||!Ix.test(n)||e!=null&&n in Object(e)}function ra(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Lx="[object AsyncFunction]",qx="[object Function]",$x="[object GeneratorFunction]",kx="[object Proxy]";function so(n){if(!ra(n))return!1;var e=na(n);return e==qx||e==$x||e==Lx||e==kx}var Uf=Un["__core-js_shared__"],s0=function(){var n=/[^.]+$/.exec(Uf&&Uf.keys&&Uf.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function jx(n){return!!s0&&s0 in n}var Bx=Function.prototype,Ux=Bx.toString;function Gi(n){if(n!=null){try{return Ux.call(n)}catch{}try{return n+""}catch{}}return""}var Fx=/[\\^$.*+?()[\]{}|]/g,Vx=/^\[object .+?Constructor\]$/,zx=Function.prototype,Wx=Object.prototype,Hx=zx.toString,Kx=Wx.hasOwnProperty,Qx=RegExp("^"+Hx.call(Kx).replace(Fx,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Gx(n){if(!ra(n)||jx(n))return!1;var e=so(n)?Qx:Vx;return e.test(Gi(n))}function Yx(n,e){return n==null?void 0:n[e]}function Yi(n,e){var t=Yx(n,e);return Gx(t)?t:void 0}var zl=Yi(Object,"create");function Jx(){this.__data__=zl?zl(null):{},this.size=0}function Xx(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var Zx="__lodash_hash_undefined__",eP=Object.prototype,tP=eP.hasOwnProperty;function nP(n){var e=this.__data__;if(zl){var t=e[n];return t===Zx?void 0:t}return tP.call(e,n)?e[n]:void 0}var rP=Object.prototype,aP=rP.hasOwnProperty;function iP(n){var e=this.__data__;return zl?e[n]!==void 0:aP.call(e,n)}var sP="__lodash_hash_undefined__";function oP(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=zl&&e===void 0?sP:e,this}function Ji(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ji.prototype.clear=Jx,Ji.prototype.delete=Xx,Ji.prototype.get=nP,Ji.prototype.has=iP,Ji.prototype.set=oP;function lP(){this.__data__=[],this.size=0}function Lh(n,e){return n===e||n!==n&&e!==e}function qh(n,e){for(var t=n.length;t--;)if(Lh(n[t][0],e))return t;return-1}var cP=Array.prototype,uP=cP.splice;function hP(n){var e=this.__data__,t=qh(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():uP.call(e,t,1),--this.size,!0}function dP(n){var e=this.__data__,t=qh(e,n);return t<0?void 0:e[t][1]}function pP(n){return qh(this.__data__,n)>-1}function mP(n,e){var t=this.__data__,r=qh(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function Sa(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Sa.prototype.clear=lP,Sa.prototype.delete=hP,Sa.prototype.get=dP,Sa.prototype.has=pP,Sa.prototype.set=mP;var Wl=Yi(Un,"Map");function fP(){this.size=0,this.__data__={hash:new Ji,map:new(Wl||Sa),string:new Ji}}function yP(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function $h(n,e){var t=n.__data__;return yP(e)?t[typeof e=="string"?"string":"hash"]:t.map}function gP(n){var e=$h(this,n).delete(n);return this.size-=e?1:0,e}function bP(n){return $h(this,n).get(n)}function vP(n){return $h(this,n).has(n)}function EP(n,e){var t=$h(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function Ra(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ra.prototype.clear=fP,Ra.prototype.delete=gP,Ra.prototype.get=bP,Ra.prototype.has=vP,Ra.prototype.set=EP;var wP="Expected a function";function kh(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(wP);var t=function(){var r=arguments,a=e?e.apply(this,r):r[0],i=t.cache;if(i.has(a))return i.get(a);var s=n.apply(this,r);return t.cache=i.set(a,s)||i,s};return t.cache=new(kh.Cache||Ra),t}kh.Cache=Ra;var TP=500;function NP(n){var e=kh(n,function(r){return t.size===TP&&t.clear(),r}),t=e.cache;return e}var CP=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,AP=/\\(\\)?/g,SP=NP(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(CP,function(t,r,a,i){e.push(a?i.replace(AP,"$1"):r||t)}),e});function jh(n,e){for(var t=-1,r=n==null?0:n.length,a=Array(r);++t<r;)a[t]=e(n[t],t,n);return a}var RP=1/0,o0=ta?ta.prototype:void 0,l0=o0?o0.toString:void 0;function c0(n){if(typeof n=="string")return n;if(xt(n))return jh(n,c0)+"";if(Dh(n))return l0?l0.call(n):"";var e=n+"";return e=="0"&&1/n==-RP?"-0":e}function Hl(n){return n==null?"":c0(n)}function Kl(n,e){return xt(n)?n:Bf(n,e)?[n]:SP(Hl(n))}var MP="[object Arguments]";function u0(n){return Fn(n)&&na(n)==MP}var h0=Object.prototype,OP=h0.hasOwnProperty,_P=h0.propertyIsEnumerable,xP=u0(function(){return arguments}())?u0:function(n){return Fn(n)&&OP.call(n,"callee")&&!_P.call(n,"callee")};const Bh=xP;var PP=9007199254740991,IP=/^(?:0|[1-9]\d*)$/;function Ql(n,e){var t=typeof n;return e=e??PP,!!e&&(t=="number"||t!="symbol"&&IP.test(n))&&n>-1&&n%1==0&&n<e}var DP=9007199254740991;function Ff(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=DP}var LP=1/0;function oo(n){if(typeof n=="string"||Dh(n))return n;var e=n+"";return e=="0"&&1/n==-LP?"-0":e}function qP(n,e,t){e=Kl(e,n);for(var r=-1,a=e.length,i=!1;++r<a;){var s=oo(e[r]);if(!(i=n!=null&&t(n,s)))break;n=n[s]}return i||++r!=a?i:(a=n==null?0:n.length,!!a&&Ff(a)&&Ql(s,a)&&(xt(n)||Bh(n)))}function Uh(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function $P(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}function Fh(n,e){e=Kl(e,n);for(var t=0,r=e.length;n!=null&&t<r;)n=n[oo(e[t++])];return t&&t==r?n:void 0}function Vf(n,e,t){var r=-1,a=n.length;e<0&&(e=-e>a?0:a+e),t=t>a?a:t,t<0&&(t+=a),a=e>t?0:t-e>>>0,e>>>=0;for(var i=Array(a);++r<a;)i[r]=n[r+e];return i}function kP(n,e){return e.length<2?n:Fh(n,Vf(e,0,-1))}function jP(n,e,t){e=Kl(e,n),n=kP(n,e);var r=n==null?n:n[oo($P(e))];return r==null?void 0:Uh(r,n,t)}function lo(n){return n}var d0=Math.max;function p0(n,e,t){return e=d0(e===void 0?n.length-1:e,0),function(){for(var r=arguments,a=-1,i=d0(r.length-e,0),s=Array(i);++a<i;)s[a]=r[e+a];a=-1;for(var o=Array(e+1);++a<e;)o[a]=r[a];return o[e]=t(s),Uh(n,this,o)}}function m0(n){return function(){return n}}var Vh=function(){try{var n=Yi(Object,"defineProperty");return n({},"",{}),n}catch{}}(),BP=Vh?function(n,e){return Vh(n,"toString",{configurable:!0,enumerable:!1,value:m0(e),writable:!0})}:lo;const UP=BP;var FP=800,VP=16,zP=Date.now;function f0(n){var e=0,t=0;return function(){var r=zP(),a=VP-(r-t);if(t=r,a>0){if(++e>=FP)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}var zf=f0(UP);function Gl(n,e){return zf(p0(n,e,lo),n+"")}var WP=Gl(jP);const be=WP;function Yl(n){return n===void 0}var HP=/\s/;function KP(n){for(var e=n.length;e--&&HP.test(n.charAt(e)););return e}var QP=/^\s+/;function GP(n){return n&&n.slice(0,KP(n)+1).replace(QP,"")}var y0=NaN,YP=/^[-+]0x[0-9a-f]+$/i,JP=/^0b[01]+$/i,XP=/^0o[0-7]+$/i,ZP=parseInt;function g0(n){if(typeof n=="number")return n;if(Dh(n))return y0;if(ra(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=ra(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=GP(n);var t=JP.test(n);return t||XP.test(n)?ZP(n.slice(2),t?2:8):YP.test(n)?y0:+n}var b0=1/0,eI=17976931348623157e292;function co(n){if(!n)return n===0?n:0;if(n=g0(n),n===b0||n===-b0){var e=n<0?-1:1;return e*eI}return n===n?n:0}function Jl(n){var e=co(n),t=e%1;return e===e?t?e-t:e:0}function v0(n,e){for(var t=-1,r=n==null?0:n.length,a=0,i=[];++t<r;){var s=n[t];e(s,t,n)&&(i[a++]=s)}return i}function tI(n){return function(e,t,r){for(var a=-1,i=Object(e),s=r(e),o=s.length;o--;){var l=s[n?o:++a];if(t(i[l],l,i)===!1)break}return e}}var nI=tI();const rI=nI;function aI(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}function iI(){return!1}var E0=typeof rn=="object"&&rn&&!rn.nodeType&&rn,w0=E0&&typeof Mt=="object"&&Mt&&!Mt.nodeType&&Mt,sI=w0&&w0.exports===E0,T0=sI?Un.Buffer:void 0,oI=T0?T0.isBuffer:void 0,lI=oI||iI;const zh=lI;var cI="[object Arguments]",uI="[object Array]",hI="[object Boolean]",dI="[object Date]",pI="[object Error]",mI="[object Function]",fI="[object Map]",yI="[object Number]",gI="[object Object]",bI="[object RegExp]",vI="[object Set]",EI="[object String]",wI="[object WeakMap]",TI="[object ArrayBuffer]",NI="[object DataView]",CI="[object Float32Array]",AI="[object Float64Array]",SI="[object Int8Array]",RI="[object Int16Array]",MI="[object Int32Array]",OI="[object Uint8Array]",_I="[object Uint8ClampedArray]",xI="[object Uint16Array]",PI="[object Uint32Array]",dt={};dt[CI]=dt[AI]=dt[SI]=dt[RI]=dt[MI]=dt[OI]=dt[_I]=dt[xI]=dt[PI]=!0,dt[cI]=dt[uI]=dt[TI]=dt[hI]=dt[NI]=dt[dI]=dt[pI]=dt[mI]=dt[fI]=dt[yI]=dt[gI]=dt[bI]=dt[vI]=dt[EI]=dt[wI]=!1;function II(n){return Fn(n)&&Ff(n.length)&&!!dt[na(n)]}function N0(n){return function(e){return n(e)}}var C0=typeof rn=="object"&&rn&&!rn.nodeType&&rn,Xl=C0&&typeof Mt=="object"&&Mt&&!Mt.nodeType&&Mt,DI=Xl&&Xl.exports===C0,Wf=DI&&r0.process,A0=function(){try{var n=Xl&&Xl.require&&Xl.require("util").types;return n||Wf&&Wf.binding&&Wf.binding("util")}catch{}}(),S0=A0&&A0.isTypedArray,LI=S0?N0(S0):II;const Hf=LI;var qI=Object.prototype,$I=qI.hasOwnProperty;function kI(n,e){var t=xt(n),r=!t&&Bh(n),a=!t&&!r&&zh(n),i=!t&&!r&&!a&&Hf(n),s=t||r||a||i,o=s?aI(n.length,String):[],l=o.length;for(var c in n)(e||$I.call(n,c))&&!(s&&(c=="length"||a&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Ql(c,l)))&&o.push(c);return o}var jI=Object.prototype;function R0(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||jI;return n===t}function M0(n,e){return function(t){return n(e(t))}}var BI=M0(Object.keys,Object),UI=Object.prototype,FI=UI.hasOwnProperty;function Kf(n){if(!R0(n))return BI(n);var e=[];for(var t in Object(n))FI.call(n,t)&&t!="constructor"&&e.push(t);return e}function Ma(n){return n!=null&&Ff(n.length)&&!so(n)}function uo(n){return Ma(n)?kI(n):Kf(n)}function O0(n,e){return n&&rI(n,e,uo)}function VI(n,e){return function(t,r){if(t==null)return t;if(!Ma(t))return n(t,r);for(var a=t.length,i=e?a:-1,s=Object(t);(e?i--:++i<a)&&r(s[i],i,s)!==!1;);return t}}var zI=VI(O0);const ho=zI;function WI(n,e){var t=[];return ho(n,function(r,a,i){e(r,a,i)&&t.push(r)}),t}function HI(){this.__data__=new Sa,this.size=0}function KI(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function QI(n){return this.__data__.get(n)}function GI(n){return this.__data__.has(n)}var YI=200;function JI(n,e){var t=this.__data__;if(t instanceof Sa){var r=t.__data__;if(!Wl||r.length<YI-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Ra(r)}return t.set(n,e),this.size=t.size,this}function Oa(n){var e=this.__data__=new Sa(n);this.size=e.size}Oa.prototype.clear=HI,Oa.prototype.delete=KI,Oa.prototype.get=QI,Oa.prototype.has=GI,Oa.prototype.set=JI;var XI="__lodash_hash_undefined__";function ZI(n){return this.__data__.set(n,XI),this}function eD(n){return this.__data__.has(n)}function po(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Ra;++e<t;)this.add(n[e])}po.prototype.add=po.prototype.push=ZI,po.prototype.has=eD;function _0(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}function Qf(n,e){return n.has(e)}var tD=1,nD=2;function x0(n,e,t,r,a,i){var s=t&tD,o=n.length,l=e.length;if(o!=l&&!(s&&l>o))return!1;var c=i.get(n),u=i.get(e);if(c&&u)return c==e&&u==n;var h=-1,d=!0,f=t&nD?new po:void 0;for(i.set(n,e),i.set(e,n);++h<o;){var g=n[h],v=e[h];if(r)var C=s?r(v,g,h,e,n,i):r(g,v,h,n,e,i);if(C!==void 0){if(C)continue;d=!1;break}if(f){if(!_0(e,function(w,T){if(!Qf(f,T)&&(g===w||a(g,w,t,r,i)))return f.push(T)})){d=!1;break}}else if(!(g===v||a(g,v,t,r,i))){d=!1;break}}return i.delete(n),i.delete(e),d}var rD=Un.Uint8Array;const P0=rD;function aD(n){var e=-1,t=Array(n.size);return n.forEach(function(r,a){t[++e]=[a,r]}),t}function Gf(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var iD=1,sD=2,oD="[object Boolean]",lD="[object Date]",cD="[object Error]",uD="[object Map]",hD="[object Number]",dD="[object RegExp]",pD="[object Set]",mD="[object String]",fD="[object Symbol]",yD="[object ArrayBuffer]",gD="[object DataView]",I0=ta?ta.prototype:void 0,Yf=I0?I0.valueOf:void 0;function bD(n,e,t,r,a,i,s){switch(t){case gD:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case yD:return!(n.byteLength!=e.byteLength||!i(new P0(n),new P0(e)));case oD:case lD:case hD:return Lh(+n,+e);case cD:return n.name==e.name&&n.message==e.message;case dD:case mD:return n==e+"";case uD:var o=aD;case pD:var l=r&iD;if(o||(o=Gf),n.size!=e.size&&!l)return!1;var c=s.get(n);if(c)return c==e;r|=sD,s.set(n,e);var u=x0(o(n),o(e),r,a,i,s);return s.delete(n),u;case fD:if(Yf)return Yf.call(n)==Yf.call(e)}return!1}function D0(n,e){for(var t=-1,r=e.length,a=n.length;++t<r;)n[a+t]=e[t];return n}function vD(n,e,t){var r=e(n);return xt(n)?r:D0(r,t(n))}function ED(){return[]}var wD=Object.prototype,TD=wD.propertyIsEnumerable,L0=Object.getOwnPropertySymbols,ND=L0?function(n){return n==null?[]:(n=Object(n),v0(L0(n),function(e){return TD.call(n,e)}))}:ED;const CD=ND;function q0(n){return vD(n,uo,CD)}var AD=1,SD=Object.prototype,RD=SD.hasOwnProperty;function MD(n,e,t,r,a,i){var s=t&AD,o=q0(n),l=o.length,c=q0(e),u=c.length;if(l!=u&&!s)return!1;for(var h=l;h--;){var d=o[h];if(!(s?d in e:RD.call(e,d)))return!1}var f=i.get(n),g=i.get(e);if(f&&g)return f==e&&g==n;var v=!0;i.set(n,e),i.set(e,n);for(var C=s;++h<l;){d=o[h];var w=n[d],T=e[d];if(r)var S=s?r(T,w,d,e,n,i):r(w,T,d,n,e,i);if(!(S===void 0?w===T||a(w,T,t,r,i):S)){v=!1;break}C||(C=d=="constructor")}if(v&&!C){var O=n.constructor,k=e.constructor;O!=k&&"constructor"in n&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof k=="function"&&k instanceof k)&&(v=!1)}return i.delete(n),i.delete(e),v}var Jf=Yi(Un,"DataView"),Xf=Yi(Un,"Promise"),mo=Yi(Un,"Set"),Zl=Yi(Un,"WeakMap"),$0="[object Map]",OD="[object Object]",k0="[object Promise]",j0="[object Set]",B0="[object WeakMap]",U0="[object DataView]",_D=Gi(Jf),xD=Gi(Wl),PD=Gi(Xf),ID=Gi(mo),DD=Gi(Zl),Xi=na;(Jf&&Xi(new Jf(new ArrayBuffer(1)))!=U0||Wl&&Xi(new Wl)!=$0||Xf&&Xi(Xf.resolve())!=k0||mo&&Xi(new mo)!=j0||Zl&&Xi(new Zl)!=B0)&&(Xi=function(n){var e=na(n),t=e==OD?n.constructor:void 0,r=t?Gi(t):"";if(r)switch(r){case _D:return U0;case xD:return $0;case PD:return k0;case ID:return j0;case DD:return B0}return e});const Wh=Xi;var LD=1,F0="[object Arguments]",V0="[object Array]",Hh="[object Object]",qD=Object.prototype,z0=qD.hasOwnProperty;function $D(n,e,t,r,a,i){var s=xt(n),o=xt(e),l=s?V0:Wh(n),c=o?V0:Wh(e);l=l==F0?Hh:l,c=c==F0?Hh:c;var u=l==Hh,h=c==Hh,d=l==c;if(d&&zh(n)){if(!zh(e))return!1;s=!0,u=!1}if(d&&!u)return i||(i=new Oa),s||Hf(n)?x0(n,e,t,r,a,i):bD(n,e,l,t,r,a,i);if(!(t&LD)){var f=u&&z0.call(n,"__wrapped__"),g=h&&z0.call(e,"__wrapped__");if(f||g){var v=f?n.value():n,C=g?e.value():e;return i||(i=new Oa),a(v,C,t,r,i)}}return d?(i||(i=new Oa),MD(n,e,t,r,a,i)):!1}function Kh(n,e,t,r,a){return n===e?!0:n==null||e==null||!Fn(n)&&!Fn(e)?n!==n&&e!==e:$D(n,e,t,r,Kh,a)}var kD=1,jD=2;function BD(n,e,t,r){var a=t.length,i=a,s=!r;if(n==null)return!i;for(n=Object(n);a--;){var o=t[a];if(s&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return!1}for(;++a<i;){o=t[a];var l=o[0],c=n[l],u=o[1];if(s&&o[2]){if(c===void 0&&!(l in n))return!1}else{var h=new Oa;if(r)var d=r(c,u,l,n,e,h);if(!(d===void 0?Kh(u,c,kD|jD,r,h):d))return!1}}return!0}function W0(n){return n===n&&!ra(n)}function UD(n){for(var e=uo(n),t=e.length;t--;){var r=e[t],a=n[r];e[t]=[r,a,W0(a)]}return e}function H0(n,e){return function(t){return t==null?!1:t[n]===e&&(e!==void 0||n in Object(t))}}function FD(n){var e=UD(n);return e.length==1&&e[0][2]?H0(e[0][0],e[0][1]):function(t){return t===n||BD(t,n,e)}}function hi(n,e,t){var r=n==null?void 0:Fh(n,e);return r===void 0?t:r}function VD(n,e){return n!=null&&e in Object(n)}function K0(n,e){return n!=null&&qP(n,e,VD)}var zD=1,WD=2;function HD(n,e){return Bf(n)&&W0(e)?H0(oo(n),e):function(t){var r=hi(t,n);return r===void 0&&r===e?K0(t,n):Kh(e,r,zD|WD)}}function Q0(n){return function(e){return e==null?void 0:e[n]}}function KD(n){return function(e){return Fh(e,n)}}function QD(n){return Bf(n)?Q0(oo(n)):KD(n)}function Zi(n){return typeof n=="function"?n:n==null?lo:typeof n=="object"?xt(n)?HD(n[0],n[1]):FD(n):QD(n)}function G0(n,e){var t=xt(n)?v0:WI;return t(n,Zi(e))}var GD="[object Map]",YD="[object Set]",JD=Object.prototype,XD=JD.hasOwnProperty;function ec(n){if(n==null)return!0;if(Ma(n)&&(xt(n)||typeof n=="string"||typeof n.splice=="function"||zh(n)||Hf(n)||Bh(n)))return!n.length;var e=Wh(n);if(e==GD||e==YD)return!n.size;if(R0(n))return!Kf(n).length;for(var t in n)if(XD.call(n,t))return!1;return!0}function Y0(n,e,t,r){for(var a=n.length,i=t+(r?1:-1);r?i--:++i<a;)if(e(n[i],i,n))return i;return-1}function ZD(n){return n!==n}function eL(n,e,t){for(var r=t-1,a=n.length;++r<a;)if(n[r]===e)return r;return-1}function J0(n,e,t){return e===e?eL(n,e,t):Y0(n,ZD,t)}function Zf(n,e){var t=n==null?0:n.length;return!!t&&J0(n,e,0)>-1}function X0(n,e,t){for(var r=-1,a=n==null?0:n.length;++r<a;)if(t(e,n[r]))return!0;return!1}function Qh(n){return Fn(n)&&Ma(n)}function Z0(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}function tL(n){return typeof n=="function"?n:lo}function eT(n,e){var t=xt(n)?Z0:ho;return t(n,tL(e))}var nL=function(n){return"default"+(n[0].toUpperCase()+n.slice(1))},rL=function(n,e,t,r){r===void 0&&(r=!1);var a=e[n];if(a!==void 0)return a;if(r){var i=e[nL(n)];if(i!==void 0)return i;if(t){var s=t[n];if(s!==void 0)return s}}if(n==="checked")return!1;if(n==="value")return e.multiple?[]:""},fo=function(n){yt(e,n);function e(){for(var t,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];t=n.call.apply(n,[this].concat(a))||this;var s=t.constructor,o=s.autoControlledProps,l=s.getAutoControlledStateFromProps,c=be($M(t),"getInitialAutoControlledState",t.props)||{},u=o.reduce(function(h,d){return h[d]=rL(d,t.props,c,!0),h},{});return t.state=Z({},c,u,{autoControlledProps:o,getAutoControlledStateFromProps:l}),t}return e.getDerivedStateFromProps=function(t,r){var a=r.autoControlledProps,i=r.getAutoControlledStateFromProps,s=a.reduce(function(l,c){var u=!Yl(t[c]);return u&&(l[c]=t[c]),l},{});if(i){var o=i(t,Z({},r,s),r);return Z({},s,o)}return s},e.getAutoControlledStateFromProps=function(){return null},e}(Y.Component);function aL(n){return function(e,t,r){var a=Object(e);if(!Ma(e)){var i=Zi(t);e=uo(e),t=function(o){return i(a[o],o,a)}}var s=n(e,t,r);return s>-1?a[i?e[s]:s]:void 0}}var iL=Math.max;function ey(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var a=t==null?0:Jl(t);return a<0&&(a=iL(r+a,0)),Y0(n,Zi(e),a)}var tT=aL(ey);function sL(n,e){var t;return ho(n,function(r,a,i){return t=e(r,a,i),!t}),!!t}function ty(n,e,t){if(!ra(t))return!1;var r=typeof e;return(r=="number"?Ma(t)&&Ql(e,t.length):r=="string"&&e in t)?Lh(t[e],n):!1}function tc(n,e,t){var r=xt(n)?_0:sL;return t&&ty(n,e,t)&&(e=void 0),r(n,Zi(e))}var oL=function(n,e){return tc(ye.Children.toArray(n),{type:e})},Fe=function(n){return n==null||Array.isArray(n)&&n.length===0},lL={1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine",10:"ten",11:"eleven",12:"twelve",13:"thirteen",14:"fourteen",15:"fifteen",16:"sixteen"};function nT(n){var e=typeof n;return e==="string"||e==="number"?lL[n]||n:""}var U=function(n,e){return n&&e},hn=function(n,e){return n&&n!==!0&&n+" "+e},gt=function(n,e){return n&&(n===!0?e:n+" "+e)},Gh=function(n,e){return!n||n===!0?null:n.replace("large screen","large-screen").replace(/ vertically/g,"-vertically").split(" ").map(function(t){return t.replace("-"," ")+" "+e}).join(" ")},es=function(n){return n==="justified"?"justified":hn(n,"aligned")},di=function(n){return hn(n,"aligned")},lr=function(n,e,t){if(e===void 0&&(e=""),t===void 0&&(t=!1),t&&n==="equal")return"equal width";var r=typeof n;return(r==="string"||r==="number")&&e?nT(n)+" "+e:nT(n)},cL=200;function rT(n,e,t,r){var a=-1,i=Zf,s=!0,o=n.length,l=[],c=e.length;if(!o)return l;t&&(e=jh(e,N0(t))),r?(i=X0,s=!1):e.length>=cL&&(i=Qf,s=!1,e=new po(e));e:for(;++a<o;){var u=n[a],h=t==null?u:t(u);if(u=r||u!==0?u:0,s&&h===h){for(var d=c;d--;)if(e[d]===h)continue e;l.push(u)}else i(e,h,r)||l.push(u)}return l}var aT=ta?ta.isConcatSpreadable:void 0;function uL(n){return xt(n)||Bh(n)||!!(aT&&n&&n[aT])}function Yh(n,e,t,r,a){var i=-1,s=n.length;for(t||(t=uL),a||(a=[]);++i<s;){var o=n[i];e>0&&t(o)?e>1?Yh(o,e-1,t,r,a):D0(a,o):r||(a[a.length]=o)}return a}var iT=Gl(function(n,e){return Qh(n)?rT(n,Yh(e,1,Qh,!0)):[]});function hL(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:Vf(n,e,t)}function dL(n){return n.split("")}var pL="\\ud800-\\udfff",mL="\\u0300-\\u036f",fL="\\ufe20-\\ufe2f",yL="\\u20d0-\\u20ff",gL=mL+fL+yL,bL="\\ufe0e\\ufe0f",vL="\\u200d",EL=RegExp("["+vL+pL+gL+bL+"]");function ny(n){return EL.test(n)}var sT="\\ud800-\\udfff",wL="\\u0300-\\u036f",TL="\\ufe20-\\ufe2f",NL="\\u20d0-\\u20ff",CL=wL+TL+NL,AL="\\ufe0e\\ufe0f",SL="["+sT+"]",ry="["+CL+"]",ay="\\ud83c[\\udffb-\\udfff]",RL="(?:"+ry+"|"+ay+")",oT="[^"+sT+"]",lT="(?:\\ud83c[\\udde6-\\uddff]){2}",cT="[\\ud800-\\udbff][\\udc00-\\udfff]",ML="\\u200d",uT=RL+"?",hT="["+AL+"]?",OL="(?:"+ML+"(?:"+[oT,lT,cT].join("|")+")"+hT+uT+")*",_L=hT+uT+OL,xL="(?:"+[oT+ry+"?",ry,lT,cT,SL].join("|")+")",PL=RegExp(ay+"(?="+ay+")|"+xL+_L,"g");function IL(n){return n.match(PL)||[]}function DL(n){return ny(n)?IL(n):dL(n)}function LL(n,e,t){e=="__proto__"&&Vh?Vh(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}var qL=Object.prototype,$L=qL.hasOwnProperty;function kL(n,e,t){var r=n[e];(!($L.call(n,e)&&Lh(r,t))||t===void 0&&!(e in n))&&LL(n,e,t)}function dT(n,e,t,r){if(!ra(n))return n;e=Kl(e,n);for(var a=-1,i=e.length,s=i-1,o=n;o!=null&&++a<i;){var l=oo(e[a]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(a!=s){var u=o[l];c=r?r(u,l,o):void 0,c===void 0&&(c=ra(u)?u:Ql(e[a+1])?[]:{})}kL(o,l,c),o=o[l]}return n}function jL(n,e,t){for(var r=-1,a=e.length,i={};++r<a;){var s=e[r],o=Fh(n,s);t(o,s)&&dT(i,Kl(s,n),o)}return i}function BL(n,e){return jL(n,e,function(t,r){return K0(n,r)})}function UL(n){var e=n==null?0:n.length;return e?Yh(n,1):[]}function FL(n){return zf(p0(n,void 0,UL),n+"")}var pT=FL(function(n,e){return n==null?{}:BL(n,e)}),VL=M0(Object.getPrototypeOf,Object),zL="[object Object]",WL=Function.prototype,HL=Object.prototype,mT=WL.toString,KL=HL.hasOwnProperty,QL=mT.call(Object);function iy(n){if(!Fn(n)||na(n)!=zL)return!1;var e=VL(n);if(e===null)return!0;var t=KL.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&mT.call(t)==QL}function Ge(n){return n==null}function GL(n,e){var t=-1,r=Ma(n)?Array(n.length):[];return ho(n,function(a,i,s){r[++t]=e(a,i,s)}),r}function Vn(n,e){var t=xt(n)?jh:GL;return t(n,Zi(e))}var sy={exports:{}},Jh={},fT={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(n){(function(){var e=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:e,canUseWorkers:typeof Worker<"u",canUseEventListeners:e&&!!(window.addEventListener||window.attachEvent),canUseViewport:e&&!!window.screen};n.exports?n.exports=t:window.ExecutionEnvironment=t})()})(fT);var YL=fT.exports;Object.defineProperty(Jh,"__esModule",{value:!0});var yT=YL,JL=ye;function gT(n){return(gT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function nc(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function bT(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function rc(n,e,t){return e&&bT(n.prototype,e),t&&bT(n,t),n}function cr(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XL(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&ET(n,e)}function vT(n){return(vT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(n)}function ET(n,e){return(ET=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(n,e)}function ZL(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function e2(n,e){return!e||typeof e!="object"&&typeof e!="function"?ZL(n):e}var wT=function(){function n(e){nc(this,n),cr(this,"handlers",void 0),this.handlers=e.slice(0)}return rc(n,[{key:"addHandlers",value:function(e){for(var t=this.handlers.slice(0),r=e.length,a=0;a<r;a+=1)t.push(e[a]);return new n(t)}},{key:"dispatchEvent",value:function(e,t){var r=this.handlers.length-1;if(t){for(var a=r;a>=0;a-=1)this.handlers[a].called||(this.handlers[a].called=!0,this.handlers[a](e));for(var i=r;i>=0;i-=1)this.handlers[i].called=!1}else(0,this.handlers[r])(e)}},{key:"hasHandlers",value:function(){return this.handlers.length>0}},{key:"removeHandlers",value:function(e){for(var t=[],r=this.handlers.length,a=0;a<r;a+=1){var i=this.handlers[a];e.indexOf(i)===-1&&t.push(i)}return new n(t)}}]),n}();function TT(n){var e=new Map;return n.forEach(function(t,r){e.set(r,t)}),e}function NT(n){return Array.isArray(n)?n:[n]}var t2=function(n){return n!==null&&gT(n)==="object"&&n.hasOwnProperty("current")};function CT(n){return n==="document"?document:n==="window"?window:t2(n)?n.current||document:n||document}var oy=function(){function n(e,t){nc(this,n),cr(this,"handlerSets",void 0),cr(this,"poolName",void 0),this.handlerSets=t,this.poolName=e}return rc(n,[{key:"addHandlers",value:function(e,t){var r=TT(this.handlerSets);if(r.has(e)){var a=r.get(e);r.set(e,a.addHandlers(t))}else r.set(e,new wT(t));return new n(this.poolName,r)}},{key:"dispatchEvent",value:function(e,t){var r=this.handlerSets.get(e),a=this.poolName==="default";r&&r.dispatchEvent(t,a)}},{key:"hasHandlers",value:function(e){if(!e)return this.handlerSets.size>0;var t=this.handlerSets.get(e);return!!t&&t.hasHandlers()}},{key:"removeHandlers",value:function(e,t){var r=TT(this.handlerSets);if(!r.has(e))return new n(this.poolName,r);var a=r.get(e).removeHandlers(t);return a.hasHandlers()?r.set(e,a):r.delete(e),new n(this.poolName,r)}}]),n}();cr(oy,"createByType",function(n,e,t){var r=new Map;return r.set(e,new wT(t)),new oy(n,r)});var n2=function(){function n(e){var t=this;nc(this,n),cr(this,"handlers",new Map),cr(this,"pools",new Map),cr(this,"target",void 0),cr(this,"createEmitter",function(r){return function(a){t.pools.forEach(function(i){i.dispatchEvent(r,a)})}}),this.target=e}return rc(n,[{key:"addHandlers",value:function(e,t,r){if(this.pools.has(e)){var a=this.pools.get(e);this.pools.set(e,a.addHandlers(t,r))}else this.pools.set(e,oy.createByType(e,t,r));this.handlers.has(t)||this.addTargetHandler(t)}},{key:"hasHandlers",value:function(){return this.handlers.size>0}},{key:"removeHandlers",value:function(e,t,r){if(this.pools.has(e)){var a=this.pools.get(e).removeHandlers(t,r);a.hasHandlers()?this.pools.set(e,a):this.pools.delete(e);var i=!1;this.pools.forEach(function(s){return i=i||s.hasHandlers(t)}),i||this.removeTargetHandler(t)}}},{key:"addTargetHandler",value:function(e){var t=this.createEmitter(e);this.handlers.set(e,t),this.target.addEventListener(e,t,!0)}},{key:"removeTargetHandler",value:function(e){this.handlers.has(e)&&(this.target.removeEventListener(e,this.handlers.get(e),!0),this.handlers.delete(e))}}]),n}(),r2=function(){function n(){var e=this;nc(this,n),cr(this,"targets",new Map),cr(this,"getTarget",function(t){var r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=CT(t);if(e.targets.has(a))return e.targets.get(a);if(!r)return null;var i=new n2(a);return e.targets.set(a,i),i}),cr(this,"removeTarget",function(t){e.targets.delete(CT(t))})}return rc(n,[{key:"sub",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(yT.canUseDOM){var a=r.target,i=a===void 0?document:a,s=r.pool,o=s===void 0?"default":s;this.getTarget(i).addHandlers(o,e,NT(t))}}},{key:"unsub",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(yT.canUseDOM){var a=r.target,i=a===void 0?document:a,s=r.pool,o=s===void 0?"default":s,l=this.getTarget(i,!1);l&&(l.removeHandlers(o,e,NT(t)),l.hasHandlers()||this.removeTarget(i))}}}]),n}(),ly=new r2,cy=function(n){function e(){return nc(this,e),e2(this,vT(e).apply(this,arguments))}return XL(e,JL.PureComponent),rc(e,[{key:"componentDidMount",value:function(){this.subscribe(this.props)}},{key:"componentDidUpdate",value:function(t){this.unsubscribe(t),this.subscribe(this.props)}},{key:"componentWillUnmount",value:function(){this.unsubscribe(this.props)}},{key:"subscribe",value:function(t){var r=t.name,a=t.on,i=t.pool,s=t.target;ly.sub(r,a,{pool:i,target:s})}},{key:"unsubscribe",value:function(t){var r=t.name,a=t.on,i=t.pool,s=t.target;ly.unsub(r,a,{pool:i,target:s})}},{key:"render",value:function(){return null}}]),e}();cr(cy,"defaultProps",{pool:"default",target:"document"}),cy.propTypes={},Jh.instance=ly,Jh.default=cy;var uy;uy=Jh,sy.exports=uy.default;var Ir=sy.exports.instance=uy.instance,a2=sy.exports;const _a=Mi(a2);function hy(){}var i2=1/0,s2=mo&&1/Gf(new mo([,-0]))[1]==i2?function(n){return new mo(n)}:hy,o2=200;function AT(n,e,t){var r=-1,a=Zf,i=n.length,s=!0,o=[],l=o;if(t)s=!1,a=X0;else if(i>=o2){var c=e?null:s2(n);if(c)return Gf(c);s=!1,a=Qf,l=new po}else l=e?[]:o;e:for(;++r<i;){var u=n[r],h=e?e(u):u;if(u=t||u!==0?u:0,s&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue e;e&&l.push(h),o.push(u)}else a(l,h,t)||(l!==o&&l.push(h),o.push(u))}return o}function l2(n){return n&&n.length?AT(n):[]}var c2="[object Number]";function u2(n){return typeof n=="number"||Fn(n)&&na(n)==c2}var h2="[object String]";function dy(n){return typeof n=="string"||!xt(n)&&Fn(n)&&na(n)==h2}var d2="[object Boolean]";function p2(n){return n===!0||n===!1||Fn(n)&&na(n)==d2}function ST(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(t=ST(n[e]))&&(r&&(r+=" "),r+=t);else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function Re(){for(var n,e,t=0,r="";t<arguments.length;)(n=arguments[t++])&&(e=ST(n))&&(r&&(r+=" "),r+=e);return r}function py(n,e,t,r){if(r===void 0&&(r={}),typeof n!="function"&&typeof n!="string")throw new Error("createShorthand() Component must be a string or function.");if(Ge(t)||p2(t))return null;var a=dy(t),i=u2(t),s=so(t),o=ye.isValidElement(t),l=iy(t),c=a||i||xt(t);if(!s&&!o&&!l&&!c)return null;var u=r,h=u.defaultProps,d=h===void 0?{}:h,f=o&&t.props||l&&t||c&&e(t),g=r,v=g.overrideProps,C=v===void 0?{}:v;C=so(C)?C(Z({},d,f)):C;var w=Z({},d,f,C);if(d.className||C.className||f.className){var T=Re(d.className,C.className,f.className);w.className=l2(T.split(" ")).join(" ")}if((d.style||C.style||f.style)&&(w.style=Z({},d.style,f.style,C.style)),Ge(w.key)){var S=w.childKey,O=r,k=O.autoGenerateKey,B=k===void 0?!0:k;Ge(S)?B&&(a||i)&&(w.key=t):(w.key=typeof S=="function"?S(w):S,delete w.childKey)}if(o)return ye.cloneElement(t,w);if(typeof w.children=="function")return w.children(n,Z({},w,{children:void 0}));if(c||l)return ye.createElement(n,w);if(s)return t(n,w,w.children)}function at(n,e){if(typeof n!="function"&&typeof n!="string")throw new Error("createShorthandFactory() Component must be a string or function.");return function(t,r){return py(n,e,t,r)}}var m2=at("div",function(n){return{children:n}}),f2=at("img",function(n){return{src:n}}),y2=at("input",function(n){return{type:n}}),g2=at("label",function(n){return{children:n}}),b2=function(n,e){var t=n.handledProps,r=t===void 0?[]:t;return Object.keys(e).reduce(function(a,i){return i==="childKey"||r.indexOf(i)===-1&&(a[i]=e[i]),a},{})};const De=b2;function $e(n,e,t){var r=n.defaultProps,a=r===void 0?{}:r;if(e.as&&e.as!==a.as)return e.as;if(t){var i=t();if(i)return i}return e.href?"a":a.as||"div"}function v2(n,e){return jh(e,function(t){return n[t]})}function E2(n){return n==null?[]:v2(n,uo(n))}var w2=Math.max;function xa(n,e,t,r){n=Ma(n)?n:E2(n),t=t&&!r?Jl(t):0;var a=n.length;return t<0&&(t=w2(a+t,0)),dy(n)?t<=a&&n.indexOf(e,t)>-1:!!a&&J0(n,e,t)>-1}var my=["selected","defaultValue","defaultChecked","accept","autoCapitalize","autoComplete","autoCorrect","autoFocus","checked","disabled","enterKeyHint","form","id","inputMode","lang","list","max","maxLength","min","minLength","multiple","name","pattern","placeholder","readOnly","required","step","title","type","value"],T2=["onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onClick","onContextMenu","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],N2=[].concat(my,T2),C2=["alt","height","src","srcSet","width","loading"],Xh=function(n,e){e===void 0&&(e={});var t=e,r=t.htmlProps,a=r===void 0?N2:r,i=t.includeAria,s=i===void 0?!0:i,o={},l={};return eT(n,function(c,u){var h=s&&(/^aria-.*$/.test(u)||u==="role"),d=xa(a,u)||h?o:l;d[u]=c}),[o,l]},A2=typeof document=="object"&&document!==null,S2=typeof window=="object"&&window!==null&&window.self===window,Zh=function n(){return Ge(n.override)?A2&&S2:n.override},R2=Math.max,M2=Math.min;function O2(n,e,t){return n>=M2(e,t)&&n<R2(e,t)}function fy(n,e,t){return e=co(e),t===void 0?(t=e,e=0):t=co(t),n=g0(n),O2(n,e,t)}function _2(n){return n&&n.length?n[0]:void 0}var x2=function(n,e){if(tc([e,n],Ge))return!1;if(e.target&&(be(e.target,"setAttribute","data-suir-click-target",!0),document.querySelector("[data-suir-click-target=true]")))return be(e.target,"removeAttribute","data-suir-click-target"),n.contains(e.target);var t=e.clientX,r=e.clientY;if(tc([t,r],Ge))return!1;var a=n.getClientRects();if(!n.offsetWidth||!n.offsetHeight||!a||!a.length)return!1;var i=_2(a),s=i.top,o=i.bottom,l=i.left,c=i.right;return tc([s,o,l,c],Ge)?!1:fy(r,s,o+.001)&&fy(t,l,c+.001)};const ac=x2;var RT=function(n){return{active:!1,type:"ellipsisItem",value:n}},P2=function(){return{active:!1,type:"firstItem",value:1}},I2=function(n){return{active:!1,type:"prevItem",value:Math.max(1,n-1)}},D2=function(n){return function(e){return{active:n===e,type:"pageItem",value:e}}},L2=function(n,e){return{active:!1,type:"nextItem",value:Math.min(n+1,e)}},q2=function(n){return{active:!1,type:"lastItem",value:n}},$2=Math.ceil,k2=Math.max;function j2(n,e,t,r){for(var a=-1,i=k2($2((e-n)/(t||1)),0),s=Array(i);i--;)s[r?i:++a]=n,n+=t;return s}function B2(n){return function(e,t,r){return r&&typeof r!="number"&&ty(e,t,r)&&(t=r=void 0),e=co(e),t===void 0?(t=e,e=0):t=co(t),r=r===void 0?e<t?1:-1:co(r),j2(e,t,r,n)}}var U2=B2(),F2=function(n,e,t){var r=e-1,a=r!==n+1,i=a?RT:t;return i(r)},V2=function(n,e,t){var r=n+1,a=r!==e-1,i=a?RT:t;return i(r)},ed=function(n,e,t){return Vn(U2(n,e+1),t)},z2=function(n,e){var t=n.activePage,r=n.boundaryRange,a=n.hideEllipsis,i=n.siblingRange,s=n.totalPages,o=a?0:1,l=r,c=ed(1,l,e),u=s+1-r,h=ed(u,s,e),d=Math.min(Math.max(t-i,l+o+1),u-o-2*i-1),f=d+2*i,g=ed(d,f,e);return[].concat(c,[!a&&F2(l,d,e)],g,[!a&&V2(f,u,e)],h).filter(Boolean)},W2=function(n){var e=n.boundaryRange,t=n.hideEllipsis,r=n.siblingRange,a=n.totalPages,i=2*e,s=t?0:2,o=2*r;return 1+s+o+i>=a},H2=function(n){var e=n.activePage,t=n.boundaryRange,r=n.hideEllipsis,a=n.siblingRange,i=n.totalPages;return{activePage:+e,boundaryRange:+t,hideEllipsis:!!r,siblingRange:+a,totalPages:+i}},K2=function(n){var e=H2(n),t=e.activePage,r=e.totalPages,a=D2(t),i=W2(e)?ed(1,r,a):z2(e,a);return[P2(),I2(t)].concat(i,[L2(t,r),q2(r)])};function Q2(n,e){return Kh(n,e)}var MT=Object.create,yy=function(){function n(){}return function(e){if(!ra(e))return{};if(MT)return MT(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),G2=Gl(function(n,e){return Qh(n)?rT(n,e):[]});const Y2=G2;function yo(n){var e=n.children,t=n.className,r=n.content,a=n.size,i=Re(a,"icons",t),s=De(yo,n),o=$e(yo,n);return Y.createElement(o,Z({},s,{className:i}),Fe(e)?r:e)}yo.handledProps=["as","children","className","content","size"],yo.propTypes={},yo.defaultProps={as:"i"};var $t=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleClick=function(o){var l=r.props.disabled;if(l){o.preventDefault();return}be(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.getIconAriaOptions=function(){var r={},a=this.props,i=a["aria-label"],s=a["aria-hidden"];return Ge(i)?r["aria-hidden"]="true":r["aria-label"]=i,Ge(s)||(r["aria-hidden"]=s),r},t.render=function(){var r=this.props,a=r.bordered,i=r.circular,s=r.className,o=r.color,l=r.corner,c=r.disabled,u=r.fitted,h=r.flipped,d=r.inverted,f=r.link,g=r.loading,v=r.name,C=r.rotated,w=r.size,T=Re(o,v,w,U(a,"bordered"),U(i,"circular"),U(c,"disabled"),U(u,"fitted"),U(d,"inverted"),U(f,"link"),U(g,"loading"),gt(l,"corner"),hn(h,"flipped"),hn(C,"rotated"),"icon",s),S=De(e,this.props),O=$e(e,this.props),k=this.getIconAriaOptions();return Y.createElement(O,Z({},S,k,{className:T,onClick:this.handleClick}))},e}(ye.PureComponent);$t.handledProps=["aria-hidden","aria-label","as","bordered","circular","className","color","corner","disabled","fitted","flipped","inverted","link","loading","name","rotated","size"],$t.propTypes={},$t.defaultProps={as:"i"},$t.Group=yo,$t.create=at($t,function(n){return{name:n}});for(var OT=function(n){return n!==null&&!Array.isArray(n)&&typeof n=="object"},td={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"},nd=0;nd<24;nd+=1)td[112+nd]="F"+(nd+1);for(var gy=0;gy<26;gy+=1){var by=gy+65;td[by]=[String.fromCharCode(by+32),String.fromCharCode(by)]}var he={codes:td,getCode:function(n){return OT(n)?n.keyCode||n.which||this[n.key]:this[n]},getKey:function(n){var e=OT(n);if(e&&n.key)return n.key;var t=td[e?n.keyCode||n.which:n];return Array.isArray(t)&&(e?t=t[n.shiftKey?1:0]:t=t[0]),t},Cancel:3,Help:6,Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Convert:28,NonConvert:29,Accept:30,ModeChange:31," ":32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Select:41,Print:42,Execute:43,PrintScreen:44,Insert:45,Delete:46,0:48,")":48,1:49,"!":49,2:50,"@":50,3:51,"#":51,4:52,$:52,5:53,"%":53,6:54,"^":54,7:55,"&":55,8:56,"*":56,9:57,"(":57,a:65,A:65,b:66,B:66,c:67,C:67,d:68,D:68,e:69,E:69,f:70,F:70,g:71,G:71,h:72,H:72,i:73,I:73,j:74,J:74,k:75,K:75,l:76,L:76,m:77,M:77,n:78,N:78,o:79,O:79,p:80,P:80,q:81,Q:81,r:82,R:82,s:83,S:83,t:84,T:84,u:85,U:85,v:86,V:86,w:87,W:87,x:88,X:88,y:89,Y:89,z:90,Z:90,OS:91,ContextMenu:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,F20:131,F21:132,F22:133,F23:134,F24:135,NumLock:144,ScrollLock:145,VolumeMute:181,VolumeDown:182,VolumeUp:183,";":186,":":186,"=":187,"+":187,",":188,"<":188,"-":189,_:189,".":190,">":190,"/":191,"?":191,"`":192,"~":192,"[":219,"{":219,"\\":220,"|":220,"]":221,"}":221,"'":222,'"':222,Meta:224,AltGraph:225,Attn:246,CrSel:247,ExSel:248,EraseEof:249,Play:250,ZoomOut:251};he.Spacebar=he[" "],he.Digit0=he[0],he.Digit1=he[1],he.Digit2=he[2],he.Digit3=he[3],he.Digit4=he[4],he.Digit5=he[5],he.Digit6=he[6],he.Digit7=he[7],he.Digit8=he[8],he.Digit9=he[9],he.Tilde=he["~"],he.GraveAccent=he["`"],he.ExclamationPoint=he["!"],he.AtSign=he["@"],he.PoundSign=he["#"],he.PercentSign=he["%"],he.Caret=he["^"],he.Ampersand=he["&"],he.PlusSign=he["+"],he.MinusSign=he["-"],he.EqualsSign=he["="],he.DivisionSign=he["/"],he.MultiplicationSign=he["*"],he.Comma=he[","],he.Decimal=he["."],he.Colon=he[":"],he.Semicolon=he[";"],he.Pipe=he["|"],he.BackSlash=he["\\"],he.QuestionMark=he["?"],he.SingleQuote=he["'"],he.DoubleQuote=he['"'],he.LeftCurlyBrace=he["{"],he.RightCurlyBrace=he["}"],he.LeftParenthesis=he["("],he.RightParenthesis=he[")"],he.LeftAngleBracket=he["<"],he.RightAngleBracket=he[">"],he.LeftSquareBracket=he["["],he.RightSquareBracket=he["]"];var J2=he;const it=Mi(J2);var vy=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleRef=function(o){ea(r.props.innerRef,o)},r}var t=e.prototype;return t.componentDidMount=function(){be(this.props,"onMount",null,this.props)},t.componentWillUnmount=function(){be(this.props,"onUnmount",null,this.props)},t.render=function(){if(!Zh())return null;var r=this.props,a=r.children,i=r.mountNode,s=i===void 0?document.body:i;return Rl.createPortal(Y.createElement(Aa,{innerRef:this.handleRef},a),s)},e}(ye.Component);vy.handledProps=["children","innerRef","mountNode","onMount","onUnmount"],vy.propTypes={};const _T=vy;var go=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.contentRef=Y.createRef(),r.triggerRef=Y.createRef(),r.latestDocumentMouseDownEvent=null,r.handleDocumentMouseDown=function(o){r.latestDocumentMouseDownEvent=o},r.handleDocumentClick=function(o){var l=r.props.closeOnDocumentClick,c=r.latestDocumentMouseDownEvent;r.latestDocumentMouseDownEvent=null,!(!r.contentRef.current||ac(r.triggerRef.current,o)||c&&ac(r.contentRef.current,c)||ac(r.contentRef.current,o))&&l&&r.close(o)},r.handleEscape=function(o){r.props.closeOnEscape&&it.getCode(o)===it.Escape&&r.close(o)},r.handlePortalMouseLeave=function(o){var l=r.props,c=l.closeOnPortalMouseLeave,u=l.mouseLeaveDelay;c&&o.target===r.contentRef.current&&(r.mouseLeaveTimer=r.closeWithTimeout(o,u))},r.handlePortalMouseEnter=function(){var o=r.props.closeOnPortalMouseLeave;o&&clearTimeout(r.mouseLeaveTimer)},r.handleTriggerBlur=function(o){for(var l=r.props,c=l.trigger,u=l.closeOnTriggerBlur,h=arguments.length,d=new Array(h>1?h-1:0),f=1;f<h;f++)d[f-1]=arguments[f];be.apply(void 0,[c,"props.onBlur",o].concat(d));var g=o.relatedTarget||document.activeElement,v=be(r.contentRef.current,"contains",g);!u||v||r.close(o)},r.handleTriggerClick=function(o){for(var l=r.props,c=l.trigger,u=l.closeOnTriggerClick,h=l.openOnTriggerClick,d=r.state.open,f=arguments.length,g=new Array(f>1?f-1:0),v=1;v<f;v++)g[v-1]=arguments[v];be.apply(void 0,[c,"props.onClick",o].concat(g)),d&&u?r.close(o):!d&&h&&r.open(o)},r.handleTriggerFocus=function(o){for(var l=r.props,c=l.trigger,u=l.openOnTriggerFocus,h=arguments.length,d=new Array(h>1?h-1:0),f=1;f<h;f++)d[f-1]=arguments[f];be.apply(void 0,[c,"props.onFocus",o].concat(d)),u&&r.open(o)},r.handleTriggerMouseLeave=function(o){clearTimeout(r.mouseEnterTimer);for(var l=r.props,c=l.trigger,u=l.closeOnTriggerMouseLeave,h=l.mouseLeaveDelay,d=arguments.length,f=new Array(d>1?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];be.apply(void 0,[c,"props.onMouseLeave",o].concat(f)),u&&(r.mouseLeaveTimer=r.closeWithTimeout(o,h))},r.handleTriggerMouseEnter=function(o){clearTimeout(r.mouseLeaveTimer);for(var l=r.props,c=l.trigger,u=l.mouseEnterDelay,h=l.openOnTriggerMouseEnter,d=arguments.length,f=new Array(d>1?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];be.apply(void 0,[c,"props.onMouseEnter",o].concat(f)),h&&(r.mouseEnterTimer=r.openWithTimeout(o,u))},r.open=function(o){be(r.props,"onOpen",o,Z({},r.props,{open:!0})),r.setState({open:!0})},r.openWithTimeout=function(o,l){var c=Z({},o);return setTimeout(function(){return r.open(c)},l||0)},r.close=function(o){r.setState({open:!1}),be(r.props,"onClose",o,Z({},r.props,{open:!1}))},r.closeWithTimeout=function(o,l){var c=Z({},o);return setTimeout(function(){return r.close(c)},l||0)},r.handleMount=function(){be(r.props,"onMount",null,r.props)},r.handleUnmount=function(){be(r.props,"onUnmount",null,r.props)},r.handleTriggerRef=function(o){r.triggerRef.current=o,ea(r.props.triggerRef,o)},r}var t=e.prototype;return t.componentWillUnmount=function(){clearTimeout(this.mouseEnterTimer),clearTimeout(this.mouseLeaveTimer)},t.render=function(){var r=this.props,a=r.children,i=r.eventPool,s=r.mountNode,o=r.trigger,l=this.state.open;return Y.createElement(Y.Fragment,null,l&&Y.createElement(Y.Fragment,null,Y.createElement(_T,{innerRef:this.contentRef,mountNode:s,onMount:this.handleMount,onUnmount:this.handleUnmount},a),Y.createElement(_a,{name:"mouseleave",on:this.handlePortalMouseLeave,pool:i,target:this.contentRef}),Y.createElement(_a,{name:"mouseenter",on:this.handlePortalMouseEnter,pool:i,target:this.contentRef}),Y.createElement(_a,{name:"mousedown",on:this.handleDocumentMouseDown,pool:i}),Y.createElement(_a,{name:"click",on:this.handleDocumentClick,pool:i}),Y.createElement(_a,{name:"keydown",on:this.handleEscape,pool:i})),o&&Y.createElement(Aa,{innerRef:this.handleTriggerRef},Y.cloneElement(o,{onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onMouseLeave:this.handleTriggerMouseLeave,onMouseEnter:this.handleTriggerMouseEnter})))},e}(fo);go.handledProps=["children","closeOnDocumentClick","closeOnEscape","closeOnPortalMouseLeave","closeOnTriggerBlur","closeOnTriggerClick","closeOnTriggerMouseLeave","defaultOpen","eventPool","mountNode","mouseEnterDelay","mouseLeaveDelay","onClose","onMount","onOpen","onUnmount","open","openOnTriggerClick","openOnTriggerFocus","openOnTriggerMouseEnter","trigger","triggerRef"],go.propTypes={},go.defaultProps={closeOnDocumentClick:!0,closeOnEscape:!0,eventPool:"default",openOnTriggerClick:!0},go.autoControlledProps=["open"],go.Inner=_T;const rd=go;function ic(n){var e=n.blurring,t=n.className,r=n.children,a=n.content,i=n.dimmed,s=Re(U(e,"blurring"),U(i,"dimmed"),"dimmable",t),o=De(ic,n),l=$e(ic,n);return Y.createElement(l,Z({},o,{className:s}),Fe(r)?a:r)}ic.handledProps=["as","blurring","children","className","content","dimmed"],ic.propTypes={};var sc=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.containerRef=ye.createRef(),r.contentRef=ye.createRef(),r.handleClick=function(o){var l=r.contentRef.current;be(r.props,"onClick",o,r.props),!(l&&l!==o.target&&ac(l,o))&&be(r.props,"onClickOutside",o,r.props)},r}var t=e.prototype;return t.componentDidMount=function(){var r=this.props.active;this.toggleStyles(r)},t.componentDidUpdate=function(r){var a=this.props.active,i=r.active;i!==a&&this.toggleStyles(a)},t.toggleStyles=function(r){var a=this.containerRef.current;!a||!a.style||(r?a.style.setProperty("display","flex","important"):a.style.removeProperty("display"))},t.render=function(){var r=this.props,a=r.active,i=r.children,s=r.className,o=r.content,l=r.disabled,c=r.inverted,u=r.page,h=r.simple,d=r.verticalAlign,f=Re("ui",U(a,"active transition visible"),U(l,"disabled"),U(c,"inverted"),U(u,"page"),U(h,"simple"),di(d),"dimmer",s),g=De(e,this.props),v=$e(e,this.props),C=Fe(i)?o:i;return Y.createElement(Aa,{innerRef:this.containerRef},Y.createElement(v,Z({},g,{className:f,onClick:this.handleClick}),C&&Y.createElement("div",{className:"content",ref:this.contentRef},C)))},e}(ye.Component);sc.handledProps=["active","as","children","className","content","disabled","inverted","onClick","onClickOutside","page","simple","verticalAlign"],sc.propTypes={};var ts=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handlePortalMount=function(){Zh()&&(document.body.classList.add("dimmed"),document.body.classList.add("dimmable"))},r.handlePortalUnmount=function(){Zh()&&(document.body.classList.remove("dimmed"),document.body.classList.remove("dimmable"))},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.page,s=De(e,this.props);return i?Y.createElement(rd,{closeOnEscape:!1,closeOnDocumentClick:!1,onMount:this.handlePortalMount,onUnmount:this.handlePortalUnmount,open:a,openOnTriggerClick:!1},Y.createElement(sc,Z({},s,{active:a,page:i}))):Y.createElement(sc,Z({},s,{active:a,page:i}))},e}(ye.Component);ts.handledProps=["active","page"],ts.propTypes={},ts.Dimmable=ic,ts.Inner=sc,ts.create=at(ts,function(n){return{content:n}});function oc(n){var e=n.children,t=n.className,r=n.content,a=n.size,i=Re("ui",a,t,"images"),s=De(oc,n),o=$e(oc,n);return Y.createElement(o,Z({},s,{className:i}),Fe(e)?r:e)}oc.handledProps=["as","children","className","content","size"],oc.propTypes={};function ur(n){var e=n.avatar,t=n.bordered,r=n.centered,a=n.children,i=n.circular,s=n.className,o=n.content,l=n.dimmer,c=n.disabled,u=n.floated,h=n.fluid,d=n.hidden,f=n.href,g=n.inline,v=n.label,C=n.rounded,w=n.size,T=n.spaced,S=n.verticalAlign,O=n.wrapped,k=n.ui,B=Re(U(k,"ui"),w,U(e,"avatar"),U(t,"bordered"),U(i,"circular"),U(r,"centered"),U(c,"disabled"),U(h,"fluid"),U(d,"hidden"),U(g,"inline"),U(C,"rounded"),gt(T,"spaced"),hn(u,"floated"),di(S),"image",s),D=De(ur,n),V=Xh(D,{htmlProps:C2}),q=V[0],K=V[1],I=$e(ur,n,function(){if(!Ge(l)||!Ge(v)||!Ge(O)||!Fe(a))return"div"});return Fe(a)?Fe(o)?I==="img"?Y.createElement(I,Z({},K,q,{className:B})):Y.createElement(I,Z({},K,{className:B,href:f}),ts.create(l,{autoGenerateKey:!1}),hr.create(v,{autoGenerateKey:!1}),Y.createElement("img",q)):Y.createElement(I,Z({},D,{className:B}),o):Y.createElement(I,Z({},D,{className:B}),a)}ur.handledProps=["as","avatar","bordered","centered","children","circular","className","content","dimmer","disabled","floated","fluid","hidden","href","inline","label","rounded","size","spaced","ui","verticalAlign","wrapped"],ur.Group=oc,ur.propTypes={},ur.defaultProps={as:"img",ui:!0},ur.create=at(ur,function(n){return{src:n}});function pi(n){var e=n.children,t=n.className,r=n.content,a=Re("detail",t),i=De(pi,n),s=$e(pi,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}pi.handledProps=["as","children","className","content"],pi.propTypes={},pi.create=at(pi,function(n){return{content:n}});function lc(n){var e=n.children,t=n.circular,r=n.className,a=n.color,i=n.content,s=n.size,o=n.tag,l=Re("ui",a,s,U(t,"circular"),U(o,"tag"),"labels",r),c=De(lc,n),u=$e(lc,n);return Y.createElement(u,Z({},c,{className:l}),Fe(e)?i:e)}lc.handledProps=["as","children","circular","className","color","content","size","tag"],lc.propTypes={};var hr=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleClick=function(o){var l=r.props.onClick;l&&l(o,r.props)},r.handleIconOverrides=function(o){return{onClick:function(l){be(o,"onClick",l),be(r.props,"onRemove",l,r.props)}}},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.attached,s=r.basic,o=r.children,l=r.circular,c=r.className,u=r.color,h=r.content,d=r.corner,f=r.detail,g=r.empty,v=r.floating,C=r.horizontal,w=r.icon,T=r.image,S=r.onRemove,O=r.pointing,k=r.prompt,B=r.removeIcon,D=r.ribbon,V=r.size,q=r.tag,K=O===!0&&"pointing"||(O==="left"||O==="right")&&O+" pointing"||(O==="above"||O==="below")&&"pointing "+O,I=Re("ui",u,K,V,U(a,"active"),U(s,"basic"),U(l,"circular"),U(g,"empty"),U(v,"floating"),U(C,"horizontal"),U(T===!0,"image"),U(k,"prompt"),U(q,"tag"),gt(d,"corner"),gt(D,"ribbon"),hn(i,"attached"),"label",c),G=De(e,this.props),H=$e(e,this.props);if(!Fe(o))return Y.createElement(H,Z({},G,{className:I,onClick:this.handleClick}),o);var se=Yl(B)?"delete":B;return Y.createElement(H,Z({className:I,onClick:this.handleClick},G),$t.create(w,{autoGenerateKey:!1}),typeof T!="boolean"&&ur.create(T,{autoGenerateKey:!1}),h,pi.create(f,{autoGenerateKey:!1}),S&&$t.create(se,{autoGenerateKey:!1,overrideProps:this.handleIconOverrides}))},e}(ye.Component);hr.handledProps=["active","as","attached","basic","children","circular","className","color","content","corner","detail","empty","floating","horizontal","icon","image","onClick","onRemove","pointing","prompt","removeIcon","ribbon","size","tag"],hr.propTypes={},hr.Detail=pi,hr.Group=lc,hr.create=at(hr,function(n){return{content:n}});function cc(n){var e=n.children,t=n.className,r=n.content,a=n.hidden,i=n.visible,s=Re(U(i,"visible"),U(a,"hidden"),"content",t),o=De(cc,n),l=$e(cc,n);return Y.createElement(l,Z({},o,{className:s}),Fe(e)?r:e)}cc.handledProps=["as","children","className","content","hidden","visible"],cc.propTypes={};function uc(n){var e=n.attached,t=n.basic,r=n.buttons,a=n.children,i=n.className,s=n.color,o=n.compact,l=n.content,c=n.floated,u=n.fluid,h=n.icon,d=n.inverted,f=n.labeled,g=n.negative,v=n.positive,C=n.primary,w=n.secondary,T=n.size,S=n.toggle,O=n.vertical,k=n.widths,B=Re("ui",s,T,U(t,"basic"),U(o,"compact"),U(u,"fluid"),U(h,"icon"),U(d,"inverted"),U(f,"labeled"),U(g,"negative"),U(v,"positive"),U(C,"primary"),U(w,"secondary"),U(S,"toggle"),U(O,"vertical"),gt(e,"attached"),hn(c,"floated"),lr(k),"buttons",i),D=De(uc,n),V=$e(uc,n);return Ge(r)?Y.createElement(V,Z({},D,{className:B}),Fe(a)?l:a):Y.createElement(V,Z({},D,{className:B}),Vn(r,function(q){return aa.create(q)}))}uc.handledProps=["as","attached","basic","buttons","children","className","color","compact","content","floated","fluid","icon","inverted","labeled","negative","positive","primary","secondary","size","toggle","vertical","widths"],uc.propTypes={};function hc(n){var e=n.className,t=n.text,r=Re("or",e),a=De(hc,n),i=$e(hc,n);return Y.createElement(i,Z({},a,{className:r,"data-text":t}))}hc.handledProps=["as","className","text"],hc.propTypes={};var aa=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.ref=ye.createRef(),r.computeElementType=function(){var o=r.props,l=o.attached,c=o.label;if(!Ge(l)||!Ge(c))return"div"},r.computeTabIndex=function(o){var l=r.props,c=l.disabled,u=l.tabIndex;if(!Ge(u))return u;if(c)return-1;if(o==="div")return 0},r.focus=function(o){return be(r.ref.current,"focus",o)},r.handleClick=function(o){var l=r.props.disabled;if(l){o.preventDefault();return}be(r.props,"onClick",o,r.props)},r.hasIconClass=function(){var o=r.props,l=o.labelPosition,c=o.children,u=o.content,h=o.icon;return h===!0?!0:h&&(l||Fe(c)&&Ge(u))},r}var t=e.prototype;return t.computeButtonAriaRole=function(r){var a=this.props.role;if(!Ge(a))return a;if(r!=="button")return"button"},t.render=function(){var r=this.props,a=r.active,i=r.animated,s=r.attached,o=r.basic,l=r.children,c=r.circular,u=r.className,h=r.color,d=r.compact,f=r.content,g=r.disabled,v=r.floated,C=r.fluid,w=r.icon,T=r.inverted,S=r.label,O=r.labelPosition,k=r.loading,B=r.negative,D=r.positive,V=r.primary,q=r.secondary,K=r.size,I=r.toggle,G=r.type,H=Re(h,K,U(a,"active"),U(o,"basic"),U(c,"circular"),U(d,"compact"),U(C,"fluid"),U(this.hasIconClass(),"icon"),U(T,"inverted"),U(k,"loading"),U(B,"negative"),U(D,"positive"),U(V,"primary"),U(q,"secondary"),U(I,"toggle"),gt(i,"animated"),gt(s,"attached")),se=Re(gt(O||!!S,"labeled")),re=Re(U(g,"disabled"),hn(v,"floated")),ue=De(e,this.props),Se=$e(e,this.props,this.computeElementType),ie=this.computeTabIndex(Se);if(!Ge(S)){var fe=Re("ui",H,"button",u),Me=Re("ui",se,"button",u,re),ge=hr.create(S,{defaultProps:{basic:!0,pointing:O==="left"?"right":"left"},autoGenerateKey:!1});return Y.createElement(Se,Z({},ue,{className:Me,onClick:this.handleClick}),O==="left"&&ge,Y.createElement(Aa,{innerRef:this.ref},Y.createElement("button",{className:fe,"aria-pressed":I?!!a:void 0,disabled:g,type:G,tabIndex:ie},$t.create(w,{autoGenerateKey:!1})," ",f)),(O==="right"||!O)&&ge)}var ne=Re("ui",H,re,se,"button",u),Ye=!Fe(l),xe=this.computeButtonAriaRole(Se);return Y.createElement(Aa,{innerRef:this.ref},Y.createElement(Se,Z({},ue,{className:ne,"aria-pressed":I?!!a:void 0,disabled:g&&Se==="button"||void 0,onClick:this.handleClick,role:xe,type:G,tabIndex:ie}),Ye&&l,!Ye&&$t.create(w,{autoGenerateKey:!1}),!Ye&&f))},e}(ye.Component);aa.handledProps=["active","animated","as","attached","basic","children","circular","className","color","compact","content","disabled","floated","fluid","icon","inverted","label","labelPosition","loading","negative","onClick","positive","primary","role","secondary","size","tabIndex","toggle","type"],aa.propTypes={},aa.defaultProps={as:"button"},aa.Content=cc,aa.Group=uc,aa.Or=hc,aa.create=at(aa,function(n){return{content:n}});function xT(n,e,t,r){var a=-1,i=n==null?0:n.length;for(r&&i&&(t=n[++a]);++a<i;)t=e(t,n[a],a,n);return t}function X2(n,e,t,r,a){return a(n,function(i,s,o){t=r?(r=!1,i):e(t,i,s,o)}),t}function Ey(n,e,t){var r=xt(n)?xT:X2,a=arguments.length<3;return r(n,Zi(e),t,a,ho)}var Z2=function(n,e,t,r){var a=t?t.call(r,n,e):void 0;if(a!==void 0)return!!a;if(n===e)return!0;if(typeof n!="object"||!n||typeof e!="object"||!e)return!1;var i=Object.keys(n),s=Object.keys(e);if(i.length!==s.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(e),l=0;l<i.length;l++){var c=i[l];if(!o(c))return!1;var u=n[c],h=e[c];if(a=t?t.call(r,u,h,c):void 0,a===!1||a===void 0&&u!==h)return!1}return!0};const ns=Mi(Z2);function dc(n){var e=n.children,t=n.className,r=n.content,a=Re("header",t),i=De(dc,n),s=$e(dc,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}dc.handledProps=["as","children","className","content"],dc.propTypes={};function eq(n){return function(e){return n==null?void 0:n[e]}}var tq={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},nq=eq(tq);const rq=nq;var aq=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,iq="\\u0300-\\u036f",sq="\\ufe20-\\ufe2f",oq="\\u20d0-\\u20ff",lq=iq+sq+oq,cq="["+lq+"]",uq=RegExp(cq,"g");function wy(n){return n=Hl(n),n&&n.replace(aq,rq).replace(uq,"")}var hq=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function dq(n){return n.match(hq)||[]}var pq=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function mq(n){return pq.test(n)}var PT="\\ud800-\\udfff",fq="\\u0300-\\u036f",yq="\\ufe20-\\ufe2f",gq="\\u20d0-\\u20ff",bq=fq+yq+gq,IT="\\u2700-\\u27bf",DT="a-z\\xdf-\\xf6\\xf8-\\xff",vq="\\xac\\xb1\\xd7\\xf7",Eq="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wq="\\u2000-\\u206f",Tq=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",LT="A-Z\\xc0-\\xd6\\xd8-\\xde",Nq="\\ufe0e\\ufe0f",qT=vq+Eq+wq+Tq,$T="['\u2019]",kT="["+qT+"]",Cq="["+bq+"]",jT="\\d+",Aq="["+IT+"]",BT="["+DT+"]",UT="[^"+PT+qT+jT+IT+DT+LT+"]",Sq="\\ud83c[\\udffb-\\udfff]",Rq="(?:"+Cq+"|"+Sq+")",Mq="[^"+PT+"]",FT="(?:\\ud83c[\\udde6-\\uddff]){2}",VT="[\\ud800-\\udbff][\\udc00-\\udfff]",bo="["+LT+"]",Oq="\\u200d",zT="(?:"+BT+"|"+UT+")",_q="(?:"+bo+"|"+UT+")",WT="(?:"+$T+"(?:d|ll|m|re|s|t|ve))?",HT="(?:"+$T+"(?:D|LL|M|RE|S|T|VE))?",KT=Rq+"?",QT="["+Nq+"]?",xq="(?:"+Oq+"(?:"+[Mq,FT,VT].join("|")+")"+QT+KT+")*",Pq="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Iq="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Dq=QT+KT+xq,Lq="(?:"+[Aq,FT,VT].join("|")+")"+Dq,qq=RegExp([bo+"?"+BT+"+"+WT+"(?="+[kT,bo,"$"].join("|")+")",_q+"+"+HT+"(?="+[kT,bo+zT,"$"].join("|")+")",bo+"?"+zT+"+"+WT,bo+"+"+HT,Iq,Pq,jT,Lq].join("|"),"g");function $q(n){return n.match(qq)||[]}function kq(n,e,t){return n=Hl(n),e=t?void 0:e,e===void 0?mq(n)?$q(n):dq(n):n.match(e)||[]}var jq="['\u2019]",Bq=RegExp(jq,"g");function Uq(n){return function(e){return xT(kq(wy(e).replace(Bq,"")),n,"")}}function Fq(n){return function(e){e=Hl(e);var t=ny(e)?DL(e):void 0,r=t?t[0]:e.charAt(0),a=t?hL(t,1).join(""):e.slice(1);return r[n]()+a}}var Vq=Fq("toUpperCase"),zq=Uq(function(n,e,t){return n+(t?" ":"")+Vq(e)}),rs=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleClick=function(o){var l=r.props.disabled;l||be(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.children,s=r.className,o=r.color,l=r.content,c=r.disabled,u=r.fitted,h=r.header,d=r.icon,f=r.link,g=r.name,v=r.onClick,C=r.position,w=Re(o,C,U(a,"active"),U(c,"disabled"),U(d===!0||d&&!(g||l),"icon"),U(h,"header"),U(f,"link"),gt(u,"fitted"),"item",s),T=$e(e,this.props,function(){if(v)return"a"}),S=De(e,this.props);return Fe(i)?Y.createElement(T,Z({},S,{className:w,onClick:this.handleClick}),$t.create(d,{autoGenerateKey:!1}),Fe(l)?zq(g):l):Y.createElement(T,Z({},S,{className:w,onClick:this.handleClick}),i)},e}(ye.Component);rs.handledProps=["active","as","children","className","color","content","disabled","fitted","header","icon","index","link","name","onClick","position"],rs.propTypes={},rs.create=at(rs,function(n){return{content:n,name:n}});function pc(n){var e=n.children,t=n.className,r=n.content,a=n.position,i=Re(a,"menu",t),s=De(pc,n),o=$e(pc,n);return Y.createElement(o,Z({},s,{className:i}),Fe(e)?r:e)}pc.handledProps=["as","children","className","content","position"],pc.propTypes={};var Pa=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleItemOverrides=function(o){return{onClick:function(l,c){var u=c.index;r.setState({activeIndex:u}),be(o,"onClick",l,c),be(r.props,"onItemClick",l,c)}}},r}var t=e.prototype;return t.renderItems=function(){var r=this,a=this.props.items,i=this.state.activeIndex;return Vn(a,function(s,o){return rs.create(s,{defaultProps:{active:parseInt(i,10)===o,index:o},overrideProps:r.handleItemOverrides})})},t.render=function(){var r=this.props,a=r.attached,i=r.borderless,s=r.children,o=r.className,l=r.color,c=r.compact,u=r.fixed,h=r.floated,d=r.fluid,f=r.icon,g=r.inverted,v=r.pagination,C=r.pointing,w=r.secondary,T=r.size,S=r.stackable,O=r.tabular,k=r.text,B=r.vertical,D=r.widths,V=Re("ui",l,T,U(i,"borderless"),U(c,"compact"),U(d,"fluid"),U(g,"inverted"),U(v,"pagination"),U(C,"pointing"),U(w,"secondary"),U(S,"stackable"),U(k,"text"),U(B,"vertical"),gt(a,"attached"),gt(h,"floated"),gt(f,"icon"),gt(O,"tabular"),hn(u,"fixed"),lr(D,"item"),o,"menu"),q=De(e,this.props),K=$e(e,this.props);return Y.createElement(K,Z({},q,{className:V}),Fe(s)?this.renderItems():s)},e}(fo);Pa.handledProps=["activeIndex","as","attached","borderless","children","className","color","compact","defaultActiveIndex","fixed","floated","fluid","icon","inverted","items","onItemClick","pagination","pointing","secondary","size","stackable","tabular","text","vertical","widths"],Pa.propTypes={},Pa.autoControlledProps=["activeIndex"],Pa.Header=dc,Pa.Item=rs,Pa.Menu=pc,Pa.create=at(Pa,function(n){return{items:n}});const Wq=Pa;var mc=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleClick=function(o){be(r.props,"onClick",o,r.props)},r.handleKeyDown=function(o){be(r.props,"onKeyDown",o,r.props),it.getCode(o)===it.Enter&&be(r.props,"onClick",o,r.props)},r.handleOverrides=function(){return{onClick:r.handleClick,onKeyDown:r.handleKeyDown}},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.type,s=this.props.disabled||i==="ellipsisItem";return rs.create(this.props,{defaultProps:{active:a,"aria-current":a,"aria-disabled":s,disabled:s,onClick:this.handleClick,onKeyDown:this.handleKeyDown,tabIndex:s?-1:0},overrideProps:this.handleOverrides})},e}(ye.Component);mc.handledProps=["active","disabled","onClick","onKeyDown","type"],mc.propTypes={},mc.create=at(mc,function(n){return{content:n}});const GT=mc;var vo=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleItemClick=function(o,l){var c=l.value,u=r.state.activePage;+u!=+c&&(r.setState({activePage:c}),be(r.props,"onPageChange",o,Z({},r.props,{activePage:c})))},r.handleItemOverrides=function(o,l,c){return function(u){return{active:o,type:l,key:l+"-"+c,onClick:function(h,d){be(u,"onClick",h,d),d.type!=="ellipsisItem"&&r.handleItemClick(h,d)}}}},r}var t=e.prototype;return t.getInitialAutoControlledState=function(){return{activePage:1}},t.render=function(){var r=this,a=this.props,i=a["aria-label"],s=a.boundaryRange,o=a.disabled,l=a.ellipsisItem,c=a.siblingRange,u=a.totalPages,h=this.state.activePage,d=K2({activePage:h,boundaryRange:s,hideEllipsis:Ge(l),siblingRange:c,totalPages:u}),f=De(e,this.props);return Y.createElement(Wq,Z({},f,{"aria-label":i,pagination:!0,role:"navigation"}),Vn(d,function(g){var v=g.active,C=g.type,w=g.value;return GT.create(r.props[C],{defaultProps:{content:w,disabled:o,value:w},overrideProps:r.handleItemOverrides(v,C,w)})}))},e}(fo);vo.handledProps=["activePage","aria-label","boundaryRange","defaultActivePage","disabled","ellipsisItem","firstItem","lastItem","nextItem","onPageChange","pageItem","prevItem","siblingRange","totalPages"],vo.propTypes={},vo.autoControlledProps=["activePage"],vo.defaultProps={"aria-label":"Pagination Navigation",boundaryRange:1,ellipsisItem:"...",firstItem:{"aria-label":"First item",content:"\xAB"},lastItem:{"aria-label":"Last item",content:"\xBB"},nextItem:{"aria-label":"Next item",content:"\u27E9"},pageItem:{},prevItem:{"aria-label":"Previous item",content:"\u27E8"},siblingRange:1},vo.Item=GT;function Hq(n,e,t){return n==null?n:dT(n,e,t)}var Eo=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.inputRef=ye.createRef(),r.labelRef=ye.createRef(),r.canToggle=function(){var o=r.props,l=o.disabled,c=o.radio,u=o.readOnly,h=r.state.checked;return!l&&!u&&!(c&&h)},r.computeTabIndex=function(){var o=r.props,l=o.disabled,c=o.tabIndex;return Ge(c)?l?-1:0:c},r.handleClick=function(o){var l=r.props.id,c=r.state,u=c.checked,h=c.indeterminate,d=be(r.inputRef.current,"contains",o.target),f=be(r.labelRef.current,"contains",o.target),g=!f&&!d,v=!Ge(l),C=f&&v;C||be(r.props,"onClick",o,Z({},r.props,{checked:!u,indeterminate:!!h})),r.isClickFromMouse&&(r.isClickFromMouse=!1,f&&!v&&r.handleChange(o),g&&r.handleChange(o),f&&v&&o.stopPropagation())},r.handleChange=function(o){var l=r.state.checked;r.canToggle()&&(be(r.props,"onChange",o,Z({},r.props,{checked:!l,indeterminate:!1})),r.setState({checked:!l,indeterminate:!1}))},r.handleMouseDown=function(o){var l=r.state,c=l.checked,u=l.indeterminate;be(r.props,"onMouseDown",o,Z({},r.props,{checked:!!c,indeterminate:!!u})),o.defaultPrevented||be(r.inputRef.current,"focus"),o.preventDefault()},r.handleMouseUp=function(o){var l=r.state,c=l.checked,u=l.indeterminate;r.isClickFromMouse=!0,be(r.props,"onMouseUp",o,Z({},r.props,{checked:!!c,indeterminate:!!u}))},r.setIndeterminate=function(){var o=r.state.indeterminate;Hq(r.inputRef,"current.indeterminate",!!o)},r}var t=e.prototype;return t.componentDidMount=function(){this.setIndeterminate()},t.componentDidUpdate=function(){this.setIndeterminate()},t.render=function(){var r=this.props,a=r.className,i=r.disabled,s=r.label,o=r.id,l=r.name,c=r.radio,u=r.readOnly,h=r.slider,d=r.toggle,f=r.type,g=r.value,v=this.state,C=v.checked,w=v.indeterminate,T=Re("ui",U(C,"checked"),U(i,"disabled"),U(w,"indeterminate"),U(Ge(s),"fitted"),U(c,"radio"),U(u,"read-only"),U(h,"slider"),U(d,"toggle"),"checkbox",a),S=De(e,this.props),O=$e(e,this.props),k=Xh(S,{htmlProps:my}),B=k[0],D=k[1],V=g2(s,{defaultProps:{htmlFor:o},autoGenerateKey:!1})||Y.createElement("label",{htmlFor:o});return Y.createElement(O,Z({},D,{className:T,onClick:this.handleClick,onChange:this.handleChange,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp}),Y.createElement(Aa,{innerRef:this.inputRef},Y.createElement("input",Z({},B,{checked:C,className:"hidden",disabled:i,id:o,name:l,readOnly:!0,tabIndex:this.computeTabIndex(),type:f,value:g}))),Y.createElement(Aa,{innerRef:this.labelRef},V))},e}(fo);Eo.handledProps=["as","checked","className","defaultChecked","defaultIndeterminate","disabled","fitted","id","indeterminate","label","name","onChange","onClick","onMouseDown","onMouseUp","radio","readOnly","slider","tabIndex","toggle","type","value"],Eo.propTypes={},Eo.defaultProps={type:"checkbox"},Eo.autoControlledProps=["checked","indeterminate"];function Kq(n){for(var e=-1,t=n==null?0:n.length,r=0,a=[];++e<t;){var i=n[e];i&&(a[r++]=i)}return a}function Qq(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(!e(n[t],t,n))return!1;return!0}function Gq(n,e){var t=!0;return ho(n,function(r,a,i){return t=!!e(r,a,i),t}),t}function Yq(n,e,t){var r=xt(n)?Qq:Gq;return t&&ty(n,e,t)&&(e=void 0),r(n,Zi(e))}function Jq(n,e,t){var r=n==null?0:n.length;return r?(e=t||e===void 0?1:Jl(e),e=r-e,Vf(n,0,e<0?0:e)):[]}var Xq=Q0("length"),YT="\\ud800-\\udfff",Zq="\\u0300-\\u036f",e$="\\ufe20-\\ufe2f",t$="\\u20d0-\\u20ff",n$=Zq+e$+t$,r$="\\ufe0e\\ufe0f",a$="["+YT+"]",Ty="["+n$+"]",Ny="\\ud83c[\\udffb-\\udfff]",i$="(?:"+Ty+"|"+Ny+")",JT="[^"+YT+"]",XT="(?:\\ud83c[\\udde6-\\uddff]){2}",ZT="[\\ud800-\\udbff][\\udc00-\\udfff]",s$="\\u200d",eN=i$+"?",tN="["+r$+"]?",o$="(?:"+s$+"(?:"+[JT,XT,ZT].join("|")+")"+tN+eN+")*",l$=tN+eN+o$,c$="(?:"+[JT+Ty+"?",Ty,XT,ZT,a$].join("|")+")",nN=RegExp(Ny+"(?="+Ny+")|"+c$+l$,"g");function u$(n){for(var e=nN.lastIndex=0;nN.test(n);)++e;return e}function h$(n){return ny(n)?u$(n):Xq(n)}var d$="[object Map]",p$="[object Set]";function m$(n){if(n==null)return 0;if(Ma(n))return dy(n)?h$(n):n.length;var e=Wh(n);return e==d$||e==p$?n.size:Kf(n).length}var rN=Gl(function(n){return AT(Yh(n,1,Qh,!0))}),as=function(n){yt(e,n);function e(){return n.apply(this,arguments)||this}var t=e.prototype;return t.render=function(){var r=this.props,a=r.className,i=r.name,s=Re(i,"flag",a),o=De(e,this.props),l=$e(e,this.props);return Y.createElement(l,Z({},o,{className:s}))},e}(ye.PureComponent);as.handledProps=["as","className","name"],as.propTypes={},as.defaultProps={as:"i"},as.create=at(as,function(n){return{name:n}});function fc(n){var e=n.className,t=Re("divider",e),r=De(fc,n),a=$e(fc,n);return Y.createElement(a,Z({},r,{className:t}))}fc.handledProps=["as","className"],fc.propTypes={};var wo=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleClick=function(o){be(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.children,s=r.className,o=r.content,l=r.disabled,c=r.description,u=r.flag,h=r.icon,d=r.image,f=r.label,g=r.selected,v=r.text,C=Re(U(a,"active"),U(l,"disabled"),U(g,"selected"),"item",s),w=Ge(h)?oL(i,"DropdownMenu")&&"dropdown":h,T=De(e,this.props),S=$e(e,this.props),O={role:"option","aria-disabled":l,"aria-checked":a,"aria-selected":g};if(!Fe(i))return Y.createElement(S,Z({},T,O,{className:C,onClick:this.handleClick}),i);var k=as.create(u,{autoGenerateKey:!1}),B=$t.create(w,{autoGenerateKey:!1}),D=ur.create(d,{autoGenerateKey:!1}),V=hr.create(f,{autoGenerateKey:!1}),q=py("span",function(I){return{children:I}},c,{defaultProps:{className:"description"},autoGenerateKey:!1}),K=py("span",function(I){return{children:I}},Fe(o)?v:o,{defaultProps:{className:"text"},autoGenerateKey:!1});return Y.createElement(S,Z({},T,O,{className:C,onClick:this.handleClick}),D,B,k,V,q,K)},e}(ye.Component);wo.handledProps=["active","as","children","className","content","description","disabled","flag","icon","image","label","onClick","selected","text","value"],wo.propTypes={},wo.create=at(wo,function(n){return n});function mi(n){var e=n.children,t=n.className,r=n.content,a=n.icon,i=Re("header",t),s=De(mi,n),o=$e(mi,n);return Fe(e)?Y.createElement(o,Z({},s,{className:i}),$t.create(a,{autoGenerateKey:!1}),r):Y.createElement(o,Z({},s,{className:i}),e)}mi.handledProps=["as","children","className","content","icon"],mi.propTypes={},mi.create=at(mi,function(n){return{content:n}});function To(n){var e=n.children,t=n.className,r=n.content,a=n.direction,i=n.open,s=n.scrolling,o=Re(a,U(i,"visible"),U(s,"scrolling"),"menu transition",t),l=De(To,n),c=$e(To,n);return Y.createElement(c,Z({},l,{className:o}),Fe(e)?r:e)}To.handledProps=["as","children","className","content","direction","open","scrolling"],To.propTypes={};var is=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleChange=function(o){var l=hi(o,"target.value");be(r.props,"onChange",o,Z({},r.props,{value:l}))},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.autoComplete,i=r.className,s=r.tabIndex,o=r.type,l=r.value,c=Re("search",i),u=De(e,this.props);return Y.createElement("input",Z({},u,{"aria-autocomplete":"list",autoComplete:a,className:c,onChange:this.handleChange,tabIndex:s,type:o,value:l}))},e}(ye.Component);is.handledProps=["as","autoComplete","className","tabIndex","type","value"],is.propTypes={},is.defaultProps={autoComplete:"off",type:"text"},is.create=at(is,function(n){return{type:n}});function fi(n){var e=n.children,t=n.className,r=n.content,a=Re("divider",t),i=De(fi,n),s=$e(fi,n);return Y.createElement(s,Z({"aria-atomic":!0,"aria-live":"polite",role:"alert"},i,{className:a}),Fe(e)?r:e)}fi.handledProps=["as","children","className","content"],fi.propTypes={},fi.create=at(fi,function(n){return{content:n}});var aN=/[\\^$.*+?()[\]{}|]/g,f$=RegExp(aN.source);function y$(n){return n=Hl(n),n&&f$.test(n)?n.replace(aN,"\\$&"):n}function No(n){var e=n.additionLabel,t=n.additionPosition,r=n.allowAdditions,a=n.deburr,i=n.multiple,s=n.options,o=n.search,l=n.searchQuery,c=n.value,u=s;if(i&&(u=G0(u,function(v){return!xa(c,v.value)})),o&&l)if(so(o))u=o(u,l);else{var h=a?wy(l):l,d=new RegExp(y$(h),"i");u=G0(u,function(v){return d.test(a?wy(v.text):v.text)})}if(r&&o&&l&&!tc(u,{text:l})){var f=Y.isValidElement(e)?Y.cloneElement(e,{key:"addition-label"}):e||"",g={key:"addition",text:[f,Y.createElement("b",{key:"addition-query"},l)],value:l,className:"addition","data-additional":!0};t==="top"?u.unshift(g):u.push(g)}return u}No.handledProps=[];function iN(n){var e=n.additionLabel,t=n.additionPosition,r=n.allowAdditions,a=n.deburr,i=n.multiple,s=n.options,o=n.search,l=n.searchQuery,c=n.selectedIndex,u=n.value,h=No({value:u,options:s,searchQuery:l,additionLabel:e,additionPosition:t,allowAdditions:r,deburr:a,multiple:i,search:o}),d=Ey(h,function(C,w,T){return w.disabled||C.push(T),C},[]),f;if(!c||c<0){var g=d[0];f=i?g:ey(h,["value",u])||d[0]}else if(i)f=tT(d,function(C){return C>=c}),c>=h.length-1&&(f=d[d.length-1]);else{var v=ey(h,["value",u]);f=xa(d,v)?v:void 0}return(!f||f<0)&&(f=d[0]),f}var sN=function(n,e){return Ge(n)?e:n},oN=function(n){return n&&n.map(function(e){return pT(e,["key","value"])})};function lN(n){var e=n.flag,t=n.image,r=n.text;return so(r)?r:{content:Y.createElement(Y.Fragment,null,as.create(e),ur.create(t),r)}}var dr=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.searchRef=ye.createRef(),r.sizerRef=ye.createRef(),r.ref=ye.createRef(),r.handleChange=function(o,l){be(r.props,"onChange",o,Z({},r.props,{value:l}))},r.closeOnChange=function(o){var l=r.props,c=l.closeOnChange,u=l.multiple,h=Yl(c)?!u:c;h&&r.close(o,hy)},r.closeOnEscape=function(o){r.props.closeOnEscape&&it.getCode(o)===it.Escape&&(o.preventDefault(),r.close(o))},r.moveSelectionOnKeyDown=function(o){var l,c=r.props,u=c.multiple,h=c.selectOnNavigation,d=r.state.open;if(d){var f=(l={},l[it.ArrowDown]=1,l[it.ArrowUp]=-1,l),g=f[it.getCode(o)];if(g!==void 0){o.preventDefault();var v=r.getSelectedIndexAfterMove(g);!u&&h&&r.makeSelectedItemActive(o,v),r.setState({selectedIndex:v})}}},r.openOnSpace=function(o){var l,c,u,h=r.state.focus&&!r.state.open&&it.getCode(o)===it.Spacebar,d=((l=o.target)==null?void 0:l.tagName)!=="INPUT"&&((c=o.target)==null?void 0:c.tagName)!=="TEXTAREA"&&((u=o.target)==null?void 0:u.isContentEditable)!==!0;h&&(d&&o.preventDefault(),r.open(o))},r.openOnArrow=function(o){var l=r.state,c=l.focus,u=l.open;if(c&&!u){var h=it.getCode(o);(h===it.ArrowDown||h===it.ArrowUp)&&(o.preventDefault(),r.open(o))}},r.makeSelectedItemActive=function(o,l){var c=r.state,u=c.open,h=c.value,d=r.props.multiple,f=r.getSelectedItem(l),g=hi(f,"value"),v=hi(f,"disabled");if(Ge(g)||!u||v)return h;var C=d?rN(h,[g]):g,w=d?!!iT(C,h).length:C!==h;return w&&(r.setState({value:C}),r.handleChange(o,C),f["data-additional"]&&be(r.props,"onAddItem",o,Z({},r.props,{value:g}))),h},r.selectItemOnEnter=function(o){var l=r.props.search,c=r.state,u=c.open,h=c.selectedIndex;if(u){var d=it.getCode(o)===it.Enter||!l&&it.getCode(o)===it.Spacebar;if(d){o.preventDefault();var f=m$(No({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search}));if(!(l&&f===0)){var g=r.makeSelectedItemActive(o,h);r.setState({selectedIndex:iN({additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search,selectedIndex:h,value:g,options:r.props.options,searchQuery:""})}),r.closeOnChange(o),r.clearSearchQuery(),l&&be(r.searchRef.current,"focus")}}}},r.removeItemOnBackspace=function(o){var l=r.props,c=l.multiple,u=l.search,h=r.state,d=h.searchQuery,f=h.value;if(it.getCode(o)===it.Backspace&&!(d||!u||!c||ec(f))){o.preventDefault();var g=Jq(f);r.setState({value:g}),r.handleChange(o,g)}},r.closeOnDocumentClick=function(o){r.props.closeOnBlur&&(r.ref.current&&ac(r.ref.current,o)||r.close())},r.handleMouseDown=function(o){r.isMouseDown=!0,be(r.props,"onMouseDown",o,r.props),document.addEventListener("mouseup",r.handleDocumentMouseUp)},r.handleDocumentMouseUp=function(){r.isMouseDown=!1,document.removeEventListener("mouseup",r.handleDocumentMouseUp)},r.handleClick=function(o){var l=r.props,c=l.minCharacters,u=l.search,h=r.state,d=h.open,f=h.searchQuery;if(be(r.props,"onClick",o,r.props),o.stopPropagation(),!u)return r.toggle(o);if(d){be(r.searchRef.current,"focus");return}if(f.length>=c||c===1){r.open(o);return}be(r.searchRef.current,"focus")},r.handleIconClick=function(o){var l=r.props.clearable,c=r.hasValue();be(r.props,"onClick",o,r.props),o.stopPropagation(),l&&c?r.clearValue(o):r.toggle(o)},r.handleItemClick=function(o,l){var c=r.props,u=c.multiple,h=c.search,d=r.state.value,f=l.value;if(o.stopPropagation(),(u||l.disabled)&&o.nativeEvent.stopImmediatePropagation(),!l.disabled){var g=l["data-additional"],v=u?rN(r.state.value,[f]):f,C=u?!!iT(v,d).length:v!==d;C&&(r.setState({value:v}),r.handleChange(o,v)),r.clearSearchQuery(),be(h?r.searchRef.current:r.ref.current,"focus"),r.closeOnChange(o),g&&be(r.props,"onAddItem",o,Z({},r.props,{value:f}))}},r.handleFocus=function(o){var l=r.state.focus;l||(be(r.props,"onFocus",o,r.props),r.setState({focus:!0}))},r.handleBlur=function(o){var l=hi(o,"currentTarget");if(!(l&&l.contains(document.activeElement))){var c=r.props,u=c.closeOnBlur,h=c.multiple,d=c.selectOnBlur;r.isMouseDown||(be(r.props,"onBlur",o,r.props),d&&!h&&(r.makeSelectedItemActive(o,r.state.selectedIndex),u&&r.close()),r.setState({focus:!1}),r.clearSearchQuery())}},r.handleSearchChange=function(o,l){var c=l.value;o.stopPropagation();var u=r.props.minCharacters,h=r.state.open,d=c;if(be(r.props,"onSearchChange",o,Z({},r.props,{searchQuery:d})),r.setState({searchQuery:d,selectedIndex:0}),!h&&d.length>=u){r.open();return}h&&u!==1&&d.length<u&&r.close()},r.handleKeyDown=function(o){r.moveSelectionOnKeyDown(o),r.openOnArrow(o),r.openOnSpace(o),r.selectItemOnEnter(o),be(r.props,"onKeyDown",o)},r.getSelectedItem=function(o){var l=No({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search});return hi(l,"["+o+"]")},r.getItemByValue=function(o){var l=r.props.options;return tT(l,{value:o})},r.getDropdownAriaOptions=function(){var o=r.props,l=o.loading,c=o.disabled,u=o.search,h=o.multiple,d=r.state.open,f={role:u?"combobox":"listbox","aria-busy":l,"aria-disabled":c,"aria-expanded":!!d};return f.role==="listbox"&&(f["aria-multiselectable"]=h),f},r.clearSearchQuery=function(){var o=r.state.searchQuery;o===void 0||o===""||r.setState({searchQuery:""})},r.handleLabelClick=function(o,l){o.stopPropagation(),r.setState({selectedLabel:l.value}),be(r.props,"onLabelClick",o,l)},r.handleLabelRemove=function(o,l){o.stopPropagation();var c=r.state.value,u=Y2(c,l.value);r.setState({value:u}),r.handleChange(o,u)},r.getSelectedIndexAfterMove=function(o,l){l===void 0&&(l=r.state.selectedIndex);var c=No({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search});if(!(c===void 0||Yq(c,"disabled"))){var u=c.length-1,h=r.props.wrapSelection,d=l+o;return!h&&(d>u||d<0)?d=l:d>u?d=0:d<0&&(d=u),c[d].disabled?r.getSelectedIndexAfterMove(o,d):d}},r.handleIconOverrides=function(o){var l=r.props.clearable,c=Re(l&&r.hasValue()&&"clear",o.className);return{className:c,onClick:function(u){be(o,"onClick",u,o),r.handleIconClick(u)}}},r.clearValue=function(o){var l=r.props.multiple,c=l?[]:"";r.setState({value:c}),r.handleChange(o,c)},r.computeSearchInputTabIndex=function(){var o=r.props,l=o.disabled,c=o.tabIndex;return Ge(c)?l?-1:0:c},r.computeSearchInputWidth=function(){var o=r.state.searchQuery;if(r.sizerRef.current&&o){r.sizerRef.current.style.display="inline",r.sizerRef.current.textContent=o;var l=Math.ceil(r.sizerRef.current.getBoundingClientRect().width);return r.sizerRef.current.style.removeProperty("display"),l}},r.computeTabIndex=function(){var o=r.props,l=o.disabled,c=o.search,u=o.tabIndex;if(!c)return l?-1:Ge(u)?0:u},r.handleSearchInputOverrides=function(o){return{onChange:function(l,c){be(o,"onChange",l,c),r.handleSearchChange(l,c)}}},r.hasValue=function(){var o=r.props.multiple,l=r.state.value;return o?!ec(l):!Ge(l)&&l!==""},r.scrollSelectedItemIntoView=function(){if(r.ref.current){var o=r.ref.current.querySelector(".menu.visible");if(o){var l=o.querySelector(".item.selected");if(l){var c=l.offsetTop<o.scrollTop,u=l.offsetTop+l.clientHeight>o.scrollTop+o.clientHeight;c?o.scrollTop=l.offsetTop:u&&(o.scrollTop=l.offsetTop+l.clientHeight-o.clientHeight)}}}},r.setOpenDirection=function(){if(r.ref.current){var o=r.ref.current.querySelector(".menu.visible");if(o){var l=r.ref.current.getBoundingClientRect(),c=o.clientHeight,u=document.documentElement.clientHeight-l.top-l.height-c,h=l.top-c,d=u<0&&h>u;!d!=!r.state.upward&&r.setState({upward:d})}}},r.open=function(o,l){o===void 0&&(o=null),l===void 0&&(l=!0);var c=r.props,u=c.disabled,h=c.search;u||(h&&be(r.searchRef.current,"focus"),be(r.props,"onOpen",o,r.props),l&&r.setState({open:!0}),r.scrollSelectedItemIntoView())},r.close=function(o,l){l===void 0&&(l=r.handleClose),r.state.open&&(be(r.props,"onClose",o,r.props),r.setState({open:!1},l))},r.handleClose=function(){var o=document.activeElement===r.searchRef.current;!o&&r.ref.current&&r.ref.current.blur();var l=document.activeElement===r.ref.current,c=o||l;r.setState({focus:c})},r.toggle=function(o){return r.state.open?r.close(o):r.open(o)},r.renderText=function(){var o=r.props,l=o.multiple,c=o.placeholder,u=o.search,h=o.text,d=r.state,f=d.searchQuery,g=d.selectedIndex,v=d.value,C=d.open,w=r.hasValue(),T=Re(c&&!w&&"default","text",u&&f&&"filtered"),S=c,O;return h?S=h:C&&!l?O=r.getSelectedItem(g):w&&(O=r.getItemByValue(v)),fi.create(O?lN(O):S,{defaultProps:{className:T}})},r.renderSearchInput=function(){var o=r.props,l=o.search,c=o.searchInput,u=r.state.searchQuery;return l&&Y.createElement(Aa,{innerRef:r.searchRef},is.create(c,{defaultProps:{style:{width:r.computeSearchInputWidth()},tabIndex:r.computeSearchInputTabIndex(),value:u},overrideProps:r.handleSearchInputOverrides}))},r.renderSearchSizer=function(){var o=r.props,l=o.search,c=o.multiple;return l&&c&&Y.createElement("span",{className:"sizer",ref:r.sizerRef})},r.renderLabels=function(){var o=r.props,l=o.multiple,c=o.renderLabel,u=r.state,h=u.selectedLabel,d=u.value;if(!(!l||ec(d))){var f=Vn(d,r.getItemByValue);return Vn(Kq(f),function(g,v){var C={active:g.value===h,as:"a",key:sN(g.key,g.value),onClick:r.handleLabelClick,onRemove:r.handleLabelRemove,value:g.value};return hr.create(c(g,v,C),{defaultProps:C})})}},r.renderOptions=function(){var o=r.props,l=o.lazyLoad,c=o.multiple,u=o.search,h=o.noResultsMessage,d=r.state,f=d.open,g=d.selectedIndex,v=d.value;if(l&&!f)return null;var C=No({value:r.state.value,options:r.props.options,searchQuery:r.state.searchQuery,additionLabel:r.props.additionLabel,additionPosition:r.props.additionPosition,allowAdditions:r.props.allowAdditions,deburr:r.props.deburr,multiple:r.props.multiple,search:r.props.search});if(h!==null&&u&&ec(C))return Y.createElement("div",{className:"message"},h);var w=c?function(T){return xa(v,T)}:function(T){return T===v};return Vn(C,function(T,S){return wo.create(Z({active:w(T.value),selected:g===S},T,{key:sN(T.key,T.value),style:Z({},T.style,{pointerEvents:"all"})}),{generateKey:!1,overrideProps:function(O){return{onClick:function(k,B){O.onClick==null||O.onClick(k,B),r.handleItemClick(k,B)}}}})})},r.renderMenu=function(){var o=r.props,l=o.children,c=o.direction,u=o.header,h=r.state.open,d=r.getDropdownMenuAriaOptions();if(!Fe(l)){var f=ye.Children.only(l),g=Re(c,U(h,"visible"),f.props.className);return ye.cloneElement(f,Z({className:g},d))}return Y.createElement(To,Z({},d,{direction:c,open:h}),mi.create(u,{autoGenerateKey:!1}),r.renderOptions())},r}var t=e.prototype;return t.getInitialAutoControlledState=function(){return{focus:!1,searchQuery:""}},e.getAutoControlledStateFromProps=function(r,a,i){var s={__options:r.options,__value:a.value},o=!ns(i.__value,a.value)||!Q2(oN(r.options),oN(i.__options));return o&&(s.selectedIndex=iN({additionLabel:r.additionLabel,additionPosition:r.additionPosition,allowAdditions:r.allowAdditions,deburr:r.deburr,multiple:r.multiple,search:r.search,selectedIndex:a.selectedIndex,value:a.value,options:r.options,searchQuery:a.searchQuery})),s},t.componentDidMount=function(){var r=this.state.open;r&&this.open(null,!1)},t.shouldComponentUpdate=function(r,a){return!ns(r,this.props)||!ns(a,this.state)},t.componentDidUpdate=function(r,a){var i=this.props,s=i.closeOnBlur,o=i.minCharacters,l=i.openOnFocus,c=i.search;if(!a.focus&&this.state.focus){if(!this.isMouseDown){var u=!c||c&&o===1&&!this.state.open;l&&u&&this.open()}}else a.focus&&!this.state.focus&&!this.isMouseDown&&s&&this.close();!a.open&&this.state.open?(this.setOpenDirection(),this.scrollSelectedItemIntoView()):a.open&&this.state.open,a.selectedIndex!==this.state.selectedIndex&&this.scrollSelectedItemIntoView()},t.getDropdownMenuAriaOptions=function(){var r=this.props,a=r.search,i=r.multiple,s={};return a&&(s["aria-multiselectable"]=i,s.role="listbox"),s},t.render=function(){var r=this.props,a=r.basic,i=r.button,s=r.className,o=r.compact,l=r.disabled,c=r.error,u=r.fluid,h=r.floating,d=r.icon,f=r.inline,g=r.item,v=r.labeled,C=r.loading,w=r.multiple,T=r.pointing,S=r.search,O=r.selection,k=r.scrolling,B=r.simple,D=r.trigger,V=this.state,q=V.focus,K=V.open,I=V.upward,G=Re("ui",U(K,"active visible"),U(l,"disabled"),U(c,"error"),U(C,"loading"),U(a,"basic"),U(i,"button"),U(o,"compact"),U(u,"fluid"),U(h,"floating"),U(f,"inline"),U(v,"labeled"),U(g,"item"),U(w,"multiple"),U(S,"search"),U(O,"selection"),U(B,"simple"),U(k,"scrolling"),U(I,"upward"),gt(T,"pointing"),"dropdown",s),H=De(e,this.props),se=$e(e,this.props),re=this.getDropdownAriaOptions(se,this.props);return Y.createElement(Aa,{innerRef:this.ref},Y.createElement(se,Z({},H,re,{className:G,onBlur:this.handleBlur,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onChange:this.handleChange,tabIndex:this.computeTabIndex()}),this.renderLabels(),this.renderSearchInput(),this.renderSearchSizer(),D||this.renderText(),$t.create(d,{overrideProps:this.handleIconOverrides,autoGenerateKey:!1}),this.renderMenu(),K&&Y.createElement(_a,{name:"keydown",on:this.closeOnEscape}),K&&Y.createElement(_a,{name:"click",on:this.closeOnDocumentClick}),q&&Y.createElement(_a,{name:"keydown",on:this.removeItemOnBackspace})))},e}(fo);dr.handledProps=["additionLabel","additionPosition","allowAdditions","as","basic","button","children","className","clearable","closeOnBlur","closeOnChange","closeOnEscape","compact","deburr","defaultOpen","defaultSearchQuery","defaultSelectedLabel","defaultUpward","defaultValue","direction","disabled","error","floating","fluid","header","icon","inline","item","labeled","lazyLoad","loading","minCharacters","multiple","noResultsMessage","onAddItem","onBlur","onChange","onClick","onClose","onFocus","onLabelClick","onMouseDown","onOpen","onSearchChange","open","openOnFocus","options","placeholder","pointing","renderLabel","scrolling","search","searchInput","searchQuery","selectOnBlur","selectOnNavigation","selectedLabel","selection","simple","tabIndex","text","trigger","upward","value","wrapSelection"],dr.propTypes={},dr.defaultProps={additionLabel:"Add ",additionPosition:"top",closeOnBlur:!0,closeOnEscape:!0,deburr:!1,icon:"dropdown",minCharacters:1,noResultsMessage:"No results found.",openOnFocus:!0,renderLabel:lN,searchInput:"text",selectOnBlur:!0,selectOnNavigation:!0,wrapSelection:!0},dr.autoControlledProps=["open","searchQuery","selectedLabel","value","upward"],dr.Divider=fc,dr.Header=mi,dr.Item=wo,dr.Menu=To,dr.SearchInput=is,dr.Text=fi;function Ia(n){var e=n.children,t=n.className,r=n.content,a=n.icon,i=Re("divider",t),s=De(Ia,n),o=$e(Ia,n);return Ge(a)?Ge(r)?Y.createElement(o,Z({},s,{className:i}),Fe(e)?"/":e):Y.createElement(o,Z({},s,{className:i}),r):$t.create(a,{defaultProps:Z({},s,{className:i}),autoGenerateKey:!1})}Ia.handledProps=["as","children","className","content","icon"],Ia.propTypes={},Ia.create=at(Ia,function(n){return{icon:n}});var yi=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.computeElementType=function(){var o=r.props,l=o.link,c=o.onClick;if(l||c)return"a"},r.handleClick=function(o){return be(r.props,"onClick",o,r.props)},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.children,s=r.className,o=r.content,l=r.href,c=Re(U(a,"active"),"section",s),u=De(e,this.props),h=$e(e,this.props,this.computeElementType);return Y.createElement(h,Z({},u,{className:c,href:l,onClick:this.handleClick}),Fe(i)?o:i)},e}(ye.Component);yi.handledProps=["active","as","children","className","content","href","link","onClick"],yi.propTypes={},yi.create=at(yi,function(n){return{content:n,link:!0}});function ss(n){var e=n.children,t=n.className,r=n.divider,a=n.icon,i=n.sections,s=n.size,o=Re("ui",s,"breadcrumb",t),l=De(ss,n),c=$e(ss,n);if(!Fe(e))return Y.createElement(c,Z({},l,{className:o}),e);var u=[];return eT(i,function(h,d){var f=yi.create(h);if(u.push(f),d!==i.length-1){var g=f.key+"_divider"||JSON.stringify(h);u.push(Ia.create({content:r,icon:a,key:g}))}}),Y.createElement(c,Z({},l,{className:o}),u)}ss.handledProps=["as","children","className","divider","icon","sections","size"],ss.propTypes={},ss.Divider=Ia,ss.Section=yi;var Co=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.inputRef=ye.createRef(),r.computeIcon=function(){var o=r.props,l=o.loading,c=o.icon;if(!Ge(c))return c;if(l)return"spinner"},r.computeTabIndex=function(){var o=r.props,l=o.disabled,c=o.tabIndex;if(!Ge(c))return c;if(l)return-1},r.focus=function(o){return r.inputRef.current.focus(o)},r.select=function(){return r.inputRef.current.select()},r.handleChange=function(o){var l=hi(o,"target.value");be(r.props,"onChange",o,Z({},r.props,{value:l}))},r.handleChildOverrides=function(o,l){return Z({},l,o.props,{ref:function(c){ea(o.ref,c),r.inputRef.current=c}})},r.partitionProps=function(){var o=r.props,l=o.disabled,c=o.type,u=r.computeTabIndex(),h=De(e,r.props),d=Xh(h),f=d[0],g=d[1];return[Z({},f,{disabled:l,type:c,tabIndex:u,onChange:r.handleChange,ref:r.inputRef}),g]},r}var t=e.prototype;return t.render=function(){var r=this,a=this.props,i=a.action,s=a.actionPosition,o=a.children,l=a.className,c=a.disabled,u=a.error,h=a.fluid,d=a.focus,f=a.icon,g=a.iconPosition,v=a.input,C=a.inverted,w=a.label,T=a.labelPosition,S=a.loading,O=a.size,k=a.transparent,B=a.type,D=Re("ui",O,U(c,"disabled"),U(u,"error"),U(h,"fluid"),U(d,"focus"),U(C,"inverted"),U(S,"loading"),U(k,"transparent"),hn(s,"action")||U(i,"action"),hn(g,"icon")||U(f||S,"icon"),hn(T,"labeled")||U(w,"labeled"),"input",l),V=$e(e,this.props),q=this.partitionProps(),K=q[0],I=q[1];if(!Fe(o)){var G=Vn(ye.Children.toArray(o),function(re){return re.type!=="input"?re:ye.cloneElement(re,r.handleChildOverrides(re,K))});return Y.createElement(V,Z({},I,{className:D}),G)}var H=aa.create(i,{autoGenerateKey:!1}),se=hr.create(w,{defaultProps:{className:Re("label",xa(T,"corner")&&T)},autoGenerateKey:!1});return Y.createElement(V,Z({},I,{className:D}),s==="left"&&H,T!=="right"&&se,y2(v||B,{defaultProps:K,autoGenerateKey:!1}),$t.create(this.computeIcon(),{autoGenerateKey:!1}),s!=="left"&&H,T==="right"&&se)},e}(ye.Component);Co.handledProps=["action","actionPosition","as","children","className","disabled","error","fluid","focus","icon","iconPosition","input","inverted","label","labelPosition","loading","onChange","size","tabIndex","transparent","type"],Co.propTypes={},Co.defaultProps={type:"text"},Co.create=at(Co,function(n){return{type:n}});function kt(n){var e=n.children,t=n.className,r=n.computer,a=n.color,i=n.floated,s=n.largeScreen,o=n.mobile,l=n.only,c=n.stretched,u=n.tablet,h=n.textAlign,d=n.verticalAlign,f=n.widescreen,g=n.width,v=Re(a,U(c,"stretched"),Gh(l,"only"),es(h),hn(i,"floated"),di(d),lr(r,"wide computer"),lr(s,"wide large screen"),lr(o,"wide mobile"),lr(u,"wide tablet"),lr(f,"wide widescreen"),lr(g,"wide"),"column",t),C=De(kt,n),w=$e(kt,n);return Y.createElement(w,Z({},C,{className:v}),e)}kt.handledProps=["as","children","className","color","computer","floated","largeScreen","mobile","only","stretched","tablet","textAlign","verticalAlign","widescreen","width"],kt.propTypes={},kt.create=at(kt,function(n){return{children:n}});function Dr(n){var e=n.centered,t=n.children,r=n.className,a=n.color,i=n.columns,s=n.divided,o=n.only,l=n.reversed,c=n.stretched,u=n.textAlign,h=n.verticalAlign,d=Re(a,U(e,"centered"),U(s,"divided"),U(c,"stretched"),Gh(o,"only"),Gh(l,"reversed"),es(u),di(h),lr(i,"column",!0),"row",r),f=De(Dr,n),g=$e(Dr,n);return Y.createElement(g,Z({},f,{className:d}),t)}Dr.handledProps=["as","centered","children","className","color","columns","divided","only","reversed","stretched","textAlign","verticalAlign"],Dr.propTypes={};function gi(n){var e=n.celled,t=n.centered,r=n.children,a=n.className,i=n.columns,s=n.container,o=n.divided,l=n.doubling,c=n.inverted,u=n.padded,h=n.relaxed,d=n.reversed,f=n.stackable,g=n.stretched,v=n.textAlign,C=n.verticalAlign,w=Re("ui",U(t,"centered"),U(s,"container"),U(l,"doubling"),U(c,"inverted"),U(f,"stackable"),U(g,"stretched"),gt(e,"celled"),gt(o,"divided"),gt(u,"padded"),gt(h,"relaxed"),Gh(d,"reversed"),es(v),di(C),lr(i,"column",!0),"grid",a),T=De(gi,n),S=$e(gi,n);return Y.createElement(S,Z({},T,{className:w}),r)}gi.handledProps=["as","celled","centered","children","className","columns","container","divided","doubling","inverted","padded","relaxed","reversed","stackable","stretched","textAlign","verticalAlign"],gi.Column=kt,gi.Row=Dr,gi.propTypes={};function bi(n){var e=n.children,t=n.className,r=Re(t),a=De(bi,n),i=$e(bi,n);return Y.createElement(i,Z({},a,{className:r}),e)}bi.handledProps=["as","children","className"],bi.defaultProps={as:"tbody"},bi.propTypes={};function Zt(n){var e=n.active,t=n.children,r=n.className,a=n.collapsing,i=n.content,s=n.disabled,o=n.error,l=n.icon,c=n.negative,u=n.positive,h=n.selectable,d=n.singleLine,f=n.textAlign,g=n.verticalAlign,v=n.warning,C=n.width,w=Re(U(e,"active"),U(a,"collapsing"),U(s,"disabled"),U(o,"error"),U(c,"negative"),U(u,"positive"),U(h,"selectable"),U(d,"single line"),U(v,"warning"),es(f),di(g),lr(C,"wide"),r),T=De(Zt,n),S=$e(Zt,n);return Fe(t)?Y.createElement(S,Z({},T,{className:w}),$t.create(l),i):Y.createElement(S,Z({},T,{className:w}),t)}Zt.handledProps=["active","as","children","className","collapsing","content","disabled","error","icon","negative","positive","selectable","singleLine","textAlign","verticalAlign","warning","width"],Zt.defaultProps={as:"td"},Zt.propTypes={},Zt.create=at(Zt,function(n){return{content:n}});function Da(n){var e=n.children,t=n.className,r=n.content,a=n.fullWidth,i=Re(U(a,"full-width"),t),s=De(Da,n),o=$e(Da,n);return Y.createElement(o,Z({},s,{className:i}),Fe(e)?r:e)}Da.handledProps=["as","children","className","content","fullWidth"],Da.defaultProps={as:"thead"},Da.propTypes={};function os(n){var e=n.as,t=De(os,n);return Y.createElement(Da,Z({},t,{as:e}))}os.handledProps=["as"],os.propTypes={},os.defaultProps={as:"tfoot"};function zn(n){var e=n.as,t=n.className,r=n.sorted,a=Re(hn(r,"sorted"),t),i=De(zn,n);return Y.createElement(Zt,Z({},i,{as:e,className:a}))}zn.handledProps=["as","className","sorted"],zn.propTypes={},zn.defaultProps={as:"th"};function vn(n){var e=n.active,t=n.cellAs,r=n.cells,a=n.children,i=n.className,s=n.disabled,o=n.error,l=n.negative,c=n.positive,u=n.textAlign,h=n.verticalAlign,d=n.warning,f=Re(U(e,"active"),U(s,"disabled"),U(o,"error"),U(l,"negative"),U(c,"positive"),U(d,"warning"),es(u),di(h),i),g=De(vn,n),v=$e(vn,n);return Fe(a)?Y.createElement(v,Z({},g,{className:f}),Vn(r,function(C){return Zt.create(C,{defaultProps:{as:t}})})):Y.createElement(v,Z({},g,{className:f}),a)}vn.handledProps=["active","as","cellAs","cells","children","className","disabled","error","negative","positive","textAlign","verticalAlign","warning"],vn.defaultProps={as:"tr",cellAs:"td"},vn.propTypes={},vn.create=at(vn,function(n){return{cells:n}});function pr(n){var e=n.attached,t=n.basic,r=n.celled,a=n.children,i=n.className,s=n.collapsing,o=n.color,l=n.columns,c=n.compact,u=n.definition,h=n.fixed,d=n.footerRow,f=n.headerRow,g=n.headerRows,v=n.inverted,C=n.padded,w=n.renderBodyRow,T=n.selectable,S=n.singleLine,O=n.size,k=n.sortable,B=n.stackable,D=n.striped,V=n.structured,q=n.tableData,K=n.textAlign,I=n.unstackable,G=n.verticalAlign,H=Re("ui",o,O,U(r,"celled"),U(s,"collapsing"),U(u,"definition"),U(h,"fixed"),U(v,"inverted"),U(T,"selectable"),U(S,"single line"),U(k,"sortable"),U(B,"stackable"),U(D,"striped"),U(V,"structured"),U(I,"unstackable"),gt(e,"attached"),gt(t,"basic"),gt(c,"compact"),gt(C,"padded"),es(K),di(G),lr(l,"column"),"table",i),se=De(pr,n),re=$e(pr,n);if(!Fe(a))return Y.createElement(re,Z({},se,{className:H}),a);var ue=f||g,Se={defaultProps:{cellAs:"th"}},ie=ue&&Y.createElement(Da,null,vn.create(f,Se),Vn(g,function(fe){return vn.create(fe,Se)}));return Y.createElement(re,Z({},se,{className:H}),ie,Y.createElement(bi,null,w&&Vn(q,function(fe,Me){return vn.create(w(fe,Me))})),d&&Y.createElement(os,null,vn.create(d)))}pr.handledProps=["as","attached","basic","celled","children","className","collapsing","color","columns","compact","definition","fixed","footerRow","headerRow","headerRows","inverted","padded","renderBodyRow","selectable","singleLine","size","sortable","stackable","striped","structured","tableData","textAlign","unstackable","verticalAlign"],pr.defaultProps={as:"table"},pr.propTypes={},pr.Body=bi,pr.Cell=Zt,pr.Footer=os,pr.Header=Da,pr.HeaderCell=zn,pr.Row=vn;function vi(n){var e=n.children,t=n.className,r=n.content,a=Re("sub header",t),i=De(vi,n),s=$e(vi,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}vi.handledProps=["as","children","className","content"],vi.propTypes={},vi.create=at(vi,function(n){return{content:n}});function Ao(n){var e=n.children,t=n.className,r=n.content,a=Re("content",t),i=De(Ao,n),s=$e(Ao,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}Ao.handledProps=["as","children","className","content"],Ao.propTypes={};function La(n){var e=n.attached,t=n.block,r=n.children,a=n.className,i=n.color,s=n.content,o=n.disabled,l=n.dividing,c=n.floated,u=n.icon,h=n.image,d=n.inverted,f=n.size,g=n.sub,v=n.subheader,C=n.textAlign,w=Re("ui",i,f,U(t,"block"),U(o,"disabled"),U(l,"dividing"),hn(c,"floated"),U(u===!0,"icon"),U(h===!0,"image"),U(d,"inverted"),U(g,"sub"),gt(e,"attached"),es(C),"header",a),T=De(La,n),S=$e(La,n);if(!Fe(r))return Y.createElement(S,Z({},T,{className:w}),r);var O=$t.create(u,{autoGenerateKey:!1}),k=ur.create(h,{autoGenerateKey:!1}),B=vi.create(v,{autoGenerateKey:!1});return O||k?Y.createElement(S,Z({},T,{className:w}),O||k,(s||B)&&Y.createElement(Ao,null,s,B)):Y.createElement(S,Z({},T,{className:w}),s,B)}La.handledProps=["as","attached","block","children","className","color","content","disabled","dividing","floated","icon","image","inverted","size","sub","subheader","textAlign"],La.propTypes={},La.Content=Ao,La.Subheader=vi;function g$(n){return Fn(n)&&n.nodeType===1&&!iy(n)}var b$=ye.createContext();ye.createContext();var v$=function(n){return Array.isArray(n)?n[0]:n},E$=function(n){if(typeof n=="function"){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.apply(void 0,t)}},w$=function(n,e){if(typeof n=="function")return E$(n,e);n!=null&&(n.current=e)},cN=function(n){return n.reduce(function(e,t){var r=t[0],a=t[1];return e[r]=a,e},{})},uN=typeof window<"u"&&window.document&&window.document.createElement?ye.useLayoutEffect:ye.useEffect,On="top",mr="bottom",fr="right",_n="left",Cy="auto",yc=[On,mr,fr,_n],So="start",gc="end",T$="clippingParents",hN="viewport",bc="popper",N$="reference",dN=yc.reduce(function(n,e){return n.concat([e+"-"+So,e+"-"+gc])},[]),pN=[].concat(yc,[Cy]).reduce(function(n,e){return n.concat([e,e+"-"+So,e+"-"+gc])},[]),C$="beforeRead",A$="read",S$="afterRead",R$="beforeMain",M$="main",O$="afterMain",_$="beforeWrite",x$="write",P$="afterWrite",I$=[C$,A$,S$,R$,M$,O$,_$,x$,P$];function ia(n){return n?(n.nodeName||"").toLowerCase():null}function Wn(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ls(n){var e=Wn(n).Element;return n instanceof e||n instanceof Element}function yr(n){var e=Wn(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Ay(n){if(typeof ShadowRoot>"u")return!1;var e=Wn(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function D$(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},a=e.attributes[t]||{},i=e.elements[t];!yr(i)||!ia(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(s){var o=a[s];o===!1?i.removeAttribute(s):i.setAttribute(s,o===!0?"":o)}))})}function L$(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var a=e.elements[r],i=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),o=s.reduce(function(l,c){return l[c]="",l},{});!yr(a)||!ia(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){a.removeAttribute(l)}))})}}const q$={name:"applyStyles",enabled:!0,phase:"write",fn:D$,effect:L$,requires:["computeStyles"]};function sa(n){return n.split("-")[0]}var cs=Math.max,ad=Math.min,Ro=Math.round;function Sy(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function mN(){return!/^((?!chrome|android).)*safari/i.test(Sy())}function Mo(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),a=1,i=1;e&&yr(n)&&(a=n.offsetWidth>0&&Ro(r.width)/n.offsetWidth||1,i=n.offsetHeight>0&&Ro(r.height)/n.offsetHeight||1);var s=ls(n)?Wn(n):window,o=s.visualViewport,l=!mN()&&t,c=(r.left+(l&&o?o.offsetLeft:0))/a,u=(r.top+(l&&o?o.offsetTop:0))/i,h=r.width/a,d=r.height/i;return{width:h,height:d,top:u,right:c+h,bottom:u+d,left:c,x:c,y:u}}function Ry(n){var e=Mo(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function fN(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Ay(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function qa(n){return Wn(n).getComputedStyle(n)}function $$(n){return["table","td","th"].indexOf(ia(n))>=0}function Ei(n){return((ls(n)?n.ownerDocument:n.document)||window.document).documentElement}function id(n){return ia(n)==="html"?n:n.assignedSlot||n.parentNode||(Ay(n)?n.host:null)||Ei(n)}function yN(n){return!yr(n)||qa(n).position==="fixed"?null:n.offsetParent}function k$(n){var e=/firefox/i.test(Sy()),t=/Trident/i.test(Sy());if(t&&yr(n)){var r=qa(n);if(r.position==="fixed")return null}var a=id(n);for(Ay(a)&&(a=a.host);yr(a)&&["html","body"].indexOf(ia(a))<0;){var i=qa(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||e&&i.willChange==="filter"||e&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function vc(n){for(var e=Wn(n),t=yN(n);t&&$$(t)&&qa(t).position==="static";)t=yN(t);return t&&(ia(t)==="html"||ia(t)==="body"&&qa(t).position==="static")?e:t||k$(n)||e}function My(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Ec(n,e,t){return cs(n,ad(e,t))}function j$(n,e,t){var r=Ec(n,e,t);return r>t?t:r}function gN(){return{top:0,right:0,bottom:0,left:0}}function bN(n){return Object.assign({},gN(),n)}function vN(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var B$=function(n,e){return n=typeof n=="function"?n(Object.assign({},e.rects,{placement:e.placement})):n,bN(typeof n!="number"?n:vN(n,yc))};function U$(n){var e,t=n.state,r=n.name,a=n.options,i=t.elements.arrow,s=t.modifiersData.popperOffsets,o=sa(t.placement),l=My(o),c=[_n,fr].indexOf(o)>=0,u=c?"height":"width";if(!(!i||!s)){var h=B$(a.padding,t),d=Ry(i),f=l==="y"?On:_n,g=l==="y"?mr:fr,v=t.rects.reference[u]+t.rects.reference[l]-s[l]-t.rects.popper[u],C=s[l]-t.rects.reference[l],w=vc(i),T=w?l==="y"?w.clientHeight||0:w.clientWidth||0:0,S=v/2-C/2,O=h[f],k=T-d[u]-h[g],B=T/2-d[u]/2+S,D=Ec(O,B,k),V=l;t.modifiersData[r]=(e={},e[V]=D,e.centerOffset=D-B,e)}}function F$(n){var e=n.state,t=n.options,r=t.element,a=r===void 0?"[data-popper-arrow]":r;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||fN(e.elements.popper,a)&&(e.elements.arrow=a))}const V$={name:"arrow",enabled:!0,phase:"main",fn:U$,effect:F$,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Oo(n){return n.split("-")[1]}var z$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function W$(n,e){var t=n.x,r=n.y,a=e.devicePixelRatio||1;return{x:Ro(t*a)/a||0,y:Ro(r*a)/a||0}}function EN(n){var e,t=n.popper,r=n.popperRect,a=n.placement,i=n.variation,s=n.offsets,o=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,h=n.isFixed,d=s.x,f=d===void 0?0:d,g=s.y,v=g===void 0?0:g,C=typeof u=="function"?u({x:f,y:v}):{x:f,y:v};f=C.x,v=C.y;var w=s.hasOwnProperty("x"),T=s.hasOwnProperty("y"),S=_n,O=On,k=window;if(c){var B=vc(t),D="clientHeight",V="clientWidth";if(B===Wn(t)&&(B=Ei(t),qa(B).position!=="static"&&o==="absolute"&&(D="scrollHeight",V="scrollWidth")),B=B,a===On||(a===_n||a===fr)&&i===gc){O=mr;var q=h&&B===k&&k.visualViewport?k.visualViewport.height:B[D];v-=q-r.height,v*=l?1:-1}if(a===_n||(a===On||a===mr)&&i===gc){S=fr;var K=h&&B===k&&k.visualViewport?k.visualViewport.width:B[V];f-=K-r.width,f*=l?1:-1}}var I=Object.assign({position:o},c&&z$),G=u===!0?W$({x:f,y:v},Wn(t)):{x:f,y:v};if(f=G.x,v=G.y,l){var H;return Object.assign({},I,(H={},H[O]=T?"0":"",H[S]=w?"0":"",H.transform=(k.devicePixelRatio||1)<=1?"translate("+f+"px, "+v+"px)":"translate3d("+f+"px, "+v+"px, 0)",H))}return Object.assign({},I,(e={},e[O]=T?v+"px":"",e[S]=w?f+"px":"",e.transform="",e))}function H$(n){var e=n.state,t=n.options,r=t.gpuAcceleration,a=r===void 0?!0:r,i=t.adaptive,s=i===void 0?!0:i,o=t.roundOffsets,l=o===void 0?!0:o,c={placement:sa(e.placement),variation:Oo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,EN(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,EN(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const K$={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:H$,data:{}};var sd={passive:!0};function Q$(n){var e=n.state,t=n.instance,r=n.options,a=r.scroll,i=a===void 0?!0:a,s=r.resize,o=s===void 0?!0:s,l=Wn(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&c.forEach(function(u){u.addEventListener("scroll",t.update,sd)}),o&&l.addEventListener("resize",t.update,sd),function(){i&&c.forEach(function(u){u.removeEventListener("scroll",t.update,sd)}),o&&l.removeEventListener("resize",t.update,sd)}}const G$={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Q$,data:{}};var Y$={left:"right",right:"left",bottom:"top",top:"bottom"};function od(n){return n.replace(/left|right|bottom|top/g,function(e){return Y$[e]})}var J$={start:"end",end:"start"};function wN(n){return n.replace(/start|end/g,function(e){return J$[e]})}function Oy(n){var e=Wn(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function _y(n){return Mo(Ei(n)).left+Oy(n).scrollLeft}function X$(n,e){var t=Wn(n),r=Ei(n),a=t.visualViewport,i=r.clientWidth,s=r.clientHeight,o=0,l=0;if(a){i=a.width,s=a.height;var c=mN();(c||!c&&e==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:i,height:s,x:o+_y(n),y:l}}function Z$(n){var e,t=Ei(n),r=Oy(n),a=(e=n.ownerDocument)==null?void 0:e.body,i=cs(t.scrollWidth,t.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),s=cs(t.scrollHeight,t.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),o=-r.scrollLeft+_y(n),l=-r.scrollTop;return qa(a||t).direction==="rtl"&&(o+=cs(t.clientWidth,a?a.clientWidth:0)-i),{width:i,height:s,x:o,y:l}}function xy(n){var e=qa(n),t=e.overflow,r=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+a+r)}function TN(n){return["html","body","#document"].indexOf(ia(n))>=0?n.ownerDocument.body:yr(n)&&xy(n)?n:TN(id(n))}function wc(n,e){var t;e===void 0&&(e=[]);var r=TN(n),a=r===((t=n.ownerDocument)==null?void 0:t.body),i=Wn(r),s=a?[i].concat(i.visualViewport||[],xy(r)?r:[]):r,o=e.concat(s);return a?o:o.concat(wc(id(s)))}function Py(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function ek(n,e){var t=Mo(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function NN(n,e,t){return e===hN?Py(X$(n,t)):ls(e)?ek(e,t):Py(Z$(Ei(n)))}function tk(n){var e=wc(id(n)),t=["absolute","fixed"].indexOf(qa(n).position)>=0,r=t&&yr(n)?vc(n):n;return ls(r)?e.filter(function(a){return ls(a)&&fN(a,r)&&ia(a)!=="body"}):[]}function nk(n,e,t,r){var a=e==="clippingParents"?tk(n):[].concat(e),i=[].concat(a,[t]),s=i[0],o=i.reduce(function(l,c){var u=NN(n,c,r);return l.top=cs(u.top,l.top),l.right=ad(u.right,l.right),l.bottom=ad(u.bottom,l.bottom),l.left=cs(u.left,l.left),l},NN(n,s,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function CN(n){var e=n.reference,t=n.element,r=n.placement,a=r?sa(r):null,i=r?Oo(r):null,s=e.x+e.width/2-t.width/2,o=e.y+e.height/2-t.height/2,l;switch(a){case On:l={x:s,y:e.y-t.height};break;case mr:l={x:s,y:e.y+e.height};break;case fr:l={x:e.x+e.width,y:o};break;case _n:l={x:e.x-t.width,y:o};break;default:l={x:e.x,y:e.y}}var c=a?My(a):null;if(c!=null){var u=c==="y"?"height":"width";switch(i){case So:l[c]=l[c]-(e[u]/2-t[u]/2);break;case gc:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function Tc(n,e){e===void 0&&(e={});var t=e,r=t.placement,a=r===void 0?n.placement:r,i=t.strategy,s=i===void 0?n.strategy:i,o=t.boundary,l=o===void 0?T$:o,c=t.rootBoundary,u=c===void 0?hN:c,h=t.elementContext,d=h===void 0?bc:h,f=t.altBoundary,g=f===void 0?!1:f,v=t.padding,C=v===void 0?0:v,w=bN(typeof C!="number"?C:vN(C,yc)),T=d===bc?N$:bc,S=n.rects.popper,O=n.elements[g?T:d],k=nk(ls(O)?O:O.contextElement||Ei(n.elements.popper),l,u,s),B=Mo(n.elements.reference),D=CN({reference:B,element:S,strategy:"absolute",placement:a}),V=Py(Object.assign({},S,D)),q=d===bc?V:B,K={top:k.top-q.top+w.top,bottom:q.bottom-k.bottom+w.bottom,left:k.left-q.left+w.left,right:q.right-k.right+w.right},I=n.modifiersData.offset;if(d===bc&&I){var G=I[a];Object.keys(K).forEach(function(H){var se=[fr,mr].indexOf(H)>=0?1:-1,re=[On,mr].indexOf(H)>=0?"y":"x";K[H]+=G[re]*se})}return K}function rk(n,e){e===void 0&&(e={});var t=e,r=t.placement,a=t.boundary,i=t.rootBoundary,s=t.padding,o=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?pN:l,u=Oo(r),h=u?o?dN:dN.filter(function(g){return Oo(g)===u}):yc,d=h.filter(function(g){return c.indexOf(g)>=0});d.length===0&&(d=h);var f=d.reduce(function(g,v){return g[v]=Tc(n,{placement:v,boundary:a,rootBoundary:i,padding:s})[sa(v)],g},{});return Object.keys(f).sort(function(g,v){return f[g]-f[v]})}function ak(n){if(sa(n)===Cy)return[];var e=od(n);return[wN(n),e,wN(e)]}function ik(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var a=t.mainAxis,i=a===void 0?!0:a,s=t.altAxis,o=s===void 0?!0:s,l=t.fallbackPlacements,c=t.padding,u=t.boundary,h=t.rootBoundary,d=t.altBoundary,f=t.flipVariations,g=f===void 0?!0:f,v=t.allowedAutoPlacements,C=e.options.placement,w=sa(C),T=w===C,S=l||(T||!g?[od(C)]:ak(C)),O=[C].concat(S).reduce(function(xe,ke){return xe.concat(sa(ke)===Cy?rk(e,{placement:ke,boundary:u,rootBoundary:h,padding:c,flipVariations:g,allowedAutoPlacements:v}):ke)},[]),k=e.rects.reference,B=e.rects.popper,D=new Map,V=!0,q=O[0],K=0;K<O.length;K++){var I=O[K],G=sa(I),H=Oo(I)===So,se=[On,mr].indexOf(G)>=0,re=se?"width":"height",ue=Tc(e,{placement:I,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),Se=se?H?fr:_n:H?mr:On;k[re]>B[re]&&(Se=od(Se));var ie=od(Se),fe=[];if(i&&fe.push(ue[G]<=0),o&&fe.push(ue[Se]<=0,ue[ie]<=0),fe.every(function(xe){return xe})){q=I,V=!1;break}D.set(I,fe)}if(V)for(var Me=g?3:1,ge=function(xe){var ke=O.find(function(ze){var Ze=D.get(ze);if(Ze)return Ze.slice(0,xe).every(function(bt){return bt})});if(ke)return q=ke,"break"},ne=Me;ne>0;ne--){var Ye=ge(ne);if(Ye==="break")break}e.placement!==q&&(e.modifiersData[r]._skip=!0,e.placement=q,e.reset=!0)}}const sk={name:"flip",enabled:!0,phase:"main",fn:ik,requiresIfExists:["offset"],data:{_skip:!1}};function AN(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function SN(n){return[On,fr,mr,_n].some(function(e){return n[e]>=0})}function ok(n){var e=n.state,t=n.name,r=e.rects.reference,a=e.rects.popper,i=e.modifiersData.preventOverflow,s=Tc(e,{elementContext:"reference"}),o=Tc(e,{altBoundary:!0}),l=AN(s,r),c=AN(o,a,i),u=SN(l),h=SN(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const lk={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ok};function ck(n,e,t){var r=sa(n),a=[_n,On].indexOf(r)>=0?-1:1,i=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,s=i[0],o=i[1];return s=s||0,o=(o||0)*a,[_n,fr].indexOf(r)>=0?{x:o,y:s}:{x:s,y:o}}function uk(n){var e=n.state,t=n.options,r=n.name,a=t.offset,i=a===void 0?[0,0]:a,s=pN.reduce(function(u,h){return u[h]=ck(h,e.rects,i),u},{}),o=s[e.placement],l=o.x,c=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}const hk={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:uk};function dk(n){var e=n.state,t=n.name;e.modifiersData[t]=CN({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const pk={name:"popperOffsets",enabled:!0,phase:"read",fn:dk,data:{}};function mk(n){return n==="x"?"y":"x"}function fk(n){var e=n.state,t=n.options,r=n.name,a=t.mainAxis,i=a===void 0?!0:a,s=t.altAxis,o=s===void 0?!1:s,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,h=t.padding,d=t.tether,f=d===void 0?!0:d,g=t.tetherOffset,v=g===void 0?0:g,C=Tc(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),w=sa(e.placement),T=Oo(e.placement),S=!T,O=My(w),k=mk(O),B=e.modifiersData.popperOffsets,D=e.rects.reference,V=e.rects.popper,q=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,K=typeof q=="number"?{mainAxis:q,altAxis:q}:Object.assign({mainAxis:0,altAxis:0},q),I=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,G={x:0,y:0};if(B){if(i){var H,se=O==="y"?On:_n,re=O==="y"?mr:fr,ue=O==="y"?"height":"width",Se=B[O],ie=Se+C[se],fe=Se-C[re],Me=f?-V[ue]/2:0,ge=T===So?D[ue]:V[ue],ne=T===So?-V[ue]:-D[ue],Ye=e.elements.arrow,xe=f&&Ye?Ry(Ye):{width:0,height:0},ke=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:gN(),ze=ke[se],Ze=ke[re],bt=Ec(0,D[ue],xe[ue]),Rt=S?D[ue]/2-Me-bt-ze-K.mainAxis:ge-bt-ze-K.mainAxis,It=S?-D[ue]/2+Me+bt+Ze+K.mainAxis:ne+bt+Ze+K.mainAxis,Kt=e.elements.arrow&&vc(e.elements.arrow),dn=Kt?O==="y"?Kt.clientTop||0:Kt.clientLeft||0:0,Ae=(H=I==null?void 0:I[O])!=null?H:0,Ke=Se+Rt-Ae-dn,Qn=Se+It-Ae,jt=Ec(f?ad(ie,Ke):ie,Se,f?cs(fe,Qn):fe);B[O]=jt,G[O]=jt-Se}if(o){var tn,$r=O==="x"?On:_n,tt=O==="x"?mr:fr,Bt=B[k],Qt=k==="y"?"height":"width",st=Bt+C[$r],xn=Bt-C[tt],z=[On,_n].indexOf(w)!==-1,X=(tn=I==null?void 0:I[k])!=null?tn:0,te=z?st:Bt-D[Qt]-V[Qt]-X+K.altAxis,m=z?Bt+D[Qt]+V[Qt]-X-K.altAxis:xn,b=f&&z?j$(te,Bt,m):Ec(f?te:st,Bt,f?m:xn);B[k]=b,G[k]=b-Bt}e.modifiersData[r]=G}}const yk={name:"preventOverflow",enabled:!0,phase:"main",fn:fk,requiresIfExists:["offset"]};function gk(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function bk(n){return n===Wn(n)||!yr(n)?Oy(n):gk(n)}function vk(n){var e=n.getBoundingClientRect(),t=Ro(e.width)/n.offsetWidth||1,r=Ro(e.height)/n.offsetHeight||1;return t!==1||r!==1}function Ek(n,e,t){t===void 0&&(t=!1);var r=yr(e),a=yr(e)&&vk(e),i=Ei(e),s=Mo(n,a,t),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((ia(e)!=="body"||xy(i))&&(o=bk(e)),yr(e)?(l=Mo(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):i&&(l.x=_y(i))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function wk(n){var e=new Map,t=new Set,r=[];n.forEach(function(i){e.set(i.name,i)});function a(i){t.add(i.name);var s=[].concat(i.requires||[],i.requiresIfExists||[]);s.forEach(function(o){if(!t.has(o)){var l=e.get(o);l&&a(l)}}),r.push(i)}return n.forEach(function(i){t.has(i.name)||a(i)}),r}function Tk(n){var e=wk(n);return I$.reduce(function(t,r){return t.concat(e.filter(function(a){return a.phase===r}))},[])}function Nk(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Ck(n){var e=n.reduce(function(t,r){var a=t[r.name];return t[r.name]=a?Object.assign({},a,r,{options:Object.assign({},a.options,r.options),data:Object.assign({},a.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var RN={placement:"bottom",modifiers:[],strategy:"absolute"};function MN(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Ak(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,a=e.defaultOptions,i=a===void 0?RN:a;return function(s,o,l){l===void 0&&(l=i);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},RN,i),modifiersData:{},elements:{reference:s,popper:o},attributes:{},styles:{}},u=[],h=!1,d={state:c,setOptions:function(v){var C=typeof v=="function"?v(c.options):v;g(),c.options=Object.assign({},i,c.options,C),c.scrollParents={reference:ls(s)?wc(s):s.contextElement?wc(s.contextElement):[],popper:wc(o)};var w=Tk(Ck([].concat(r,c.options.modifiers)));return c.orderedModifiers=w.filter(function(T){return T.enabled}),f(),d.update()},forceUpdate:function(){if(!h){var v=c.elements,C=v.reference,w=v.popper;if(MN(C,w)){c.rects={reference:Ek(C,vc(w),c.options.strategy==="fixed"),popper:Ry(w)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(V){return c.modifiersData[V.name]=Object.assign({},V.data)});for(var T=0;T<c.orderedModifiers.length;T++){if(c.reset===!0){c.reset=!1,T=-1;continue}var S=c.orderedModifiers[T],O=S.fn,k=S.options,B=k===void 0?{}:k,D=S.name;typeof O=="function"&&(c=O({state:c,options:B,name:D,instance:d})||c)}}}},update:Nk(function(){return new Promise(function(v){d.forceUpdate(),v(c)})}),destroy:function(){g(),h=!0}};if(!MN(s,o))return d;d.setOptions(l).then(function(v){!h&&l.onFirstUpdate&&l.onFirstUpdate(v)});function f(){c.orderedModifiers.forEach(function(v){var C=v.name,w=v.options,T=w===void 0?{}:w,S=v.effect;if(typeof S=="function"){var O=S({state:c,name:C,instance:d,options:T}),k=function(){};u.push(O||k)}})}function g(){u.forEach(function(v){return v()}),u=[]}return d}}var Sk=[G$,pk,K$,q$,hk,sk,yk,V$,lk],Rk=Ak({defaultModifiers:Sk}),Mk=typeof Element<"u",Ok=typeof Map=="function",_k=typeof Set=="function",xk=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function ld(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){if(n.constructor!==e.constructor)return!1;var t,r,a;if(Array.isArray(n)){if(t=n.length,t!=e.length)return!1;for(r=t;r--!==0;)if(!ld(n[r],e[r]))return!1;return!0}var i;if(Ok&&n instanceof Map&&e instanceof Map){if(n.size!==e.size)return!1;for(i=n.entries();!(r=i.next()).done;)if(!e.has(r.value[0]))return!1;for(i=n.entries();!(r=i.next()).done;)if(!ld(r.value[1],e.get(r.value[0])))return!1;return!0}if(_k&&n instanceof Set&&e instanceof Set){if(n.size!==e.size)return!1;for(i=n.entries();!(r=i.next()).done;)if(!e.has(r.value[0]))return!1;return!0}if(xk&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(e)){if(t=n.length,t!=e.length)return!1;for(r=t;r--!==0;)if(n[r]!==e[r])return!1;return!0}if(n.constructor===RegExp)return n.source===e.source&&n.flags===e.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof e.valueOf=="function")return n.valueOf()===e.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof e.toString=="function")return n.toString()===e.toString();if(a=Object.keys(n),t=a.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,a[r]))return!1;if(Mk&&n instanceof Element)return!1;for(r=t;r--!==0;)if(!((a[r]==="_owner"||a[r]==="__v"||a[r]==="__o")&&n.$$typeof)&&!ld(n[a[r]],e[a[r]]))return!1;return!0}return n!==n&&e!==e}var Pk=function(n,e){try{return ld(n,e)}catch(t){if((t.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw t}};const Ik=Mi(Pk);var Dk=[],Lk=function(n,e,t){t===void 0&&(t={});var r=ye.useRef(null),a={onFirstUpdate:t.onFirstUpdate,placement:t.placement||"bottom",strategy:t.strategy||"absolute",modifiers:t.modifiers||Dk},i=ye.useState({styles:{popper:{position:a.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=i[0],o=i[1],l=ye.useMemo(function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(h){var d=h.state,f=Object.keys(d.elements);Rl.flushSync(function(){o({styles:cN(f.map(function(g){return[g,d.styles[g]||{}]})),attributes:cN(f.map(function(g){return[g,d.attributes[g]]}))})})},requires:["computeStyles"]}},[]),c=ye.useMemo(function(){var h={onFirstUpdate:a.onFirstUpdate,placement:a.placement,strategy:a.strategy,modifiers:[].concat(a.modifiers,[l,{name:"applyStyles",enabled:!1}])};return Ik(r.current,h)?r.current||h:(r.current=h,h)},[a.onFirstUpdate,a.placement,a.strategy,a.modifiers,l]),u=ye.useRef();return uN(function(){u.current&&u.current.setOptions(c)},[c]),uN(function(){if(!(n==null||e==null)){var h=t.createPopper||Rk,d=h(n,e,c);return u.current=d,function(){d.destroy(),u.current=null}}},[n,e,t.createPopper]),{state:u.current?u.current.state:null,styles:s.styles,attributes:s.attributes,update:u.current?u.current.update:null,forceUpdate:u.current?u.current.forceUpdate:null}},qk=function(){},$k=function(){return Promise.resolve(null)},kk=[];function jk(n){var e=n.placement,t=e===void 0?"bottom":e,r=n.strategy,a=r===void 0?"absolute":r,i=n.modifiers,s=i===void 0?kk:i,o=n.referenceElement,l=n.onFirstUpdate,c=n.innerRef,u=n.children,h=ye.useContext(b$),d=ye.useState(null),f=d[0],g=d[1],v=ye.useState(null),C=v[0],w=v[1];ye.useEffect(function(){w$(c,f)},[c,f]);var T=ye.useMemo(function(){return{placement:t,strategy:a,onFirstUpdate:l,modifiers:[].concat(s,[{name:"arrow",enabled:C!=null,options:{element:C}}])}},[t,a,l,s,C]),S=Lk(o||h,f,T),O=S.state,k=S.styles,B=S.forceUpdate,D=S.update,V=ye.useMemo(function(){return{ref:g,style:k.popper,placement:O?O.placement:t,hasPopperEscaped:O&&O.modifiersData.hide?O.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:O&&O.modifiersData.hide?O.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:k.arrow,ref:w},forceUpdate:B||qk,update:D||$k}},[g,w,t,O,k,D,B]);return v$(u)(V)}function Bk(n,e,t,r){return O0(n,function(a,i,s){e(r,t(a),i,s)}),r}function Uk(n,e){return function(t,r){return Bk(t,n,e(r),{})}}var Fk=Object.prototype,Vk=Fk.toString,zk=Uk(function(n,e,t){e!=null&&typeof e.toString!="function"&&(e=Vk.call(e)),n[e]=t},m0(lo)),Iy={"top center":"top","top left":"top-start","top right":"top-end","bottom center":"bottom","bottom left":"bottom-start","bottom right":"bottom-end","right center":"right","left center":"left"};uo(Iy);var Wk=zk(Iy),Hk=function(){function n(t){this.ref=t}var e=n.prototype;return e.getBoundingClientRect=function(){return be(this.ref.current,"getBoundingClientRect")||{}},BM(n,[{key:"clientWidth",get:function(){return this.getBoundingClientRect().width}},{key:"clientHeight",get:function(){return this.getBoundingClientRect().height}},{key:"parentNode",get:function(){return this.ref.current?this.ref.current.parentNode:void 0}},{key:"contextElement",get:function(){return this.ref.current}}]),n}(),Kk=kh(function(n){return new Hk(vx(n)?n:{current:n})});const Qk=Kk;function wi(n){var e=n.children,t=n.className,r=n.content,a=Re("content",t),i=De(wi,n),s=$e(wi,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}wi.handledProps=["as","children","className","content"],wi.propTypes={},wi.create=at(wi,function(n){return{children:n}});function Ti(n){var e=n.children,t=n.className,r=n.content,a=Re("header",t),i=De(Ti,n),s=$e(Ti,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}Ti.handledProps=["as","children","className","content"],Ti.propTypes={},Ti.create=at(Ti,function(n){return{children:n}});var Ni=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.state={},r.open=!1,r.zIndexWasSynced=!1,r.triggerRef=Y.createRef(),r.elementRef=Y.createRef(),r.getPortalProps=function(){var o={},l=r.props,c=l.on,u=l.hoverable,h=xt(c)?c:[c];return u&&(o.closeOnPortalMouseLeave=!0,o.mouseLeaveDelay=300),xa(h,"hover")&&(o.openOnTriggerClick=!1,o.closeOnTriggerClick=!1,o.openOnTriggerMouseEnter=!0,o.closeOnTriggerMouseLeave=!0,o.mouseLeaveDelay=70,o.mouseEnterDelay=50),xa(h,"click")&&(o.openOnTriggerClick=!0,o.closeOnTriggerClick=!0,o.closeOnDocumentClick=!0),xa(h,"focus")&&(o.openOnTriggerFocus=!0,o.closeOnTriggerBlur=!0),o},r.hideOnScroll=function(o){g$(o.target)&&r.elementRef.current.contains(o.target)||(r.setState({closed:!0}),Ir.unsub("scroll",r.hideOnScroll,{target:window}),r.timeoutId=setTimeout(function(){r.setState({closed:!1})},50),r.handleClose(o))},r.handleClose=function(o){be(r.props,"onClose",o,Z({},r.props,{open:!1}))},r.handleOpen=function(o){be(r.props,"onOpen",o,Z({},r.props,{open:!0}))},r.handlePortalMount=function(o){be(r.props,"onMount",o,r.props)},r.handlePortalUnmount=function(o){r.positionUpdate=null,be(r.props,"onUnmount",o,r.props)},r.renderContent=function(o){var l=o.placement,c=o.ref,u=o.update,h=o.style,d=r.props,f=d.basic,g=d.children,v=d.className,C=d.content,w=d.hideOnScroll,T=d.flowing,S=d.header,O=d.inverted,k=d.popper,B=d.size,D=d.style,V=d.wide,q=r.state.contentRestProps;r.positionUpdate=u;var K=Re("ui",Wk[l],B,gt(V,"wide"),U(f,"basic"),U(T,"flowing"),U(O,"inverted"),"popup transition visible",v),I=$e(e,r.props),G=Z({left:"auto",right:"auto",position:"initial"},D),H=Y.createElement(I,Z({},q,{className:K,style:G,ref:r.elementRef}),Fe(g)?Y.createElement(Y.Fragment,null,Ti.create(S,{autoGenerateKey:!1}),wi.create(C,{autoGenerateKey:!1})):g,w&&Y.createElement(_a,{on:r.hideOnScroll,name:"scroll",target:"window"}));return m2(k||{},{overrideProps:{children:H,ref:c,style:Z({display:"flex"},h)}})},r}e.getDerivedStateFromProps=function(r,a){if(a.closed||a.disabled)return{};var i=De(e,r),s=Ey(i,function(l,c,u){return xa(rd.handledProps,u)||(l[u]=c),l},{}),o=pT(i,rd.handledProps);return{contentRestProps:s,portalRestProps:o}};var t=e.prototype;return t.componentDidUpdate=function(r){var a=ns(this.props.popperDependencies,r.popperDependencies);a||this.handleUpdate()},t.componentWillUnmount=function(){clearTimeout(this.timeoutId)},t.handleUpdate=function(){this.positionUpdate&&this.positionUpdate()},t.render=function(){var r=this,a=this.props,i=a.context,s=a.disabled,o=a.eventsEnabled,l=a.offset,c=a.pinned,u=a.popper,h=a.popperModifiers,d=a.position,f=a.positionFixed,g=a.trigger,v=this.state,C=v.closed,w=v.portalRestProps;if(C||s)return g;var T=[{name:"arrow",enabled:!1},{name:"eventListeners",options:{scroll:!!o,resize:!!o}},{name:"flip",enabled:!c},{name:"preventOverflow",enabled:!!l},{name:"offset",enabled:!!l,options:{offset:l}}].concat(h,[{name:"syncZIndex",enabled:!0,phase:"beforeRead",fn:function(k){var B,D=k.state;if(!r.zIndexWasSynced){var V=u==null||(B=u.style)==null?void 0:B.zIndex;Yl(V)&&(D.elements.popper.style.zIndex=window.getComputedStyle(D.elements.popper.firstChild).zIndex),r.zIndexWasSynced=!0}},effect:function(){return function(){r.zIndexWasSynced=!1}}}]),S=Qk(Ge(i)?this.triggerRef:i),O=Z({},this.getPortalProps(),w);return Y.createElement(rd,Z({},O,{onClose:this.handleClose,onMount:this.handlePortalMount,onOpen:this.handleOpen,onUnmount:this.handlePortalUnmount,trigger:g,triggerRef:this.triggerRef}),Y.createElement(jk,{modifiers:T,placement:Iy[d],strategy:f?"fixed":null,referenceElement:S},this.renderContent))},e}(ye.Component);Ni.handledProps=["as","basic","children","className","content","context","disabled","eventsEnabled","flowing","header","hideOnScroll","hoverable","inverted","offset","on","onClose","onMount","onOpen","onUnmount","pinned","popper","popperDependencies","popperModifiers","position","positionFixed","size","style","trigger","wide"],Ni.propTypes={},Ni.defaultProps={disabled:!1,eventsEnabled:!0,on:["click","hover"],pinned:!1,popperModifiers:[],position:"top left"},Ni.Content=wi,Ni.Header=Ti;var cd=Zl&&new Zl,ON=cd?function(n,e){return cd.set(n,e),n}:lo;function Nc(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=yy(n.prototype),r=n.apply(t,e);return ra(r)?r:t}}var Gk=1;function Yk(n,e,t){var r=e&Gk,a=Nc(n);function i(){var s=this&&this!==Un&&this instanceof i?a:n;return s.apply(r?t:this,arguments)}return i}var Jk=Math.max;function _N(n,e,t,r){for(var a=-1,i=n.length,s=t.length,o=-1,l=e.length,c=Jk(i-s,0),u=Array(l+c),h=!r;++o<l;)u[o]=e[o];for(;++a<s;)(h||a<i)&&(u[t[a]]=n[a]);for(;c--;)u[o++]=n[a++];return u}var Xk=Math.max;function xN(n,e,t,r){for(var a=-1,i=n.length,s=-1,o=t.length,l=-1,c=e.length,u=Xk(i-o,0),h=Array(u+c),d=!r;++a<u;)h[a]=n[a];for(var f=a;++l<c;)h[f+l]=e[l];for(;++s<o;)(d||a<i)&&(h[f+t[s]]=n[a++]);return h}function Zk(n,e){for(var t=n.length,r=0;t--;)n[t]===e&&++r;return r}function Dy(){}var ej=4294967295;function _o(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ej,this.__views__=[]}_o.prototype=yy(Dy.prototype),_o.prototype.constructor=_o;var PN=cd?function(n){return cd.get(n)}:hy,IN={},tj=Object.prototype,nj=tj.hasOwnProperty;function rj(n){for(var e=n.name+"",t=IN[e],r=nj.call(IN,e)?t.length:0;r--;){var a=t[r],i=a.func;if(i==null||i==n)return a.name}return e}function xo(n,e){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}xo.prototype=yy(Dy.prototype),xo.prototype.constructor=xo;function DN(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}function aj(n){if(n instanceof _o)return n.clone();var e=new xo(n.__wrapped__,n.__chain__);return e.__actions__=DN(n.__actions__),e.__index__=n.__index__,e.__values__=n.__values__,e}var ij=Object.prototype,sj=ij.hasOwnProperty;function ud(n){if(Fn(n)&&!xt(n)&&!(n instanceof _o)){if(n instanceof xo)return n;if(sj.call(n,"__wrapped__"))return aj(n)}return new xo(n)}ud.prototype=Dy.prototype,ud.prototype.constructor=ud;function oj(n){var e=rj(n),t=ud[e];if(typeof t!="function"||!(e in _o.prototype))return!1;if(n===t)return!0;var r=PN(t);return!!r&&n===r[0]}var LN=f0(ON),lj=/\{\n\/\* \[wrapped with (.+)\] \*/,cj=/,? & /;function uj(n){var e=n.match(lj);return e?e[1].split(cj):[]}var hj=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function dj(n,e){var t=e.length;if(!t)return n;var r=t-1;return e[r]=(t>1?"& ":"")+e[r],e=e.join(t>2?", ":" "),n.replace(hj,`{
/* [wrapped with `+e+`] */
`)}var pj=1,mj=2,fj=8,yj=16,gj=32,bj=64,vj=128,Ej=256,wj=512,Tj=[["ary",vj],["bind",pj],["bindKey",mj],["curry",fj],["curryRight",yj],["flip",wj],["partial",gj],["partialRight",bj],["rearg",Ej]];function Nj(n,e){return Z0(Tj,function(t){var r="_."+t[0];e&t[1]&&!Zf(n,r)&&n.push(r)}),n.sort()}function qN(n,e,t){var r=e+"";return zf(n,dj(r,Nj(uj(r),t)))}var Cj=1,Aj=2,Sj=4,Rj=8,$N=32,kN=64;function jN(n,e,t,r,a,i,s,o,l,c){var u=e&Rj,h=u?s:void 0,d=u?void 0:s,f=u?i:void 0,g=u?void 0:i;e|=u?$N:kN,e&=~(u?kN:$N),e&Sj||(e&=~(Cj|Aj));var v=[n,e,a,f,h,g,d,o,l,c],C=t.apply(void 0,v);return oj(n)&&LN(C,v),C.placeholder=r,qN(C,n,e)}function Ly(n){var e=n;return e.placeholder}var Mj=Math.min;function Oj(n,e){for(var t=n.length,r=Mj(e.length,t),a=DN(n);r--;){var i=e[r];n[r]=Ql(i,t)?a[i]:void 0}return n}var BN="__lodash_placeholder__";function Cc(n,e){for(var t=-1,r=n.length,a=0,i=[];++t<r;){var s=n[t];(s===e||s===BN)&&(n[t]=BN,i[a++]=t)}return i}var _j=1,xj=2,Pj=8,Ij=16,Dj=128,Lj=512;function qy(n,e,t,r,a,i,s,o,l,c){var u=e&Dj,h=e&_j,d=e&xj,f=e&(Pj|Ij),g=e&Lj,v=d?void 0:Nc(n);function C(){for(var w=arguments.length,T=Array(w),S=w;S--;)T[S]=arguments[S];if(f)var O=Ly(C),k=Zk(T,O);if(r&&(T=_N(T,r,a,f)),i&&(T=xN(T,i,s,f)),w-=k,f&&w<c){var B=Cc(T,O);return jN(n,e,qy,C.placeholder,t,T,B,o,l,c-w)}var D=h?t:this,V=d?D[n]:n;return w=T.length,o?T=Oj(T,o):g&&w>1&&T.reverse(),u&&l<w&&(T.length=l),this&&this!==Un&&this instanceof C&&(V=v||Nc(V)),V.apply(D,T)}return C}function qj(n,e,t){var r=Nc(n);function a(){for(var i=arguments.length,s=Array(i),o=i,l=Ly(a);o--;)s[o]=arguments[o];var c=i<3&&s[0]!==l&&s[i-1]!==l?[]:Cc(s,l);if(i-=c.length,i<t)return jN(n,e,qy,a.placeholder,void 0,s,c,void 0,void 0,t-i);var u=this&&this!==Un&&this instanceof a?r:n;return Uh(u,this,s)}return a}var $j=1;function kj(n,e,t,r){var a=e&$j,i=Nc(n);function s(){for(var o=-1,l=arguments.length,c=-1,u=r.length,h=Array(u+l),d=this&&this!==Un&&this instanceof s?i:n;++c<u;)h[c]=r[c];for(;l--;)h[c++]=arguments[++o];return Uh(d,a?t:this,h)}return s}var UN="__lodash_placeholder__",$y=1,jj=2,Bj=4,FN=8,Ac=128,VN=256,Uj=Math.min;function Fj(n,e){var t=n[1],r=e[1],a=t|r,i=a<($y|jj|Ac),s=r==Ac&&t==FN||r==Ac&&t==VN&&n[7].length<=e[8]||r==(Ac|VN)&&e[7].length<=e[8]&&t==FN;if(!(i||s))return n;r&$y&&(n[2]=e[2],a|=t&$y?0:Bj);var o=e[3];if(o){var l=n[3];n[3]=l?_N(l,o,e[4]):o,n[4]=l?Cc(n[3],UN):e[4]}return o=e[5],o&&(l=n[5],n[5]=l?xN(l,o,e[6]):o,n[6]=l?Cc(n[5],UN):e[6]),o=e[7],o&&(n[7]=o),r&Ac&&(n[8]=n[8]==null?e[8]:Uj(n[8],e[8])),n[9]==null&&(n[9]=e[9]),n[0]=e[0],n[1]=a,n}var Vj="Expected a function",zN=1,zj=2,ky=8,jy=16,By=32,WN=64,HN=Math.max;function Wj(n,e,t,r,a,i,s,o){var l=e&zj;if(!l&&typeof n!="function")throw new TypeError(Vj);var c=r?r.length:0;if(c||(e&=~(By|WN),r=a=void 0),s=s===void 0?s:HN(Jl(s),0),o=o===void 0?o:Jl(o),c-=a?a.length:0,e&WN){var u=r,h=a;r=a=void 0}var d=l?void 0:PN(n),f=[n,e,t,r,a,u,h,i,s,o];if(d&&Fj(f,d),n=f[0],e=f[1],t=f[2],r=f[3],a=f[4],o=f[9]=f[9]===void 0?l?0:n.length:HN(f[9]-c,0),!o&&e&(ky|jy)&&(e&=~(ky|jy)),!e||e==zN)var g=Yk(n,e,t);else e==ky||e==jy?g=qj(n,e,o):(e==By||e==(zN|By))&&!a.length?g=kj(n,e,t,r):g=qy.apply(void 0,f);var v=d?ON:LN;return qN(v(g,f),n,e)}var Hj=64,Uy=Gl(function(n,e){var t=Cc(e,Ly(Uy));return Wj(n,Hj,void 0,e,t)});Uy.placeholder={};const Kj=Uy;function Fy(n){var e=n.categoryContent,t=n.resultsContent;return Y.createElement(Y.Fragment,null,Y.createElement("div",{className:"name"},e),Y.createElement("div",{className:"results"},t))}Fy.handledProps=["categoryContent","resultsContent"],Fy.propTypes={};function us(n){var e=n.active,t=n.children,r=n.className,a=n.content,i=n.layoutRenderer,s=n.renderer,o=Re(U(e,"active"),"category",r),l=De(us,n),c=$e(us,n),u=s(n),h=Fe(t)?a:t;return Y.createElement(c,Z({},l,{className:o}),i({categoryContent:u,resultsContent:h}))}us.handledProps=["active","as","children","className","content","layoutRenderer","name","renderer","results"],us.defaultProps={layoutRenderer:Fy,renderer:function(n){var e=n.name;return e}},us.propTypes={};var KN=function(n){var e=n.image,t=n.price,r=n.title,a=n.description;return[e&&Y.createElement("div",{key:"image",className:"image"},f2(e,{autoGenerateKey:!1})),Y.createElement("div",{key:"content",className:"content"},t&&Y.createElement("div",{className:"price"},t),r&&Y.createElement("div",{className:"title"},r),a&&Y.createElement("div",{className:"description"},a))]};KN.handledProps=[];var Sc=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleClick=function(o){var l=r.props.onClick;l&&l(o,r.props)},r}var t=e.prototype;return t.render=function(){var r=this.props,a=r.active,i=r.className,s=r.renderer,o=Re(U(a,"active"),"result",i),l=De(e,this.props),c=$e(e,this.props);return Y.createElement(c,Z({},l,{className:o,onClick:this.handleClick}),s(this.props))},e}(ye.Component);Sc.handledProps=["active","as","className","content","description","id","image","onClick","price","renderer","title"],Sc.propTypes={},Sc.defaultProps={renderer:KN};function Po(n){var e=n.children,t=n.className,r=n.content,a=Re("results transition",t),i=De(Po,n),s=$e(Po,n);return Y.createElement(s,Z({},i,{className:a}),Fe(e)?r:e)}Po.handledProps=["as","children","className","content"],Po.propTypes={};var Qj=function(n){var e=n.input;return Yl(e)?Z({},n,{input:{className:"prompt"}}):iy(e)?Z({},n,{input:Z({},e,{className:Re(e.className,"prompt")})}):n},Ci=function(n){yt(e,n);function e(){for(var r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r=n.call.apply(n,[this].concat(i))||this,r.handleResultSelect=function(o,l){be(r.props,"onResultSelect",o,Z({},r.props,{result:l}))},r.handleSelectionChange=function(o){var l=r.getSelectedResult();be(r.props,"onSelectionChange",o,Z({},r.props,{result:l}))},r.closeOnEscape=function(o){it.getCode(o)===it.Escape&&(o.preventDefault(),r.close())},r.moveSelectionOnKeyDown=function(o){switch(it.getCode(o)){case it.ArrowDown:o.preventDefault(),r.moveSelectionBy(o,1);break;case it.ArrowUp:o.preventDefault(),r.moveSelectionBy(o,-1);break}},r.selectItemOnEnter=function(o){if(it.getCode(o)===it.Enter){var l=r.getSelectedResult();l&&(o.preventDefault(),r.setValue(l.title),r.handleResultSelect(o,l),r.close())}},r.closeOnDocumentClick=function(o){r.close()},r.handleMouseDown=function(o){r.isMouseDown=!0,be(r.props,"onMouseDown",o,r.props),Ir.sub("mouseup",r.handleDocumentMouseUp)},r.handleDocumentMouseUp=function(){r.isMouseDown=!1,Ir.unsub("mouseup",r.handleDocumentMouseUp)},r.handleInputClick=function(o){o.nativeEvent.stopImmediatePropagation(),r.tryOpen()},r.handleItemClick=function(o,l){var c=l.id,u=r.getSelectedResult(c);o.nativeEvent.stopImmediatePropagation(),r.setValue(u.title),r.handleResultSelect(o,u),r.close()},r.handleItemMouseDown=function(o){o.preventDefault()},r.handleFocus=function(o){be(r.props,"onFocus",o,r.props),r.setState({focus:!0})},r.handleBlur=function(o){be(r.props,"onBlur",o,r.props),r.setState({focus:!1})},r.handleSearchChange=function(o){o.stopPropagation();var l=r.props.minCharacters,c=r.state.open,u=o.target.value;be(r.props,"onSearchChange",o,Z({},r.props,{value:u})),u.length<l?r.close():c||r.tryOpen(u),r.setValue(u)},r.getFlattenedResults=function(){var o=r.props,l=o.category,c=o.results;return l?Ey(c,function(u,h){return u.concat(h.results)},[]):c},r.getSelectedResult=function(o){o===void 0&&(o=r.state.selectedIndex);var l=r.getFlattenedResults();return hi(l,o)},r.setValue=function(o){var l=r.props.selectFirstResult;r.setState({value:o,selectedIndex:l?0:-1})},r.moveSelectionBy=function(o,l){var c=r.state.selectedIndex,u=r.getFlattenedResults(),h=u.length-1,d=c+l;d>h?d=0:d<0&&(d=h),r.setState({selectedIndex:d}),r.scrollSelectedItemIntoView(),r.handleSelectionChange(o)},r.scrollSelectedItemIntoView=function(){if(Zh()){var o=document.querySelector(".ui.search.active.visible .results.visible");if(o){var l=o.querySelector(".result.active");if(l){var c=l.offsetTop<o.scrollTop,u=l.offsetTop+l.clientHeight>o.scrollTop+o.clientHeight;c?o.scrollTop=l.offsetTop:u&&(o.scrollTop=l.offsetTop+l.clientHeight-o.clientHeight)}}}},r.tryOpen=function(o){o===void 0&&(o=r.state.value);var l=r.props.minCharacters;o.length<l||r.open()},r.open=function(){r.setState({open:!0})},r.close=function(){r.setState({open:!1})},r.renderSearchInput=function(o){var l=r.props,c=l.icon,u=l.input,h=l.placeholder,d=r.state.value;return Co.create(u,{autoGenerateKey:!1,defaultProps:Z({},o,{autoComplete:"off",icon:c,onChange:r.handleSearchChange,onClick:r.handleInputClick,tabIndex:"0",value:d,placeholder:h}),overrideProps:Qj})},r.renderNoResults=function(){var o=r.props,l=o.noResultsDescription,c=o.noResultsMessage;return Y.createElement("div",{className:"message empty"},Y.createElement("div",{className:"header"},c),l&&Y.createElement("div",{className:"description"},l))},r.renderResult=function(o,l,c,u){var h=o.childKey,d=qf(o,["childKey"]);u===void 0&&(u=0);var f=r.props.resultRenderer,g=r.state.selectedIndex,v=l+u;return Y.createElement(Sc,Z({key:h??(d.id||d.title),active:g===v,onClick:r.handleItemClick,onMouseDown:r.handleItemMouseDown,renderer:f},d,{id:v}))},r.renderResults=function(){var o=r.props.results;return Vn(o,r.renderResult)},r.renderCategories=function(){var o=r.props,l=o.categoryLayoutRenderer,c=o.categoryRenderer,u=o.results,h=r.state.selectedIndex,d=0;return Vn(u,function(f){var g=f.childKey,v=qf(f,["childKey"]),C=Z({key:g??v.name,active:fy(h,d,d+v.results.length),layoutRenderer:l,renderer:c},v),w=Kj(r.renderResult,d);return d+=v.results.length,Y.createElement(us,C,v.results.map(w))})},r.renderMenuContent=function(){var o=r.props,l=o.category,c=o.showNoResults,u=o.results;return ec(u)?c?r.renderNoResults():null:l?r.renderCategories():r.renderResults()},r.renderResultsMenu=function(){var o=r.state.open,l=o?"visible":"",c=r.renderMenuContent();if(c)return Y.createElement(Po,{className:l},c)},r}e.getAutoControlledStateFromProps=function(r,a){if(typeof a.prevValue<"u"&&ns(a.prevValue,a.value))return{prevValue:a.value};var i=r.selectFirstResult?0:-1;return{prevValue:a.value,selectedIndex:i}};var t=e.prototype;return t.shouldComponentUpdate=function(r,a){return!ns(r,this.props)||!ns(a,this.state)},t.componentDidUpdate=function(r,a){!a.focus&&this.state.focus?(this.isMouseDown||this.tryOpen(),this.state.open&&Ir.sub("keydown",[this.moveSelectionOnKeyDown,this.selectItemOnEnter])):a.focus&&!this.state.focus&&(this.isMouseDown||this.close(),Ir.unsub("keydown",[this.moveSelectionOnKeyDown,this.selectItemOnEnter])),!a.open&&this.state.open?(this.open(),Ir.sub("click",this.closeOnDocumentClick),Ir.sub("keydown",[this.closeOnEscape,this.moveSelectionOnKeyDown,this.selectItemOnEnter])):a.open&&!this.state.open&&(this.close(),Ir.unsub("click",this.closeOnDocumentClick),Ir.unsub("keydown",[this.closeOnEscape,this.moveSelectionOnKeyDown,this.selectItemOnEnter]))},t.componentWillUnmount=function(){Ir.unsub("click",this.closeOnDocumentClick),Ir.unsub("keydown",[this.closeOnEscape,this.moveSelectionOnKeyDown,this.selectItemOnEnter])},t.render=function(){var r=this.state,a=r.searchClasses,i=r.focus,s=r.open,o=this.props,l=o.aligned,c=o.category,u=o.className,h=o.fluid,d=o.loading,f=o.size,g=Re("ui",s&&"active visible",f,a,U(c,"category"),U(i,"focus"),U(h,"fluid"),U(d,"loading"),hn(l,"aligned"),"search",u),v=De(e,this.props),C=$e(e,this.props),w=Xh(v,{htmlProps:my}),T=w[0],S=w[1];return Y.createElement(C,Z({},S,{className:g,onBlur:this.handleBlur,onFocus:this.handleFocus,onMouseDown:this.handleMouseDown}),this.renderSearchInput(T),this.renderResultsMenu())},e}(fo);Ci.handledProps=["aligned","as","category","categoryLayoutRenderer","categoryRenderer","className","defaultOpen","defaultValue","fluid","icon","input","loading","minCharacters","noResultsDescription","noResultsMessage","onBlur","onFocus","onMouseDown","onResultSelect","onSearchChange","onSelectionChange","open","placeholder","resultRenderer","results","selectFirstResult","showNoResults","size","value"],Ci.propTypes={},Ci.defaultProps={icon:"search",input:"text",minCharacters:1,noResultsMessage:"No results found.",showNoResults:!0},Ci.autoControlledProps=["open","value"],Ci.Category=us,Ci.Result=Sc,Ci.Results=Po;function Gj(){return j.jsxs(j.Fragment,{children:[j.jsx(La,{size:"large",children:"CoolMikeHatsune22 - List of Translations"}),j.jsxs(ss,{children:[j.jsx(yi,{href:"https://coolmikehatsune22.wordpress.com/",title:"Back to Wordpress",children:"Home"}),j.jsx(Ia,{icon:"right chevron"}),j.jsx(yi,{link:!0,active:!0,children:"List of Translations"})]}),j.jsx("hr",{})]})}function Yj({showEnglish:n,dispatchSearchSongs:e,stateFilterOptions:t}){const{songs:r,isLoading:a}=Ks(o=>o.search),[i,s]=t;return ye.useEffect(()=>{r&&r.length===0?s({...i,ids:null,synths:null,producers:null,vocalists:null,circles:null,page:1}):s({...i,ids:r.map(o=>o.id),synths:null,producers:null,vocalists:null,circles:null,page:1})},[r]),j.jsx(Ci,{className:"search-bar",loading:a,fluid:!0,placeholder:"Search...",onSearchChange:(o,l)=>{e(l.value)},onResultSelect:(o,l)=>{var c;e((c=l==null?void 0:l.result)==null?void 0:c.title)},results:r.slice(0,5).map(o=>{let l,c;return n?(l=o.engTitle||o.orgTitle,c=o.engTitle?`${o.orgTitle}${o.romTitle?` (${o.romTitle})`:""}`:null):(l=o.orgTitle,c=o.engTitle?`${o.engTitle}${o.romTitle?` (${o.romTitle})`:""}`:null),{title:l,description:c}})})}function hd({value:n,field:e,options:t,placeholder:r,stateFilterOptions:a,showEnglish:i}){const[s,o]=a,l=u=>{var w;let h=i&&u.loclName||u.origName,d=i?u.loclName?u.origName:"":u.loclName||"",f=((w=u==null?void 0:u.aliases)==null?void 0:w.join(", "))||"",g=`${d}${d===""||f===""?"":", "}${f}`,v=j.jsxs("div",{children:[h,j.jsx("br",{}),j.jsxs("span",{children:[u.engine?j.jsx(hr,{size:"mini",color:"green",className:"engine-label",children:u.engine}):null,j.jsx("small",{children:g})]})]}),C=u.numSongs>1?`(${u.numSongs} songs)`:`(${u.numSongs} song)`;return{content:v,text:h,description:C,value:u.id}},c=(u,h)=>{u=u||"",u=u.normalize("NFD").replace(/[\u0300-\u036f]/g,""),h=h.replace(/([\\\.\+\*\?\^\$\(\)\[\]\{\}\|\/])/g,"\\$1");const d=new RegExp("\\b"+h,"i");return u.match(d)!==null};return j.jsx(dr,{placeholder:r,fluid:!0,multiple:!0,selection:!0,options:t.map(l),value:n||[],onChange:(u,h)=>{var f;let d=((f=h.value)==null?void 0:f.slice())||null;d&&d.length===0&&(d=null),o({...s,page:1,[e]:d,ids:null})},search:(u,h)=>{h=h.toLocaleLowerCase();const d=t.filter(f=>c(f.origName,h)||c(f.loclName,h)?!0:f!=null&&f.aliases?f.aliases.some(g=>c(g,h)):!1);return d.length===0?[]:d.map(l)}})}function Jj({synths:n,producers:e,vocalists:t,circles:r,stateFilterOptions:a,stateShowEnglish:i,stateShowSubs:s,dispatchSearchSongs:o}){const[l,c]=a,[u,h]=i,[d,f]=s,g=()=>j.jsxs("div",{className:"filter-submenu",children:[j.jsx("div",{children:j.jsx(dr,{className:"lang-dropdown",placeholder:"Language",selection:!0,button:!0,value:l.lang||0,header:"Filter songs by language",options:[{key:0,text:"Default - All languages",value:0},{key:1,text:"Chinese",value:"CN"},{key:2,text:"Japanese",value:"JP"}],onChange:(v,C)=>{let w=C.value||null;c({...l,page:1,lang:w})}})}),j.jsxs("div",{className:"flex-middle",children:[j.jsx(Eo,{toggle:!0,checked:!u,onChange:(v,C)=>h(!C.checked)}),j.jsx("span",{children:"Show titles in original language"})]}),j.jsxs("div",{className:"flex-middle",children:[j.jsx(Eo,{toggle:!0,checked:d,onChange:(v,C)=>f(C.checked)}),j.jsx("span",{children:"Show sub links"})]})]});return j.jsxs(gi,{stretched:!0,relaxed:!0,verticalAlign:"middle",children:[j.jsxs(Dr,{children:[j.jsx(kt,{width:3,children:"Search songs"}),j.jsx(kt,{width:13,children:j.jsx(Yj,{showEnglish:u,dispatchSearchSongs:o,stateFilterOptions:a})})]}),j.jsxs(Dr,{only:"computer",children:[j.jsx(kt,{width:12,children:j.jsxs(gi,{children:[j.jsxs(Dr,{children:[j.jsx(kt,{width:4,children:"Filter by synths:"}),j.jsx(kt,{width:12,children:j.jsx(hd,{field:"synths",placeholder:"Hatsune Miku",options:n,value:l.synths,stateFilterOptions:a,showEnglish:u})})]}),j.jsxs(Dr,{children:[j.jsx(kt,{width:4,children:"Filter by vocalists:"}),j.jsx(kt,{width:12,children:j.jsx(hd,{field:"vocalists",placeholder:"...",options:t,value:l.vocalists,stateFilterOptions:a,showEnglish:u})})]}),j.jsxs(Dr,{children:[j.jsx(kt,{width:4,children:"Filter by producers:"}),j.jsx(kt,{width:12,children:j.jsx(hd,{field:"producers",placeholder:"...",options:e,value:l.producers,stateFilterOptions:a,showEnglish:u})})]}),j.jsxs(Dr,{children:[j.jsx(kt,{width:4,children:"Filter by circles:"}),j.jsx(kt,{width:12,children:j.jsx(hd,{field:"circles",placeholder:"...",options:r,value:l.circles,stateFilterOptions:a,showEnglish:u})})]})]})}),j.jsx(kt,{width:4,children:j.jsx(g,{})})]})]})}function Xj({pageUrl:n,orgTitle:e,romTitle:t,engTitle:r,showEnglish:a}){return a?j.jsxs(j.Fragment,{children:[j.jsx(La,{as:"h3",children:j.jsx("a",{href:n||"",target:"_blank",children:r||e})}),r?j.jsx("div",{children:t?j.jsxs(j.Fragment,{children:[e,j.jsx("span",{children:` (${t})`})]}):j.jsx(j.Fragment,{children:e})}):null]}):j.jsxs(j.Fragment,{children:[j.jsx(La,{as:"h3",children:j.jsx("a",{href:n||"",target:"_blank",children:e})}),!r&&!t?null:j.jsxs("div",{children:[r," ",t?j.jsx("span",{children:`(${t})`}):null]})]})}function Rc({artist:n,showEnglish:e}){const{__synthProps:t,__vocalistProps:r}=n;let a,i,s,o=null;t.id?(a=t.origName,i=t.loclName,s=t.aliases,o=t.engine):(a=r.origName,i=r.loclName,s=r.aliases);let l,c,u,h,d;return e?(l=j.jsx("span",{children:i||a}),c=i?a:""):(l=j.jsx("span",{children:a}),c=i||""),u=s.join(", "),h=`${c}${c===""||u===""?"":", "}${u}`,h===""&&!o?l:(d=h===""?null:j.jsx(j.Fragment,{children:`AKA: ${h}`}),o&&(d=j.jsxs("div",{children:[d?j.jsxs(j.Fragment,{children:[d,j.jsx("hr",{})]}):null,o," synth"]})),j.jsx(Ni,{trigger:l,content:d,position:"bottom left",size:"mini"}))}function Mc({producer:n,showEnglish:e}){const{role:t,__props:{origName:r,loclName:a,aliases:i=[]}={}}=n;let s,o,l,c;return e?(s=j.jsx("span",{children:a||r}),o=a?r:""):(s=j.jsx("span",{children:r}),o=a||""),l=i.join(", "),c=`${o}${o===""||l===""?"":", "}${l}`,j.jsx(Ni,{trigger:s,content:j.jsxs("div",{children:[c===""?null:j.jsxs(j.Fragment,{children:[`AKA: ${c}`,j.jsx("hr",{})]}),t]}),position:"bottom left",size:"mini"})}function Oc({circle:n,showEnglish:e}){const{origName:t,loclName:r}=n;let a,i;return e?(a=j.jsx("span",{className:"circle-element",children:r||t}),i=r?t:""):(a=j.jsx("span",{className:"circle-element",children:t}),i=r||""),i===""?a:j.jsx(Ni,{trigger:a,content:j.jsx("div",{children:i}),position:"bottom left",size:"mini"})}function Zj({sub:n}){let e=n.description,t=n.subUrl;return e===null&&(t.match(/^https?:\/\/nekocap\.com/)?e="Nekocap":t.match(/^https?:\/\/www\.youtube\.com/)?e="YouTube":e="Sub"),j.jsx("a",{href:t,target:"_blank",children:`[${e}]`})}function Vy({field:n,filterOptions:e,setFilterOptions:t}){var o,l;const r=((o=e.sort)==null?void 0:o.field)||null,a=((l=e.sort)==null?void 0:l.order)||null;let i="caret down",s=!1;return r===n&&(s=!0,a==="ASC"&&(i="caret up")),j.jsx($t,{name:i,className:s?"active-filter":"",onClick:()=>{t({...e,page:1,sort:{field:n,order:s&&a==="ASC"?"DESC":"ASC"}})}})}const e3=n=>{const e={};for(let t of n){const r=t.ver;e[r]===void 0&&(e[r]=[]),e[r].push(t)}return Object.values(e)},t3=(n,e)=>{const t=n.length;return t===1?j.jsx(Rc,{artist:n[0],showEnglish:e}):t===2?j.jsxs(j.Fragment,{children:[j.jsx(Rc,{artist:n[0],showEnglish:e})," and ",j.jsx(Rc,{artist:n[1],showEnglish:e})]}):j.jsxs(j.Fragment,{children:[n.map((r,a)=>a===t-1?null:j.jsxs(j.Fragment,{children:[j.jsx(Rc,{artist:r,showEnglish:e}),", "]})),"and ",j.jsx(Rc,{artist:n[t-1],showEnglish:e})]})},n3=(n,e)=>{const t=n.length;return t===1?j.jsx(Mc,{producer:n[0],showEnglish:e}):t===2?j.jsxs(j.Fragment,{children:[j.jsx(Mc,{producer:n[0],showEnglish:e})," and ",j.jsx(Mc,{producer:n[1],showEnglish:e})]}):j.jsxs(j.Fragment,{children:[n.map((r,a)=>a===t-1?null:j.jsxs(j.Fragment,{children:[j.jsx(Mc,{producer:r,showEnglish:e}),", "]})),"and ",j.jsx(Mc,{producer:n[t-1],showEnglish:e})]})},r3=(n,e)=>{const t=n.length;return t===1?j.jsx(Oc,{circle:n[0],showEnglish:e}):t===2?j.jsxs(j.Fragment,{children:[j.jsx(Oc,{circle:n[0],showEnglish:e})," and ",j.jsx(Oc,{circle:n[1],showEnglish:e})]}):j.jsxs(j.Fragment,{children:[n.map((r,a)=>a===t-1?null:j.jsxs(j.Fragment,{children:[j.jsx(Oc,{circle:r,showEnglish:e}),", "]})),"and ",j.jsx(Oc,{circle:n[t-1],showEnglish:e})]})};function a3({songs:n=[],totalCount:e=1,stateFilterOptions:t,showEnglish:r,showSubs:a}){const i=ye.useRef(null),[s,o]=t;return j.jsxs(j.Fragment,{children:[j.jsx("span",{ref:i}),j.jsxs(pr,{celled:!0,striped:!0,color:"teal",compact:!0,children:[j.jsx(Da,{children:j.jsxs(vn,{children:[j.jsxs(zn,{collapsing:!0,width:1,children:["No",j.jsx(Vy,{field:"song_translated_date",filterOptions:s,setFilterOptions:o})]}),j.jsxs(zn,{width:a?5:7,children:["Title",j.jsx(Vy,{field:r?"song_english_title":"song_romanized_title",filterOptions:s,setFilterOptions:o})]}),j.jsx(zn,{width:3,children:"Vocals"}),j.jsx(zn,{width:3,children:"Producers"}),j.jsx(zn,{width:1,children:"Tags"}),j.jsxs(zn,{width:1,children:["Song Release Year",j.jsx(Vy,{field:"song_released_date",filterOptions:s,setFilterOptions:o})]}),a&&j.jsx(zn,{width:2,children:"Available Subs"})]})}),j.jsx(bi,{children:n.map((l,c)=>j.jsxs(vn,{children:[j.jsx(Zt,{textAlign:"center",children:((s.page||1)-1)*Nh+c+1}),j.jsx(Zt,{children:j.jsx(Xj,{pageUrl:l.pageUrl,orgTitle:l.orgTitle,romTitle:l.romTitle,engTitle:l.engTitle,showEnglish:r})}),j.jsx(Zt,{children:e3(l.singers).map(u=>j.jsxs(j.Fragment,{children:[t3(u,r),j.jsx("br",{})]}))}),j.jsxs(Zt,{children:[l.circles.length===0?null:j.jsxs("div",{children:[r3(l.circles,r),":"]}),n3(l.producers,r)]}),j.jsx(Zt,{textAlign:"center",children:j.jsx("div",{className:"lang-tag",children:l.lang})}),j.jsx(Zt,{textAlign:"center",children:new Date(l.releasedDate).getFullYear()}),a&&j.jsx(Zt,{children:l.subs.map(u=>j.jsx(Zj,{sub:u}))})]},l.id))}),j.jsx(os,{children:j.jsx(vn,{children:j.jsx(zn,{colSpan:a?7:6,children:j.jsxs("div",{className:"table-footer",children:[j.jsx("div",{className:"table-footer-info-songs",children:j.jsxs("div",{children:["Showing ",n.length," entries out of ",e]})}),j.jsx(vo,{totalPages:Math.ceil(e/Nh),activePage:s.page||1,boundaryRange:0,siblingRange:1,ellipsisItem:null,onPageChange:(l,c)=>{var u;o({...s,page:c.activePage}),(u=i==null?void 0:i.current)==null||u.scrollIntoView({behavior:"smooth",block:"start"})}})]})})})})]})]})}function i3(){const n=US(),e=F_(),[t,r]=ye.useState({lang:null,ids:null,synths:null,producers:null,vocalists:null,circles:null,page:1,sort:{field:"song_translated_date",order:"DESC"}}),[a,i]=ye.useState(!0),[s,o]=ye.useState(!1);ye.useEffect(()=>{e!==null&&(n(J_(e,t)),n(ex(e,t)),n(rx(e,t)),n(sx(e,t)),n(cx(e,t)))},[e,t]);const{synths:l}=Ks(v=>v.synths),{vocalists:c}=Ks(v=>v.vocalists),{producers:u}=Ks(v=>v.producers),{circles:h}=Ks(v=>v.circles),{songs:d,count:f}=Ks(v=>v.songs),g=v=>n(dx(e,v));return j.jsxs(j.Fragment,{children:[j.jsx("header",{children:j.jsx(Gj,{})}),j.jsxs("main",{children:[j.jsx("article",{id:"filter-article",children:j.jsx(Jj,{synths:l,vocalists:c,producers:u,circles:h,stateFilterOptions:[t,r],stateShowEnglish:[a,i],stateShowSubs:[s,o],dispatchSearchSongs:g})}),j.jsx("article",{id:"main-article",children:j.jsx(a3,{songs:d,totalCount:f,stateFilterOptions:[t,r],showEnglish:a,showSubs:s})})]}),j.jsxs("footer",{children:[j.jsx("hr",{}),j.jsxs("div",{children:["Powered by React and ",j.jsx("a",{href:"https://semantic-ui.com/",target:"_blank",children:"Semantic UI"}),"."]})]})]})}function en(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var s3=typeof Symbol=="function"&&Symbol.observable||"@@observable",QN=s3,zy=()=>Math.random().toString(36).substring(7).split("").join("."),o3={INIT:`@@redux/INIT${zy()}`,REPLACE:`@@redux/REPLACE${zy()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${zy()}`},dd=o3;function Wy(n){if(typeof n!="object"||n===null)return!1;let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e||Object.getPrototypeOf(n)===null}function GN(n,e,t){if(typeof n!="function")throw new Error(en(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(en(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(en(1));return t(GN)(n,e)}let r=n,a=e,i=new Map,s=i,o=0,l=!1;function c(){s===i&&(s=new Map,i.forEach((v,C)=>{s.set(C,v)}))}function u(){if(l)throw new Error(en(3));return a}function h(v){if(typeof v!="function")throw new Error(en(4));if(l)throw new Error(en(5));let C=!0;c();const w=o++;return s.set(w,v),function(){if(C){if(l)throw new Error(en(6));C=!1,c(),s.delete(w),i=null}}}function d(v){if(!Wy(v))throw new Error(en(7));if(typeof v.type>"u")throw new Error(en(8));if(typeof v.type!="string")throw new Error(en(17));if(l)throw new Error(en(9));try{l=!0,a=r(a,v)}finally{l=!1}return(i=s).forEach(C=>{C()}),v}function f(v){if(typeof v!="function")throw new Error(en(10));r=v,d({type:dd.REPLACE})}function g(){const v=h;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(en(11));function w(){const T=C;T.next&&T.next(u())}return w(),{unsubscribe:v(w)}},[QN](){return this}}}return d({type:dd.INIT}),{dispatch:d,subscribe:h,getState:u,replaceReducer:f,[QN]:g}}function l3(n){Object.keys(n).forEach(e=>{const t=n[e];if(typeof t(void 0,{type:dd.INIT})>"u")throw new Error(en(12));if(typeof t(void 0,{type:dd.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(en(13))})}function c3(n){const e=Object.keys(n),t={};for(let i=0;i<e.length;i++){const s=e[i];typeof n[s]=="function"&&(t[s]=n[s])}const r=Object.keys(t);let a;try{l3(t)}catch(i){a=i}return function(i={},s){if(a)throw a;let o=!1;const l={};for(let c=0;c<r.length;c++){const u=r[c],h=t[u],d=i[u],f=h(d,s);if(typeof f>"u")throw s&&s.type,new Error(en(14));l[u]=f,o=o||f!==d}return o=o||r.length!==Object.keys(i).length,o?l:i}}function pd(...n){return n.length===0?e=>e:n.length===1?n[0]:n.reduce((e,t)=>(...r)=>e(t(...r)))}function u3(...n){return e=>(t,r)=>{const a=e(t,r);let i=()=>{throw new Error(en(15))};const s={getState:a.getState,dispatch:(l,...c)=>i(l,...c)},o=n.map(l=>l(s));return i=pd(...o)(a.dispatch),{...a,dispatch:i}}}function h3(n){return Wy(n)&&"type"in n&&typeof n.type=="string"}var YN=Symbol.for("immer-nothing"),JN=Symbol.for("immer-draftable"),Hn=Symbol.for("immer-state");function Lr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Io=Object.getPrototypeOf;function Ai(n){return!!n&&!!n[Hn]}function $a(n){var e;return n?XN(n)||Array.isArray(n)||!!n[JN]||!!((e=n.constructor)!=null&&e[JN])||fd(n)||yd(n):!1}var d3=Object.prototype.constructor.toString();function XN(n){if(!n||typeof n!="object")return!1;const e=Io(n);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===d3}function _c(n,e){md(n)===0?Object.entries(n).forEach(([t,r])=>{e(t,r,n)}):n.forEach((t,r)=>e(r,t,n))}function md(n){const e=n[Hn];return e?e.type_:Array.isArray(n)?1:fd(n)?2:yd(n)?3:0}function Hy(n,e){return md(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function ZN(n,e,t){const r=md(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function p3(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function fd(n){return n instanceof Map}function yd(n){return n instanceof Set}function hs(n){return n.copy_||n.base_}function Ky(n,e){if(fd(n))return new Map(n);if(yd(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);if(!e&&XN(n))return Io(n)?{...n}:Object.assign(Object.create(null),n);const t=Object.getOwnPropertyDescriptors(n);delete t[Hn];let r=Reflect.ownKeys(t);for(let a=0;a<r.length;a++){const i=r[a],s=t[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:n[i]})}return Object.create(Io(n),t)}function Qy(n,e=!1){return gd(n)||Ai(n)||!$a(n)||(md(n)>1&&(n.set=n.add=n.clear=n.delete=m3),Object.freeze(n),e&&_c(n,(t,r)=>Qy(r,!0))),n}function m3(){Lr(2)}function gd(n){return Object.isFrozen(n)}var f3={};function ds(n){const e=f3[n];return e||Lr(0,n),e}var xc;function eC(){return xc}function y3(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function tC(n,e){e&&(ds("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Gy(n){Yy(n),n.drafts_.forEach(g3),n.drafts_=null}function Yy(n){n===xc&&(xc=n.parent_)}function nC(n){return xc=y3(xc,n)}function g3(n){const e=n[Hn];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function rC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Hn].modified_&&(Gy(e),Lr(4)),$a(n)&&(n=bd(e,n),e.parent_||vd(e,n)),e.patches_&&ds("Patches").generateReplacementPatches_(t[Hn].base_,n,e.patches_,e.inversePatches_)):n=bd(e,t,[]),Gy(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==YN?n:void 0}function bd(n,e,t){if(gd(e))return e;const r=e[Hn];if(!r)return _c(e,(a,i)=>aC(n,r,e,a,i,t)),e;if(r.scope_!==n)return e;if(!r.modified_)return vd(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const a=r.copy_;let i=a,s=!1;r.type_===3&&(i=new Set(a),a.clear(),s=!0),_c(i,(o,l)=>aC(n,r,a,o,l,t,s)),vd(n,a,!1),t&&n.patches_&&ds("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function aC(n,e,t,r,a,i,s){if(Ai(a)){const o=i&&e&&e.type_!==3&&!Hy(e.assigned_,r)?i.concat(r):void 0,l=bd(n,a,o);if(ZN(t,r,l),Ai(l))n.canAutoFreeze_=!1;else return}else s&&t.add(a);if($a(a)&&!gd(a)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;bd(n,a),(!e||!e.scope_.parent_)&&vd(n,a)}}function vd(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Qy(e,t)}function b3(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:eC(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,i=Jy;t&&(a=[r],i=Pc);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return r.draft_=o,r.revoke_=s,o}var Jy={get(n,e){if(e===Hn)return n;const t=hs(n);if(!Hy(t,e))return v3(n,t,e);const r=t[e];return n.finalized_||!$a(r)?r:r===Xy(n.base_,e)?(eg(n),n.copy_[e]=tg(r,n)):r},has(n,e){return e in hs(n)},ownKeys(n){return Reflect.ownKeys(hs(n))},set(n,e,t){const r=iC(hs(n),e);if(r!=null&&r.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const a=Xy(hs(n),e),i=a==null?void 0:a[Hn];if(i&&i.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(p3(t,a)&&(t!==void 0||Hy(n.base_,e)))return!0;eg(n),Zy(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return Xy(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,eg(n),Zy(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=hs(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){Lr(11)},getPrototypeOf(n){return Io(n.base_)},setPrototypeOf(){Lr(12)}},Pc={};_c(Jy,(n,e)=>{Pc[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Pc.deleteProperty=function(n,e){return Pc.set.call(this,n,e,void 0)},Pc.set=function(n,e,t){return Jy.set.call(this,n[0],e,t,n[0])};function Xy(n,e){const t=n[Hn];return(t?hs(t):n)[e]}function v3(n,e,t){var a;const r=iC(e,t);return r?"value"in r?r.value:(a=r.get)==null?void 0:a.call(n.draft_):void 0}function iC(n,e){if(!(e in n))return;let t=Io(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Io(t)}}function Zy(n){n.modified_||(n.modified_=!0,n.parent_&&Zy(n.parent_))}function eg(n){n.copy_||(n.copy_=Ky(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var E3=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const s=this;return function(o=i,...l){return s.produce(o,c=>t.call(this,c,...l))}}typeof t!="function"&&Lr(6),r!==void 0&&typeof r!="function"&&Lr(7);let a;if($a(e)){const i=nC(this),s=tg(e,void 0);let o=!0;try{a=t(s),o=!1}finally{o?Gy(i):Yy(i)}return tC(i,r),rC(a,i)}else if(!e||typeof e!="object"){if(a=t(e),a===void 0&&(a=e),a===YN&&(a=void 0),this.autoFreeze_&&Qy(a,!0),r){const i=[],s=[];ds("Patches").generateReplacementPatches_(e,a,i,s),r(i,s)}return a}else Lr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(i,...s)=>this.produceWithPatches(i,o=>e(o,...s));let r,a;return[this.produce(e,t,(i,s)=>{r=i,a=s}),r,a]},typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof(n==null?void 0:n.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){$a(n)||Lr(8),Ai(n)&&(n=sC(n));const e=nC(this),t=tg(n,void 0);return t[Hn].isManual_=!0,Yy(e),t}finishDraft(n,e){const t=n&&n[Hn];(!t||!t.isManual_)&&Lr(9);const{scope_:r}=t;return tC(r,e),rC(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const a=e[t];if(a.path.length===0&&a.op==="replace"){n=a.value;break}}t>-1&&(e=e.slice(t+1));const r=ds("Patches").applyPatches_;return Ai(n)?r(n,e):this.produce(n,a=>r(a,e))}};function tg(n,e){const t=fd(n)?ds("MapSet").proxyMap_(n,e):yd(n)?ds("MapSet").proxySet_(n,e):b3(n,e);return(e?e.scope_:eC()).drafts_.push(t),t}function sC(n){return Ai(n)||Lr(10,n),oC(n)}function oC(n){if(!$a(n)||gd(n))return n;const e=n[Hn];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Ky(n,e.scope_.immer_.useStrictShallowCopy_)}else t=Ky(n,!0);return _c(t,(r,a)=>{ZN(t,r,oC(a))}),e&&(e.finalized_=!1),t}var Kn=new E3,lC=Kn.produce;Kn.produceWithPatches.bind(Kn),Kn.setAutoFreeze.bind(Kn),Kn.setUseStrictShallowCopy.bind(Kn),Kn.applyPatches.bind(Kn),Kn.createDraft.bind(Kn),Kn.finishDraft.bind(Kn);function w3(n,e=`expected a function, instead received ${typeof n}`){if(typeof n!="function")throw new TypeError(e)}function T3(n,e=`expected an object, instead received ${typeof n}`){if(typeof n!="object")throw new TypeError(e)}function N3(n,e="expected all items to be functions, instead received the following types: "){if(!n.every(t=>typeof t=="function")){const t=n.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${e}[${t}]`)}}var cC=n=>Array.isArray(n)?n:[n];function C3(n){const e=Array.isArray(n[0])?n[0]:n;return N3(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function A3(n,e){const t=[],{length:r}=n;for(let a=0;a<r;a++)t.push(n[a].apply(null,e));return t}var S3=class{constructor(n){this.value=n}deref(){return this.value}},R3=typeof WeakRef<"u"?WeakRef:S3,M3=0,uC=1;function Ed(){return{s:M3,v:void 0,o:null,p:null}}function ng(n,e={}){let t=Ed();const{resultEqualityCheck:r}=e;let a,i=0;function s(){var h;let o=t;const{length:l}=arguments;for(let d=0,f=l;d<f;d++){const g=arguments[d];if(typeof g=="function"||typeof g=="object"&&g!==null){let v=o.o;v===null&&(o.o=v=new WeakMap);const C=v.get(g);C===void 0?(o=Ed(),v.set(g,o)):o=C}else{let v=o.p;v===null&&(o.p=v=new Map);const C=v.get(g);C===void 0?(o=Ed(),v.set(g,o)):o=C}}const c=o;let u;if(o.s===uC?u=o.v:(u=n.apply(null,arguments),i++),c.s=uC,r){const d=((h=a==null?void 0:a.deref)==null?void 0:h.call(a))??a;d!=null&&r(d,u)&&(u=d,i!==0&&i--),a=typeof u=="object"&&u!==null||typeof u=="function"?new R3(u):u}return c.v=u,u}return s.clearCache=()=>{t=Ed(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function hC(n,...e){const t=typeof n=="function"?{memoize:n,memoizeOptions:e}:n,r=(...a)=>{let i=0,s=0,o,l={},c=a.pop();typeof c=="object"&&(l=c,c=a.pop()),w3(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...t,...l},{memoize:h,memoizeOptions:d=[],argsMemoize:f=ng,argsMemoizeOptions:g=[],devModeChecks:v={}}=u,C=cC(d),w=cC(g),T=C3(a),S=h(function(){return i++,c.apply(null,arguments)},...C),O=f(function(){s++;const k=A3(T,arguments);return o=S.apply(null,k),o},...w);return Object.assign(O,{resultFunc:c,memoizedResultFunc:S,dependencies:T,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:f})};return Object.assign(r,{withTypes:()=>r}),r}var O3=hC(ng),_3=Object.assign((n,e=O3)=>{T3(n,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof n}`);const t=Object.keys(n),r=t.map(a=>n[a]);return e(r,(...a)=>a.reduce((i,s,o)=>(i[t[o]]=s,i),{}))},{withTypes:()=>_3});function dC(n){return({dispatch:e,getState:t})=>r=>a=>typeof a=="function"?a(e,t,n):r(a)}var x3=dC(),P3=dC,I3=(...n)=>{const e=hC(...n);return(...t)=>{const r=e(...t),a=(i,...s)=>r(Ai(i)?sC(i):i,...s);return Object.assign(a,r),a}};I3(ng);var D3=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?pd:pd.apply(null,arguments)};function Ic(n,e){function t(...r){if(e){let a=e(...r);if(!a)throw new Error(qr(0));return{type:n,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:n,payload:r[0]}}return t.toString=()=>`${n}`,t.type=n,t.match=r=>h3(r)&&r.type===n,t}var pC=class Bc extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Bc.prototype)}static get[Symbol.species](){return Bc}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Bc(...e[0].concat(this)):new Bc(...e.concat(this))}};function mC(n){return $a(n)?lC(n,()=>{}):n}function fC(n,e,t){if(n.has(e)){let a=n.get(e);return t.update&&(a=t.update(a,e,n),n.set(e,a)),a}if(!t.insert)throw new Error(qr(10));const r=t.insert(e,n);return n.set(e,r),r}function L3(n){return typeof n=="boolean"}var q3=()=>function(n){const{thunk:e=!0,immutableCheck:t=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=n??{};let i=new pC;return e&&(L3(e)?i.push(x3):i.push(P3(e.extraArgument))),i},$3="RTK_autoBatch",yC=n=>e=>{setTimeout(e,n)},k3=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:yC(10),j3=(n={type:"raf"})=>e=>(...t)=>{const r=e(...t);let a=!0,i=!1,s=!1;const o=new Set,l=n.type==="tick"?queueMicrotask:n.type==="raf"?k3:n.type==="callback"?n.queueNotification:yC(n.timeout),c=()=>{s=!1,i&&(i=!1,o.forEach(u=>u()))};return Object.assign({},r,{subscribe(u){const h=()=>a&&u(),d=r.subscribe(h);return o.add(u),()=>{d(),o.delete(u)}},dispatch(u){var h;try{return a=!((h=u==null?void 0:u.meta)!=null&&h[$3]),i=!a,i&&(s||(s=!0,l(c))),r.dispatch(u)}finally{a=!0}}})},B3=n=>function(e){const{autoBatch:t=!0}=e??{};let r=new pC(n);return t&&r.push(j3(typeof t=="object"?t:void 0)),r},U3=!0;function F3(n){const e=q3(),{reducer:t=void 0,middleware:r,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=n||{};let o;if(typeof t=="function")o=t;else if(Wy(t))o=c3(t);else throw new Error(qr(1));let l;typeof r=="function"?l=r(e):l=e();let c=pd;a&&(c=D3({trace:!U3,...typeof a=="object"&&a}));const u=u3(...l),h=B3(u);let d=typeof s=="function"?s(h):h();const f=c(...d);return GN(o,i,f)}function gC(n){const e={},t=[];let r;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(qr(28));if(o in e)throw new Error(qr(29));return e[o]=s,a},addMatcher(i,s){return t.push({matcher:i,reducer:s}),a},addDefaultCase(i){return r=i,a}};return n(a),[e,t,r]}function V3(n){return typeof n=="function"}function z3(n,e){let[t,r,a]=gC(e),i;if(V3(n))i=()=>mC(n());else{const o=mC(n);i=()=>o}function s(o=i(),l){let c=[t[l.type],...r.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[a]),c.reduce((u,h)=>{if(h)if(Ai(u)){const d=h(u,l);return d===void 0?u:d}else{if($a(u))return lC(u,d=>h(d,l));{const d=h(u,l);if(d===void 0){if(u===null)return u;throw new Error(qr(9))}return d}}return u},o)}return s.getInitialState=i,s}var W3=Symbol.for("rtk-slice-createasyncthunk");function H3(n,e){return`${n}/${e}`}function K3({creators:n}={}){var t;const e=(t=n==null?void 0:n.asyncThunk)==null?void 0:t[W3];return function(r){const{name:a,reducerPath:i=a}=r;if(!a)throw new Error(qr(11));typeof process<"u";const s=(typeof r.reducers=="function"?r.reducers(G3()):r.reducers)||{},o=Object.keys(s),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(v,C){const w=typeof v=="string"?v:v.type;if(!w)throw new Error(qr(12));if(w in l.sliceCaseReducersByType)throw new Error(qr(13));return l.sliceCaseReducersByType[w]=C,c},addMatcher(v,C){return l.sliceMatchers.push({matcher:v,reducer:C}),c},exposeAction(v,C){return l.actionCreators[v]=C,c},exposeCaseReducer(v,C){return l.sliceCaseReducersByName[v]=C,c}};o.forEach(v=>{const C=s[v],w={reducerName:v,type:H3(a,v),createNotation:typeof r.reducers=="function"};J3(C)?Z3(w,C,c,e):Y3(w,C,c)});function u(){const[v={},C=[],w=void 0]=typeof r.extraReducers=="function"?gC(r.extraReducers):[r.extraReducers],T={...v,...l.sliceCaseReducersByType};return z3(r.initialState,S=>{for(let O in T)S.addCase(O,T[O]);for(let O of l.sliceMatchers)S.addMatcher(O.matcher,O.reducer);for(let O of C)S.addMatcher(O.matcher,O.reducer);w&&S.addDefaultCase(w)})}const h=v=>v,d=new WeakMap;let f;const g={name:a,reducerPath:i,reducer(v,C){return f||(f=u()),f(v,C)},actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState(){return f||(f=u()),f.getInitialState()},getSelectors(v=h){const C=fC(d,this,{insert:()=>new WeakMap});return fC(C,v,{insert:()=>{const w={};for(const[T,S]of Object.entries(r.selectors??{}))w[T]=Q3(this,S,v,this!==g);return w}})},selectSlice(v){let C=v[this.reducerPath];return typeof C>"u"&&this!==g&&(C=this.getInitialState()),C},get selectors(){return this.getSelectors(this.selectSlice)},injectInto(v,{reducerPath:C,...w}={}){const T=C??this.reducerPath;return v.inject({reducerPath:T,reducer:this.reducer},w),{...this,reducerPath:T}}};return g}}function Q3(n,e,t,r){function a(i,...s){let o=t.call(n,i);return typeof o>"u"&&r&&(o=n.getInitialState()),e(o,...s)}return a.unwrapped=e,a}K3();function G3(){function n(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return n.withTypes=()=>n,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:n}}function Y3({type:n,reducerName:e,createNotation:t},r,a){let i,s;if("reducer"in r){if(t&&!X3(r))throw new Error(qr(17));i=r.reducer,s=r.prepare}else i=r;a.addCase(n,i).exposeCaseReducer(e,i).exposeAction(e,s?Ic(n,s):Ic(n))}function J3(n){return n._reducerDefinitionType==="asyncThunk"}function X3(n){return n._reducerDefinitionType==="reducerWithPrepare"}function Z3({type:n,reducerName:e},t,r,a){if(!a)throw new Error(qr(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:l,settled:c,options:u}=t,h=a(n,i,u);r.exposeAction(e,h),s&&r.addCase(h.fulfilled,s),o&&r.addCase(h.pending,o),l&&r.addCase(h.rejected,l),c&&r.addMatcher(h.settled,c),r.exposeCaseReducer(e,{fulfilled:s||wd,pending:o||wd,rejected:l||wd,settled:c||wd})}function wd(){}var rg="listenerMiddleware";Ic(`${rg}/add`),Ic(`${rg}/removeAll`),Ic(`${rg}/remove`);function qr(n){return`Minified Redux Toolkit error #${n}; visit https://redux-toolkit.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}const eB={synths:[],isLoading:!1};function tB(n=eB,e){switch(e.type){case bf:return{...n,synths:e.payload};case vf:return{...n,synths:[]};case Ef:return{...n,isLoading:e.payload}}return n}const nB={vocalists:[],isLoading:!1};function rB(n=nB,e){switch(e.type){case Cf:return{...n,vocalists:e.payload};case Af:return{...n,vocalists:[]};case Sf:return{...n,isLoading:e.payload}}return n}const aB={producers:[],isLoading:!1};function iB(n=aB,e){switch(e.type){case wf:return{...n,producers:e.payload};case Tf:return{...n,producers:[]};case Nf:return{...n,isLoading:e.payload}}return n}const sB={circles:[],isLoading:!1};function oB(n=sB,e){switch(e.type){case Rf:return{...n,circles:e.payload};case Mf:return{...n,circles:[]};case Of:return{...n,isLoading:e.payload}}return n}const lB={songs:[],count:0,isLoading:!1};function cB(n=lB,e){switch(e.type){case _f:return{...n,songs:e.payload.songs,count:e.payload.count};case xf:return{...n,songs:[]};case Pf:return{...n,isLoading:e.payload}}return n}const uB={songs:[],isLoading:!1};function hB(n=uB,e){switch(e.type){case If:return{...n,songs:e.payload};case Df:return{...n,songs:[]};case Lf:return{...n,isLoading:e.payload}}return n}const dB=F3({reducer:{synths:tB,vocalists:rB,producers:iB,circles:oB,songs:cB,search:hB},middleware:n=>n({serializableCheck:{ignoredActions:[bf,vf,Ef,wf,Tf,Nf,Cf,Af,Sf,Rf,Mf,Of,_f,xf,Pf,If,Df,Lf],ignoredPaths:["synths.synths","vocalists.vocalists","producers.producers","circles.circles","songs.songs","search.songs"]}})});Bd.createRoot(document.getElementById("root")).render(j.jsx(kS,{store:dB,children:j.jsx(U_,{children:j.jsx(i3,{})})}))}),eU=XB();export{eU as default};
